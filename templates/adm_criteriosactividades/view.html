{% extends "base.html" %}
{% load sga_extras %}
{% block heading %}
    <link href="/static/css/table-responsive.css?1.0.0" type="text/css" rel="stylesheet" />
    <link rel="stylesheet" href="/static/css/jquery.fancybox.css?v=1.0.0" type="text/css" media="screen" />
    <script type="text/javascript" src="/static/js/jquery.fancybox.pack.js?v=1.0.0"></script>
    <script type="text/javascript">
        $(document).ready(function() {
            $(".verdetalle").click(function () {
                var opc = $(this).attr('opc');
                var idcriterio = $(this).attr('idcriterio');
                bloqueointerface();
                $.ajax({
                    type: "POST",
                    url: "/adm_criteriosactividades",
                    data: {'action': 'verdetalledocentescriterios', 'idcriterio': idcriterio, 'opc': opc },
                    success: function (data) {
                        if (data.result == 'ok') {
                            $("#bodyrequisitos").html(data.data);
                            $("#modaldetallerequisitos").modal({"backdrop": "static", "width": "900px"}).modal("show");
                            $.unblockUI();
                        } else {
                            $.unblockUI();
                            mensajeSuccess(data.mensaje)
                        }
                    },
                    error: function () {
                        $.unblockUI();
                        mensajeWarning('Error al obtener los datos.')
                    },
                    dataType: "json"
                });
            });
            $(".deleteajax").click(function () {
                var idnombre = $(this).attr('idnombre');
                var pk = $(this).attr('indice');
                var accion = $(this).attr('opc');
                Swal.fire({
                    html: '<b>Estás por activar/desactivar este registro: </b>' + idnombre,
                    text: "Esta acción es irreversible",
                    type: 'info',
                    showCancelButton: true,
                    allowOutsideClick: false,
                    confirmButtonColor: '#3085d6',
                    cancelButtonColor: '#d33',
                    confirmButtonText: 'Si, deseo hacerlo',
                    cancelButtonText: 'Cancelar'
                }).then((result) => {
                    if (result.value) {
                        bloqueointerface();
                        $.ajax({
                            type: 'POST',
                            url: '{{ reques.path }}',
                            async: false,
                            data: {
                                csrfmiddlewaretoken: '{{ csrf_token }}',
                                action: accion,
                                id: pk,
                            },
                            dataType: "json",
                            beforeSend: function () {
                                bloqueointerface();
                            }
                        }).done(function (data) {
                            {#setTimeout($.unblockUI, 1);#}
                            if (data.result == 'ok') {
                                location.reload();
                            }
                        }).fail(function (jqXHR, textStatus, errorThrown) {
                            setTimeout($.unblockUI, 1);
                            NotificationJG.error('Error en el servidor', 'Advertencia!', 10000);
                        }).always(function () {
                        });
                    } else {
                    }
                })
            });
            $(".activasubirdoc").click(function () {
                var idnombre = $(this).attr('idnombre');
                var pk = $(this).attr('indice');
                var accion = $(this).attr('opc');
                Swal.fire({
                    html: '<b>Estás por activar/desactivar subir evidencia: </b>' + idnombre,
                    text: "Esta acción es irreversible",
                    type: 'info',
                    showCancelButton: true,
                    allowOutsideClick: false,
                    confirmButtonColor: '#3085d6',
                    cancelButtonColor: '#d33',
                    confirmButtonText: 'Si, deseo hacerlo',
                    cancelButtonText: 'Cancelar'
                }).then((result) => {
                    if (result.value) {
                        bloqueointerface();
                        $.ajax({
                            type: 'POST',
                            url: '{{ reques.path }}',
                            async: false,
                            data: {
                                csrfmiddlewaretoken: '{{ csrf_token }}',
                                action: accion,
                                id: pk,
                            },
                            dataType: "json",
                            beforeSend: function () {
                                bloqueointerface();
                            }
                        }).done(function (data) {
                            {#setTimeout($.unblockUI, 1);#}
                            if (data.result == 'ok') {
                                location.href = "/adm_criteriosactividades?t=1";
                            }
                        }).fail(function (jqXHR, textStatus, errorThrown) {
                            setTimeout($.unblockUI, 1);
                            NotificationJG.error('Error en el servidor', 'Advertencia!', 10000);
                        }).always(function () {
                        });
                    } else {
                    }
                })
            });
            $(".activabitacoradoc").click(function () {
                var idnombre = $(this).attr('idnombre');
                var pk = $(this).attr('indice');
                var accion = $(this).attr('opc');
                Swal.fire({
                    html: '<b>Estás por activar/desactivar llenar bitacora: </b>' + idnombre,
                    text: "Esta acción es irreversible",
                    type: 'info',
                    showCancelButton: true,
                    allowOutsideClick: false,
                    confirmButtonColor: '#3085d6',
                    cancelButtonColor: '#d33',
                    confirmButtonText: 'Si, deseo hacerlo',
                    cancelButtonText: 'Cancelar'
                }).then((result) => {
                    if (result.value) {
                        bloqueointerface();
                        $.ajax({
                            type: 'POST',
                            url: '{{ reques.path }}',
                            async: false,
                            data: {
                                csrfmiddlewaretoken: '{{ csrf_token }}',
                                action: accion,
                                id: pk,
                            },
                            dataType: "json",
                            beforeSend: function () {
                                bloqueointerface();
                            }
                        }).done(function (data) {
                            {#setTimeout($.unblockUI, 1);#}
                            if (data.result == 'ok') {
                                location.href = "/adm_criteriosactividades?t=1";
                            }
                        }).fail(function (jqXHR, textStatus, errorThrown) {
                            setTimeout($.unblockUI, 1);
                            NotificationJG.error('Error en el servidor', 'Advertencia!', 10000);
                        }).always(function () {
                        });
                    } else {
                    }
                })
            });
            $(".activasubir").click(function () {
                var idnombre = $(this).attr('idnombre');
                var pk = $(this).attr('indice');
                var accion = $(this).attr('opc');
                Swal.fire({
                    html: '<b>Estás por activar/desactivar subir evidencia: </b>' + idnombre,
                    text: "Esta acción es irreversible",
                    type: 'info',
                    showCancelButton: true,
                    allowOutsideClick: false,
                    confirmButtonColor: '#3085d6',
                    cancelButtonColor: '#d33',
                    confirmButtonText: 'Si, deseo hacerlo',
                    cancelButtonText: 'Cancelar'
                }).then((result) => {
                    if (result.value) {
                        bloqueointerface();
                        $.ajax({
                            type: 'POST',
                            url: '{{ reques.path }}',
                            async: false,
                            data: {
                                csrfmiddlewaretoken: '{{ csrf_token }}',
                                action: accion,
                                id: pk,
                            },
                            dataType: "json",
                            beforeSend: function () {
                                bloqueointerface();
                            }
                        }).done(function (data) {
                            {#setTimeout($.unblockUI, 1);#}
                            if (data.result == 'ok') {
                                location.href = "/adm_criteriosactividades?t=2";
                            }
                        }).fail(function (jqXHR, textStatus, errorThrown) {
                            setTimeout($.unblockUI, 1);
                            NotificationJG.error('Error en el servidor', 'Advertencia!', 10000);
                        }).always(function () {
                        });
                    } else {
                    }
                })
            });
            $(".activabitacora").click(function () {
                var idnombre = $(this).attr('idnombre');
                var pk = $(this).attr('indice');
                var accion = $(this).attr('opc');
                Swal.fire({
                    html: '<b>Estás por activar/desactivar llenar bitacora: </b>' + idnombre,
                    text: "Esta acción es irreversible",
                    type: 'info',
                    showCancelButton: true,
                    allowOutsideClick: false,
                    confirmButtonColor: '#3085d6',
                    cancelButtonColor: '#d33',
                    confirmButtonText: 'Si, deseo hacerlo',
                    cancelButtonText: 'Cancelar'
                }).then((result) => {
                    if (result.value) {
                        bloqueointerface();
                        $.ajax({
                            type: 'POST',
                            url: '{{ reques.path }}',
                            async: false,
                            data: {
                                csrfmiddlewaretoken: '{{ csrf_token }}',
                                action: accion,
                                id: pk,
                            },
                            dataType: "json",
                            beforeSend: function () {
                                bloqueointerface();
                            }
                        }).done(function (data) {
                            {#setTimeout($.unblockUI, 1);#}
                            if (data.result == 'ok') {
                                location.href = "/adm_criteriosactividades?t=2";
                            }
                        }).fail(function (jqXHR, textStatus, errorThrown) {
                            setTimeout($.unblockUI, 1);
                            NotificationJG.error('Error en el servidor', 'Advertencia!', 10000);
                        }).always(function () {
                        });
                    } else {
                    }
                })
            });
            $(".activasubirges").click(function () {
                var idnombre = $(this).attr('idnombre');
                var pk = $(this).attr('indice');
                var accion = $(this).attr('opc');
                Swal.fire({
                    html: '<b>Estás por activar/desactivar subir evidencia: </b>' + idnombre,
                    text: "Esta acción es irreversible",
                    type: 'info',
                    showCancelButton: true,
                    allowOutsideClick: false,
                    confirmButtonColor: '#3085d6',
                    cancelButtonColor: '#d33',
                    confirmButtonText: 'Si, deseo hacerlo',
                    cancelButtonText: 'Cancelar'
                }).then((result) => {
                    if (result.value) {
                        bloqueointerface();
                        $.ajax({
                            type: 'POST',
                            url: '{{ reques.path }}',
                            async: false,
                            data: {
                                csrfmiddlewaretoken: '{{ csrf_token }}',
                                action: accion,
                                id: pk,
                            },
                            dataType: "json",
                            beforeSend: function () {
                                bloqueointerface();
                            }
                        }).done(function (data) {
                            {#setTimeout($.unblockUI, 1);#}
                            if (data.result == 'ok') {
                                location.href = "/adm_criteriosactividades?t=3";
                            }
                        }).fail(function (jqXHR, textStatus, errorThrown) {
                            setTimeout($.unblockUI, 1);
                            NotificationJG.error('Error en el servidor', 'Advertencia!', 10000);
                        }).always(function () {
                        });
                    } else {
                    }
                })
            });
            $(".activabitacorages").click(function () {
                var idnombre = $(this).attr('idnombre');
                var pk = $(this).attr('indice');
                var accion = $(this).attr('opc');
                Swal.fire({
                    html: '<b>Estás por activar/desactivar llenar bitacora: </b>' + idnombre,
                    text: "Esta acción es irreversible",
                    type: 'info',
                    showCancelButton: true,
                    allowOutsideClick: false,
                    confirmButtonColor: '#3085d6',
                    cancelButtonColor: '#d33',
                    confirmButtonText: 'Si, deseo hacerlo',
                    cancelButtonText: 'Cancelar'
                }).then((result) => {
                    if (result.value) {
                        bloqueointerface();
                        $.ajax({
                            type: 'POST',
                            url: '{{ reques.path }}',
                            async: false,
                            data: {
                                csrfmiddlewaretoken: '{{ csrf_token }}',
                                action: accion,
                                id: pk,
                            },
                            dataType: "json",
                            beforeSend: function () {
                                bloqueointerface();
                            }
                        }).done(function (data) {
                            {#setTimeout($.unblockUI, 1);#}
                            if (data.result == 'ok') {
                                location.href = "/adm_criteriosactividades?t=3";
                            }
                        }).fail(function (jqXHR, textStatus, errorThrown) {
                            setTimeout($.unblockUI, 1);
                            NotificationJG.error('Error en el servidor', 'Advertencia!', 10000);
                        }).always(function () {
                        });
                    } else {
                    }
                })
            });
            $(".activasubirvin").click(function () {
                var idnombre = $(this).attr('idnombre');
                var pk = $(this).attr('indice');
                var accion = $(this).attr('opc');
                Swal.fire({
                    html: '<b>Estás por activar/desactivar subir evidencia: </b>' + idnombre,
                    text: "Esta acción es irreversible",
                    type: 'info',
                    showCancelButton: true,
                    allowOutsideClick: false,
                    confirmButtonColor: '#3085d6',
                    cancelButtonColor: '#d33',
                    confirmButtonText: 'Si, deseo hacerlo',
                    cancelButtonText: 'Cancelar'
                }).then((result) => {
                    if (result.value) {
                        bloqueointerface();
                        $.ajax({
                            type: 'POST',
                            url: '{{ reques.path }}',
                            async: false,
                            data: {
                                csrfmiddlewaretoken: '{{ csrf_token }}',
                                action: accion,
                                id: pk,
                            },
                            dataType: "json",
                            beforeSend: function () {
                                bloqueointerface();
                            }
                        }).done(function (data) {
                            {#setTimeout($.unblockUI, 1);#}
                            if (data.result == 'ok') {
                                location.href = "/adm_criteriosactividades?t=4";
                            }
                        }).fail(function (jqXHR, textStatus, errorThrown) {
                            setTimeout($.unblockUI, 1);
                            NotificationJG.error('Error en el servidor', 'Advertencia!', 10000);
                        }).always(function () {
                        });
                    } else {
                    }
                })
            });
            $(".activabitacoravin").click(function () {
                var idnombre = $(this).attr('idnombre');
                var pk = $(this).attr('indice');
                var accion = $(this).attr('opc');
                Swal.fire({
                    html: '<b>Estás por activar/desactivar llenar bitacora: </b>' + idnombre,
                    text: "Esta acción es irreversible",
                    type: 'info',
                    showCancelButton: true,
                    allowOutsideClick: false,
                    confirmButtonColor: '#3085d6',
                    cancelButtonColor: '#d33',
                    confirmButtonText: 'Si, deseo hacerlo',
                    cancelButtonText: 'Cancelar'
                }).then((result) => {
                    if (result.value) {
                        bloqueointerface();
                        $.ajax({
                            type: 'POST',
                            url: '{{ reques.path }}',
                            async: false,
                            data: {
                                csrfmiddlewaretoken: '{{ csrf_token }}',
                                action: accion,
                                id: pk,
                            },
                            dataType: "json",
                            beforeSend: function () {
                                bloqueointerface();
                            }
                        }).done(function (data) {
                            {#setTimeout($.unblockUI, 1);#}
                            if (data.result == 'ok') {
                                location.href = "/adm_criteriosactividades?t=4";
                            }
                        }).fail(function (jqXHR, textStatus, errorThrown) {
                            setTimeout($.unblockUI, 1);
                            NotificationJG.error('Error en el servidor', 'Advertencia!', 10000);
                        }).always(function () {
                        });
                    } else {
                    }
                })
            });
        });
    </script>
    <script type="text/javascript">
        function activar(campo) {
            smoke.confirm("¿Está seguro de modificar ?", function(e){
                if (e){
                    $.blockUI({message: null});
                    $.post("/adm_criteriosactividades", {'action': 'activarproducto', 'id': campo}, function(data){
                        $.unblockUI();
                        if (data.result=='ok'){
                            if (data.valor==1){
                                $("#activado_"+campo).html('<i class="fa fa-check" style="color: green"></i>');
                            } else {
                                $("#activado_"+campo).html('<i class="fa fa-remove" style="color: red"></i>');
                            }
                        }
                    }, "json" );
                }
            }, {
                ok: "SI,SEGURO",
                cancel: "NO,CANCELAR",
                classname: "custom-class",
                reverseButtons: true
            });
        }
        $(function() {
            {#Para agregar periodos relacionados #}
            $(".periodosrelacionados").click(function() {
                var id = $(this).attr("id");
                abrirmodalperiodos('addperiodosrelaciondos',id)
            });


            $(".articulodocencia_view").click(function() {
                var id = $(this).attr("id");
                abrirmodal('articulosdocencia','addarticulodocencia',id)
            });
            $(".criteriolink_view").click(function() {
                var id = $(this).attr("id");
                abrirmodallink('criteriolink','addcriteriolink',id)
            });

            $(".articulogestion_view").click(function() {
                var id = $(this).attr("id");
                abrirmodal('articulosgestion','addarticulogestion',id)
            });
            $(".articulovinculacion_view").click(function() {
                var id = $(this).attr("id");
                abrirmodal('articulosvinculacion','addarticulovinculacion',id)
            });
            $(".articuloinvestigacion_view").click(function() {
                var id = $(this).attr("id");
                abrirmodal('articulosinvestigacion','addarticuloinvestigacion',id)
            });
            abrirmodallink = function(action1,action2,id ) {
                bloqueointerface();
                $.ajax({
                    type: "POST",
                    url: "/adm_criteriosactividades",
                    data: {'action': action1, id: id},
                    success: function (data) {
                        $.unblockUI();
                        if (data.result == 'ok') {
                            $("#paneltitlelink").html("Asignar criterio link");
                            $("#panel_link").html(data.html);
                            $("#itemspanellink").modal({"backdrop": "static", "width": "900px"}).modal("show");
                            $(".filterable tr:has(td)").each(function () {
                                var t = $(this).text().toLowerCase();
                                $("<td class='indexColumn'></td>").hide().text(t).appendTo(this);
                            });
                            $("#FilterTextBox").unbind().val('');
                            $("#FilterTextBox").keyup(function () {
                                var s = $(this).val().toLowerCase().split(" ");
                                $(".filterable tr:hidden").show();
                                $(".filterable tr:visible .indexColumn:not(:contains('" + s + "'))").parent().hide();
                                $(".filterable3 tr:hidden").show();
                            });
                            $(".fancybox").fancybox();
                            $(".gallerypdf").fancybox({
                                openEffect: 'elastic',
                                closeEffect: 'elastic',
                                autoSize: true,
                                type: 'iframe',
                                iframe: {
                                    preload: false // fixes issue with iframe and IE
                                }
                            });
                            addcriteriolink(action2);
                        } else {
                            smoke.alert(data.mensaje);
                        }
                    },
                    error: function () {
                        $.unblockUI();
                        smoke.alert("Error de conexión.");
                    },
                    dataType: "json"
                });
            };
            addcriteriolink = function(action) {
                $(".btn-criteriolink").unbind();

                $(".btn-criteriolink").click(function () {
                    var aproeli = $(this).attr("aproeli");
                    var cid = $(this).attr("cid");
                    var aid = $(this).attr("aid");
                    if (cid > 0){
                        bloqueointerface();
                        $("#itemspanellink").modal("hide");
                        showWaiting("Registrando link", "Espere unos segundos por favor...");
                        $.ajax({
                            type: "POST",
                            url: "/adm_criteriosactividades",
                            data: {'action': action, 'cid': cid, 'aid': aid,'aproeli':aproeli},
                            success: function(data) {
                                if (data.result=='ok'){
                                    location.reload();
                                } else {
                                    hideWaiting();
                                    smoke.alert(data.mensaje);
                                }
                            },
                            error: function() {
                                hideWaiting();
                                smoke.alert("Error de conexión.");
                            },
                            dataType: "json"
                        });
                    } else {
                        $("#vr"+tid).focus();
                    }
                });
            };
            abrirmodal = function(action1,action2,id ) {
                bloqueointerface();
                $.ajax({
                    type: "POST",
                    url: "/adm_criteriosactividades",
                    data: {'action': action1, id: id},
                    success: function (data) {
                        $.unblockUI();
                        if (data.result == 'ok') {
                            $("#paneltitle").html("Asignar Articulo");
                            $("#panel_articulo").html(data.html);
                            $("#itemspanel").modal({"backdrop": "static", "width": "900px"}).modal("show");
                            $(".filterable tr:has(td)").each(function () {
                                var t = $(this).text().toLowerCase();
                                $("<td class='indexColumn'></td>").hide().text(t).appendTo(this);
                            });
                            $("#FilterTextBox").unbind().val('');
                            $("#FilterTextBox").keyup(function () {
                                var s = $(this).val().toLowerCase().split(" ");
                                $(".filterable tr:hidden").show();
                                $(".filterable tr:visible .indexColumn:not(:contains('" + s + "'))").parent().hide();
                                $(".filterable3 tr:hidden").show();
                            });
                            addarticulo(action2);
                        } else {
                            smoke.alert(data.mensaje);
                        }
                    },
                    error: function () {
                        $.unblockUI();
                        smoke.alert("Error de conexión.");
                    },
                    dataType: "json"
                });
            };
            addarticulo = function(action) {
                $(".btn-articulo").unbind();

                $(".btn-articulo").click(function () {
                    var aproeli = $(this).attr("aproeli");
                    var cid = $(this).attr("cid");
                    var aid = $(this).attr("aid");
                    if (cid > 0){
                        bloqueointerface();
                        $("#itemspanel").modal("hide");
                        showWaiting("Registrando Articulo", "Espere unos segundos por favor...");
                        $.ajax({
                            type: "POST",
                            url: "/adm_criteriosactividades",
                            data: {'action': action, 'cid': cid, 'aid': aid,'aproeli':aproeli},
                            success: function(data) {
                                if (data.result=='ok'){
                                    location.reload();
                                } else {
                                    hideWaiting();
                                    smoke.alert(data.mensaje);
                                }
                            },
                            error: function() {
                                hideWaiting();
                                smoke.alert("Error de conexión.");
                            },
                            dataType: "json"
                        });
                    } else {
                        $("#vr"+tid).focus();
                    }
                });
            };

            abrirmodalperiodos = function(action1,id ) {
                bloqueointerface();
                $.ajax({
                    type: "GET",
                    url: "/adm_criteriosactividades",
                    data: {'action': action1, id: id},
                    success: function (data) {
                        $.unblockUI();
                        if (data.result === 'ok') {
                            $("#modal_body_periodos").html(data.html);
                            $("#modalperiodosrelacionados").modal({"backdrop": "static", "width": "900px"}).modal("show");
                        } else {
                            smoke.alert(data.mensaje);

                        }
                    },
                    error: function () {
                        $.unblockUI();
                        smoke.alert("Error de conexión.");
                    },
                    dataType: "json"
                });
            };
            $("#itemspanel .btn-cerrar").click(function() {
                $("#itemspanel").modal("hide");
                return false;
            });
            $("#itemspanellink .btn-cerrar").click(function() {
                $("#itemspanellink").modal("hide");
                return false;
            });
            $("#boton_notoficacionimportar").click(function () {
                var lista = "";
                $(".recorreparticipantes").each(function (index) {
                    if ($(this).is(":checked")) {
                        var seleccion = $(this).attr('idpar');
                        lista += seleccion + ",";
                    }
                });
                if (lista.length == 0) {
                    smoke.alert('Favor seleccione periodo');
                    return false;
                }
                lista = lista.substring(0, lista.length - 1);
                bloqueointerface();
                var codigocriterio = $('#codigocriterio').val();
                $.ajax({
                    type: "POST",
                    url: "/adm_criteriosactividades",
                    data: {'action': 'guardarperiodotitulacion', 'codigocriterio': codigocriterio, 'lista': lista},
                    success: function (data) {
                        if (data.result == 'ok') {
                            $('#modalnotoficacionimportar').modal('hide');
                            location.reload();
                        } else {
                            $.unblockUI();
                            smoke.alert(data.mensaje);
                        }
                    },
                    error: function () {
                        $.unblockUI();
                        smoke.alert("Error al obtener los datos");
                    },
                    dataType: "json"
                });

            });
            $("#cancel_importarcioncancela").click(function () {
                $('#modalnotoficacionimportar').modal('hide');
            });
        });
        $(function() {
            $(".navegalink").click(function() {
                actualizartables();
                setTimeout(function(){
                    {#alert('ggg')#}
                    $($.fn.dataTable.tables(true)).DataTable().columns.adjust();
                },5)

            });
        });
        function actualizartables() {
            var languaje_datatable = {
                            "emptyTable": "No hay registros que mostrar",
                            "sZeroRecords": "No se encontraron registros",
                            "search": "Buscar:"
                        }
            {% if criterios_docencia %}
                $(document).ready(function() {
                    var table = $('#exampledoc').DataTable({
                        language: languaje_datatable,
                        "sPaginationType": "full_numbers",
                        "sDom": 'T<"clear">lfrtip',
                        "retrieve": true,
                        "ordering": false,
                        {#"searching": false,#}
                        "paging":   false,
                        "info":     false,
                        "order": [[ 2, 'asc' ]],
                        "columnDefs": [{ "visible": false,"targets": 1 }],
                        "drawCallback": function ( settings ) {
                            var api = this.api();
                            var rows = api.rows( {page:'current'} ).nodes();
                            var last=null;
                            api.column(1, {page:'current'} ).data().each( function ( group, i ) {
                                if ( last !== group ) {
                                    $(rows).eq( i ).before(
                                        '<tr class="group"><td colspan="9" height="30" bgcolor= "#f1f1f1" style="text-align: justify;"><strong><i class="fa fa-asterisk"><div></div></i> '+group+'</strong></td></tr>'
                                    );
                                    last = group
                                }
                            });
                            $('[data-bs-toggle="tooltip"]').tooltip();
                        }

                    });
                } );
            {% endif %}
            {% if criterios_investigacion %}
                $(document).ready(function() {
                    var table = $('#exampleinv').DataTable({
                        language: languaje_datatable,
                        "sPaginationType": "full_numbers",
                        "sDom": 'T<"clear">lfrtip',
                        "retrieve": true,
                        "ordering": false,
                        {#"searching": false,#}
                        "paging":   false,
                        "info":     false,
                        "order": [[ 2, 'asc' ]],
                        "columnDefs": [{ "visible": false,"targets": 1 }],
                        "drawCallback": function ( settings ) {
                            var api = this.api();
                            var rows = api.rows( {page:'current'} ).nodes();
                            var last=null;
                            api.column(1, {page:'current'} ).data().each( function ( group, i ) {
                                if ( last !== group ) {
                                    $(rows).eq( i ).before(
                                        '<tr class="group"><td colspan="8" height="30" bgcolor= "#f1f1f1" style="text-align: justify;"><strong><i class="fa fa-asterisk"><div></div></i> '+group+'</strong></td></tr>'
                                    );
                                    last = group
                                }
                            });
                            $('[data-toggle="tooltip"]').tooltip();
                        }

                    });
                } );
            {% endif %}
            {% if criterios_vinculacion %}
                $(document).ready(function() {
                    var table = $('#examplevinc').DataTable({
                        language: languaje_datatable,
                        "sPaginationType": "full_numbers",
                        "sDom": 'T<"clear">lfrtip',
                        "retrieve": true,
                        "ordering": false,
                        {#"searching": false,#}
                        "paging":   false,
                        "info":     false,
                        "order": [[ 2, 'asc' ]],
                        "columnDefs": [{ "visible": false,"targets": 1 }],
                        "drawCallback": function ( settings ) {
                            var api = this.api();
                            var rows = api.rows( {page:'current'} ).nodes();
                            var last=null;
                            api.column(1, {page:'current'} ).data().each( function ( group, i ) {
                                if ( last !== group ) {
                                    $(rows).eq( i ).before(
                                        '<tr class="group"><td colspan="8" height="30" bgcolor= "#f1f1f1" style="text-align: justify;"><strong><i class="fa fa-asterisk"><div></div></i> '+group+'</strong></td></tr>'
                                    );
                                    last = group
                                }
                            });
                            $('[data-toggle="tooltip"]').tooltip();
                        }

                    });
                } );
            {% endif %}
            {% if criterios_gestion %}
                $(document).ready(function() {
                    var table = $('#exampleges').DataTable({
                        language: languaje_datatable,
                        "sPaginationType": "full_numbers",
                        "sDom": 'T<"clear">lfrtip',
                        "retrieve": true,
                        "ordering": false,
                        {#"searching": false,#}
                        "paging":   false,
                        "info":     false,
                        "order": [[ 2, 'asc' ]],
                        "columnDefs": [{ "visible": false,"targets": 1 }],
                        "drawCallback": function ( settings ) {
                            var api = this.api();
                            var rows = api.rows( {page:'current'} ).nodes();
                            var last=null;
                            api.column(1, {page:'current'} ).data().each( function ( group, i ) {
                                if ( last !== group ) {
                                    $(rows).eq( i ).before(
                                        '<tr class="group"><td colspan="8" height="30" bgcolor= "#f1f1f1" style="text-align: justify;"><strong><i class="fa fa-asterisk"><div></div></i> '+group+'</strong></td></tr>'
                                    );
                                    last = group
                                }
                            });
                            $('[data-toggle="tooltip"]').tooltip();
                        }

                    });
                } );
            {% endif %}
        }
        actualizartables();
        function importarperiodoeval(idcriterio) {
            $('#codigocriterio').val(idcriterio);
            bloqueointerface();
            $.get("/adm_criteriosactividades", {
                'action': 'listadoperiodoseval',
                'idcriterio': idcriterio
            }, function (data) {
                if (data.results) {

                    $("#modalnotoficacionimportar").modal({backdrop: 'static', width: '600px'}).modal('show');
                    $(".elementosubtema").remove();
                    $('#contenidoparticipantes').empty();
                    for (elemento in data.listadoperiodoseval) {
                        $("#contenidoparticipantes").append('<tr>' +
                            '<td style="text-align: center;" class="idtema" width="5%"><input  type="checkbox" class="recorreparticipantes" ' + data.listadoperiodoseval[elemento][2] + ' idpar="' + data.listadoperiodoseval[elemento][0] + '"> </td>' +
                            '<td style="text-align:left;" width="95%">' + data.listadoperiodoseval[elemento][1] + '</td></tr>');
                    }
                    $.unblockUI();

                    {#$("#example").dataTable().fnDestroy();#}
                    {#$(document).ready(function () {#}
                    {#    var h = $(window).height() - 332;#}
                    {#    var table = $('#example').DataTable({#}
                    {#        "sPaginationType": "full_numbers",#}
                    {#        "sDom": 'T<"clear">lfrtip',#}
                    {#        "paging": false,#}
                    {#        "ordering": false,#}
                    {#        "info": false,#}
                    {#        "scrollY": h,#}
                    {#        "order": [[1, 'asc']],#}
                    {#        //"columnDefs": [{ "visible": false,"targets": 2 }],#}
                    {#        "drawCallback": function (settings) {#}
                    {#            var api = this.api();#}
                    {#            var rows = api.rows({page: 'current'}).nodes();#}
                    {#            var last = null;#}
                    {##}
                    {#        }#}
                    {#    });#}
                    {# });#}
                }
            }, 'json');

        }
    </script>
{% endblock %}
{% block atras %}/{% endblock %}
{% block canvas %}
    <div class='row'>
        <div class='col-lg-12'>
            <div class="headtitle">
                <h3>{{ title }}</h3>
                <h6>Gestión de criterios</h6>
            </div>
        </div>
    </div>
    <div class="container-fluid">
        <div class='row'>
            <div class="col-sm-12">
                {% if puede_agregar_criterio %}
                <a class="btn  btn-default" href="/adm_criteriosactividades?action=actividadprincipal"><i class="fa fa-list"></i> Actividad Principal</a>
                {% endif %}
                <a class="btn  btn-default" href="/adm_criteriosactividades?action=criteriosarticulo"><i class="fa fa-list"></i> Artículo</a>
                {#            <a class="btn  btn-default" href="/adm_criteriosactividades?action=recurso"><i class="fa fa-list"></i> Recurso</a>#}
                <div class="btn-group">
                    <a class="btn btn-default dropdown-toggle" data-bs-toggle="dropdown" href="javascript:;"> Reportes <i class="fa fa-caret-down"></i></a>
                    <ul class="dropdown-menu pull-left">
                        <li class="dropdown-item"><a href="javascript:;" tipos="{{ reporte_0.tiporeporte }}" nhref="/reportes?action=run&n={{ reporte_0.nombre }}&periodo={{ periodo.id }}" class='reportedirecto'><span class="fa fa-print" ></span> Imprimir</a></li>
                    </ul>
                </div>
            </div>
        </div>
        <div id="no-more-tables"><!-- inicio no more tables#-->
            <div class='row'>
                <div class='col-sm-12'>
                    <div class="card mb-4">
                        <div class="card-body border-6 rounded-3 table-responsive">
                            <ul class="nav nav-pills mb-3">
                                <li class="nav-item">
                                    <a class="nav-link navegalink {% if t == 1 or not t %}active{% endif %}" data-bs-toggle="tab" href="#doc">Docencia</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link navegalink {% if t == 2 %}active{% endif %}" data-bs-toggle="tab" href="#inv">Investigación</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link navegalink {% if t == 3 %}active{% endif %}" data-bs-toggle="tab" href="#ges">Gestión</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link navegalink {% if t == 4 %}active{% endif %}" data-bs-toggle="tab" href="#vin">Vinculación</a>
                                </li>
                            </ul>
                            <div class="tab-content">
                                <div class="tab-pane container {% if t == 1 or not t %}active{% else %}fade{% endif %}" id="doc">
                                    <table class='table table_primary' id="exampledoc">
                                        <thead class="table-light">
                                        <tr>
                                            <th>Criterio</th>
                                            <th>Actividad</th>
                                            <th style="width: 150px">Tipo</th>
                                            <th style="text-align: center; width: 60px">M&iacute;nimo</th>
                                            <th style="text-align: center; width: 60px">M&aacute;ximo</th>
                                            <th style="text-align: center; width: 60px">Porcentaje</th>
                                            <th style="text-align: center; width: 20px">Ver evidencia</th>
                                            <th style="text-align: center; width: 20px">Subir evidencia</th>
                                            <th style="text-align: center; width: 60px">Llenar bitácora</th>
                                            <th style="width: 10px"><i class="fa fa-cogs"></i></th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        {% for cd in criterios_docencia %}
                                            <tr>
                                                <td style="text-align: justify;">
                                                    <a class="fa fa-angle-double-right"></a>
                                                    {{ cd.criterio }}({{ cd.id }})
                                                    {% if cd.articulo %}<br/>
                                                        <i style="font-size: 9px; text-align: justify;">{{ cd.articulo|default_if_none:'' }}</i>
                                                    {% endif %}
                                                    {% if cd.nombrehtml %}<br>
                                                        <b style="color: #006400;"><b>({{ cd.nombrehtml|upper }})</b></b>
                                                    {% else %}<br>
                                                        <b class="text-danger"><b>(Sin evidencia)</b></b>
                                                    {% endif %}
                                                    <a class="fa fa-angle-double-right"></a>
                                                    <a href="javascript:;" class="btn btn-cian-secondary tu verdetalle" opc="1" idcriterio="{{ cd.id }}" title="Docentes relacionados"><i class="fa fa-users"></i> Asignados: {{cd.total_docentes_relacionados}}</a>
                                                </td>
                                                <td >{{ cd.actividad.nombre|default:'---' }}</td>
                                                <td >{{ cd.criterio.get_tipocriterioactividad_display|lower|capfirst }}</td>
                                                <td style="text-align: center">{{ cd.minimo|floatformat:0 }}</td>
                                                <td style="text-align: center">{{ cd.maximo|floatformat:0 }}</td>
                                                <td style="text-align: center">{{ cd.porcentaje|floatformat:0 }}</td>
                                                <td style="text-align: center">
                                                    {% if cd.criteriolink %}
                                                        {% if cd.criteriolink.id == 1 %}
                                                            <a class="btn btn-success btn-mini " onclick="importarperiodoeval({{ cd.id }})" href="javascript:;" id="{{ cd.id }}"><i class="fa fa-list"></i> T</a>
                                                        {% endif %}
                                                        <a class="btn btn-success btn-mini criteriolink_view"href="javascript:;" id="{{ cd.id }}"><i class="fa fa-list"></i></a>
                                                    {% else %}
                                                        <a class="btn btn-warning btn-mini criteriolink_view"href="javascript:;" id="{{ cd.id }}"><i class="fa fa-list"></i></a>
                                                    {% endif %}
                                                </td>
                                                <td style="text-align: center">
                                                    {% if cd.subirevidencia %}
                                                        <a href="javascript:;" id='activado_{{ cd.id }}' class="activasubirdoc" indice="{{ cd.id }}" opc="activarsubirevidenciadoc" idnombre="{{ cd.criterio }}"><i class="fa fa-check" style="color: green"></i></a>
                                                    {% else %}
                                                        <a href="javascript:;" id='activado_{{ cd.id }}' class="activasubirdoc" indice="{{ cd.id }}" opc="activarsubirevidenciadoc" idnombre="{{ cd.criterio }}"><i class="fa fa-close" style="color: red"></i></a>
                                                    {% endif %}
                                                </td>
                                                <td style="text-align: center">
                                                    {% if cd.llenarbitacora %}
                                                        <a href="javascript:;" id='activado_{{ cd.id }}' class="activabitacoradoc" indice="{{ cd.id }}" opc="activarllenarbitacoradoc" idnombre="{{ cd.criterio }}"><i class="fa fa-check" style="color: green"></i></a>
                                                    {% else %}
                                                        <a href="javascript:;" id='activado_{{ cd.id }}' class="activabitacoradoc" indice="{{ cd.id }}" opc="activarllenarbitacoradoc" idnombre="{{ cd.criterio }}"><i class="fa fa-close" style="color: red"></i></a>
                                                    {% endif %}
                                                </td>
                                                {#                                        <td style="text-align: center">{{ cd.actividades_docenciaperiodo }}</td>#}
                                                <td style="text-align: center">
                                                    {% if not periodo.finalizo %}
                                                        <div class="dropdown dropstart">
                                                            <a href="javascript:void(0);" class="btn-icon btn btn-ghost btn-sm rounded-circle" data-bs-toggle="dropdown" data-offset="-140" aria-haspopup="true" aria-expanded="false">
                                                                <i class="fa fa-ellipsis-v"></i>
                                                            </a>
                                                            <div class="dropdown-menu">
                                                                <a class="dropdown-item bloqueo_pantalla" href="/adm_criteriosactividades?action=editcriteriodocenciaperiodo&id={{ cd.id }}"><i class="fa fa-edit"></i>&nbsp;Editar</a>
                                                                {% if cd.id not in cadenadoc or periodo.clasificacion == 2 %}
                                                                    <a class="dropdown-item bloqueo_pantalla eliminacionmodal" href="javascript:;" nhref="/adm_criteriosactividades?action=delcriteriodocenciaperiodo&id={{ cd.id }}" ><i class="fa fa-remove"></i>&nbsp;Eliminar</a>
                                                                {% endif %}
                                                                <a class="dropdown-item bloqueo_pantalla articulodocencia_view " href="javascript:;" id="{{ cd.id }}"><i class="fa fa-check"></i>&nbsp;Artículo</a>
                                                                <a class="dropdown-item bloqueo_pantalla periodosrelacionados" href="javascript:;" id="{{ cd.id }}"><i class="fa fa-calendar"></i>&nbsp;Periodos relacionados</a>
                                                            </div>
                                                        </div>
                                                    {% endif %}
                                                </td>
                                            </tr>
                                        {% empty %}
                                            <tr>
                                                <td colspan="6">NO EXISTEN CRITERIOS DE DOCENCIA</td>
                                            </tr>
                                        {% endfor %}
                                        </tbody>
                                        {% if not periodo.finalizo and puede_agregar_criterio %}
                                            <tfoot>
                                            <tr>
                                                <td colspan="10">
                                                    <a href="/adm_criteriosactividades?action=criteriosdocencia" class="btn btn-success"><i class="fa fa-plus"></i> Adicionar</a>
                                                </td>
                                            </tr>
                                            </tfoot>
                                        {% endif %}
                                    </table>
                                </div>
                                <div class="tab-pane container {% if t == 2 %}active{% else %}fade{% endif %}" id="inv">
                                    <table class='table table_primary' id="exampleinv">
                                        <thead class="table-light">
                                        <tr>
                                            <th>Criterio</th>
                                            <th>Actividad</th>
                                            <th style="width: 150px">Tipo</th>
                                            <th style="text-align: center; width: 60px">M&iacute;nimo</th>
                                            <th style="text-align: center; width: 60px">M&aacute;ximo</th>
                                            <th style="text-align: center; width: 60px">Tiene producto investigación</th>
                                            <th style="text-align: center; width: 60px">Subir evidencia</th>
                                            <th style="text-align: center; width: 60px">Llenar bitácora</th>
                                            <th style="width: 10px"></th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        {% for ci in criterios_investigacion %}
                                            <tr>
                                                <td style="text-align: justify;">
                                                    {{ ci.criterio }}({{ ci.id }})<br/>
                                                    <i style="font-size: 9px; text-align: justify;">{{ ci.articulo|default_if_none:'' }}</i>
                                                    {% if ci.nombrehtml %}<br>
                                                        <b style="color: #006400;"><b>({{ ci.nombrehtml|upper }})</b></b>
                                                    {% else %}<br>
                                                        <b class="text-danger"><b>(Sin evidencia)</b></b>
                                                    {% endif %}
                                                    <a class="fa fa-angle-double-right"></a>
                                                    <a href="javascript:;" class="btn btn-cian-secondary tu verdetalle" opc="2" idcriterio="{{ ci.id }}" title="Docentes relacionados"><i class="fa fa-users"></i> Asignados: {{ci.total_docentes_relacionados}}</a>
                                                </td>
                                                <td >{{ ci.actividad.nombre|default:'---' }}</td>
                                                <td >{{ ci.criterio.get_tipocriterioactividad_display|lower|capfirst }}</td>
                                                <td style="text-align: center" id="ci_{{ ci.id }}_min">{{ ci.minimo|floatformat:0 }}</td>
                                                <td style="text-align: center" id="ci_{{ ci.id }}_max">{{ ci.maximo|floatformat:0 }}</td>
                                                <td style="text-align: center">
                                                    {% if ci.productoinvestigacion %}
                                                        <a href="javascript:;" id='activado_{{ ci.id }}' class="deleteajax" indice="{{ ci.id }}" opc="activarproducto" idnombre="{{ ci.criterio }}"><i class="fa fa-check" style="color: green"></i></a>
                                                    {% else %}
                                                        <a href="javascript:;" id='activado_{{ ci.id }}' class="deleteajax" indice="{{ ci.id }}" opc="activarproducto" idnombre="{{ ci.criterio }}"><i class="fa fa-close" style="color: red"></i></a>
                                                    {% endif %}
                                                </td>
                                                <td style="text-align: center">
                                                    {% if ci.subirevidencia %}
                                                        <a href="javascript:;" id='activado_{{ ci.id }}' class="activasubir" indice="{{ ci.id }}" opc="activarsubirevidencia" idnombre="{{ ci.criterio }}"><i class="fa fa-check" style="color: green"></i></a>
                                                    {% else %}
                                                        <a href="javascript:;" id='activado_{{ ci.id }}' class="activasubir" indice="{{ ci.id }}" opc="activarsubirevidencia" idnombre="{{ ci.criterio }}"><i class="fa fa-close" style="color: red"></i></a>
                                                    {% endif %}
                                                </td>
                                                <td style="text-align: center">
                                                    {% if ci.llenarbitacora %}
                                                        <a href="javascript:;" id='activado_{{ ci.id }}' class="activabitacora" indice="{{ ci.id }}" opc="activarllenarbitacora" idnombre="{{ ci.criterio }}"><i class="fa fa-check" style="color: green"></i></a>
                                                    {% else %}
                                                        <a href="javascript:;" id='activado_{{ ci.id }}' class="activabitacora" indice="{{ ci.id }}" opc="activarllenarbitacora" idnombre="{{ ci.criterio }}"><i class="fa fa-close" style="color: red"></i></a>
                                                    {% endif %}
                                                </td>
                                                <td style="text-align: center">
                                                    {% if not periodo.finalizo %}
                                                        <div class="dropdown dropstart">
                                                            <a href="javascript:void(0);" class="btn-icon btn btn-ghost btn-sm rounded-circle"
                                                               data-bs-toggle="dropdown" data-offset="-140"
                                                               aria-haspopup="true" aria-expanded="false">
                                                                <i class="fa fa-ellipsis-v"></i>
                                                            </a>
                                                            <div class="dropdown-menu">
                                                                <a class="dropdown-item bloqueo_pantalla" href="/adm_criteriosactividades?action=editcriterioinvestigacionperiodo&id={{ ci.id }}"><i class="fa fa-edit"></i>&nbsp;Editar</a>
                                                                {% if ci.id not in cadenainv %}
                                                                    <a class="dropdown-item eliminacionmodal" href="javascript:;" nhref="/adm_criteriosactividades?action=delcriterioinvestigacionperiodo&id={{ ci.id }}"><i class="fa fa-remove"></i>&nbsp;Eliminar</a>
                                                                {% endif %}
                                                                <a class="dropdown-item articuloinvestigacion_view" href="javascript:;" id="{{ ci.id }}"><i class="fa fa-check"></i>&nbsp;Artículos</a>
                                                                {% if ci.es_actividadmacro %}
                                                                    <div class="dropdown-divider"></div>
                                                                    <a class="dropdown-item" href="?action=actividades&t=2&id={{ ci.pk }}"><i class="fa fa-list"></i>&nbsp;Gestión de actividades y subactividades</a>
                                                                {% endif %}
                                                            </div>
                                                        </div>
                                                    {% endif %}
                                                </td>
                                            </tr>
                                        {% empty %}
                                            <tr>
                                                <td colspan="7">NO EXISTEN CRITERIOS DE INVESTIGACION</td>
                                            </tr>
                                        {% endfor %}
                                        </tbody>
                                        {% if not periodo.finalizo and puede_agregar_criterio %}
                                            <tfoot>
                                            <tr>
                                                <td colspan="9">
                                                    <a href="/adm_criteriosactividades?action=criteriosinvestigacion" class="btn btn-success"><i class="fa fa-plus"></i> Adicionar</a>
                                                </td>
                                            </tr>
                                            </tfoot>
                                        {% endif %}
                                    </table>
                                </div>
                                <div class="tab-pane container {% if t == 3 %}active{% else %}fade{% endif %}" id="ges">
                                    <table class='table table_primary' id="exampleges">
                                        <thead class="table-light">
                                        <tr>
                                            <th>Criterio</th>
                                            <th>Actividad</th>
                                            <th style="width: 150px">Tipo</th>
                                            <th style="text-align: center; width: 60px">M&iacute;nimo</th>
                                            <th style="text-align: center; width: 60px">M&aacute;ximo</th>
                                            <th style="text-align: center; width: 60px">Act.</th>
                                            <th style="text-align: center; width: 60px">Subir evidencia</th>
                                            <th style="text-align: center; width: 60px">Llenar bitácora</th>
                                            <th style="width: 10px"><i class="fa fa-cogs"></i></th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        {% for cg in criterios_gestion %}
                                            <tr>
                                                <td style="text-align: justify;">
                                                    {{ cg.criterio }}({{ cg.id }})<br/>
                                                    <i style="text-align: justify;">{{ cg.articulo|default_if_none:'' }}</i>
                                                    {% if cg.nombrehtml %}<br>
                                                        <span style="color: #006400;"><b>({{ cg.nombrehtml|upper }})</b></span>
                                                    {% else %}<br>
                                                        <span class="text-danger"><b>(Sin evidencia)</b></span>
                                                    {% endif %}
                                                    <a class="fa fa-angle-double-right"></a>
                                                    <a href="javascript:;" class="btn btn-cian-secondary tu verdetalle" opc="3" idcriterio="{{ cg.id }}" title="Docentes relacionados"><i class="fa fa-users"></i> Asignados: {{cg.total_docentes_relacionados}} </a>
                                                </td>
                                                <td >{{ cg.actividad.nombre|default:'---' }}</td>
                                                <td >{{ cg.criterio.get_tipocriterioactividad_display|lower|capfirst }}</td>
                                                <td style="text-align: center" id="cg_{{ cg.id }}_min">{{ cg.minimo|floatformat:0 }}</td>
                                                <td style="text-align: center" id="cg_{{ cg.id }}_max">{{ cg.maximo|floatformat:0 }}</td>
                                                <td style="text-align: center">{{ cg.actividades_gestionperiodo }}</td>
                                                <td style="text-align: center">
                                                    {% if cg.subirevidencia %}
                                                        <a href="javascript:;" id='activado_{{ cg.id }}' class="activasubirges" indice="{{ cg.id }}" opc="activarsubirevidenciages" idnombre="{{ cg.criterio }}"><i class="fa fa-check" style="color: green"></i></a>
                                                    {% else %}
                                                        <a href="javascript:;" id='activado_{{ cg.id }}' class="activasubirges" indice="{{ cg.id }}" opc="activarsubirevidenciages" idnombre="{{ cg.criterio }}"><i class="fa fa-close" style="color: red"></i></a>
                                                    {% endif %}
                                                </td>
                                                <td style="text-align: center">
                                                    {% if cg.llenarbitacora %}
                                                        <a href="javascript:;" id='activado_{{ cg.id }}' class="activabitacorages" indice="{{ cg.id }}" opc="activarllenarbitacorages" idnombre="{{ cg.criterio }}"><i class="fa fa-check" style="color: green"></i></a>
                                                    {% else %}
                                                        <a href="javascript:;" id='activado_{{ cg.id }}' class="activabitacorages" indice="{{ cg.id }}" opc="activarllenarbitacorages" idnombre="{{ cg.criterio }}"><i class="fa fa-close" style="color: red"></i></a>
                                                    {% endif %}
                                                </td>
                                                <td style="text-align: center">
                                                    {% if not periodo.finalizo %}
                                                        <div class="dropdown dropstart">
                                                            <a href="javascript:void(0);" class="btn-icon btn btn-ghost btn-sm rounded-circle"
                                                               data-bs-toggle="dropdown" data-offset="-140"
                                                               aria-haspopup="true" aria-expanded="false">
                                                                <i class="fa fa-ellipsis-v"></i>
                                                            </a>
                                                            <div class="dropdown-menu">
                                                                <a class="dropdown-item bloqueo_pantalla" href="/adm_criteriosactividades?action=actividadescriterio&id={{ cg.id }}&tip=3"><i class="fa fa-list"></i>&nbsp;Actividades</a>
                                                                <a class="dropdown-item bloqueo_pantalla" href="/adm_criteriosactividades?action=editcriteriogestionperiodo&id={{ cg.id }}"><i class="fa fa-edit"></i>&nbsp;Edit</a>
                                                                {% if cg.id not in cadenagest %}
                                                                    <a class="dropdown-item eliminacionmodal" href="javascript:;" nhref="/adm_criteriosactividades?action=delcriteriogestionperiodo&id={{ cg.id }}"><i class="fa fa-remove"></i>&nbsp;Eliminar</a>
                                                                {% endif %}
                                                                <a class="dropdown-item bloqueo_pantalla articulogestion_view" title="Artículos" href="javascript:;" id="{{ cg.id }}"><i class="fa fa-check"></i>&nbsp;Artículos</a>
                                                                <a class="dropdown-item bloqueo_pantalla" href="/adm_criteriosactividades?action=actividadrecurso&id={{ cg.id }}&tipo=3" ><i class="fa fa-cart-plus"></i>&nbsp;Recurso Aprendizaje</a>
                                                            </div>
                                                        </div>
                                                    {% endif %}
                                                </td>
                                            </tr>
                                        {% empty %}
                                            <tr>
                                                <td colspan="6">NO EXISTEN CRITERIOS DE GESTION</td>
                                            </tr>
                                        {% endfor %}
                                        </tbody>
                                        {% if not periodo.finalizo and puede_agregar_criterio %}
                                            <tfoot>
                                            <tr>
                                                <td colspan="9">
                                                    <a href="/adm_criteriosactividades?action=criteriosgestion" class="btn btn-success"><i class="fa fa-plus"></i> Adicionar</a>
                                                </td>
                                            </tr>
                                            </tfoot>
                                        {% endif %}
                                    </table>
                                </div>
                                <div class="tab-pane container {% if t == 4 %}active{% else %}fade{% endif %}" id="vin">
                                    <table class='table table_primary' id="examplevinc">
                                        <thead class="table-light">
                                        <tr>
                                            <th>Criterio</th>
                                            <th>Actividad</th>
                                            <th style="width: 150px">Tipo</th>
                                            <th style="text-align: center; width: 60px">M&iacute;nimo</th>
                                            <th style="text-align: center; width: 60px">M&aacute;ximo</th>
                                            <th style="width: 20px">Vicerrectorado Vinculación</th>
                                            <th style="text-align: center; width: 60px">Subir evidencia</th>
                                            <th style="text-align: center; width: 60px">Llenar bitácora</th>
                                            <th style="width: 10px; text-align: center"><i class="fa fa-cogs"></i></th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        {% for cv in criterios_vinculacion %}
                                            <tr>
                                                <td style="text-align: justify;">
                                                    {{ cv.criterio }}({{ cv.id }})<br/>
                                                    <i style="text-align: justify;">{{ cv.articulo|default_if_none:'' }}</i>
                                                    {% if cv.nombrehtml %}<br>
                                                        <span style="color: #006400;"><b>({{ cv.nombrehtml|upper }})</b></span>
                                                    {% else %}<br>
                                                        <span class="text-danger"><b>(Sin evidencia)</b></span>
                                                    {% endif %}
                                                    <a class="fa fa-angle-double-right"></a>
                                                    <a href="javascript:;" class="btn btn-cian-secondary tu verdetalle" opc="4" idcriterio="{{ cv.id }}" title="Docentes relacionados"><i class="fa fa-users"></i> Asignados: {{cv.total_docentes_relacionados}}</a>
                                                </td>
                                                <td >{{ cv.actividad.nombre|default:'---' }}</td>
                                                <td >{{ cv.criterio.get_tipocriterioactividad_display|lower|capfirst }}</td>
                                                <td style="text-align: center" id="cv_{{ cv.id }}_min">{{ cv.minimo|floatformat:0 }}</td>
                                                <td style="text-align: center" id="cv_{{ cv.id }}_max">{{ cv.maximo|floatformat:0 }}</td>
                                                <td style="text-align: center">
                                                    {% if cv.criterio.vicevinculacion %}
                                                        <a style="color: green" href="javascript:;"><i class="fa fa-check"></i></a>
                                                    {% else %}
                                                        <a style="color: red" href="javascript:;"><i class="fa fa-remove"></i></a>
                                                    {% endif %}
                                                </td>
                                                <td style="text-align: center">
                                                    {% if cv.subirevidencia %}
                                                        <a href="javascript:;" id='activado_{{ cv.id }}' class="activasubirvin" indice="{{ cv.id }}" opc="activarsubirevidenciadoc" idnombre="{{ cv.criterio }}"><i class="fa fa-check" style="color: green"></i></a>
                                                    {% else %}
                                                        <a href="javascript:;" id='activado_{{ cv.id }}' class="activasubirvin" indice="{{ cv.id }}" opc="activarsubirevidenciadoc" idnombre="{{ cv.criterio }}"><i class="fa fa-close" style="color: red"></i></a>
                                                    {% endif %}
                                                </td>
                                                <td style="text-align: center">
                                                    {% if cv.llenarbitacora %}
                                                        <a href="javascript:;" id='activado_{{ cv.id }}' class="activabitacoravin" indice="{{ cv.id }}" opc="activarllenarbitacoradoc" idnombre="{{ cv.criterio }}"><i class="fa fa-check" style="color: green"></i></a>
                                                    {% else %}
                                                        <a href="javascript:;" id='activado_{{ cv.id }}' class="activabitacoravin" indice="{{ cv.id }}" opc="activarllenarbitacoradoc" idnombre="{{ cv.criterio }}"><i class="fa fa-close" style="color: red"></i></a>
                                                    {% endif %}
                                                </td>
                                                <td style="text-align: center">
                                                    {% if not periodo.finalizo %}
                                                        <div class="dropdown dropstart">
                                                            <a href="javascript:void(0);" class="btn-icon btn btn-ghost btn-sm rounded-circle"
                                                               data-bs-toggle="dropdown" data-offset="-140"
                                                               aria-haspopup="true" aria-expanded="false">
                                                                <i class="fa fa-ellipsis-v"></i>
                                                            </a>
                                                            <div class="dropdown-menu">
                                                                {#                                                                <a class="dropdown-item bloqueo_pantalla" href="/adm_criteriosactividades?action=actividadescriterio&id={{ cv.id }}&tip=1"><i class="fa fa-list"></i> Actividades</a>#}
                                                                <a class="dropdown-item bloqueo_pantalla" href="/adm_criteriosactividades?action=editcriteriovinculacionperiodo&id={{ cv.id }}"><i class="fa fa-edit"></i>&nbsp;Editar</a>
                                                                {% if cv.id not in cadenavin %}
                                                                    <a class="dropdown-item eliminacionmodal" href="javascript:;" nhref="/adm_criteriosactividades?action=delcriteriovinculacionperiodo&id={{ cv.id }}"><i class="fa fa-remove"></i> Eliminar</a>
                                                                {% endif %}
                                                                <a class="dropdown-item articulovinculacion_view" title="Artículos" href="javascript:;" id="{{ cv.id }}"><i class="fa fa-check"></i> Artículos</a>
                                                                {#                                                                <a class="dropdown-item" href="/adm_criteriosactividades?action=actividadrecurso&id={{ cv.id }}&tipo=3"><i class="fa fa-cart-plus"></i> Recurso Aprendizaje</a>#}
                                                                {% if cv.es_actividadmacro %}
                                                                    <div class="dropdown-divider"></div>
                                                                    <a class="dropdown-item" href="?action=actividades&t=4&id={{ cv.pk }}"><i class="fa fa-list"></i>&nbsp;Gestión de actividades y subactividades</a>
                                                                {% endif %}
                                                            </div>
                                                        </div>
                                                    {% endif %}
                                                </td>
                                            </tr>
                                        {% empty %}
                                            <tr>
                                                <td colspan="6">NO EXISTEN CRITERIOS DE VINCULACIÓN</td>
                                            </tr>
                                        {% endfor %}
                                        </tbody>
                                        {% if not periodo.finalizo and puede_agregar_criterio %}
                                            <tfoot>
                                            <tr>
                                                <td colspan="9">
                                                    <a href="/adm_criteriosactividades?action=criteriosvinculacion" class="btn btn-success"><i class="fa fa-plus"></i> Adicionar</a>
                                                </td>
                                            </tr>
                                            </tfoot>
                                        {% endif %}
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="itemspanel" style="display: none;">
        <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 id="paneltitle"></h3>
                </div>
                <div class="modal-body">
                    <input type="text" id="FilterTextBox" class="input-block-level">
                    <div style="max-height: 400px; overflow: auto">
                        <table id="panel_articulo" class="table table-bordered table-striped table-condensed filterable">
                        </table>
                    </div>
                </div>
                <div class="modal-footer">
                    <table class="pull-right">
                        <tr>
                            <td><a href="javascript:;" class="btn btn-cerrar btn-info">Cerrar</a></td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="itemspanellink" style="display: none;">
        <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 id="paneltitlelink"></h3>
                </div>
                <div class="modal-body">
                    {#            <input type="text" id="FilterTextBox" class="input-block-level">#}
                    <div style="max-height: 400px; overflow: auto">
                        <table id="panel_link" class="table table-bordered table-striped table-condensed filterable">
                        </table>
                    </div>
                </div>
                <div class="modal-footer">
                    <table class="pull-right">
                        <tr>
                            <td><a href="javascript:;" class="btn btn-default" data-bs-dismiss="modal"><i class="fa fa-times-circle"></i> Cerrar</a></td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="modalnotoficacionimportar" style="display: none;">
        <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 id="paneltitle">Listado de periodos titulación</h4>
                </div>
                <div class="modal-body" style="overflow: scroll;">
                    <table class='table table-bordered' cellpadding="0" cellspacing="0" id="tableperiodo">
                        <thead>
                        <tr>
                            <th style="text-align: left">
                                {#                        <input type="checkbox" class="seleccionartodoscheck">#}
                            </th>
                            <th style="text-align: left" width="70%">Periodos de titulación</th>
                        </tr>
                        </thead>
                        <tbody id="contenidoparticipantes">
                        </tbody>
                    </table>
                    <input type="hidden" id="codigocriterio" name="codigocriterio">
                </div>
                <div class="modal-footer">
                    <p style="text-align: right; margin-bottom: 0">
                        <a href="javascript:;" id="boton_notoficacionimportar" class='btn btn-success'> Importar</a>
                        <a href="javascript:;" id="cancel_importarcioncancela" class='btn btn-default'> Cancelar</a>
                    </p>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="modalperiodosrelacionados" style="display: none;">
        <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h4>Listado de periodos relacionados</h4>
                </div>
                <div class="modal-body container-fluid">
                    <div id="modal_body_periodos">

                    </div>
                </div>
                <div class="modal-footer">
                    <p style="text-align: right; margin-bottom: 0">
                        <a href="javascript:;" class="btn btn-default" data-bs-dismiss="modal"><i class="fa fa-times-circle"></i> Cerrar</a>
                    </p>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="modaldetallerequisitos" style="display: none;">
        <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="text-center">DOCENTES ASIGNADOS AL CRITERIO</h4>
                </div>
                <div class="modal-body container-fluid">
                    <div id="bodyrequisitos">

                    </div>
                </div>
                <div class="modal-footer">
                    <p style="text-align: right; margin-bottom: 0">
                        <a href="javascript:;" class="btn btn-default" data-bs-dismiss="modal"><i class="fa fa-times-circle"></i> Cerrar</a>
                    </p>
                </div>
            </div>
        </div>
    </div>
{% endblock %}
