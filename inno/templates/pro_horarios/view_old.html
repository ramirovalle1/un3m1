{% extends "basebs.html" %}
{% load sga_extras %}
{% block heading %}
    <script type="text/javascript">
        $(function() {
            $(".creavideo").click(function() {
                var codigoclase = $(this).attr('codigoclase');
                var codigodia = $(this).attr('codigodia');
                {#alert(codigoclase)#}
                $("#id_clasevideo").val(codigoclase);
                $("#id_diavideo").val(codigodia);
                $("#modalcreavideo").modal({backdrop:'static', width: '600px'}).modal('show');
            });
            $(".savevideo").click(function() {
                var codclase = $("#id_clasevideo").val();
                var coddia = $("#id_diavideo").val();
                var observacion = $("#id_observacionvideo").val();
                var enlace2 = $("#id_enlace2video").val();
                var enlace3 = $("#id_enlace3video").val();
                if(observacion == ''){
                    smoke.alert("Favor ingrese descripción.");
                    return false;
                }
                bloqueointerface();
                $.post("/pro_horarios/old", {'action':'addvideovirtual', 'codclase': codclase, 'coddia': coddia, 'observacion': observacion, 'enlace2': enlace2, 'enlace3': enlace3 }, function(data) {
                    if (data.result == 'ok') {
                        location.reload();
                    }
                }, 'json');
            });
            $(".cancelaforo").click(function() {
                $("#modalcreavideo").modal("hide");
            });
            $(".creaforo").click(function() {
                var codigoclase = $(this).attr('codigoclase');
                var codigodia = $(this).attr('codigodia');
                {#alert(codigoclase)#}
                $("#id_clase").val(codigoclase);
                $("#id_dia").val(codigodia);
                $("#modalcreaforo").modal({backdrop:'static', width: '600px'}).modal('show');
            });
            $(".saveforo").click(function() {
                var codclase = $("#id_clase").val();
                var coddia = $("#id_dia").val();
                var observacion = $("#id_observacion").val();
                var enlace2 = $("#id_enlace2").val();
                var enlace3 = $("#id_enlace3").val();
                if(observacion == ''){
                    smoke.alert("Favor ingrese descripción.");
                    return false;
                }
                bloqueointerface();
                $.post("/pro_horarios/old", {'action':'addclaseasincronica', 'codclase': codclase, 'coddia': coddia, 'observacion': observacion, 'enlace2': enlace2, 'enlace3': enlace3 }, function(data) {
                    if (data.result == 'ok') {
                        location.reload();
                    }
                }, 'json');
            });
            $(".addsincronica").click(function() {
                var clasesid = $(this).attr('codigoidclase');
                $.post("/pro_horarios/old", {'action':'addclasesincronica', 'codclase': clasesid }, function(data) {
                    if (data.result == 'ok') {
                        d=0
                    }
                }, 'json');
            });
            $(".cancelaforo").click(function() {
                $("#modalcreaforo").modal("hide");
            });
            $(".btn-abrir").click(function(){
                clearInterval(ocultar);
                clearInterval(chequeo);
                var don;
                var clases = $(this).attr('clases');
                bloqueointerface();
                $.ajax({
                    type:"POST",
                    url:"/pro_clases",
                    data:{'action': 'nuevaleccion', 'clases': clases{% if parametros %}, 'reemplazo': 'true', 'reemplazoid': {{ reemplazoid }}{% endif %}{% if not disponible %}, 'ida':$(this).attr('ida'){% endif %}},
                    error:function(){
                        $.unblockUI();
                        mostarbotones();
                        smoke.alert("Error al enviar los datos.");
                    },
                    success:function(data){
                        if (data.result=="ok"){
                            location.href = "/pro_clases?action=view&id="+data.lg;
                        } else {
                            $.unblockUI();
                            mostarbotones();
                            smoke.alert(data.mensaje);
                        }
                    }
                });
                return false;
            });

            verificarhorarios = function(){
                bloqueointerface();
                location.reload();
            };

            ocultarbotones = function(){
                {#                $('.btn-abrir').hide();#}
            };

            mostarbotones = function(){
                $('.btn-abrir').show();
            };

            $('#continuar').click(function(){
                clearInterval(chequeo);
            });

            var chequeo = setInterval(verificarhorarios, 200000);
            var ocultar = setInterval(ocultarbotones, 27000);

            $("#reemplazoid").change(function() {
                bloqueointerface();
                location.href = "/pro_horario_reemplazo?reemplazoid="+this.value;
            });
            $(".btn-abrir-complexivo").on('click', function () {
                clearInterval(ocultar);
                clearInterval(chequeo);

                var clases = $(this).attr('clases');
                $.ajax({
                    type:"POST",
                    url:"/pro_complexivoclase",
                    data:{'action':'nuevaleccion','clases': clases},
                    error:function(){
                        $.unblockUI();
                        mostarbotones();
                        smoke.alert("Error al enviar los datos.");
                    },
                    success:function(data){
                        if (data.result=="ok"){
                            bloqueointerface();
                            location.href = "/pro_complexivoclase?action=view&listaleccionid=" + data.lec;
                        } else {
                            $.unblockUI();
                            mostarbotones();
                            smoke.alert(data.mensaje);
                        }
                    }
                })
            })


            $(".addclasetutoria").click(function() {
                var codigoidclase=$(this).attr('codigoidclase');
                $.post("/pro_horarios/old", {'action':'addclasetutoria','id':codigoidclase}, function(data) {
                    if (data.result == 'ok') {
                        d=0
                    }
                }, 'json');
            });

        });
        function pdfhorarios(profesorid,periodoid){
            openwindow('POST' ,'/pro_horarios/old', {action:'pdf_horarios',profesor:profesorid,periodo:periodoid}, '_blank');
        }
    </script>
{% endblock %}
{% block atras %}/{% endblock %}
{% block canvas %}
    <div class='row-fluid'>
        <div class='span12'>
            <h4>{{ title }}</h4>
            {% if reemplazos %}
                <select id='reemplazoid' class="imp-50">
                    {% for r in reemplazos %}
                        <option value="{{ r.solicita.persona.id }}" {% if reemplazoid == r.solicita.persona.id %}selected="selected"{% endif %}>{{ r.solicita.persona }}</option>
                    {% endfor %}
                </select>
            {% endif %}
            <h5>Docente: {{ profesor }}</h5>
            <!-- <a class="btn btn-warning" href="http://goo.gl/forms/te2SLChsJp" target="_blank">Evaluación Docente</a>-->
        </div>
    </div>
    {#{{ fechainicio|date:"Y-m-d" }}#}
    {% if periodo.visiblehorario %}
        <div class="row-fluid">
            <div class='span6' style="padding:8px">
                <a href="javascript:;" onclick="pdfhorarios({{ profesor.id }},{{ periodo.id }})" class='btn btn-warning'><i class="fa fa-print"></i> Imprimir</a>
                <a href="/pro_horarios/old?action=asistencia" class='btn btn-info'><i class="fa fa-list"></i> Asistencia zoom</a>
                <br><label class="label label-info">Seleccionar el periodo lectivo para imprimir</label>
                {% if reemplazo %}<br><label class="label label-default">{{ reemplazo }}</label>{% endif %}
            </div>
        </div>
    {% endif %}
    {% if not disponible %}
        {% if leccionclases %}
            {% for leccion in leccionclases %}
                {% if leccion.abierta %}
                    <div class="alert alert-info">
                        <a  href="javascript:;" class="close" data-dismiss="alert">×</a>
                        <h4 class="alert-heading">Alerta Importante!</h4>
                        Ud. ya tiene una <b>CLASE ABIERTA</b>, en la materia <b>{{ leccion.clase.materia.nombre_mostrar_solo }}</b> para continuar la misma de click en: <a class="btn btn-warning btn-form" id="continuar" href="/pro_clases?action=view&id={{ claseabierta.id }}&idl={{ leccion.id|encrypt }}">Continuar</a>
                    </div>
                {% endif %}
            {% endfor %}
        {% else %}
            <div class="alert alert-info">
                <a  href="javascript:;" class="close" data-dismiss="alert">×</a>
                <h4 class="alert-heading">Alerta Importante!</h4>
                Ud. ya tiene una <b>CLASE ABIERTA</b>, para continuar la misma de click en: <a class="btn btn-warning btn-form" id="continuar" href="/pro_clases?action=view&id={{ claseabierta.id }}">Continuar</a>
            </div>
        {% endif %}
    {% endif %}
    {% if not disponiblecomplexivo %}
        <div class="alert alert-info">
            <a  href="javascript:;" class="close" data-dismiss="alert">×</a>
            <h4 class="alert-heading">Alerta Importante!</h4>
            Ud. ya tiene una <b>CLASE ABIERTA</b>, para continuar la misma de click en: <a class="btn btn-warning btn-form" id="continuar" href="/pro_complexivoclase?action=view&listaleccionid={% for lisleccion in claseabiertacomplexivo %}{{ lisleccion.id}}{% if not forloop.last %},{% endif %}{% endfor %}">Continuar</a>
        </div>
    {% endif %}
    {% comment %}{% if materiasnoprogramadas %}
        <div class="alert alert-error">
            <a  href="javascript:;" class="close" data-dismiss="alert">×</a>
            <h4 class="alert-heading">Informaci&oacute;n!</h4>
            Tiene asignada materias las cuales no tienen horario creado: {% for materia in materiasnoprogramadas %}{{ materia.materia.nombre_completo }}{% if not forloop.last %},{% endif %}{% endfor %}.
        </div>
    {% endif %}{% endcomment %}
    <div class="alert alert-warning">
        <a  href="javascript:;" class="close" data-dismiss="alert">×</a>
        <h4 class="alert-heading">Alerta Importante!</h4>
        La clase se apertura 15 minutos antes y 15 minutos después de la hora planificada en su horario.
    </div>
    <div class="alert alert-info">
        <a  href="javascript:;" class="close" data-dismiss="alert">×</a>
        <h4 class="alert-heading">Alerta Importante!</h4>
        La opción de subir video se mostrará una vez culminada la última hora de cada asignatura, basándose en la planificación semanal.
    </div>
    {#    <div class="row-fluid">#}
    {#        <div class="span12">#}
    {#            <table class="table table-bordered table-striped filterable">#}
    {#                <thead>#}
    {#                <tr>#}
    {#                    <th colspan="3">HERRAMIENTA ZOOM</th>#}
    {#                </tr>#}
    {#                <tr>#}
    {##}
    {#                    <th style="text-align: center">Enlace al ID personal</th>#}
    {#                    <th style="text-align: center">Correo institucional</th>#}
    {#                    <th style="text-align: center">Enlace</th>#}
    {#                </tr>#}
    {#                </thead>#}
    {#                <tbody>#}
    {#                <tr>#}
    {#                    <td style="text-align: center">{{ profesor.urlzoom }}</td>#}
    {#                    <td style="text-align: center">{{ profesor.persona.emailinst }}</td>#}
    {#                    <td style="text-align: center">#}
    {#                        {% if profesor.urlzoom %}#}
    {#                            <a href="{{ profesor.urlzoom }}" target="_blank" style="background-color: #2d8cff!important;" class='btn btn-warning'>#}
    {#                                <i class="fa fa-video-camera"></i> Verificar enlace#}
    {#                            </a>#}
    {#                        {% endif %}#}
    {#                    </td>#}
    {#                </tr>#}
    {#                </tbody>#}
    {#            </table>#}
    {#        </div>#}
    {#    </div>#}
    <div class='row-fluid'>
        <div class='span12'>
            {% with sesiones_cur=sesiones %}
                {% if sesiones_cur %}
                    {%  for sesion in sesiones_cur %}
                        <table class='table table-striped table-bordered' >
                            <tbody>
                            <thead>
                            <tr>
                                <th colspan="8">{{ sesion }}</th>
                            </tr>
                            <tr>
                                <th></th>
                                {% if sesion.id != 15 %}
                                    {% for dia in semana %}
                                        <th style="text-transform: uppercase;text-align: center;width: 160px;">{{ dia.1 }}</th>
                                    {% endfor %}
                                {% else %}
                                    {% for diatuto in semanatutoria %}
                                        <th style="text-transform: uppercase;text-align: center;width: 160px;">{{ diatuto.1 }}</th>
                                    {% endfor %}
                                {% endif %}
                            </tr>
                            </thead>
                            {% with turnos=sesion|args:misclases|args:clasecomplexivo|call:"turnos_clasehorario" %}
                                {% for turno in turnos %}
                                    <tr>
                                        <td>
                                            {{ turno.comienza|time:"G:i" }} a {{ turno.termina|time:"G:i" }}
                                        </td>
                                        {% for dia in semana %}
                                            {% with clasesactuales=turno|args:dia.0|args:profesor|args:periodo|call:"horario_profesor_actual_horario" clasesactualespractica=turno|args:dia.0|args:profesor|args:periodo|call:"horario_profesor_actual_practica" clasesfuturas=turno|args:dia.0|args:profesor|args:periodo|call:"horario_profesor_futuro" clasescomplexivo=turno|args:dia.0|args:profesor|call:"horario_profesor_complexivo" clasescomplexivofuturas=turno|args:dia.0|args:profesor|call:"horario_profesor_complexivo_futuro" mishorariosactuales=turno|args:dia.0|args:profesor|call:"mis_horario_actuales" clasesactualesayudante=turno|args:dia.0|args:profesor|args:periodo|call:"horario_profesor_ayudante" clasesfuturasayudante=turno|args:dia.0|args:profesor|args:periodo|call:"horario_profesor_futuro_ayudante" %}
                                                <td style="padding: 2px">
                                                    {% if clasesactuales %}
                                                        {% for clase in clasesactuales %}
                                                            {#                                                            <div style="background-color: #7cc885; text-align: center; width: 100%; min-height: 50px; border: 1px solid #a7b0c8; border-radius: 3px; margin-bottom: 2px; padding-bottom: 2px;">#}
                                                            <div style="background-color: {{ clase.color }} ; text-align: center; width: 100%; min-height: 50px; border: 1px solid #a7b0c8; border-radius: 3px; margin-bottom: 2px; padding-bottom: 2px;">
                                                                <b>{{ clase.materia.asignatura.nombre }}<br>[{{ clase.materia.identificacion }}]-{{ clase.materia.paralelo }}</b><br>
                                                                <span class="smaller"><b>{{ clase.materia.asignaturamalla.malla.carrera.alias }}</b></span><br>
                                                                <span class="smaller"><b>{{ clase.materia.asignaturamalla.nivelmalla }}</b></span><br>
                                                                <span class="smaller label">{{ clase.inicio|date:'d-m-Y' }} al {{ clase.fin|date:'d-m-Y' }}</span><br>
                                                                <span class="smaller">{{ clase.materia.nivel.paralelo }}<br></span>
                                                                <span class="smaller">{{ clase.aula.nombre }}<br></span>
                                                                <span class="smaller label">{{ clase.tipoprofesor }}</span><br>
                                                                <span class="smaller">{{ clase.get_tipohorario_display }} <br></span>
                                                                {#                                                                <br>{{ clase.materia.id }}#}
                                                                {#                                                                <br>{{ clase.tipoprofesor.id }}#}
                                                                {% if clase.profesor.urlzoom %}
                                                                    {% if clase.tipohorario == 2 or clase.tipohorario == 8 %}
                                                                        {#                                                                        {% if clasesactuales.0.tipoprofesor.id != 8 %}#}
                                                                        {% if disponible %}
                                                                            {% if clasesactuales.0.disponible %}
                                                                                {#                                                                        <a href="{{ clase.profesor.urlzoom }}" target="_blank" style="background-color: #2d8cff!important;" class='btn btn-large btn-warning'>#}
                                                                                {% with verificarwebex=clase.materia|args:clase.profesor|call:"tieneurlwebex" %}
                                                                                    {% if verificarwebex %}
                                                                                        <a href="https://unemi.webex.com/meet/{{ clase.profesor.persona.usuario }}" target="_blank" codigoidclase="{{ clase.id }}" style="background-color: #2d8cff!important;" class='btn btn-warning addsincronica'>
                                                                                            <i class="fa fa-video-camera"></i> Iniciar la clase
                                                                                        </a>
                                                                                    {% else %}
                                                                                        <a href="{{ clase.profesor.urlzoom }}" target="_blank" codigoidclase="{{ clase.id }}" style="background-color: #2d8cff!important;" class='btn btn-warning addsincronica'>
                                                                                            <i class="fa fa-video-camera"></i> Iniciar la clase
                                                                                        </a>
                                                                                    {% endif %}
                                                                                {% endwith %}
                                                                            {% endif %}
                                                                        {% endif %}
                                                                        {#                                                                       INICIO  ES PARECIDO A LA CLASE ASINCRÓNICA#}
                                                                        {% if disponible %}
                                                                            {% if clase.subirenlace %}
                                                                                {% with clasesactualesasincronica=clase|args:numerosemanaactual|call:"horario_profesor_actualasincronica" %}
                                                                                    {% with fechacompara=clase|args:numerosemanaactual|call:"compararfecha" %}
{#                                                                                        fechacompara:{{ fechacompara }}#}
                                                                                        {% with tieneferiado=periodo|args:fechacompara|call:"es_feriado" %}
                                                                                            {% if not tieneferiado %}
                                                                                                {% if not clasesactualesasincronica %}
                                                                                                    <strong>{{ fechacompara|date:"Y-m-d" }}</strong><br>
                                                                                                    {#                                                                                            <strong>{{ horaactual }}</strong><br>#}
                                                                                                    {#                                                                                            <strong>{{ turno.termina }}</strong><br>#}
                                                                                                    {#                                                                                            <strong>{{ fechaactual|date:"Y-m-d" }}</strong><br>#}
                                                                                                    {% if fechacompara <= fechaactual %}
                                                                                                        {% if fechacompara < fechaactual %}
                                                                                                            {#                                                                                                            bloqueo temporal#}
                                                                                                            <a href="javascript:;" class='btn btn-warning creavideo' codigoclase="{{ clase.id }}" codigodia="{{ dia.0 }}">
                                                                                                                <i class="fa fa-comments"></i> Subir video
                                                                                                            </a>
                                                                                                        {% endif %}
                                                                                                        {% if fechacompara == fechaactual %}
                                                                                                            {% if turno.termina < horaactual %}
                                                                                                                {#                                                                                                                bloqueo temporal#}
                                                                                                                <a href="javascript:;" class='btn btn-warning creavideo' codigoclase="{{ clase.id }}" codigodia="{{ dia.0 }}">
                                                                                                                    <i class="fa fa-comments"></i> Subir video
                                                                                                                </a>
                                                                                                            {% endif %}
                                                                                                        {% endif %}
                                                                                                    {% endif %}
                                                                                                {% else %}
                                                                                                    <strong>{{ fechacompara|date:"Y-m-d" }}</strong><br>
                                                                                                    {% if clase.materia.coordinacion.id == 9 %}
                                                                                                        <a href="https://aulanivelacion.unemi.edu.ec/mod/url/view.php?id={{ clasesactualesasincronica.0.idforomoodle }}" target="_blank" class='btn btn-info'>
                                                                                                            <i class="fa fa-video-camera"></i> Ver video
                                                                                                        </a>
                                                                                                    {% else %}
                                                                                                        <a href="https://aulagrado.unemi.edu.ec/mod/url/view.php?id={{ clasesactualesasincronica.0.idforomoodle }}" target="_blank" class='btn btn-info'>
                                                                                                            <i class="fa fa-video-camera"></i> Ver video
                                                                                                        </a>
                                                                                                    {% endif %}
                                                                                                {% endif %}
                                                                                            {% endif %}
                                                                                        {% endwith %}
                                                                                    {% endwith %}
                                                                                {% endwith %}
                                                                            {% endif %}
                                                                        {% endif %}
                                                                        {#                                                                        FIN#}
                                                                        {#                                                                        {% endif %}#}
                                                                    {% endif %}
                                                                    {% if clase.tipohorario == 7 %}
                                                                        {% with clasesactualesasincronica=clase|args:numerosemanaactual|call:"horario_profesor_actualasincronica" %}
                                                                            {% if not clasesactualesasincronica %}
                                                                                <a href="javascript:;" class='btn btn-warning creaforo' codigoclase="{{ clase.id }}" codigodia="{{ dia.0 }}">
                                                                                    <i class="fa fa-comments"></i> Generar clase asincrónica
                                                                                </a>
                                                                            {% else %}
                                                                                {% if clase.materia.coordinacion.id == 9 %}
                                                                                    <a href="https://aulanivelacion.unemi.edu.ec/mod/forum/view.php?id={{ clasesactualesasincronica.0.idforomoodle }}" target="_blank" class='btn btn-warning'>
                                                                                        <i class="fa fa-comments"></i> Ir a la clase
                                                                                    </a>
                                                                                {% else %}
                                                                                    <a href="https://aulagrado.unemi.edu.ec/mod/forum/view.php?id={{ clasesactualesasincronica.0.idforomoodle }}" target="_blank" class='btn btn-warning'>
                                                                                        <i class="fa fa-comments"></i> Ir a la clase
                                                                                    </a>
                                                                                {% endif %}
                                                                            {% endif %}
                                                                        {% endwith %}
                                                                    {% endif %}
                                                                {% endif %}
                                                                {% if clase.tipohorario == 1  %}
                                                                    {% if clasesactuales.0.tipoprofesor.id != 8 %}
                                                                        {% if disponible %}
                                                                            {% if clasesactuales.0.disponible %}
                                                                                <a href='javascript:;' clases="{% for clase in clasesactuales %}{{ clase.id }}{% if not forloop.last %},{% endif %}{% endfor %}" class='btn btn-primary btn-mini btn-abrir'>
                                                                                    <i class='fa fa-plus'></i> Comenzar Clase
                                                                                </a>
                                                                            {% endif %}
                                                                        {% endif %}
                                                                    {% endif %}
                                                                {% endif %}
                                                            </div>
                                                        {% endfor %}
                                                    {% endif %}
                                                    {% if clasesactualespractica %}
                                                        {% for clase in clasesactualespractica %}
                                                            {#                                                            <div style="background-color: #7cc885; text-align: center; width: 100%; min-height: 50px; border: 1px solid #a7b0c8; border-radius: 3px; margin-bottom: 2px; padding-bottom: 2px;">#}
                                                            <div style="background-color: {{ clase.color }} ; text-align: center; width: 100%; min-height: 50px; border: 1px solid #a7b0c8; border-radius: 3px; margin-bottom: 2px; padding-bottom: 2px;">
                                                                <b>{{ clase.materia.asignatura.nombre }}<br>[{{ clase.materia.identificacion }}] - {{ clase.materia.paralelo }}</b><br>
                                                                <span class="smaller"><b>{{ clase.materia.asignaturamalla.malla.carrera.alias }}</b></span>
                                                                <span class="smaller label">{{ clase.inicio|date:'d-m-Y' }} al {{ clase.fin|date:'d-m-Y' }}</span><br>
                                                                <span class="smaller">{{ clase.materia.nivel.paralelo }}<br></span>
                                                                <span class="smaller">{{ clase.aula.nombre }}<br></span>
                                                                <span class="smaller label">{{ clase.tipoprofesor }}</span><br>
                                                                <span class="smaller">{{ clase.get_tipohorario_display }}<br></span>
                                                                {% if clase.tipoprofesor.id == 2 %}
                                                                    {% if clase.grupoprofesor.get_paralelopractica_display %}
                                                                        <span class="smaller">{{ clase.grupoprofesor.get_paralelopractica_display }}<br></span>
                                                                    {% endif %}
                                                                    {#                                                                    {% if clasesactualespractica.0.disponible %}#}
                                                                    <a href="/pro_cronograma?action=practicas&id={{ clase.materia.id|encrypt }}" class="btn btn-info btn-mini"><i class="fa fa-list"></i> Prácticas</a>
                                                                    {#                                                                    {% endif %}#}
                                                                    <br>
                                                                    {% if clase.profesor.urlzoom %}
                                                                        {% if clase.tipohorario == 2 or clase.tipohorario == 8 %}
                                                                            {% if disponible %}
                                                                                {% if clasesactualespractica.0.disponible %}
                                                                                    {% with verificarwebex=clase.materia|args:clase.profesor|call:"tieneurlwebex" %}
                                                                                        {% if verificarwebex %}
                                                                                            <a href="https://unemi.webex.com/meet/{{ clase.profesor.persona.usuario }}" target="_blank" codigoidclase="{{ clase.id }}" style="background-color: #2d8cff!important;" class='btn btn-warning addsincronica'>
                                                                                                <i class="fa fa-video-camera"></i> Iniciar la clase
                                                                                            </a>
                                                                                        {% else %}
                                                                                            <a href="{{ clase.profesor.urlzoom }}" target="_blank" codigoidclase="{{ clase.id }}" style="background-color: #2d8cff!important;" class='btn btn-warning addsincronica'>
                                                                                                <i class="fa fa-video-camera"></i> Iniciar la clase
                                                                                            </a>
                                                                                        {% endif %}
                                                                                    {% endwith %}
                                                                                {% endif %}
                                                                            {% endif %}
                                                                            {% if disponible %}
                                                                                {% if clase.subirenlace %}
                                                                                    {% with clasesactualesasincronica=clase|args:numerosemanaactual|call:"horario_profesor_actualasincronica" %}
                                                                                        {% with fechacompara=clase|args:numerosemanaactual|call:"compararfecha" %}
                                                                                            {% with tieneferiado=periodo|args:fechacompara|call:"es_feriado" %}
                                                                                                {% if not tieneferiado %}
                                                                                                    {% if not clasesactualesasincronica %}
                                                                                                        <strong>{{ fechacompara|date:"Y-m-d" }}</strong><br>
                                                                                                        {% if fechacompara <= fechaactual %}
                                                                                                            {% if fechacompara < fechaactual %}
                                                                                                                <a href="javascript:;" class='btn btn-warning creavideo' codigoclase="{{ clase.id }}" codigodia="{{ dia.0 }}">
                                                                                                                    <i class="fa fa-comments"></i> Subir video
                                                                                                                </a>
                                                                                                            {% endif %}
                                                                                                            {% if fechacompara == fechaactual %}
                                                                                                                {% if turno.termina < horaactual %}
                                                                                                                    <a href="javascript:;" class='btn btn-warning creavideo' codigoclase="{{ clase.id }}" codigodia="{{ dia.0 }}">
                                                                                                                        <i class="fa fa-comments"></i> Subir video
                                                                                                                    </a>
                                                                                                                {% endif %}
                                                                                                            {% endif %}
                                                                                                        {% endif %}
                                                                                                    {% else %}
                                                                                                        <strong>{{ fechacompara|date:"Y-m-d" }}</strong><br>
                                                                                                        <a href="https://aulagrado.unemi.edu.ec/mod/url/view.php?id={{ clasesactualesasincronica.0.idforomoodle }}" target="_blank" class='btn btn-info'>
                                                                                                            <i class="fa fa-video-camera"></i> Ver video
                                                                                                        </a>
                                                                                                    {% endif %}
                                                                                                {% endif %}
                                                                                            {% endwith %}
                                                                                        {% endwith %}
                                                                                    {% endwith %}
                                                                                {% endif %}
                                                                            {% endif %}
                                                                        {% endif %}
                                                                    {% endif %}
                                                                {% endif %}

                                                            </div>
                                                        {% endfor %}
                                                    {% endif %}
                                                    {% if clasesactualesayudante %}
                                                        {% for claseayudante in clasesactualesayudante %}
                                                            {#                                                            <div style="background-color: #7cc885; text-align: center; width: 100%; min-height: 50px; border: 1px solid #a7b0c8; border-radius: 3px; margin-bottom: 2px; padding-bottom: 2px;">#}
                                                            <div style="background-color: {{ claseayudante.color }}; text-align: center; width: 100%; min-height: 50px; border: 1px solid #a7b0c8; border-radius: 3px; margin-bottom: 2px; padding-bottom: 2px;">
                                                                <b>{{ claseayudante.materia.asignatura.nombre }}<br>[{{ claseayudante.materia.identificacion }}]-{{ claseayudante.materia.paralelo }}</b><br>
                                                                <span class="smaller"><b>{{ claseayudante.materia.asignaturamalla.malla.carrera.alias }}</b></span><br>
                                                                <span class="smaller label">{{ claseayudante.inicio|date:'d-m-Y' }} al {{ claseayudante.fin|date:'d-m-Y' }}</span><br>
                                                                <span class="smaller">{{ claseayudante.materia.nivel.paralelo }}<br></span>
                                                                <span class="smaller">{{ claseayudante.aula.nombre }}<br></span>
                                                                <span class="smaller label">AYUDANTE</span><br>
                                                                <span class="smaller">{{ claseayudante.get_tipohorario_display }}<br></span>
                                                                {% if clase.tipoprofesor.id == 2 %}
                                                                    {% if clase.grupoprofesor.get_paralelopractica_display %}
                                                                        <span class="smaller">{{ clase.grupoprofesor.get_paralelopractica_display }}<br></span>
                                                                    {% endif %}
                                                                {% endif %}
                                                            </div>
                                                        {% endfor %}
                                                    {% endif %}
                                                    {% if clasesfuturas %}
                                                        {% for clase in clasesfuturas %}
                                                            <div style="background: {{ clase.color }} ;text-align: center; width: 100%; min-height: 50px; border: 1px solid #a7b0c8; border-radius: 3px; margin-bottom: 2px; padding-bottom: 2px;">
                                                                <b>{{ clase.materia.asignatura.nombre }}<br>[{{ clase.materia.identificacion }}]-{{ clase.materia.paralelo }}</b><br>
                                                                <span class="smaller"><b>{{ clase.materia.asignaturamalla.malla.carrera.alias }}</b></span><br>
                                                                <span class="smaller label">{{ clase.inicio|date:'d-m-Y' }} al {{ clase.fin|date:'d-m-Y' }}</span><br>
                                                                <span class="smaller">{{ clase.materia.nivel.paralelo }}<br></span>
                                                                <span class="smaller">{{ clase.aula.nombre }}<br></span>
                                                                <span class="smaller label" >{{ clase.tipoprofesor }}</span><br>
                                                                <span class="smaller">{{ clase.get_tipohorario_display }}<br></span>
                                                            </div>
                                                        {% endfor %}
                                                    {% endif %}
                                                    {% if clasesfuturasayudante %}
                                                        {% for clasefuturaayudante in clasesfuturasayudante %}
                                                            <div style="background: {{ clasefuturaayudante.color }} ;text-align: center; width: 100%; min-height: 50px; border: 1px solid #a7b0c8; border-radius: 3px; margin-bottom: 2px; padding-bottom: 2px;">
                                                                <b>{{ clasefuturaayudante.materia.asignatura.nombre }}<br>[{{ clasefuturaayudante.materia.identificacion }}]-{{ clasefuturaayudante.materia.paralelo }}</b><br>
                                                                <span class="smaller"><b>{{ clasefuturaayudante.materia.asignaturamalla.malla.carrera.alias }}</b></span><br>
                                                                <span class="smaller label">{{ clasefuturaayudante.inicio|date:'d-m-Y' }} al {{ clasefuturaayudante.fin|date:'d-m-Y' }}</span><br>
                                                                <span class="smaller">{{ clasefuturaayudante.materia.nivel.paralelo }}<br></span>
                                                                <span class="smaller">{{ clasefuturaayudante.aula.nombre }}<br></span>
                                                                <span class="smaller label">AYUDANTE</span><br>
                                                                <span class="smaller">{{ clasefuturaayudante.get_tipohorario_display }}<br></span>
                                                                {% if clase.tipoprofesor.id == 2 %}
                                                                    {% if clase.grupoprofesor.get_paralelopractica_display %}
                                                                        <span class="smaller">{{ clase.grupoprofesor.get_paralelopractica_display }}<br></span>
                                                                    {% endif %}
                                                                {% endif %}
                                                            </div>
                                                        {% endfor %}
                                                    {% endif %}
                                                    {#          ------------------------------    M O D I F I C A D A -------------------------------------------#}
                                                    {% if clasescomplexivo %}
                                                        <div style="background-color: #7cc885; text-align: center; width: 100%; min-height: 50px; border: 1px solid #a7b0c8; border-radius: 3px; margin-bottom: 2px; padding-bottom: 2px;">
                                                            {% for clase in clasescomplexivo %}
                                                                <b>{{ clase.materia.asignatura.nombre }}<br>[{{ clase.materia.asignatura.codigo }}]</b><br>
                                                                <span class="smaller label">{{ clase.fechainicio|date:'d-m-Y' }} al {{ clase.fechafin|date:'d-m-Y' }}</span><br>
                                                                <span class="smaller">
                                                                    {% for mishorarioactual in mishorariosactuales %}
                                                                        [{{ mishorarioactual.materia.alternativa.carrera.alias }}]-{{ mishorarioactual.materia.alternativa.get_sesion.sesion.nombre }}-{{ mishorarioactual.materia.alternativa.paralelo }}<br>
                                                                    {% endfor %}
                                                                    <br></span>
                                                                <span class="smaller">{{ clase.aula.nombre }}<br></span>
                                                                <span class="smaller label">COMPLEXIVO</span><br>
                                                                <span class="smaller">{{ clase.aula.sede }}<br></span>
                                                            {% endfor %}
                                                            {% if disponiblecomplexivo %}
                                                                {% if clasescomplexivo.0.disponible %}
                                                                    <a href='javascript:;' clases ="{% for clase in mishorariosactuales %}{{ clase.id }}{% if not forloop.last %},{% endif %}{% endfor %}" class='btn btn-primary btn-mini btn-abrir-complexivo'><i class='fa fa-plus '></i> Comenzar Clase</a>
                                                                {% endif %}
                                                            {% endif %}
                                                        </div>
                                                    {% endif %}
                                                    {% if clasescomplexivofuturas %}
                                                        {% for clase in clasescomplexivofuturas %}
                                                            <div style="background: {{ clase.color }} ;text-align: center; width: 100%; min-height: 50px; border: 1px solid #a7b0c8; border-radius: 3px; margin-bottom: 2px; padding-bottom: 2px;">
                                                                <b>{{ clase.materia.asignatura.nombre }}<br>[{{ clase.materia.asignatura.codigo }}]</b><br>
                                                                <span class="smaller label">{{ clase.fechainicio|date:'d-m-Y' }} al {{ clase.fechafin|date:'d-m-Y' }}</span><br>
                                                                <span class="smaller">
                                                                    {% for mishorarioactual in mishorariosactuales %}
                                                                        [{{ mishorarioactual.materia.alternativa.carrera.alias }}]-{{ mishorarioactual.materia.alternativa.get_sesion.sesion.nombre }}-{{ mishorarioactual.materia.alternativa.paralelo }}<br>
                                                                    {% endfor %}
                                                                    <br></span>
                                                                <span class="smaller">{{ clase.aula.nombre }}<br></span>
                                                                <span class="smaller label">COMPLEXIVO</span><br>
                                                                <span class="smaller">{{ clase.aula.sede }}<br></span>
                                                            </div>
                                                        {% endfor %}
                                                    {% endif %}
                                                </td>
                                            {% endwith %}
                                        {% endfor %}
                                    </tr>
                                {% endfor %}
                            {% endwith %}
                            {% if sesion.id == 15 %}
                                {% with turnosactivostutoria=sesion|args:profesor|args:periodo|call:"turnosactivos_tutoria" %}
                                    {% for turnotuto in turnosactivostutoria %}
                                        <tr>
                                            <td>
                                                {{ turnotuto.comienza|time:"G:i" }} a {{ turnotuto.termina|time:"G:i" }}
                                            </td>
                                            {% for diatuto in semanatutoria %}
                                                {% with horariotutoria=turnotuto|args:diatuto.0|args:profesor|args:periodo|call:"horario_tutorias_academicas"%}
                                                    <td style="padding: 2px">
                                                        {% if horariotutoria %}
                                                            {% if profesor.urlzoom %}
                                                                {% for tuto in horariotutoria %}
                                                                    <div style="background: #1b6d85;text-align: center; width: 100%; min-height: 50px; border: 1px solid #a7b0c8; border-radius: 3px; margin-bottom: 2px; padding-bottom: 2px; color:#ffffff">
                                                                        <span class="smaller">  ORIENTACIÓN Y ACOMPAÑAMIENTO A TRAVÉS DE TUTORÍAS PRESENCIALES O VIRTUALES, INDIVIDUALES O GRUPALES<br></span>
                                                                        {%  if tuto.disponibletutoria %}
                                                                            <a href="{{ profesor.urlzoom }}" target="_blank" codigoidclase="{{ tuto.id }}" style="background-color: #2d8cff!important;" class='btn btn-warning addclasetutoria'>
                                                                                <i class="fa fa-video-camera"></i> Iniciar la tutoría
                                                                            </a>
                                                                        {% endif %}
                                                                    </div>
                                                                {% endfor %}
                                                            {% endif %}
                                                        {% endif %}
                                                    </td>
                                                {% endwith %}
                                            {% endfor %}
                                        </tr>
                                    {% endfor %}
                                {% endwith %}
                            {% endif %}
                            <tr></tr>
                            </tbody>
                        </table>
                    {% endfor %}
                    {#                {% else %}#}
                    {#                    {% if periodo.visiblehorario %}#}
                    {#                        <div class="alert alert-error">#}
                    {#                            <a  href="javascript:;" class="close" data-dismiss="alert">×</a>#}
                    {#                            <h4 class="alert-heading">Informaci&oacute;n!</h4>#}
                    {#                            Periodo de clases de la materia ha terminado.#}
                    {#                        </div>#}
                    {#                    {% endif %}#}
                {% endif %}
            {% endwith %}
        </div>
    </div>
    <div class="modal fade static" id="mensajepanel" data-backdrop="static" data-keyboard="false" >
        <div class="modal-header">
            <h4>Mensaje</h4>
        </div>
        <div class="modal-body" style="height: 60px;">
            <div id='mensaje'>
            </div>
        </div>
        <div class="modal-footer" hidden="hidden">
            <a href="javascript:;" class="btn btn-cerrar btn-info">Cerrar</a>
        </div>
    </div>
    <div class="modal fade static" id="modalcreaforo" style="display: none;">
        <div class="modal-header">
            <h3 class="paneltitle">Crear clase asincrónica</h3>
        </div>
        <div class="modal-body panelbodyforo">
            Enlace a la grabación 1
            <span style="color:#FF0000";>* Obligatorio</span>
            <br>
            <input type="hidden" id="id_clase" name="id_clase" value="0">
            <input type="hidden" id="id_dia" name="id_dia" value="0">
            <textarea rows="3" name="id_observacion" id="id_observacion" style="width: 500px"></textarea><br>
            Enlace a la grabación 2<br>
            <textarea rows="3" name="id_enlace2" id="id_enlace2" style="width: 500px"></textarea><br>
            Enlace a la grabación 3<br>
            <textarea rows="3" name="id_enlace3" id="id_enlace3" style="width: 500px"></textarea>
        </div>
        <div class="modal-footer">
            <table class="pull-right">
                <tr>
                    <td><a href="javascript:;" class="btn btn-success saveforo">Crear</a></td>
                    <td><a href="javascript:;" class="btn btn-default cancelaforo">Cancelar</a></td>
                </tr>
            </table>
        </div>
    </div>
    <div class="modal fade static" id="modalcreavideo" style="display: none;">
        <div class="modal-header">
            <h3 class="paneltitle">Crear video</h3>
        </div>
        <div class="modal-body panelbodyforo">
            Enlace a la grabación 1
            <span style="color:#FF0000">* Obligatorio</span>
            <br>
            <input type="hidden" id="id_clasevideo" name="id_clasevideo" value="0">
            <input type="hidden" id="id_diavideo" name="id_diavideo" value="0">
            <textarea rows="3" name="id_observacionvideo" id="id_observacionvideo" style="width: 500px"></textarea><br>
            Enlace a la grabación 2<br>
            <textarea rows="3" name="id_enlace2video" id="id_enlace2video" style="width: 500px"></textarea><br>
            Enlace a la grabación 3<br>
            <textarea rows="3" name="id_enlace3video" id="id_enlace3video" style="width: 500px"></textarea>
        </div>
        <div class="modal-footer">
            <table class="pull-right">
                <tr>
                    <td><a href="javascript:;" class="btn btn-success savevideo">Crear</a></td>
                    <td><a href="javascript:;" class="btn btn-default cancelaforo">Cancelar</a></td>
                </tr>
            </table>
        </div>
    </div>
{% endblock %}
