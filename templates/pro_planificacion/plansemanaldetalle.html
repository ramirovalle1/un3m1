{% load sga_extras %}
<div class="contenidosemanalplan">
    <script>
        var itemsblib = 1;
        var lista_items1 = [];
        var obj = 0;
        var enf = 0;
        var rec = 0;
        var eva = 0;

        $(function () {
            $("#id_objetivo").css({'text-transform': 'none'});
            $("#id_enfoque").css({'text-transform': 'none'});
            $("#id_enfoquedos").css({'text-transform': 'none'});
            $("#id_enfoquetres").css({'text-transform': 'none'});
            $("#id_recurso").css({'text-transform': 'none'});
            $("#id_evaluacion").css({'text-transform': 'none'});
            $("#id_subtema").css({'text-transform': 'none'});
            $("#id_subtema").addClass("validate[required]");
            $("#id_tema").addClass("validate[required]");
            $("#desplegar_obj").each(function () {
                $(this).trigger('click');
            });
            mostrar__componentes = function () {
                $(".mostrar_temasevaluacion").unbind();
                $(".mostrar_temasevaluacion").click(function () {
                    var codcomp = $(this).attr('codcomp');
                    bloqueointerface();
                    $.get("/pro_planificacion", {'action': 'consultacomponentestemas', 'codcomp': codcomp}, function (data) {
                        var dato;
                        if (data.result == 'ok') {
                            $("#itemsbodytemas").empty();
                            for (elemento in data.listadocomponentestemas) {
                                $("#itemsbodytemas").append("<tr>" +
                                    {#"<td style='text-align: center;'><input type='checkbox' class='seleccionados' idtema="+coditema+" ></td>" +#}
                                    "<td style='text-align: left'>SEMANA " + data.listadocomponentestemas[elemento][3] + " | UNIDAD " + data.listadocomponentestemas[elemento][4] + " - TEMA " + data.listadocomponentestemas[elemento][2] + ": " + data.listadocomponentestemas[elemento][1] + "</td>" +
                                    "</tr>");
                            }
                            $.unblockUI();
                            $("#itemspanelevacomptemas").modal({backdrop: 'static', width: '610px'}).modal('show');

                        }
                    }, 'json');
                });
            };
            eliminar__componentes = function () {
                $(".eliminarcomponente").unbind();
                $(".eliminarcomponente").click(function () {
                    var codcomp = $(this).attr('codcomp');
                    var idcodsemanal = $(this).attr('idcodsemanal');
                    Swal.fire({
                        title: '¿Está seguro de eliminar componente?',
                        showDenyButton: true,
                        showCancelButton: true,
                        confirmButtonText: 'Si, eliminar',
                        denyButtonText: `No, cancelar`,
                    }).then((result) => {
                        if (result.value) {
                            bloqueointerface();
                            $.ajax({
                                type: "POST",
                                url: "/pro_planificacion",
                                data: {'action': 'deletecomponente', 'id': codcomp},
                                error: function () {
                                    $.unblockUI();
                                    mensajeWarning("Error al obtener los datos.");
                                },
                                success: function (data) {
                                    if (data.result == "ok") {
                                        location.reload();
                                        {#$('#componente'+idcodsemanal+'_'+codcomp).remove();#}
                                        {#$.unblockUI();#}
                                    } else {
                                        $.unblockUI();
                                        mensajeWarning(data.mensaje);
                                    }
                                }
                            });
                        }
                    })
                });
            };
            $(".eliminarcomponente").click(function () {
                var codcomp = $(this).attr('codcomp');
                var idcodsemanal = $(this).attr('idcodsemanal');
                Swal.fire({
                    title: '¿Está seguro de eliminar componente?',
                    showDenyButton: true,
                    showCancelButton: true,
                    confirmButtonText: 'Si, eliminar',
                    denyButtonText: `No, cancelar`,
                }).then((result) => {
                    if (result.value) {
                        bloqueointerface();
                        $.ajax({
                            type: "POST",
                            url: "/pro_planificacion",
                            data: {'action': 'deletecomponente', 'id': codcomp},
                            error: function () {
                                $.unblockUI();
                                mensajeWarning("Error al obtener los datos.");
                            },
                            success: function (data) {
                                if (data.result == "ok") {
                                    location.reload();
                                    {#$('#componente'+idcodsemanal+'_'+codcomp).remove();#}
                                    {#$.unblockUI();#}
                                } else {
                                    $.unblockUI();
                                    mensajeWarning(data.mensaje);
                                }
                            }
                        });
                    }
                })

            });
            $(".eliminarsilabosemanal").click(function () {
                var idcodigosemana = $(this).attr('idcodigosemanal');
                Swal.fire({
                    title: '¿Está seguro de eliminar silabo semanal?',
                    showDenyButton: true,
                    showCancelButton: true,
                    confirmButtonText: 'Si, eliminar',
                    denyButtonText: `No, cancelar`,
                }).then((result) => {
                    if (result.value) {
                        bloqueointerface();
                        $.ajax({
                            type: "POST",
                            url: "/pro_planificacion",
                            data: {'action': 'delsemanasilabo', 'id': idcodigosemana},
                            error: function () {
                                $.unblockUI();
                                mensajeWarning("Error al obtener los datos.");
                            },
                            success: function (data) {
                                if (data.result == "ok") {
                                    location.reload();
                                    {#$.unblockUI();#}
                                } else {
                                    $.unblockUI();
                                    mensajeWarning(data.mensaje);
                                }
                            }
                        });
                    }
                })
            });
            $(".eliminarsilabosemanaltodo").click(function () {
                var idcodigosilabo = $(this).attr('idcodigosilabo');
                Swal.fire({
                    title: '¿Está seguro de eliminar silabo semanal? Importante: Al dar clic en ELIMINAR, se eliminará todas las planificaciones semanales.',
                    showDenyButton: true,
                    showCancelButton: true,
                    confirmButtonText: 'Si, eliminar',
                    denyButtonText: `No, cancelar`,
                }).then((result) => {
                    if (result.value) {
                        bloqueointerface();
                        $.ajax({
                            type: "POST",
                            url: "/pro_planificacion",
                            data: {'action': 'delsemanasilabotodo', 'id': idcodigosilabo},
                            error: function () {
                                $.unblockUI();
                                mensajeWarning("Error al obtener los datos.");
                            },
                            success: function (data) {
                                if (data.result == "ok") {
                                    location.reload();
                                } else {
                                    $.unblockUI();
                                    mensajeWarning(data.mensaje);
                                }
                            }
                        });
                    }
                })
            });
            $(".editar_objetivo").click(function () {
                var id = $(this).attr('ids');
                $.get("/pro_planificacion", {'action': 'editarobjetivoaprendizaje', 'ids': id}, function (data) {
                    var dato;
                    if (data.result == 'ok') {
                        $.unblockUI();
                        $("#itemspanelo").modal({backdrop: 'static', width: '610px'}).modal('show');
                        $("#id_objetivo").val(data.objetivo);
                        $("#idso").val(data.ids);
                    }
                }, 'json');

            });
            $("#itemspanelo .btn-cerrar").click(function () {
                $("#itemspanelo").modal("hide");
            });
            $("#itemspanelo #adicionarobj").click(function () {
                var cont = $("#id_objetivo").val();
                if (cont.length > 0) {
                    var ids = $("#idso").val();
                    var formdata = new FormData($("#formobj")[0]);
                    try {
                        formdata.append("objetivo", JSON.stringify(cont));
                    } catch (err) {
                        console.log(err.message);
                    }
                    bloqueointerface();
                    $.ajax({
                        type: "POST",
                        url: "/pro_planificacion",
                        data: formdata,
                        success: function (data) {
                            if (data.result == 'ok') {
                                bloqueointerface();
                                $("#itemspanelo").modal("hide");
                                location.href = "/pro_planificacion?action=planclase&silaboid=" + data.ids;
                            } else {
                                $.unblockUI();
                                mensajeWarning(data.mensaje);
                            }
                        },
                        error: function () {
                            $.unblockUI();
                            mensajeWarning("Error al enviar los datos.");
                        },
                        dataType: "json",
                        cache: false,
                        contentType: false,
                        processData: false
                    });
                } else {
                    mensajeWarning("Es obligatirio llenar la información Objetivo Apendizaje");
                }
            });
            $(".editar_enfoque").click(function () {
                var id = $(this).attr('ids');
                $.get("/pro_planificacion", {'action': 'editenfoquemetodologico', 'ids': id}, function (data) {
                    var dato;
                    if (data.result == 'ok') {
                        $.unblockUI();
                        $("#itemspanelenf").modal({backdrop: 'static', width: '610px'}).modal('show');
                        $("#id_enfoque").val(data.enfoque);
                        $("#id_enfoquedos").val(data.enfoquedos);
                        $("#id_enfoquetres").val(data.enfoquetres);
                        $("#idse").val(data.ids);
                    }
                }, 'json');

            });
            $("#itemspanelenf .btn-cerrar").click(function () {
                $("#itemspanelenf").modal("hide");
            });
            $("#itemspanelenf #adicionarenf").click(function () {
                var cont = $("#id_enfoque").val();
                var idenfoquedos = $("#id_enfoquedos").val();
                var idenfoquetres = $("#id_enfoquetres").val();
                if (cont.length > 0) {
                    var ids = $("#idse").val();
                    var formdata = new FormData($("#formenf")[0]);
                    try {
                        formdata.append("enfoque", JSON.stringify(cont));
                        formdata.append("enfoquedos", JSON.stringify(idenfoquedos));
                        formdata.append("enfoquetres", JSON.stringify(idenfoquetres));
                    } catch (err) {
                        console.log(err.message);
                    }
                    bloqueointerface();
                    $.ajax({
                        type: "POST",
                        url: "/pro_planificacion",
                        data: formdata,
                        success: function (data) {
                            if (data.result == 'ok') {
                                bloqueointerface();
                                $("#itemspanelenf").modal("hide");
                                location.href = "/pro_planificacion?action=planclase&silaboid=" + data.ids;
                            } else {
                                $.unblockUI();
                                mensajeWarning(data.mensaje);
                            }
                        },
                        error: function () {
                            $.unblockUI();
                            mensajeWarning("Error al enviar los datos.");
                        },
                        dataType: "json",
                        cache: false,
                        contentType: false,
                        processData: false
                    });
                } else {
                    mensajeWarning("Es obligatirio llenar la información Enfoque Metodológico");
                }
            });
            $(".editar_recurso").click(function () {
                var id = $(this).attr('ids');
                $.get("/pro_planificacion", {'action': 'editrecursodidactico', 'ids': id}, function (data) {
                    var dato;
                    if (data.result == 'ok') {
                        $.unblockUI();
                        $("#itemspanelrec").modal({backdrop: 'static', width: '610px'}).modal('show');
                        $("#id_recurso").val(data.recurso);
                        $("#idsr").val(data.ids);
                    }
                }, 'json');
            });
            $("#itemspanelrec .btn-cerrar").click(function () {
                $("#itemspanelrec").modal("hide");
            });
            $("#itemspanelrec #adicionarrec").click(function () {
                var cont = $("#id_recurso").val();
                if (cont.length > 0) {
                    var ids = $("#idsr").val();
                    var formdata = new FormData($("#formrec")[0]);
                    try {
                        formdata.append("recurso", JSON.stringify(cont));
                    } catch (err) {
                        console.log(err.message);
                    }
                    bloqueointerface();
                    $.ajax({
                        type: "POST",
                        url: "/pro_planificacion",
                        data: formdata,
                        success: function (data) {
                            if (data.result == 'ok') {
                                bloqueointerface();
                                $("#itemspanelrec").modal("hide");
                                location.href = "/pro_planificacion?action=planclase&silaboid=" + data.ids;
                            } else {
                                $.unblockUI();
                                mensajeWarning(data.mensaje);
                            }
                        },
                        error: function () {
                            $.unblockUI();
                            mensajeWarning("Error al enviar los datos.");
                        },
                        dataType: "json",
                        cache: false,
                        contentType: false,
                        processData: false
                    });
                } else {
                    mensajeWarning("Es obligatirio llenar la información Recursos Didácticos");
                }
            });
            $(".editar_evaluacion").click(function () {
                var id = $(this).attr('ids');

                $.get("/pro_planificacion", {'action': 'editevaluacion', 'ids': id}, function (data) {
                    var dato;
                    if (data.result == 'ok') {
                        $.unblockUI();
                        $("#itemspaneleva").modal({backdrop: 'static', width: '610px'}).modal('show');
                        $("#id_evaluacion").val(data.evaluacion);
                        $("#idsv").val(data.ids);
                    }
                }, 'json');

            });
            $("#itemspaneleva .btn-cerrar").click(function () {
                $("#itemspaneleva").modal("hide");
            });
            $("#itemspaneleva #adicionareva").click(function () {
                var cont = $("#id_evaluacion").val();
                if (cont.length > 0) {
                    var ids = $("#idsv").val();
                    var formdata = new FormData($("#formeva")[0]);
                    try {
                        formdata.append("evaluacion", JSON.stringify(cont));
                    } catch (err) {
                        console.log(err.message);
                    }
                    bloqueointerface();
                    $.ajax({
                        type: "POST",
                        url: "/pro_planificacion",
                        data: formdata,
                        success: function (data) {
                            if (data.result == 'ok') {
                                bloqueointerface();
                                $("#itemspaneleva").modal("hide");
                                location.href = "/pro_planificacion?action=planclase&silaboid=" + data.ids;
                            } else {
                                $.unblockUI();
                                mensajeWarning(data.mensaje);
                            }
                        },
                        error: function () {
                            $.unblockUI();
                            mensajeWarning("Error al enviar los datos.");
                        },
                        dataType: "json",
                        cache: false,
                        contentType: false,
                        processData: false
                    });
                } else {
                    mensajeWarning("Es obligatirio llenar la información Evaluación");
                }
            });
            $("#id_componente").change(function () {
                var nomcomponente = $(this).attr('nomcomponente');
                $("#tipocomponente").html($("option:selected", this).attr('nomcomponente'))
                var idactividad = $("#id_componente").val()
                var codsilabo = $("#codsilabo").val()
                var numsemana = $("#id_numsemana").val()
                bloqueointerface();
                $.get("/pro_planificacion", {'action': 'consultacomponentesactividadestemas', 'idactividad': idactividad, 'codsilabo': codsilabo, 'idsilabosemanal': numsemana}, function (data) {
                    var dato;
                    if (data.result == 'ok') {
                        {#alert(data.listadocomponentestemas)#}
                        $.unblockUI();
                        $("#itemsbody").empty();
                        if (data.listadotemassemanales != '') {
                            for (elemento in data.listadotemassemanales) {
                                $("#itemsbody").append("<tr id='filatema" + data.listadotemassemanales[elemento][1] + "' >" +
                                    "<td style='text-align: center;' id='filatd" + data.listadotemassemanales[elemento][1] + "'><input type='checkbox' class='seleccionados' idtema=" + data.listadotemassemanales[elemento][1] + " ></td>" +
                                    "<td style='text-align: left'>SEMANA " + data.listadotemassemanales[elemento][0] + ": " + data.listadotemassemanales[elemento][2] + "</td>" +
                                    "</tr>");
                            }
                        }
                        if (data.listadocomponentestemas != '') {
                            for (elemento in data.listadocomponentestemas) {
                                $("#filatd" + data.listadocomponentestemas[elemento]).html('');
                            }
                        }
                    } else {
                        $.unblockUI();
                        console.log(data.mensaje)
                    }
                }, 'json');
            });
            $(".adicionar_evaluacioncomp").click(function () {
                $('#id_componente').empty().append('<option value="">---------</option>').val(0).trigger("change");
                var id = $(this).attr('ids');
                $("#id_silsemana").val(id);
                $("#tipocomponente").html('');
                bloqueointerface();
                $.get("/pro_planificacion", {'action': 'consultacomponentes', 'idsem': id}, function (data) {
                    var dato;
                    if (data.result == 'ok') {
                        $.unblockUI();
                        $("#itemspanelevacomp").modal({backdrop: 'static', width: '610px'}).modal('show');
                        for (elemento in data.listadocomponentes) {
                            $('#id_componente').append('<option nomcomponente="' + data.listadocomponentes[elemento][2] + '" value="' + data.listadocomponentes[elemento][0] + '">' + data.listadocomponentes[elemento][1] + '</option>');
                        }
                        $("#itemsbody").empty();
                    }
                }, 'json');

            });
            $("#itemspanelevacomp #adicionarevacomp").click(function () {
                var id_silsemana = $("#id_silsemana").val();
                var id_componente = $("#id_componente").val();
                var codsilabo = $("#codsilabo").val()
                bloqueointerface();
                if (id_componente == 0) {
                    $.unblockUI();
                    mensajeWarning("Favor seleccione componente.");
                    return false;
                }
                var listadotemas = '';
                $('.seleccionados').each(function () {
                    var idtema = $(this).attr('idtema');
                    if ($(this).is(":checked")) {
                        listadotemas += idtema + ",";
                    }
                });
                if (listadotemas == '') {
                    $.unblockUI();
                    mensajeWarning('Favor seleccionar temas');
                    return false;
                }
                listadotemas = listadotemas.substring(0, listadotemas.length - 1);
                $.ajax({
                    type: "POST",
                    url: "/pro_planificacion",
                    data: {'action': 'addcomponente', 'id_silsemana': id_silsemana, 'id_componente': id_componente, 'listadotemas': listadotemas, 'codsilabo': codsilabo},
                    error: function () {
                        $.unblockUI();
                        mensajeWarning("Error al obtener los datos.");
                    },
                    success: function (data) {
                        if (data.result == "ok") {
                            location.reload();
                            {#$("#itemspanelevacomp").modal("hide");#}
                            {#$("#itemsbodycomponente"+data.idsilabo).append("<tr id='componente"+data.idsilabo+"_"+data.evaluacionaprendizaje+"' >" +#}
                            {#    "<td >"+data.nomcomponente+"</td>" +#}
                            {#    "<td >"+data.nomactividad+"</td>" +#}
                            {#    "<td ><a class='btn btn-warning btn-mini mostrar_temasevaluacion' idcodsemanal="+data.idsilabo+" codcomp="+data.evaluacionaprendizaje+"><i class='fa fa-list'></i></a></td>" +#}
                            {#    "<td ><a class='btn btn-defaultd btn-mini eliminarcomponente' idcodsemanal="+data.idsilabo+" codcomp="+data.evaluacionaprendizaje+"><strong>X</strong></a></td>" +#}
                            {#    "</tr>");#}
                            {#eliminar__componentes();#}
                            {#mostrar__componentes();#}
                            {#$.unblockUI();#}
                        } else {
                            $.unblockUI();
                            mensajeWarning(data.mensaje);
                        }
                    }
                });


            });
            $("#itemspanelevacomp .btn-cerrarcomp").click(function () {
                $("#itemspanelevacomp").modal("hide");
            });
            $(".mostrar_temasevaluacion").click(function () {
                var codcomp = $(this).attr('codcomp');
                bloqueointerface();
                $.get("/pro_planificacion", {'action': 'consultacomponentestemas', 'codcomp': codcomp}, function (data) {
                    var dato;
                    if (data.result == 'ok') {
                        $("#itemsbodytemas").empty();
                        for (elemento in data.listadocomponentestemas) {
                            $("#itemsbodytemas").append("<tr>" +
                                {#"<td style='text-align: center;'><input type='checkbox' class='seleccionados' idtema="+coditema+" ></td>" +#}
                                "<td style='text-align: left'>SEMANA " + data.listadocomponentestemas[elemento][3] + " | UNIDAD " + data.listadocomponentestemas[elemento][4] + " - TEMA " + data.listadocomponentestemas[elemento][2] + ": " + data.listadocomponentestemas[elemento][1] + "</td>" +
                                "</tr>");
                        }
                        $.unblockUI();
                        $("#itemspanelevacomptemas").modal({backdrop: 'static', width: '610px'}).modal('show');

                    }
                }, 'json');

            });
            $("#itemspanelevacomptemas .btn-cerrarcomptemas").click(function () {
                $("#itemspanelevacomptemas").modal("hide");
            });
            $(".detalle_tst_registrar").click(function () {
                var id = $(this).attr('ids');
                $.get("/pro_planificacion", {'action': 'detalle_temasxplanificar', 'ids': id}, function (data) {
                    if (data.result == 'ok') {
                        $.unblockUI();
                        $(".panelbody").html(data.data);
                        $("#itemspaneldetalle_temas_subtemas").modal({backdrop: 'static', width: '1000px'}).modal('show');
                    }
                }, 'json');
            });
            $("#itemspanelplanificacionsalida .btn-cerrar").click(function () {
                $("#itemspanelplanificacionsalida").modal("hide");
            });
            $(".addplanificacionsalida").click(function () {
                var id = $(this).attr('ids');
                $.unblockUI();
                $("#itemspanelplanificacionsalida").modal({backdrop: 'static', width: '610px'}).modal('show');
                $("#ids").val(id);
            });
            $("#adicionarplanificacionsalida").click(function () {
                var cont = $("#contenido").val();
                if (cont.length > 0) {
                    var ids = $("#ids").val();
                    $.ajax({
                        type: "POST",
                        url: "/pro_planificacion",
                        data: {'action': 'addplanificacion_salida', 'ids': ids, 'cont': cont},
                        success: function (data) {
                            if (data.result == 'ok') {
                                $.unblockUI();
                                bloqueointerface();
                                $("#itemspanelplanificacionsalida").modal("hide");
                                location.href = "/pro_planificacion?action=planclase&silaboid=" + data.ids;
                            } else {
                                $.unblockUI();
                                mensajeWarning(data.mensaje);
                            }
                        }, error: function () {
                            $.unblockUI();
                            {#control.val(0).trigger("change");#}
                            mensajeWarning("Error de conexion.");
                        },
                        dataType: "json"
                    });
                } else {
                    mensajeWarning("Es obligatirio llenar la información de descricripcion de la salida");
                }
            });
            $("#itemspaneleditplanificacionsalida .btn-cerrar").click(function () {
                $("#itemspaneleditplanificacionsalida").modal("hide");
            });
            $(".editplanificacionsemanalsalida").click(function () {
                var id = $(this).attr('ids');
                $.unblockUI();
                $.get("/pro_planificacion", {'action': 'editplanificacion_salida', 'ids': id}, function (data) {
                    if (data.result == 'ok') {
                        $("#itemspaneleditplanificacionsalida").modal({backdrop: 'static', width: '610px'}).modal('show');
                        $("#id_contenido").val(data.descripcion);
                        $("#ids").val(id);
                    }
                }, 'json');
            });
            $("#editplanificacionsalida").click(function () {
                var cont = $("#id_contenido").val();
                if (cont.length > 0) {
                    var id = $("#ids").val();
                    $.ajax({
                        type: "POST",
                        url: "/pro_planificacion",
                        data: {'action': 'editplanificacion_salida', 'ids': id, 'cont': cont},
                        success: function (data) {
                            if (data.result == 'ok') {
                                $.unblockUI();
                                bloqueointerface();
                                $("#itemspanelplanificacionsalida").modal("hide");
                                location.href = "/pro_planificacion?action=planclase&silaboid=" + data.ids;
                            } else {
                                $.unblockUI();
                                mensajeWarning(data.mensaje);
                            }
                        }, error: function () {
                            $.unblockUI();
                            {#control.val(0).trigger("change");#}
                            mensajeWarning("Error de conexion.");
                        },
                        dataType: "json"
                    });
                } else {
                    mensajeWarning("Es obligatirio llenar la información de descricripcion de la salida");
                }
            });
            $("#id_tema").change(function () {
                var id = $(this).val();
                if (id.length > 0) {
                    $("#id_subtema").prop("disabled", false);
                } else {
                    $("#id_subtema").prop("disabled", true);
                }
            });
            $("#itemspaneladicionarsubtemas .btn-cerrar").click(function () {
                $("#itemspaneladicionarsubtemas").modal("hide");
            });
            $(".adicionarsubtemas").click(function () {
                var id = $(this).attr('ids');
                $.unblockUI();
                $.get("/pro_planificacion", {'action': 'adicionar_subtemas', 'ids': id}, function (data) {
                    if (data.results) {
                        $('#id_tema').empty().append('<option value="">---------</option>').val(0).trigger("change");
                        for (elemento in data.listatema) {
                            $('#id_tema').append('<option value="' + data.listatema[elemento][0] + '">' + data.listatema[elemento][1] + '</option>');
                        }
                        $("#itemspaneladicionarsubtemas").modal({backdrop: 'static', width: '610px'}).modal('show');
                        $("#ids").val(id);
                        $(".elementosubtema").remove();
                        for (elemento in data.lista) {
                            $("#contenidosubtemas").append('<tr class="elementosubtema"  id="fila_' + itemsblib + '">' +
                                '<td style="text-align: center ; display:none" class="idtema">' + data.lista[elemento][0] + '</td>' +
                                '<td width="45%" style="text-align: left;" class="tema">' + data.lista[elemento][1] + '</td>' +
                                '<td width="45%" style="text-align: left;" class="subtema">' + data.lista[elemento][2] + '</td>' +
                                '<td style="text-align:center;" width="5%"><a class="btn btn-mini btn-default tu eliminarsubtema" title="Eliminar"><i class="fa fa-trash text-danger"></i> Eminiar</a></td>' +
                                '</tr>');
                            itemsblib += 1;
                            actualizar_lista_subtemas();
                            eliminar__subtemas();
                        }
                    }
                }, 'json');
            });
            $(".addsubtema").click(function () {
                var idt = $("#id_tema").val();
                var tema = $("#id_tema option:selected").text();
                var subtema = $("#id_subtema").val();
                if (subtema.length > 0) {
                    if (leer_lista_subtemas(subtema) == 0) {
                        $("#contenidosubtemas").append('<tr class="elementosubtema"  id="fila_' + itemsblib + '">' +
                            '<td style="text-align: center ; display:none" class="idtema">' + idt + '</td>' +
                            '<td width="45%" style="text-align: left;" class="tema">' + tema + '</td>' +
                            '<td width="45%" style="text-align: left;" class="subtema">' + subtema + '</td>' +
                            '<td style="text-align:center;" width="5%"><a class="btn btn-mini btn-default tu eliminarsubtema" title="Eliminar"><i class="fa fa-trash text-danger"></i> Eminiar</a></td>' +
                            '</tr>');
                        itemsblib += 1;
                        actualizar_lista_subtemas();
                        eliminar__subtemas();
                        $("#adicionarsubtema").prop("disabled", false);
                    } else {
                        mensajeWarning("El subtema ya se encuentra registrado");
                    }
                    document.getElementById('id_subtema').value = '';
                }
            });
            actualizar_lista_subtemas = function () {
                lista_items1 = [];
                $(".elementosubtema").each(function () {
                    var item = {
                        idtema: $(this).find(".idtema").html(),
                        tema: $(this).find(".tema").html(),
                        subtema: $(this).find(".subtema").html()
                    };
                    lista_items1.push(item);
                });
            };
            eliminar__subtemas = function () {
                $(".eliminarsubtema").unbind();
                $(".eliminarsubtema").click(function () {
                    var padre = $(this).parent().parent();
                    padre.remove();
                    actualizar_lista_subtemas();
                });
            };
            $(".btn-adicionarsubtema").click(function () {
                var id = $("#ids").val();
                if (lista_items1.length > 0) {
                    $.ajax({
                        type: "POST",
                        url: "/pro_planificacion",
                        data: {'action': 'addsubtemasadicional', 'ids': id, 'lista': JSON.stringify(lista_items1)},
                        success: function (data) {
                            if (data.result == 'ok') {
                                $.unblockUI();
                                bloqueointerface();
                                $("#itemspaneladicionarsubtemas").modal("hide");
                                location.href = "/pro_planificacion?action=planclase&silaboid=" + data.ids;
                            } else {
                                $.unblockUI();
                                mensajeWarning(data.mensaje);
                            }
                        }, error: function () {
                            $.unblockUI();
                            {#control.val(0).trigger("change");#}
                            mensajeWarning("Error de conexion.");
                        },
                        dataType: "json"
                    });
                } else {
                    $("#itemspaneladicionarsubtemas").modal("hide");
                }
            });
            $("#itemspanelimportar_silabo_periodo .btn-cerrar").click(function () {
                $("#itemspanelimportar_silabo_periodo").modal("hide");
            });
            $(".duplicar_silabo_periodo").click(function () {
                var ids = $(this).attr('ids');
                var semana = $(this).attr('semana');
                var numsemana = $(this).attr('numsemana');
                var fini = $(this).attr('fini');
                var ffin = $(this).attr('ffin');
                $.post("/pro_planificacion", {'action': 'duplicar_silabo_otro_periodo', 'ids': ids, 'semana': semana, 'numsemana': numsemana, 'fini': fini, 'ffin': ffin}, function (data) {
                    if (data.result == 'ok') {
                        $.unblockUI();
                        $(".panelbody").html(data.data);
                        $("#itemspanelimportar_silabo_periodo").modal({backdrop: 'static', width: '750px'}).modal('show');
                    }
                }, 'json');
            });
            $("#desplegar_obj").each(function () {
                obj = desplegar(1, obj, 'desplegar_obj');
            });
            $("#desplegar_enf").each(function () {
                enf = desplegar(2, enf, 'desplegar_enf');
            });
            $("#desplegar_rec").each(function () {
                rec = desplegar(3, rec, 'desplegar_rec');
            });
            $("#desplegar_eva").each(function () {
                eva = desplegar(4, eva, 'desplegar_eva');
            });
            $("#desplegar_evaxcomp").each(function () {
                eva = desplegar(5, eva, 'desplegar_evaxcomp');
            });
            $("#desplegar_obj").click(function () {
                obj = desplegar(1, obj, 'desplegar_obj');
            });
            $("#desplegar_enf").click(function () {
                enf = desplegar(2, enf, 'desplegar_enf');
            });
            $("#desplegar_rec").click(function () {
                rec = desplegar(3, rec, 'desplegar_rec');
            });
            $("#desplegar_eva").click(function () {
                eva = desplegar(4, eva, 'desplegar_eva');
            });

            $("#desplegar_evaxcomp").click(function () {
                eva = desplegar(5, eva, 'desplegar_evaxcomp');
            });
            $(".editobjetivo").change(function () {
                var obj = $(this).val();
                var id = $(this).attr('ids');
                bloqueointerface();
                $.post("/pro_planificacion", {'action': 'editobjetivoacttema', 'id': id, 'obj': obj}, function (data) {
                    if (data.result == 'ok') {
                        $.unblockUI();
                    } else {
                        mensajeWarning(data.mensaje);
                    }
                }, 'json');
            });
            $(".editenfoque").change(function () {
                var enf = $(this).val();
                var id = $(this).attr('ids');
                bloqueointerface();
                $.post("/pro_planificacion", {'action': 'editenfoqueact', 'id': id, 'enf': enf}, function (data) {
                    if (data.result == 'ok') {
                        $.unblockUI();
                    } else {
                        mensajeWarning(data.mensaje);
                    }
                }, 'json');
            });
            $(".editenfoquedos").change(function () {
                var enf = $(this).val();
                var id = $(this).attr('ids');
                bloqueointerface();
                $.post("/pro_planificacion", {'action': 'editenfoqueactdos', 'id': id, 'enf': enf}, function (data) {
                    if (data.result == 'ok') {
                        $.unblockUI();
                    } else {
                        mensajeWarning(data.mensaje);
                    }
                }, 'json');
            });
            $(".editenfoquetres").change(function () {
                var enf = $(this).val();
                var id = $(this).attr('ids');
                bloqueointerface();
                $.post("/pro_planificacion", {'action': 'editenfoqueacttres', 'id': id, 'enf': enf}, function (data) {
                    if (data.result == 'ok') {
                        $.unblockUI();
                    } else {
                        mensajeWarning(data.mensaje);
                    }
                }, 'json');
            });
            $(".editrecurso").change(function () {
                var rec = $(this).val();
                var id = $(this).attr('ids');
                bloqueointerface();
                $.post("/pro_planificacion", {'action': 'editrecursoact', 'id': id, 'rec': rec}, function (data) {
                    if (data.result == 'ok') {
                        $.unblockUI();
                    } else {
                        mensajeWarning(data.mensaje);
                    }
                }, 'json');
            });
            $(".editevaluacion").change(function () {
                var eval = $(this).val();
                var id = $(this).attr('ids');
                bloqueointerface();
                $.post("/pro_planificacion", {'action': 'editevaluacionact', 'id': id, 'eval': eval}, function (data) {
                    if (data.result == 'ok') {
                        $.unblockUI();
                    } else {
                        mensajeWarning(data.mensaje);
                    }
                }, 'json');
            });
            $("#itemspanellink .btn-cerrar").click(function () {
                $("#itemspanellink").modal("hide");
            });
            $(".editrecursolink").click(function () {
                var id = $(this).attr('ids');
                $.post("/pro_planificacion", {'action': 'listarecursolink', 'id': id}, function (data) {
                    if (data.result == 'ok') {
                        $.unblockUI();
                        $(".panelbodylink").html(data.data);
                        $(".itemspanellink").modal({backdrop: 'static', width: '700px'}).modal('show');
                    }
                }, 'json');
            });
            $(".actualizar_horas").click(function () {
                bloqueointerface();
                $.post("/pro_planificacion", {'action': 'actualizar_horas', 'id': {{silabocab.id }}}, function (data) {
                    if (data.result == 'ok') {
                        bloqueointerface();
                        location.href = '/pro_planificacion?action=planclase&silaboid={{ silabocab.id|encrypt }}';
                        $.unblockUI();
                    } else {
                        mensajeWarning("Error al actualizar las horas")
                    }
                }, 'json');
            });
        });
        $(function () {
            conectar_eliminacion = function () {
                var href = $(this).attr('nhref');
                bloqueointerface();
                $.ajax({
                    type: "GET",
                    url: href,
                    success: function (data) {
                        $.unblockUI();
                        if (data.search('"' + 'ajaxdeletedinamicbs' + '"') >= 0) {
                            $("#eliminacionmodal .modal-dialog .modal-content").html(data);
                            $('#eliminacionmodal').modal({'width': '650'}).modal('show');
                        } else {
                            mensajeWarning("Error de conexión.");
                        }
                    },
                    error: function () {
                        $.unblockUI();
                        mensajeWarning("Error de conexión.");
                    },
                    dataType: "html"
                });
            };
            $('.eliminacionmodal').bind('click.conectar_eliminacion', conectar_eliminacion);
        })
    </script>
    <div class="tab-content" id="tabContent">
        <div class="tab-pane fade show active" role="tabpanel" aria-labelledby="table-tab">
            <input type="hidden" name="numsemana"  value="{{ fecha_sel }}">
            {% if not estado_aprobacion.estadoaprobacion == aprobar %}
            <div class="alert alert-info">
                <a href="javascript:;" class="close" data-bs-dismiss="alert">×</a>
                <p class="alert-heading"><i class="fa fa-bell  blinkimg" border=0></i> Para ver al detalle la <b>Planificación mínima de Actividades</b> dar click en el botón
                    <b><a onclick="formModal('{{ silabocab.id|encrypt }}', 'PENDIENTES', 'listadopendientes')" href="javascript:">{% if totalporcentajecumplimiento >= 100 %} Ver cumplimiento {% else %} Ver pendientes{% endif %}</a>.</b>
                </p>
            </div>
            {% endif %}
            {% with semanaadicional=silabocab|args:fecha.1|args:fecha.2|call:'semana_adicional' cronograma_silabo=silabocab|args:fecha.1|args:fecha.2|call:'cronograma_silabo' numero_semana=silabocab|args:fecha.1|args:fecha.2|call:'cronograma_silabo_n_semana' %}
                <h4>
                    {% if semanaadicional %}
                        {% for semana in  semanaadicional %}
                            <strong><i class="fa fa-calendar-check"></i> {{ semana.cronograma.obejetivosemanal }}</strong>
                        {% endfor %}
                    {% else %}
                        {% if cronograma_silabo %}
                            {% for crono in  cronograma_silabo %}
                                <strong><i class="fa fa-calendar-check"></i> {{ crono.obejetivosemanal }} <span class="text-muted">({{ fecha.1|date:"Y-m-d" }} - {{ fecha.2|date:"Y-m-d" }})</span></strong>
                                {% if crono.examen %}
                                    {#                                <span class="label label-default">EXAMEN</span>#}
                                {% endif %}
                            {% endfor %}
                        {% else %}
                            <span class="text-danger">Por favor comuníquese con GTA para verificar cronograma y fechas de la materia.</span><br>
                        {% endif %}
                    {% endif %}
                    {% if fecha.9 > 0 %}
                        <span class="badge badge-info tu" title="Horas Presenciales">Hrs-Pre:{{ fecha.7|floatformat:2 }}</span>
                        <span class="badge badge-success tu" title="Horas Autónomas">Hrs-Aut:{{ fecha.8|floatformat:2 }}</span>
                    {% endif %}
                    {% if fecha.13 > 0 %}
                        <span class="badge badge-default tu" title="Horas Práctica Experimental">Hrs-Ape:{{ fecha.13|floatformat:2 }}</span>
                    {% endif %}
                    {% if fecha.10.numero_mis_guiaspracticas > 0 %}
                        <span class="badge badge-warning tu" title="Numero de practícas de semana">Num-Prac:{{ fecha.10.numero_mis_guiaspracticas }}</span>
                    {% endif %}
                </h4>
                {% if cronograma_silabo %}
                    {% for crono in  cronograma_silabo %}
                        {% if not crono.examen %}
                            <div class='col-lg-12 mb-2' style="text-align: right; float: right">
                                {% if not fecha.9 %}
                                    {% if not silabocab.codigoqr %}
                                        {% if crono.semana != 0 %}
                                            <a class="btn btn-mini btn-success tu" href="/pro_planificacion?action=addsemanaplanificacion&idsilabo={{ silabocab.id|encrypt }}&semana={{ fecha.0|encrypt }}&numsemana={{ crono.semana|encrypt }}&fini={{ fecha.1|date:"Y-m-d" }}&ffin={{ fecha.2|date:"Y-m-d" }}" title="Adicionar"><span class="fa fa-plus"></span> Adicionar</a>
                                            {% if not no_permite_duplicar %}
                                            <a ids="{{ silabocab.id|encrypt }}" semana="{{ fecha.0 }}" numsemana="{{ crono.semana }}" fini="{{ fecha.1|date:"Y-m-d" }}" ffin="{{ fecha.2|date:"Y-m-d" }}" href="javascript:;" class='btn btn-mini btn-form btn-info tu duplicar_silabo_periodo' title="Importar"><i class="fa fa-clone"></i> Importar</a>
                                            {% endif %}
                                        {% endif %}
                                    {% endif %}
                                {% else %}
                                    <a style="margin-top: 10px" class="btn btn-mini btn-secondary tu addplanificacionsalida" href="javascript:;" ids="{{ fecha.9|encrypt }}" data-bs-toggle="tooltip" title="Opción de gira de clase disponible para la carrera de turismo."><span class="fa fa-plus tu"></span> Gira de clase</a>
                                    {% if not silabocab.codigoqr %}
                                        {% if crono.semana != 0 %}
                                            <a style="margin-top: 10px" class="btn btn-mini btn-info tu" href="/pro_planificacion?action=editsemanaplanificacion&ids={{ fecha.9|encrypt }}&fini={{ fecha.1|date:"Y-m-d" }}&ffin={{ fecha.2|date:"Y-m-d" }}&numsemana={{ crono.semana|encrypt }}" title="Editar"><span class="fa fa-edit"></span> Editar</a>
                                        {% endif %}
                                    {% endif %}
                                    {% if pruede_modificar %}
                                        {% with enuso=fecha.10|call:'puede_eliminar' %}
                                            {% with tieneapro=silabocab|call:'tiene_aprobaciones' %}
                                                {% if tieneapro %}
                                                    {% with estadoaprobacion=silabocab|call:'estado_aprobacion' %}
                                                        {% if estadoaprobacion %}
                                                            {% if not estadoaprobacion.estadoaprobacion == aprobar %}
                                                                <a style="margin-top: 10px" class="btn btn-mini btn-default eliminacionmodal tu" href="javascript:;" nhref="/pro_planificacion?action=delsemanasilabo&ids={{ fecha.9|encrypt }}" title="Eliminar"><span class="fa fa-trash text-danger"></span></a>
                                                            {% endif %}
                                                        {% endif %}
                                                    {% endwith %}
                                                {% else %}
                                                    {% if not silabocab.materia.cerrado %}
                                                        <a style="margin-top: 10px" class="btn btn-default btn-mini eliminarsilabosemanal tl" title="Eliminar" href="javascript:;" idcodigosemanal="{{ fecha.9|encrypt }}"><i class="fa fa-trash text-danger"></i></a>
                                                    {% endif %}
                                                {% endif %}
                                            {% endwith %}
                                        {% endwith %}
                                    {% endif %}
                                {% endif %}
                            </div>
                        {% endif %}
                    {% endfor %}
                {% endif %}
                <div class="text-left">
                    {% if fecha.9 > 0 %}
                        {% with temasselec=fecha.10|call:'temas_seleccionados_planclase' enuso=fecha.10|call:'puede_eliminar' %}
                            {% with unidades=fecha.10|call:'unidades_silabosemanal' %}
                                {% for uni in unidades %}
                                    {% with temasselec=fecha.10|args:uni.temaunidadresultadoprogramaanalitico.unidadresultadoprogramaanalitico.id|call:'temas_silabosemanal' %}
                                        <table cellpadding="0" border="0" cellspacing="0" FRAME="void" RULES="rows" width="100%" class="table table-bordered">
                                            <thead>
                                            <tr>
                                                <td colspan="2" style="text-align: justify;">
                                                    <b>&nbsp;UNIDAD {{ uni.temaunidadresultadoprogramaanalitico.unidadresultadoprogramaanalitico.orden }}: {{ uni.temaunidadresultadoprogramaanalitico.unidadresultadoprogramaanalitico.descripcion }}</b>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td style="text-align: center; width: 50%"><strong>TEMAS</strong></td>
                                                <td style="width: 80px;text-align: center; width: 50%"><strong>OBJETIVOS</strong></td>
                                            </tr>
                                            </thead>
                                            <tbody>
                                            {% for temassel in temasselec %}
                                                <tr>
                                                    <td style="text-align: left;">
                                                        <dt style="font-weight: normal;">
                                                            <ul style="margin-left: -32px;">
                                                                <div class="recorretemas" nombresemana={{ temassel.silabosemanal.numsemana }} codtema="{{ temassel.id }}" nomtema="UNIDAD {{ uni.temaunidadresultadoprogramaanalitico.unidadresultadoprogramaanalitico.orden }} - TEMA {{ temassel.temaunidadresultadoprogramaanalitico.orden }}.- {{ temassel.temaunidadresultadoprogramaanalitico.descripcion }}">
                                                                </div>
                                                        <dt style="font-weight: normal;"><b>TEMA: {{ temassel.temaunidadresultadoprogramaanalitico.orden }}.-</b> {{ temassel.temaunidadresultadoprogramaanalitico.descripcion }}</dt>
                                                        <ul>
                                                            {% with subtemasselec=fecha.10|args:temassel.temaunidadresultadoprogramaanalitico|call:'subtemas_silabosemanal' subtemasadicionales=fecha.10|args:temassel.id|call:'subtemas_adicionales' %}
                                                                {% if subtemasselec %}
                                                                    {% for subtemassel in subtemasselec %}
                                                                        <dt style="font-weight: normal;"><b>SUBTEMA: {{ subtemassel.subtemaunidadresultadoprogramaanalitico.orden }}.-</b> {{ subtemassel.subtemaunidadresultadoprogramaanalitico.descripcion }}</dt>
                                                                    {% endfor %}
                                                                {% endif %}
                                                                {% if subtemasadicionales %}
                                                                    {% for suba in subtemasadicionales %}
                                                                        <dt style="font-weight: normal;"><b>SUBTEMA:</b> {{ suba }}</dt>
                                                                    {% endfor %}
                                                                {% endif %}
                                                            {% endwith %}
                                                        </ul>
                                                        </dt>
                                                    </td>
                                                    <td style="text-align: center; width: 250px">
                                                        <textarea class="editobjetivo" ids="{{ temassel.id|encrypt }}" style="width: 95%;" rows="7" {% if silabocab.codigoqr %}disabled{% endif %}>{{ temassel.objetivoaprendizaje|default_if_none:"" }}</textarea>
                                                    </td>
                                                </tr>
                                            {% endfor %}
                                            </tbody>
                                        </table>
                                    {% endwith %}
                                {% endfor %}
                            {% endwith %}
                        {% endwith %}
                    {% endif %}
                </div>
                {% if fecha.9 > 0 %}
                    <ul class="list-group list-group-flush">
                        {% with planificacion_semanal_salida=fecha.10|call:'salidas_planificadas_semanales' %}
                            {% if planificacion_semanal_salida %}
                                <li class="list-group-item px-0 pt-0">
                                    <a class="h4 mt-2 mb-0 d-flex align-items-center text-inherit text-decoration-none active" data-bs-toggle="collapse" href="#girasclasesdiv" aria-expanded="true" aria-controls="courseTwo">
                                        <div class="me-auto">
                                            Giras
                                        </div>
                                        <span class="chevron-arrow ms-4"><i class="fa fa-chevron-down fs-4"></i></span>
                                    </a>
                                    <div class="collapse show" id="girasclasesdiv" data-bs-parent="#girasclasesdiv">
                                        <div class="pt-3 pb-2">
                                            {% for salida in  planificacion_semanal_salida %}
                                                <ul class="list-group">
                                                    <li class="list-group-item d-flex justify-content-between align-items-start pd-1">
                                                        <div class="ms-2 me-auto mt-1">
                                                            {{ salida }}
                                                        </div>
{#                                                        {% if pruede_modificar %}#}
                                                            <a ids="{{ salida.id|encrypt }}" href="javascript:;" class='btn btn-mini editplanificacionsemanalsalida tu' title='Editar salida de clase'><i class="fa fa-edit"></i></a>
                                                            <a nhref="/pro_planificacion?action=delplanificacion_salida&ids={{ salida.id|encrypt }}" href="javascript:;" class='btn btn-mini eliminacionmodal tu' title='Eliminar salida de clase'><i style="color: red" class="fa fa-trash text-danger"></i></a>
{#                                                        {% endif %}#}
                                                    </li>
                                                </ul>
                                            {% endfor %}
                                        </div>
                                    </div>
                                </li>
                            {% endif %}
                        {% endwith %}
                        {% if fecha.9 > 0 %}
                            {% if fecha.4 %}
                                <li class="list-group-item px-0 pt-0">
                                    <a class="h4 mt-2 mb-0 d-flex align-items-center text-inherit text-decoration-none active" data-bs-toggle="collapse" href="#enfoquemetodologico" aria-expanded="true" aria-controls="courseTwo">
                                        <div class="me-auto">
                                            Enfoque Metodológico
                                        </div>
                                        <span class="chevron-arrow ms-4"><i class="fa fa-chevron-down fs-4"></i></span>
                                    </a>
                                    <div class="collapse show" id="enfoquemetodologico" data-bs-parent="#enfoquemetodologico">
                                        <div class="pt-3 pb-1">
                                            {% if not silabocab.codigoqr %}
                                                <div style="float: right;">
                                                    <a ids="{{ fecha.9|encrypt }}" href="javascript:;" class='btn tl editar_enfoque' title='Editar Enfoque Metodológico'><i class="fa fa-edit"></i> Editar</a>
                                                </div>
                                            {% endif %}
                                            <strong>Inicio</strong><br>
                                            {{ fecha.4 }}<br>
                                            <br><strong>Desarrollo</strong><br>
                                            {{ fecha.11|default:"" }}<br>
                                            <br><strong>Cierre</strong><br>
                                            {{ fecha.12|default:"" }}
                                        </div>
                                    </div>
                                </li>
                            {% endif %}
                            <li class="list-group-item px-0 pt-0">
                                <a class="h4 mt-2 mb-0 d-flex align-items-center text-inherit text-decoration-none active" data-bs-toggle="collapse" href="#recursosdidacticos" aria-expanded="true" aria-controls="courseTwo">
                                    <div class="me-auto">
                                        Recursos Didácticos
                                    </div>
                                    <span class="chevron-arrow ms-4"><i class="fa fa-chevron-down fs-4"></i></span>
                                </a>
                                <div class="collapse show" id="recursosdidacticos" data-bs-parent="#recursosdidacticos">
                                    <div class="pt-3 pb-2">
                                        {#                                                            {% if not silabocab.codigoqr %}#}
                                        {#                                                                <div style="float: right;" class="mb-2">#}
                                        {#                                                                    <a ids="{{ fecha.9|encrypt }}" href="javascript:;" class='btn tu editar_recurso' title='Editar Recursos Didácticos'><i class="fa fa-edit"></i> Editar</a>#}
                                        {#                                                                </div>#}
                                        {#                                                            {% endif %}#}
                                        <textarea class="editrecurso" ids="{{ fecha.9|encrypt }}" style="width: 100%" rows="6" {% if silabocab.codigoqr %}disabled{% endif %}>{{ fecha.5 }}</textarea>
                                    </div>
                                </div>
                            </li>
                            <li class="list-group-item px-0 pt-0">
                                <a class="h4 mt-2 mb-0 d-flex align-items-center text-inherit text-decoration-none active" data-bs-toggle="collapse" href="#recursosdidacticoslink" aria-expanded="true" aria-controls="courseTwo">
                                    <div class="me-auto">
                                        Recursos didácticos (Links)
                                    </div>
                                    <span class="chevron-arrow ms-4"><i class="fa fa-chevron-down fs-4"></i></span>
                                </a>
                                <div class="collapse show" id="recursosdidacticoslink" data-bs-parent="#recursosdidacticoslink">
                                    <div class="pt-3 pb-2">
                                        {% if pruede_modificar %}
                                            {% if not silabocab.codigoqr %}
                                                <div style="float: right;" class="mb-2">
                                                    <a ids="{{ fecha.9|encrypt }}" href="javascript:;" class='btn tu editrecursolink' title='Editar Recursos Didácticos Link'><i class="fa fa-edit"></i> Editar</a>
                                                </div><br><br>
                                            {% endif %}
                                        {% endif %}
                                        <ul class="list-group">
                                            {% for link in fecha.10.mis_recursos_didacticos_link %}
                                                <li class="list-group-item d-flex justify-content-between align-items-start pd-1">
                                                    <div class="ms-2 me-auto mt-1">
                                                        <a href="{{ link.link }}" target="_blank"><span class="fa fa-link"></span> {{ link|linebreaksbr }}</a>
                                                    </div>
                                                    {% if not silabocab.codigoqr %}
                                                        <a class="btn btn-mini btn-default eliminacionmodal tu" href="javascript:;"
                                                           title="Eliminar" nhref="/pro_planificacion?action=delrecursolink&ids={{ fecha.9|encrypt }}&id={{ link.id|encrypt }}">
                                                            <i style="color: red" class="fa fa-trash text-danger"></i></a>
                                                    {% endif %}
                                                </li>
                                            {% endfor %}
                                        </ul>
                                    </div>
                                </div>
                            </li>
                            {% with bibliografias=fecha.10|call:'bibliografia_basica' bibcomplementaria=fecha.10|call:'bibliografia_complementaria' librosvirtuales=fecha.10|call:'bibliografia_virtual' listaarticulos=fecha.10|call:'listado_articulo' listalibrosodilo=fecha.10|call:'bibliografia_odilo' %}
                                {% if  bibliografias or bibcomplementaria or librosvirtuales or listalibrosodilo %}
                                    <li class="list-group-item px-0 pt-0">
                                        <a class="h4 mt-2 mb-0 d-flex align-items-center text-inherit text-decoration-none active" data-bs-toggle="collapse" href="#bibbasica" aria-expanded="true" aria-controls="courseTwo">
                                            <div class="me-auto">
                                                Bibliografía Básica
                                            </div>
                                            <span class="chevron-arrow ms-4"><i class="fa fa-chevron-down fs-4"></i></span>
                                        </a>
                                        <div class="collapse show" id="bibbasica" data-bs-parent="#bibbasica">
                                            <div class="pt-3 pb-2">
                                                {% if not silabocab.codigoqr %}
                                                    <div style="float: right;" class="mb-2">
                                                        <a href="/pro_planificacion?action=editbibliografia&ids={{ fecha.9|encrypt }}" href="javascript:;" class='btn tu' title='Editar Bibliografía'><i class="fa fa-edit"></i> Editar</a>
                                                    </div><br><br>
                                                {% endif %}

                                                <ul class="list-group">
                                                    {% for librosbasicos in bibliografias %}
                                                        <li class="list-group-item d-flex justify-content-between align-items-start pd-1">
                                                            {% if librosbasicos.bibliografiaprogramaanaliticoasignatura.odilo %}
                                                                <div class="ms-2 me-auto mt-1">
                                                                    <img style="height: 35px;margin-top: 1px;" src="{{ librosbasicos.bibliografiaprogramaanaliticoasignatura.small }}"  class="img-thumbnail">
                                                                    {{ librosbasicos.bibliografiaprogramaanaliticoasignatura.autor }}, {{ librosbasicos.bibliografiaprogramaanaliticoasignatura.titulo }}, {{ librosbasicos.bibliografiaprogramaanaliticoasignatura.isbm }}<br>
                                                                </div>
                                                                <a target="_blank" href="https://uteca.unemi.edu.ec/info/{{ librosbasicos.bibliografiaprogramaanaliticoasignatura.codigo }}"  class="btn btn-mini btn-default"><i class="fa fa-book"></i> Ver libro</a>
                                                            {% else %}
                                                                <div class="ms-2 me-auto mt-1">
                                                                    <span class="fa fa-bookmark-o"></span> {{ librosbasicos.bibliografiaprogramaanaliticoasignatura.librokohaprogramaanaliticoasignatura }}
                                                                </div>
                                                                {% if not silabocab.codigoqr %}
                                                                    <a class="btn btn-mini eliminacionmodal tu" href="javascript:;"
                                                                       nhref="/pro_planificacion?action=delbibliografiabasica&ids={{ fecha.9|encrypt }}&idb={{ librosbasicos.id|encrypt }}">
                                                                        <i class="fa fa-trash text-danger"></i>
                                                                    </a>
                                                                {% endif %}
                                                            {% endif %}
                                                        </li>
                                                    {% endfor %}
                                                </ul>
                                            </div>
                                        </div>
                                    </li>
                                    <li class="list-group-item px-0 pt-0">
                                        <a class="h4 mt-2 mb-0 d-flex align-items-center text-inherit text-decoration-none active" data-bs-toggle="collapse" href="#bibcomplementaria" aria-expanded="true" aria-controls="courseTwo">
                                            <div class="me-auto">
                                                Bibliografía Complementaria
                                            </div>
                                            <span class="chevron-arrow ms-4"><i class="fa fa-chevron-down fs-4"></i></span>
                                        </a>
                                        <div class="collapse show" id="bibcomplementaria" data-bs-parent="#bibcomplementaria">
                                            <div class="pt-3 pb-2">
                                                {#                                                {% if not silabocab.codigoqr %}#}
                                                <div style="float: right;" class="mb-2">
                                                    <a href="/pro_planificacion?action=editbibliografia&ids={{ fecha.9|encrypt }}" href="javascript:;" class='btn tu' title='Editar Bibliografía'><i class="fa fa-edit"></i> Editar</a>
                                                </div><br><br>
                                                {#                                                {% endif %}#}
                                                <ul class="list-group">
                                                    {% for libroscomplementaria in bibcomplementaria %}
                                                        <li class="list-group-item d-flex justify-content-between align-items-start pd-1">
                                                            <div class="ms-2 me-auto mt-1">
                                                                <span class="fa fa-bookmark-o"></span> {{ libroscomplementaria.librokohaprogramaanaliticoasignatura }}
                                                            </div>
                                                            {% if not silabocab.codigoqr %}
                                                                <a class="btn btn-mini btn-default eliminacionmodal tu" href="javascript:;" nhref="/pro_planificacion?action=delbibliografiacomplementaria&ids={{ fecha.9|encrypt }}&idc={{ libroscomplementaria.id|encrypt }}"><i class="fa fa-trash text-danger"></i></a>
                                                            {% endif %}
                                                        </li>
                                                    {% endfor %}
                                                    {% if listalibrosodilo %}
                                                        {#                                                        <div class="h4 mt-2 mb-0 d-flex align-items-center text-inherit text-decoration-none active">#}
                                                        {#                                                            Libros U-teca#}
                                                        {#                                                        </div>#}
                                                        {% for lodilo in listalibrosodilo %}
                                                            <li class="list-group-item d-flex justify-content-between align-items-start pd-1">
                                                                <div class="ms-2 me-auto mt-1">
                                                                    <img style="height: 35px;margin-top: 1px;" src="{{ lodilo.small }}"  class="img-thumbnail">
                                                                    {{ lodilo.autor }}, {{ lodilo.titulo }}, {{ lodilo.isbm }}<br>

                                                                </div>
                                                                {#                                                                style="background-color:#15CA9A"#}
                                                                <a target="_blank" href="https://uteca.unemi.edu.ec/info/{{ lodilo.codigo }}"  class="btn btn-mini btn-default"><i class="fa fa-book"></i> Ver libro</a>
                                                                {#                                                                {% if not silabocab.codigoqr %}#}
                                                                <a class="btn btn-mini btn-default eliminacionmodal tu" href="javascript:;" nhref="/pro_planificacion?action=dellibrosodilo&ids={{ fecha.9|encrypt }}&idc={{ lodilo.id|encrypt }}"><i class="fa fa-trash text-danger"></i></a>
                                                                {#                                                                {% endif %}#}
                                                            </li>
                                                        {% endfor %}
                                                    {% endif %}
                                                    {% for bvirtual in librosvirtuales %}
                                                        <li class="list-group-item d-flex justify-content-between align-items-start pd-1">
                                                            <div class="ms-2 me-auto mt-1">
                                                                <span class="fa fa-bookmark-o"></span> {{ bvirtual.bibliografia|linebreaksbr }}
                                                            </div>
                                                            {% if pruede_modificar %}
                                                                <td style="width: 15px">
                                                                    {% with tieneapro=silabocab|call:'tiene_aprobaciones' %}
                                                                        {% if tieneapro %}
                                                                            {% with estadoaprobacion=silabocab|call:'estado_aprobacion' %}
                                                                                {% if estadoaprobacion %}
                                                                                    {% if not estadoaprobacion.estadoaprobacion == aprobar %}
                                                                                        <a class="btn btn-mini eliminacionmodal tu" href="javascript:;" nhref="/pro_planificacion?action=delbibliografiavirtual&ids={{ fecha.9|encrypt }}&idv={{ bvirtual.id|encrypt }}"><i class="fa fa-trash text-danger"></i></a>
                                                                                    {% endif %}
                                                                                {% endif %}
                                                                            {% endwith %}
                                                                        {% else %}
                                                                            <a class="btn btn-mini eliminacionmodal tu" href="javascript:;" nhref="/pro_planificacion?action=delbibliografiavirtual&ids={{ fecha.9|encrypt }}&idv={{ bvirtual.id|encrypt }}"><i class="fa fa-trash text-danger"></i></a>
                                                                        {% endif %}
                                                                    {% endwith %}
                                                                </td>
                                                            {% endif %}
                                                        </li>
                                                    {% endfor %}
                                                    {% if listaarticulos %}
                                                        {% for lart in listaarticulos %}
                                                            <li class="list-group-item d-flex justify-content-between align-items-start pd-1">
                                                                <div class="ms-2 me-auto mt-1">
                                                                    <span class="fa fa-bookmark-o"></span>  {{ lart.articulo.nombre }}
                                                                </div>
                                                                {% if lart.articulo.enlace %}
                                                                    <a target="_blank" href="{{ lart.articulo.enlace }}"  class="btn btn-mini btn-default"><i class="fa fa-link"></i> Ver artículo</a>
                                                                {% endif %}
                                                            </li>
                                                        {% endfor %}
                                                    {% endif %}
                                                </ul>
                                            </div>
                                        </div>
                                    </li>
                                {% endif %}
                            {% endwith %}
                            <li class="list-group-item px-0 pt-0">
                                <a class="h4 mt-2 mb-0 d-flex align-items-center text-inherit text-decoration-none active" data-bs-toggle="collapse" href="#evaluacion" aria-expanded="true" aria-controls="courseTwo">
                                    <div class="me-auto">
                                        Evaluación
                                    </div>
                                    <span class="chevron-arrow ms-4"><i class="fa fa-chevron-down fs-4"></i></span>
                                </a>
                                <div class="collapse show" id="evaluacion" data-bs-parent="#evaluacion">
                                    <div class="pt-3 pb-2">
                                        {% if not silabocab.codigoqr %}
                                            {% if pruede_modificar %}
                                                <div style="float: right;" class="mb-2">
                                                    <a ids="{{ fecha.9|encrypt }}" href="javascript:;" class='btn adicionar_evaluacioncomp'><i class="fa fa-plus"></i> Adicionar</a>
                                                </div>
                                            {% endif %}
                                        {% endif %}
                                        <table style="font-size: 12px" class='table table-bordered'>
                                            <thead>
                                            <tr>
                                                <th class="text-center">TIPO</th>
                                                <th class="text-center">ACTIVIDAD</th>
                                                <th class="text-center">ACCIONES</th>
                                            </tr>
                                            </thead>
                                            <tbody id="itemsbodycomponente{{ fecha.9 }}">
                                            {% for componente in fecha.10.eval_componente %}
                                                <tr id="componente{{ fecha.9 }}_{{ componente.id }}">
                                                    <td class="text-center">{{ componente.evaluacionaprendizaje.get_tipoevaluacion_display }}</td>
                                                    <td class="text-center">{{ componente.evaluacionaprendizaje.descripcion }} {{ componente.numactividad }}</td>
                                                    <td class="text-center">
                                                        <a href="javascript:void(0)" class="btn btn-warning btn-mini mostrar_temasevaluacion" idcodsemanal="{{ fecha.9 }}" codcomp="{{ componente.id }}"><i class="fa fa-list"></i> Ver temas</a>
                                                        {% if not silabocab.codigoqr %}
                                                            <a href="javascript:void(0)" class="btn btn-mini eliminarcomponente" idcodsemanal="{{ fecha.9 }}" codcomp="{{ componente.id }}"><i class="fa fa-trash text-danger"></i></a>
                                                        {% endif %}
                                                    </td>
                                                </tr>
                                            {% empty %}
                                                <tr>
                                                    <td colspan="3" class="text-center">Sin registros</td>
                                                </tr>
                                            {% endfor %}
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </li>
                        {% endif %}
                    </ul>
                {% else %}
                    <center>
                        <h4 class="text-danger"><i class="fa fa-warning"></i> Sin Planificar</h4>
                    </center>
                {% endif %}
            {% endwith %}
        </div>
    </div>
</div>