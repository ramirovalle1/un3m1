{% load sga_extras %}
<!DOCTYPE html>
<html lang="es" data-location="UNEMI">

<head>
    {#NOTIFICACIONES WEB#}
    {% if request.user.is_authenticated and permiteWebPush %}
        <meta name="vapid-key" content="{{ vapid_key }}">
        <meta name="islogged" content="{{ request.user.username }}">
        <meta name="uslog" content="
                {% if request.session.user_anterior %}{{ request.session.user_anterior }}{% else %}false{% endif %}">
        {% load pwa %}
        {% progressive_web_app_meta_i %}
    {% endif %}
    {#NOTIFICACIONES WEB#}
    <meta charset="utf-8">
    <title>{% block pagetitle %}{{ title }}{% endblock %}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="UNEMI">
    <meta name="description" content="Sistema de Gestión Academica"/>
    <meta name="keywords" content="Universidad Estatal de Milagro, Unemi, Sga, Sistema Gestión Academica"/>
    {#    <link href="/static/fonts/feather/feather.css" rel="stylesheet">#}
    <link rel="shortcut icon" type="image/x-icon" href="/static/logos/sgaplus_phone.svg?v={{ version_static|default_if_none:'0.1' }}">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" rel="stylesheet"/>
    <link href="/static/bootstrap5/libs/dragula/dist/dragula.min.css?v={{ version_static|default_if_none:'0.1' }}" rel="stylesheet"/>
    <link href="/static/bootstrap5/libs/%40mdi/font/css/materialdesignicons.min.css?v={{ version_static|default_if_none:'0.1' }}" rel="stylesheet"/>
    {#    <link href="/static/bootstrap5/libs/dropzone/dist/dropzone.css?v={{ version_static|default_if_none:'0.1' }}" rel="stylesheet"/>#}
    {#    <link href="/static/bootstrap5/libs/magnific-popup/dist/magnific-popup.css?v={{ version_static|default_if_none:'0.1' }}" rel="stylesheet"/>#}
    {#    <link href="/static/bootstrap5/libs/bootstrap-select/dist/css/bootstrap-select.min.css?v={{ version_static|default_if_none:'0.1' }}" rel="stylesheet">#}
    {#    <link href="/static/bootstrap5/libs/%40yaireo/tagify/dist/tagify.css?v={{ version_static|default_if_none:'0.1' }}" rel="stylesheet">#}
    <link href="/static/bootstrap5/libs/datatables.net-bs5/css/dataTables.bootstrap5.min.css?v={{ version_static|default_if_none:'0.1' }}" rel="stylesheet">
    {#    <link href="/static/bootstrap5/libs/prismjs/themes/prism-okaidia.min.css?v={{ version_static|default_if_none:'0.1' }}" rel="stylesheet">#}
    {#    <link href="/static/bootstrap5/libs/simplebar/dist/simplebar.min.css?v={{ version_static|default_if_none:'0.1' }}" rel="stylesheet">#}
    {#    <link href="/static/bootstrap5/libs/nouislider/dist/nouislider.min.css?v={{ version_static|default_if_none:'0.1' }}" rel="stylesheet">#}
    {#    <link href="/static/bootstrap5/libs/glightbox/dist/css/glightbox.min.css?v={{ version_static|default_if_none:'0.1' }}" rel="stylesheet">#}
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/static/bootstrap5/css/theme.min.css?v={{ version_static|default_if_none:'0.2' }}">
    <link rel="stylesheet" href="/static/bootstrap5/css/style.css?v={{ version_static|default_if_none:'0.5' }}">
{#    <link href="/static/bootstrap5/libs/bootstrap-icons/font/bootstrap-icons.css?v={{ version_static|default_if_none:'0.1' }}" rel="stylesheet"/>#}
    <link href="/static/bootstrap5/bootstrap-responsive.css?v={{ version_static|default_if_none:'0.1' }}" rel="stylesheet"/>
    <link rel="stylesheet" href="/static/bootstrap5/fonts/robotofont.css?v={{ version_static|default_if_none:'0.1' }}">
    <script src="/static/bootstrap5/libs/jquery/dist/jquery.min.js?v={{ version_static|default_if_none:'0.1' }}"></script>
    <script type='text/javascript' src="/static/bootstrap5/js/jquery.blockUI.js?v={{ version_static|default_if_none:'0.1' }}"></script>
    <link href="/static/picons-thin/style.css?v={{ version_static|default_if_none:'0.1' }}" rel="stylesheet">
    <link rel="stylesheet" href="/static/animate/animate.css?v={{ version_static|default_if_none:'0.1' }}">
    <script type="text/javascript" src='/static/js/fontawesomev3.js?v={{ version_static|default_if_none:'0.1' }}'></script>
    {#LIBRERIAS BASEOLD#}
    <script src="/static/js/moment/moment.min.js?v={{ version_static|default_if_none:'0.1' }}" type="text/javascript"></script>
    <link rel="stylesheet" href="/static/bootstrap4/plugins/daterangepicker/daterangepicker.css?v={{ version_static|default_if_none:'0.1' }}">
    <script src="/static/bootstrap4/plugins/daterangepicker/daterangepicker.js?v={{ version_static|default_if_none:'0.1' }}"></script>
    <script type="text/javascript">
        jQuery.browser = {};
        (function () {
            jQuery.browser.msie = false;
            jQuery.browser.version = 0;
            if (navigator.userAgent.match(/MSIE ([0-9]+)\./)) {
                jQuery.browser.msie = true;
                jQuery.browser.version = RegExp.$1;
            }
        })();
        localStorage.setItem("request_path", '{{ request.path }}');
    </script>
    <script type='text/javascript' src="/static/js/jquery.maskedinput.min.js?v={{ version_static|default_if_none:'0.1' }}"></script>
    <script type='text/javascript' src="/static/js/sysend.js?v={{ version_static|default_if_none:'0.1' }}"></script>
    <script type='text/javascript' src="/static/js/smoke.js?v={{ version_static|default_if_none:'0.1' }}"></script>
    <link href="/static/sweet2/sweetalert2.css?v={{ version_static|default_if_none:'0.1' }}" rel="stylesheet"/>
    <script src="/static/sweet2/sweetalert2.js?v={{ version_static|default_if_none:'0.1' }}"></script>
    <script type="text/javascript" src="/static/js/select2.js?v={{ version_static|default_if_none:'0.1' }}"></script>
    <link type="text/css" rel="stylesheet" href="/static/css/select2.css?v={{ version_static|default_if_none:'0.1' }}">
    <style>
        .select2-container--open .select2-dropdown {
            z-index: 1070;
        }
    </style>
    <script type="text/javascript" src="/static/js/snow.js?v={{ version_static|default_if_none:'0.1' }}"></script>
    {#    {% if not request.path in "'/adm_areaspolideportivo', '/adm_solicitudpago', '/pro_solicitudpago','/dir_cronograma', '/adm_planpractica', '/adm_convenioempresa', '/alu_practicaspro', '/adm_ingresoacta', '/alu_justificacionsufragio', '/pro_justificacionsufragio', '/adm_padronelectoral', '/alu_practicaspreprofesionalesinscripcion', '/alu_convalidacionpractica', '/alu_finanzas', '/pro_cronograma', '/adm_solicitudbalcon', /adm_evento', /alu_eventos', '/alu_solicitudbalcon', '/adm_balconservicios', '/adm_gedcevaluacion', '/adm_solicitudpermisossistemas', '/alu_solicitudcambiocarrera', '/pro_tutoria', '/alu_solicitudtutor'" or  request.path == '/' %}#}
    {#        <link rel="stylesheet" href="/static/css/jquery.fancybox.css?v=2.1.4" type="text/css" media="screen"/>#}
    {#        <script type="text/javascript" src="/static/js/jquery.fancybox.pack.js?v=2.1.4"></script>#}
    {#    {% else %}#}
    {#        <link rel="stylesheet" href="/static/fancybox/css/core.css"/>#}
    {#        <script src="/static/fancybox/js/core.js"></script>#}
    <link rel="stylesheet" href="/static/fancyboxv4/fancybox.css?v={{ version_static|default_if_none:'0.1' }}"/>
    <link rel="stylesheet" href="/static/fancyboxv4/panzoom.css?v={{ version_static|default_if_none:'0.1' }}"/>
    <script src="/static/fancyboxv4/fancybox.umd.js?v={{ version_static|default_if_none:'0.1' }}"></script>
    {#    {% endif %}#}
    {#LIBRERIAS BASEOLD#}
    <script type="text/javascript">
        function formModalReport(id, text, action, tiporeporte, idreporte, dimension, footer = true) {
            bloqueointerface()
            $('.panelbody-firma').empty()
            $('#footermodal-firma').show();
            $.ajax({
                type: "GET",
                url: `{{ request.path }}`,
                data: {
                    'action': action,
                    'id': id,
                    'reporte': idreporte,
                    'tipos': tiporeporte,
                },
                success: function (data) {
                    $.unblockUI();
                    if (dimension) {
                        $('#wmodal-firma').removeClass('modal-lg modal-sm modal-xl modal-md modal-fullscreen').addClass(dimension)
                    }
                    if (data.result === true) {
                        if (footer === true) {
                            $('#footermodal-firma').hide();
                        }
                        $('.panelbody-firma').html(data.data);
                        $('#modalfirmaelectronida .paneltitle-firma').html(text.toUpperCase());
                        $("#modalfirmaelectronida").modal({backdrop: 'static'}).modal('show');
                    } else {
                        mensajeDanger(data.message);
                    }
                },
                error: function () {
                    $.unblockUI();
                    mensajeDanger("Error de conexión.");
                },
                dataType: "json"
            });
        }

        function MenuFijo() {
            var altura = $('.caja-menu').offset().top;
            $(window).on('scroll', function () {
                if ($(window).scrollTop() > altura) {
                    $('.caja-menu').addClass('caja-menu-flotante');
                } else {
                    $('.caja-menu').removeClass('caja-menu-flotante');
                }
            })
        }

        function soloNumeros(e) {
            var key = window.Event ? e.which : e.keyCode
            return (key >= 48 && key <= 57)
        }


        window.RTCPeerConnection = window.RTCPeerConnection || window.mozRTCPeerConnection || window.webkitRTCPeerConnection;   //compatibility for firefox and chrome
        var modalposition = 0;
        var mensaje = '';
        var capippriva = ''

        function converToAscii(str) {
            return str.normalize("NFD").replace(/[\u0300-\u036f]/g, "").toUpperCase();
        }

        $(function () {
            $('#buscarPeriodo').keyup(function () {
                _this = this;
                $.each($(".listaPeriodosMenu li"), function () {
                    if (converToAscii($(this).text().toLowerCase()).indexOf(converToAscii($(_this).val().toLowerCase())) === -1)
                        $(this).hide();
                    else
                        $(this).show();
                });
            });

            if (!('contains' in String.prototype)) {
                String.prototype.contains = function (str, startIndex) {
                    return -1 !== String.prototype.indexOf.call(this, str, startIndex);
                };
            }

            $("*").focusin(function () {
                $('.datepicker').css({"display": "none"});
            });

            showWaiting = function (titulo, mensaje, close) {
                var panel = $("#waitpanel");
                $("#waitpaneltitle").html(titulo);
                $("#waitpanelbody").html(mensaje);
                if (!close) {
                    panel.modal({keyboard: false, backdrop: 'static'});
                }
                panel.modal("show");
            };

            hideWaiting = function () {
                $("#waitpanel").modal("hide");
            };

            sinurlatrasbutton = function () {
                if (location.pathname == '/') {
                    $("#urlatrasbutton").remove();
                } else {
                    $("#idbuscador").remove();
                }
            };

            deshabilitar = function (nombre) {
                $(nombre).attr({"disabled": "disabled"});
            };

            habilitar = function (nombre) {
                $(nombre).removeAttr("disabled").removeAttr("readonly");
            };

            // Funcion de redondeo que reemplaza a la funcion math.round() de javascript por fallos al redondear
            redondeo = function (numero, presicion) {
                var multiplicador = Math.pow(10, presicion + 1);
                var num_multi = Math.floor(numero * multiplicador);
                var num_redondeado = (Math.round(num_multi / 10)) * 10 / multiplicador;

                if (num_redondeado == 0) {
                    return 0;
                } else {
                    if (!isNaN(num_redondeado))
                        return num_redondeado;
                    else
                        return 0;
                }
            };


            openwindow_reporte = function (url, width, height) {
                newwindow = window.open(url, 'name', 'height=' + height + ' ,width=' + width);
            };

            openwindow = function (verb, url, data, target) {
                var form = document.createElement("form");
                form.action = url;
                form.method = verb;
                form.target = target || "_self";
                if (data) {
                    for (var key in data) {
                        var input = document.createElement("textarea");
                        input.name = key;
                        input.value = typeof data[key] === "object" ? JSON.stringify(data[key]) : data[key];
                        form.appendChild(input);
                    }
                    var csrf = document.createElement("input");
                    csrf.name = 'csrfmiddlewaretoken';
                    csrf.value = '{{ csrf_token }}';
                    form.appendChild(csrf);
                }
                form.style.display = 'none';
                document.body.appendChild(form);
                form.submit();
            };

            fechavalida = function (elemento) {
                var valor = elemento.val().toString();
                //Validate dd/mm/yyyy or dd-mm-yyyy format
                var dateformat = /^(0?[1-9]|[12][0-9]|3[01])[\/\-](0?[1-9]|1[012])[\/\-]\d{4}$/;
                // Match the date format through regular expression
                if (valor.match(dateformat)) {
                    //Test which seperator is used '/' or '-'
                    var opera1 = valor.split('/');
                    var opera2 = valor.split('-');
                    lopera1 = opera1.length;
                    lopera2 = opera2.length;
                    // Extract the string into month, date and year
                    if (lopera1 > 1) {
                        var pdate = valor.split('/');
                    } else if (lopera2 > 1) {
                        var pdate = valor.split('-');
                    }
                    var dd = parseInt(pdate[0]);
                    var mm = parseInt(pdate[1]);
                    var yy = parseInt(pdate[2]);
                    // Create list of days of a month [assume there is no leap year by default]
                    var ListofDays = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];
                    if (mm == 1 || mm > 2) {
                        if (dd > ListofDays[mm - 1]) {
                            //alert('Invalid date format!');
                            elemento.val(fechaactual());
                            return;
                        }
                    }
                    if (mm == 2) {
                        var lyear = false;
                        if ((!(yy % 4) && yy % 100) || !(yy % 400)) {
                            lyear = true;
                        }
                        if ((lyear == false) && (dd >= 29)) {
                            //alert('Invalid date format!');
                            elemento.val(fechaactual());
                            return;
                        }
                        if ((lyear == true) && (dd > 29)) {
                            //alert('Invalid date format!');
                            elemento.val(fechaactual());
                            return;
                        }
                    }
                } else {
                    //alert("Invalid date format!");
                    elemento.val(fechaactual());
                    return;
                }
                //return;
            };

            fechaactual = function () {
                var d = new Date();
                var month = d.getMonth() + 1;
                var day = d.getDate();
                var fecha = (day < 10 ? '0' : '') + day + '-' + (month < 10 ? '0' : '') + month + '-' + d.getFullYear();
                return fecha;
            };

            numerico = function (elemento, min, max, decimales) {
                var nvalor;
                var valor = elemento.val();
                if (valor == "") {
                    valor = parseFloat(0).toFixed(decimales);
                    elemento.val(valor);
                    return;
                }
                if (isNaN(valor)) {
                    nvalor = parseFloat(min).toFixed(decimales);
                    elemento.val(nvalor);
                    return;
                }
                if (valor < min) {
                    nvalor = parseFloat(min).toFixed(decimales);
                    elemento.val(nvalor);
                    return;
                }
                if (max > 0 && valor > max) {
                    nvalor = parseFloat(max).toFixed(decimales);
                    elemento.val(nvalor);
                    return;
                }
                nvalor = parseFloat(valor).toFixed(decimales);
                elemento.val(nvalor);
            };

            digitos = function (elemento) {
                var valor = elemento.val();
                if (valor == "") {
                    elemento.val("");
                    return;
                }
                if (isNaN(valor)) {
                    elemento.val("");
                    return;
                } else if (valor.indexOf("-") != -1 || valor.indexOf(".") != -1 || valor.indexOf(",") != -1) {
                    elemento.val("");
                    return;
                } else {
                    elemento.val(valor.trim());
                }
            };

            validacionesnumericas = function () {
                $(".validarnumero").blur(function () {
                    numerico($(this), 0, 0, 0);
                });

                $(".validarmoneda").blur(function () {
                    numerico($(this), 0, 0, 2);
                });
            };

            sinurlatrasbutton();

            $(".listaperiodos").click(function () {
                $("#periodospanel").modal("show");
            });

            $("#cerrarperiodospanel").click(function () {
                $("#periodospanel").modal("hide");
            });

            cerrar_viewhtml = function () {
                $("#viewhtml").modal("hide");
            };

            $("#seleccionarperiodospanel").click(function () {
                var pid = $("#periodoselectorall").val();
                $("#periodospanel").modal("hide");
                bloqueointerface();
                $.ajax({
                    type: "POST",
                    url: "/",
                    data: {'action': 'periodo', 'id': pid},
                    success: function (data) {
                        if (data.result == 'ok') {
                            location.href = location.pathname;
                        } else {
                            $.unblockUI();
                            mensajeWarning("Error al cambiar de periodo");
                        }
                    },
                    error: function () {
                        $.unblockUI();
                        mensajeWarning("Error al cambiar de periodo");
                    },
                    dataType: "json"
                });
            });

            {% if chequear_correo %}
                chequearemial = function () {
                    $.ajax({
                        type: "POST",
                        url: "/api",
                        data: {'a': 'checkmail'},
                        success: function (data) {
                            if (data.result == 'ok') {
                                if (data.mensajes) {
                                    $("#checkmailicon").removeClass("hidden").show();
                                } else {
                                    $("#checkmailicon").addClass("hidden").hide();
                                }
                            }
                        },
                        dataType: "json"
                    });
                };

                setInterval(chequearemial, 60000);
            {% endif %}

            sleep = function (milliseconds) {
                var start = new Date().getTime();
                for (var i = 0; i < 1e7; i++) {
                    if ((new Date().getTime() - start) > milliseconds) {
                        break;
                    }
                }
            };

            {#            {% if persona and check_session %}#}
            {#                chequearsesion = function () {#}
            {#                    $.ajax({#}
            {#                        type: "POST",#}
            {#                        url: "/api",#}
            {#                        data: {'a': 'checksession'},#}
            {#                        success: function (data) {#}
            {#                            if (data.result == 'ok') {#}
            {#                                if (data.nuevasesion) {#}
            {#                                    bloqueointerface();#}
            {#                                    location.href = '/logout';#}
            {#                                }#}
            {#                            }#}
            {#                        },#}
            {#                        dataType: "json"#}
            {#                    });#}
            {#                };#}
            {##}
            {#                setInterval(chequearsesion, 60000);#}
            {#            {% endif %}#}

            bloqueointerface_old = function () {
                if (!$(".blockUI").length) {
                    $.blockUI({
                        message: $('#throbber'),
                        css: {
                            'border': '1px solid',
                            'border-radius': '10px',
                            'left': '46%',
                            'width': '120px',
                            'padding': '15px',
                            '-webkit-border-radius': '10px',
                            '-moz-border-radius': '10px',
                            opacity: .6,
                            color: '#000'
                        }
                    });
                }
            };

{#            {% if DIA_CANCER_MAMA_19_OCTUBRE %}#}
{#                bloqueointerface = function () {#}
{#                    if (!$(".blockUI").length) {#}
{#                        $.blockUI({#}
{#                            message: '<span class="spinner-grow spinner-border-lg" role="status" aria-hidden="true" style="width: 10rem; height: 10rem; background-color: #FFABD6 ; color: #FFABD6 ; !important"</span>',#}
{#                            css: {#}
{#                                backgroundColor: 'transparent',#}
{#                                border: '0',#}
{#                                zIndex: 9999999#}
{#                            },#}
{#                            overlayCSS: {#}
{#                                backgroundColor: '#fff',#}
{#                                opacity: 0.8,#}
{#                                zIndex: 9999990#}
{#                            }#}
{#                        });#}
{#                    }#}
{#                };#}
{#            {% else %}#}
                bloqueointerface_old2 = function () {
                    if (!$(".blockUI").length) {
                        $.blockUI({
                            message: '<span class="spinner-grow spinner-border-lg" role="status" aria-hidden="true" style="width: 10rem; height: 10rem; background-color: #F8C471 ; color: #F8C471 ; !important"</span>',
                            css: {
                                backgroundColor: 'transparent',
                                border: '0',
                                zIndex: 9999999
                            },
                            overlayCSS: {
                                backgroundColor: '#fff',
                                opacity: 0.8,
                                zIndex: 9999990
                            }
                        });
                    }
                };
{#            {% endif %}#}

            bloqueointerface = function () {
                if (!$(".blockUI").length) {
                    $.blockUI({
                        message: $('#throbber'),
                        css: {
                            backgroundColor: 'transparent',
                            border: '0',
                            zIndex: 9999999
                        },
                        overlayCSS: {
                            backgroundColor: '#fff',
                            opacity: 0.8,
                            zIndex: 9999990
                        }
                    });
                }
            };

            {% if persona %}
                var check_logout;

                logout = function () {
                    bloqueointerface();
                    localStorage.clear();
                    $.ajax({
                        type: "POST",
                        url: "/api",
                        data: {'a': 'logout'},
                        success: function (data) {
                            if (data.result == 'ok') {
                                location.href = data.url;
                            } else {
                                logout();
                            }
                        },
                        error: function () {
                            logout();
                        },
                        dataType: "json"
                    });
                };

                $('.logoutuser').click(function () {
                    logout();
                });

                window.onload = function () {
                    sysend.on('sga', function (obj) {
                        if (obj.message == 'check') {
                            if (window.name.length > 0) {
                                localStorage.setItem('windowid', window.name);
                                sysend.broadcast('sga', {message: 'set'});
                            }
                        }
                        if (obj.message == 'set') {
                            if (window.name.length == 0) {
                                var windowid = localStorage.getItem('windowid');
                                localStorage.removeItem('windowid');
                                $.unblockUI();
                                if (windowid) {
                                    window.name = windowid;
                                    clearInterval(check_logout);
                                }
                            }
                        }
                    });

                    {#var sessionid = localStorage.getItem('sessionid');#}
                    {#if (sessionid) {#}
                    {#    if (window.name != sessionid) {#}
                    {#        $.blockUI({message: null});#}
                    {#        sysend.broadcast('sga', {message: 'check'});#}
                    {#        check_logout = setInterval(logout, 1000);#}
                    {#    }#}
                    {# } else {#}
                    {#    bloqueointerface();#}
                    {#    logout();#}
                    {# }#}
                };
            {% endif %}

            serverdate = new Date({{ currenttime.year }}, {{ currenttime.month }}-1, {{ currenttime.day }}, {{ currenttime.hour }}, {{ currenttime.minute }}, {{ currenttime.second }}, 0);
            clientdate = new Date();

            showTime = function () {
                var m;
                var today = new Date();
                var timediff = today - clientdate;
                var renderdate = new Date(serverdate.getTime() + timediff);
                var h = renderdate.getHours();
                var mer = " AM";
                if (h > 12) {
                    mer = " PM";
                    h -= 12;
                }
                m = renderdate.getMinutes();
                m = checkTime(m);
                $("#clock").text(h + ":" + m + mer);
            };

            checkTime = function (i) {
                if (i < 10) {
                    i = "0" + i;
                }
                return i;
            };

            setInterval(showTime, 15000);

            showTime();

            $('.dropdown-toggle').dropdown();
            {#$(".collapse").collapse();#}
            $('.tips').tooltip({});

            $(".periodoselector").click(function () {
                var pid = $(this).attr('pid');
                bloqueointerface();
                $.ajax({
                    type: "POST",
                    url: "/",
                    data: {'action': 'periodo', 'id': pid},
                    success: function (data) {
                        if (data.result == 'ok') {
                            location.href = location.pathname;
                        } else {
                            $.unblockUI();
                            mensajeWarning("Error al cambiar de periodo");
                        }
                    },
                    error: function () {
                        $.unblockUI();
                        mensajeWarning("Error al cambiar de periodo");
                    },
                    dataType: "json"
                });
            });

            $("#id_email, #id_emailinst, #id_correoinstasoc, #id_correoinst").css({'text-transform': 'none'});

            $("table tbody tr").hover(function () {
                $(this).addClass("info");
            }, function () {
                $(this).removeClass("info");
            });

            $(".btn-form").click(function () {
                bloqueointerface();
            });

            $(".bloqueo_pantalla").click(function () {
                bloqueointerface();
            });

            if (typeof String.prototype.startsWith != 'function') {
                String.prototype.startsWith = function (str) {
                    return this.indexOf(str) == 0;
                };
            }

            if (typeof String.prototype.endsWith != 'function') {
                String.prototype.endsWith = function (str) {
                    return this.slice(-str.length) == str;
                };
            }

            abrir_reporte = function () {
                var href = $(this).attr('nhref');
                var tipos = $(this).attr('tipos');
                if (!tipos) {
                    tipos = "pdf, xls, csv, doc";
                }
                if (tipos.contains("pdf")) {
                    $("#formatopdf").removeAttr("hidden");
                } else {
                    $("#formatopdf").attr({"hidden": "hidden"});
                }
                if (tipos.contains("doc")) {
                    $("#formatodoc").removeAttr("hidden");
                } else {
                    $("#formatodoc").attr({"hidden": "hidden"});
                }
                if (tipos.contains("xls")) {
                    $("#formatoxls").removeAttr("hidden");
                } else {
                    $("#formatoxls").attr({"hidden": "hidden"});
                }
                if (tipos.contains("csv")) {
                    $("#formatocsv").removeAttr("hidden");
                } else {
                    $("#formatocsv").attr({"hidden": "hidden"});
                }
                if (tipos.length > 4) {
                    primero = $("#formatoreporte_formato").find("option:first").val();
                    $("#formatoreporte_formato").val(primero);
                    $('#formatoreporte').modal('show');
                    $('#formatoreporte_run').attr('nhref', href);
                } else {
                    primero = $("#formatoreporte_formato").find("option:first").val();
                    $("#formatoreporte_formato").val(primero);
                    ejecutar_reporte_directo(href);

                }

            };

            cerrar_reporte = function () {
                $('#formatoreporte').modal('hide');
            };

            ejecutar_reporte_directo = function (ruta) {
                var href = ruta;
                $('#formatoreporte').modal('hide');
                var formato = $('#formatoreporte_formato').val();
                var formato_final = '';
                if (formato == 0) {
                    formato_final = '&rt=pdf';
                } else if (formato == 1) {
                    formato_final = '&rt=docx';
                } else if (formato == 2) {
                    formato_final = '&rt=xlsx';
                } else if (formato == 3) {
                    formato_final = '&rt=csv';
                }
                bloqueointerface();
                var report_url = href + formato_final;
                $.ajax({
                    type: "POST",
                    url: report_url,
                    success: function (data) {
                        $.unblockUI();
                        if (data.result == 'ok') {
                            if (formato == 0) {
                                openwindow_reporte(location.origin + data.reportfile, 800, 500);
                            } else {
                                location.href = location.origin + data.reportfile;
                            }
                        } else {
                            mensajeWarning("Error al generar el reporte");
                        }
                    },
                    error: function () {
                        $.unblockUI();
                        mensajeWarning("Error al generar el reporte");
                    },
                    dataType: "json"
                });
            };

            ejecutar_reporte = function () {
                var href = $(this).attr('nhref');
                $('#formatoreporte').modal('hide');
                var formato = $('#formatoreporte_formato').val();
                var formato_final = '';
                if (formato == 0) {
                    formato_final = '&rt=pdf';
                } else if (formato == 1) {
                    formato_final = '&rt=docx';
                } else if (formato == 2) {
                    formato_final = '&rt=xlsx';
                } else if (formato == 3) {
                    formato_final = '&rt=csv';
                }
                bloqueointerface();
                var report_url = href + formato_final;
                {#alert(report_url);#}
                $.ajax({
                    type: "POST",
                    url: report_url,
                    success: function (data) {
                        $.unblockUI();
                        if (data.result == 'ok') {
                            if (formato == 0) {
                                openwindow_reporte(location.origin + data.reportfile, 800, 500);
                            } else {
                                location.href = location.origin + data.reportfile;
                            }
                        } else {
                            mensajeWarning("Error al generar el reporte");
                        }
                    },
                    error: function () {
                        $.unblockUI();
                        mensajeWarning("Error al generar el reporte");
                    },
                    dataType: "json"
                });
            };

            {% if mensj or info %}
                Swal.fire({
                    toast: false,
                    position: 'center',
                    icon: "error",
                    type: 'error',
                    title: mensaje,
                    html: `{{ mensj }}{{ info }}`,
                    showConfirmButton: true
                });
            {% endif %}

            conectar_confirmacion = function () {
                var href = $(this).attr('nhref');
                bloqueointerface();
                $.ajax({
                    type: "GET",
                    url: href,
                    success: function (data) {
                        $.unblockUI();
                        if (data.search('"' + 'ajaxconfirmaciondinamicbs' + '"') >= 0) {
                            $("#confirmacionmodal .modal-dialog .modal-content").html(data);
                            $('#confirmacionmodal').modal({'width': '650'}).modal('show');
                            {#Se agregó para que se cierre el offcanvas con las opciones cuando se muestra el modal y no se superpongan#}
                            let close_offcamvas = document.getElementById("close-offcanvas");
                            close_offcamvas.click();

                        } else {
                            mensajeWarning("Error de conexión.");
                        }
                    },
                    error: function () {
                        $.unblockUI();
                        mensajeWarning("Error de conexión.");
                    },
                    dataType: "html"
                });
            };

            conectar_eliminacion = function () {
                var href = $(this).attr('nhref');
                bloqueointerface();
                $.ajax({
                    type: "GET",
                    url: href,
                    success: function (data) {
                        $.unblockUI();
                        if (data.search('"' + 'ajaxdeletedinamicbs' + '"') >= 0) {
                            $("#eliminacionmodal .modal-dialog .modal-content").html(data);
                            $('#eliminacionmodal').modal({'width': '650'}).modal('show');
                            {#Se agregó para que se cierre el offcanvas con las opciones cuando se muestra el modal y no se superpongan#}
                            let close_offcamvas = document.getElementById("close-offcanvas");
                            close_offcamvas.click();
                        } else {
                            mensajeWarning("Error de conexión.");
                        }
                    },
                    error: function () {
                        $.unblockUI();
                        mensajeWarning("Error de conexión.");
                    },
                    dataType: "html"
                });
            };

            conectar_viewhtml = function () {
                var href = $(this).attr('nhref');
                bloqueointerface();
                $.ajax({
                    type: "GET",
                    url: href,
                    success: function (data) {
                        $.unblockUI();
                        if (data.search('"' + 'ajaxconfirmaciondinamicbs' + '"') >= 0) {
                            $("#viewhtml .modal-dialog .modal-content").html(data);
                            $('#viewhtml').modal({'width': '650'}).modal('show');
                            $('.cerrarviewhtml').bind('click.cerrar_viewhtml', cerrar_viewhtml);
                        } else {
                            mensajeWarning("Error de conexión.");
                        }
                    },
                    error: function () {
                        $.unblockUI();
                        mensajeWarning("Error de conexión.");
                    },
                    dataType: "html"
                });
            };


            $('.confirmacionmodal').bind('click.conectar_confirmacion', conectar_confirmacion);
            $('.viewhtml').bind('click.conectar_viewhtml', conectar_viewhtml);
            $('.eliminacionmodal').bind('click.conectar_eliminacion', conectar_eliminacion);
            $(".reportedirecto").bind("click.conectar_reporte", abrir_reporte);
            $("#formatoreporte_run").bind("click.ejecutar_reporte", ejecutar_reporte);
            $("#formatoreporte_close").bind("click.cerrar_reporte", cerrar_reporte);

            conectar_reporte = function () {
                $(".reportedirecto").unbind("click.conectar_reporte");
                $(".reportedirecto").bind("click.conectar_reporte", abrir_reporte);
            };

            tooltips = function () {
                $(".tl").tooltip({placement: "left"});
                $(".tr").tooltip({placement: "right"});
                $(".tu").tooltip({placement: "top"});
                $(".tb").tooltip({placement: "bottom"});
            };

            tooltips();

            $('.selectorfecha').keypress(function () {
                return false;
            });

            history.pushState(null, null, location.href);
            window.addEventListener('popstate', function (event) {
                history.pushState(null, null, location.href);
            });

            actualizarnumerico = function () {
                $('.imp-number[decimal], .imp-moneda[decimal], .imp-numbersmall[decimal], .imp-numbermed-right[decimal], .imp-numbermed-center[decimal], .nota[decimal]').each(function () {
                    numerico($(this), 0, 0, $(this).attr('decimal'));
                })
            };

            escapeHTMLEncode = function (str) {
                var div = document.createElement('div');
                var text = document.createTextNode(str);
                div.appendChild(text);
                return div.innerHTML;
            };

            actualizarnumerico();

            $('.imp-number, .imp-moneda, .imp-numbersmall, .imp-numbermed-right, .imp-numbermed-center, .nota').focus(function () {
                if (!parseFloat($(this).val())) {
                    $(this).val("");
                }
            });

            $('.selectorfecha').keypress(function () {
                return false;
            });

            tipo_formulario = function (elemento) {
                if (elemento.attr('formtype') == 'form-vertical') {
                    elemento.find(".control-label").css({'float': 'none'});
                    elemento.find(".label-text").css({'text-align': 'left'});
                    elemento.find(".control-label").each(function () {
                        var contenedor = parseFloat($(this).parent().css('width')) - 5;
                        $(this).css({'width': contenedor.toString() + 'px'});
                    });
                    elemento.find(".control").each(function () {
                        var contenedor = parseFloat($(this).parent().css('width')) - 5;
                        $(this).css({'width': contenedor.toString() + 'px'});
                    });

                } else {
                    elemento.find(".control-label").css({'float': 'left'});
                    elemento.find(".label-text").css({'text-align': 'right'});
                    if (elemento.hasClass('form-modal')) {
                        elemento.find(".control-group").each(function () {
                            var contenedor = parseFloat($(this).parent().width());
                            var porciento = (parseFloat($(this).width()) / 100);
                            var tam = parseInt(contenedor * porciento);
                            $(this).css({'width': tam});
                        });
                    }
                    elemento.find(".control-label").each(function () {
                        if ($(this).attr('labelwidth')) {
                            $(this).css({'width': $(this).attr('labelwidth')});
                        } else {
                            $(this).css({'width': '160px'});
                        }
                    });
                    elemento.find(".control").each(function () {
                        var contenedor = $(this).parent().width();
                        var label = parseFloat($(this).parent().find('.control-label').width());
                        $(this).css({'width': ((contenedor - label) - 20).toString() + 'px'});
                    });
                }
                elemento.find(".select2").css({'width': '100%'});
            };
            pop_lista = function (arr, item) {
                for (var i = arr.length; i--;) {
                    if (arr[i] === item) {
                        arr.splice(i, 1);
                    }
                }
            };


            $('.viewNotification_b').click(function () {
                var id = $(this).attr('id');
                var _href = $(this).attr('_href');
                bloqueointerface();
                $.ajax({
                    type: "POST",
                    url: "/notificacion",
                    data: {'action': 'ViewedNotification', 'id': id},
                    success: function (data) {
                        $.unblockUI();
                        if (data.result == 'ok') {
                            window.open(_href, '_blank');
                            location.reload()
                        } else {
                            mensajeWarning(data.mensaje);
                        }
                    },
                    error: function () {
                        $.unblockUI();
                        mensajeWarning("Error de conexión.");
                    },
                    dataType: "json"
                });
            });


            /*$('.button').on('click', function() {
                $.ajax({
                    url: 'adm_tasks/',
                    data: { action: 'loadType', type: $(this).data('type') },
                    method: 'POST',
                })
                .done((res) => {
                    getStatus(res.task_id);
                })
                .fail((err) => {
                    console.log(err);
                });
            });*/

        });

        /*function getStatus(taskID) {
            $.ajax({
                url: 'adm_tasks/${taskID}/',
                method: 'GET'
                })
            .done((res) => {
                const html ='<tr><td>${res.task_id}</td><td>${res.task_status}</td> <td>${res.task_result}</td> </tr>'
                $('#tasks').prepend(html);

                const taskStatus = res.task_status;

                if (taskStatus === 'SUCCESS' || taskStatus === 'FAILURE') return false;
                setTimeout(function() {
                    getStatus(res.task_id);
                }, 1000);
            })
            .fail((err) => {
                console.log(err)
            });
        }*/


        //aqui entra
        function getCookie(name) {
            var cookieValue = null;
            if (document.cookie && document.cookie !== '') {
                var cookies = document.cookie.split(';');
                for (var i = 0; i < cookies.length; i++) {
                    var cookie = jQuery.trim(cookies[i]);
                    // Does this cookie string begin with the name we want?
                    if (cookie.substring(0, name.length + 1) === (name + '=')) {
                        cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                        break;
                    }
                }
            }
            return cookieValue;
        }

        var csrftoken = getCookie('csrftoken');

        function csrfSafeMethod(method) {
            return (/^(GET|HEAD|OPTIONS|TRACE)$/.test(method));
        }

        $.ajaxSetup({
            beforeSend: function (xhr, settings) {
                if (!csrfSafeMethod(settings.type) && !this.crossDomain) {
                    xhr.setRequestHeader("X-CSRFToken", csrftoken);
                }
            }
        });

        $(function () {
            {% if messages %}
                {% for message in messages %}
                    console.log(`{{ message }}`)
                    Swal.fire({
                        toast: true,
                        position: 'top-end',
                        type: '{% if message.tags %}{{ message.tags }}{% endif %}',
                        title: `{{ message }}`,
                        showConfirmButton: false,
                        timer: 17000
                    })
                    var swal2Content = document.querySelector('.swal2-content');
                    swal2Content.remove();
                {% endfor %}
            {% endif %}
        })
    </script>
    <style>
        .divScroll {
            height: 350px;

            overflow: scroll;
        }

        .scrollbar-dusty-grass::-webkit-scrollbar-track {
            -webkit-box-shadow: inset 0 0 6px rgba(0, 0, 0, 0.1);
            background-color: #F5F5F5;
            border-radius: 10px;
        }

        .scrollbar-dusty-grass::-webkit-scrollbar {
            width: 12px;
            background-color: #F5F5F5;
        }

        .scrollbar-dusty-grass::-webkit-scrollbar-thumb {
            border-radius: 10px;
            -webkit-box-shadow: inset 0 0 6px rgba(0, 0, 0, 0.1);
            background-image: -webkit-linear-gradient(330deg, #d4fc79 0%, #96e6a1 100%);
            background-image: linear-gradient(120deg, #d4fc79 0%, #96e6a1 100%);
        }


        .square::-webkit-scrollbar-track {
            border-radius: 0 !important;
        }

        .square::-webkit-scrollbar-thumb {
            border-radius: 0 !important;
        }

        .thin::-webkit-scrollbar {
            width: 10px;
        }


        .table_striped tbody tr:nth-child(even), .table_striped tbody tr:nth-child(even) {background-color: #e7eef5;}

        .table_striped tbody tr:nth-child(odd), .table_striped tbody tr:nth-child(odd) {background-color: #f2f6fb;}

        .table_striped thead th, .table_striped thead td, .table_striped tbody th, .table_striped tbody td {border-right: 1px solid white;}

        .table_striped thead th:nth-child(1), .table_striped thead th:nth-child(2), .table_striped thead td:nth-child(1), .table_striped thead td:nth-child(2), .table_striped tbody td:nth-child(1), .table_striped tbody td:nth-child(2), .table_striped tbody th:nth-child(1), .table_striped tbody th:nth-child(2) {border-right: none;}

        {#.table_striped thead th:nth-child(2), .table_striped thead td:nth-child(2) {padding-left: 15px}#}
        .table_striped tbody th:nth-child(2), .table_striped tbody td:nth-child(2) {color:#000;}

        {#.table_striped a.btn {padding-bottom: 0.5rem !important;padding-top: 0.5rem !important;font-weight: bold}#}
        .table_striped a.btn {padding-bottom: 0.5rem !important;padding-top: 0.5rem !important;}

        .table_striped a.btn .fa {font-size: 9px;margin-right: 3px}

        .table_striped thead th {text-align: center;color: #1e121e;font-size: 13px;vertical-align: middle;text-transform: uppercase;}

        .table_primary th {
            color: #122436;
        }

        .table_primary thead th {background-color: #abcae6}

        .table_primary thead th:first-child, .table_primary thead td:first-child {border-left: 5px solid #1c3247}

        .table_primary tbody th, .table_primary tbody td {font-size: 13px;vertical-align: middle !important}

        .table_warning thead th {background-color: #f9ebd6;}

        .table_warning thead th:first-child, .table_warning thead td:first-child {border-left: 5px solid #fe9900}

        .table_warning tbody th, .table_warning tbody td {font-size: 13px;vertical-align: middle !important}

        .table_danger thead th {background-color: #FADBD8;}

        .table_danger thead th:first-child, .table_danger thead td:first-child {border-left: 5px solid #E74C3C}

        .table_danger tbody th, .table_danger tbody td {font-size: 13px;vertical-align: middle !important}

        .table_success thead th {background-color: #D0ECE7;}

        .table_success thead th:first-child, .table_success thead td:first-child {border-left: 5px solid #73C6B6}

        .table_success tbody th, .table_success tbody td {font-size: 13px;vertical-align: middle !important}

        .table_white thead th {background-color: white;}

        .table_white thead th:first-child, .table_white thead td:first-child {border-left: 5px solid #white}

        .table_white tbody th, .table_white tbody td {font-size: 13px;vertical-align: middle !important}


    </style>
    <link rel="stylesheet" href="/static/jgrowl/jgrowl.css?v={{ version_static|default_if_none:'0.1' }}" type="text/css"/>
    <script type="text/javascript" src="/static/jgrowl/jgrowl.min.js?v={{ version_static|default_if_none:'0.1' }}"></script>
    {#    <div id="throbber" style="display:none; margin: 0 auto; width: 100px; height: 100px; background-color: #ffffff">#}
    {#        <img src="/static/images/tigrillo_loader.gif"/>#}
    {#    </div>#}
    <div id="throbber" style="display: none">
        <center>
            <img src="/static/images/TIGRILLO_LOAD_3.gif" style=" margin: -110px;opacity: 0.5;"/>
        </center>
    </div>
    <script>
        {#bloqueointerface = function () {#}
        {#    if (!$("#loading").is(':visible')) {#}
        {#        if (!$(".blockUI").length) {#}
        {#            $.blockUI({#}
        {#                message: $('#throbber'),#}
        {#                css: {#}
        {#                    'border': '1px solid',#}
        {#                    'border-radius': '10px',#}
        {#                    'left': '45%',#}
        {#                    'width': '140px',#}
        {#                    'height': '140px',#}
        {#                    'padding': '15px',#}
        {#                    '-webkit-border-radius': '10px',#}
        {#                    '-moz-border-radius': '10px',#}
        {#                    opacity: .6,#}
        {#                    color: '#000'#}
        {#                }#}
        {#            });#}
        {#        }#}
        {#    }#}
        {# };#}
    </script>
    <script type="text/javascript">

        NotificationJG = {
            success: function (msg, header/*=undefined*/, ttime/*=5000*/) {
                alertaSuccess(msg)
            },
            error: function (msg, header/*=undefined*/, ttime/*=5000*/) {
                alertaDanger(msg)
            },
            warning: function (msg, header/*=undefined*/, ttime/*=5000*/) {
                alertaWarning(msg)
            },
            info: function (msg, header/*=undefined*/, ttime/*=5000*/) {
                alertaInfo(msg)
            }
        };

        Confirm = {
            question: function (question, fun_yes/*=null*/, fun_no/*=null*/) {
                var $popup = $('#modalConfirm');

                $popup.modal({backdrop: 'static', keyboard: false}).modal('show');

                $('.modal-body p', $popup).html(question);

                $('.action_yes', $popup).off('click').on('click', function () {
                    if (typeof fun_yes != 'undefined') {
                        fun_yes();
                    }
                    $popup.modal('hide');
                });

                $('.action_not', $popup).off('click').on('click', function () {
                    if (typeof fun_no != 'undefined') {
                        fun_no();
                    }
                    $popup.modal('hide');
                });
            },
            ajax: function (aData, fun_yes/*=null*/, fun_no/*=null*/) {
                var d = {"action": "deleteView"}
                $.each(aData, function (index, value) {
                    d[index] = value
                });
                aData = d
                bloqueointerface();
                var $popup = $('#modalConfirmAjax');
                $.ajax({
                    type: "GET",
                    url: "/data",
                    data: aData,
                    success: function (data) {
                        if (data.result == 'ok') {
                            $('.modal-body', $popup).html(data.html);
                            var h = $(window).height() - 350;
                            $popup.modal({backdrop: 'static', keyboard: false, width: "60%", height: h}).modal('show');
                            $('.action_yes', $popup).off('click').on('click', function () {
                                if (typeof fun_yes != 'undefined') {
                                    fun_yes();
                                }
                                $popup.modal('hide');
                            });

                            $('.action_not', $popup).off('click').on('click', function () {
                                if (typeof fun_no != 'undefined') {
                                    fun_no();
                                }
                                $popup.modal('hide');
                            });
                        } else {
                            NotificationJG.error(data.mensaje);
                        }
                        $.unblockUI();
                    },
                    error: function () {
                        $.unblockUI();
                        NotificationJG.error("Error al enviar los datos.");
                    },
                    dataType: "json",
                });
            },

        };

        $(function () {
            $(document).ready(function () {

                {#                {% if persona.tiene_notificaciones.sga and tipoentrada == 'SGA' %}#}
                {#                    var num_notificaciones = {{ persona.num_notificaciones.sga }}#}
                {#                    {% if persona.num_notificaciones.sga > 1 %}#}
                {#                        var msg = `Tiene ${num_notificaciones} notificaciones`;#}
                {#                    {% else %}#}
                {#                        var msg = `Tiene ${num_notificaciones} notificación`;#}
                {#                    {% endif %}#}
                {#                    NotificationJG.info(msg, "SGA");#}
                {#                {% endif %}#}
                {#                {% if persona.tiene_notificaciones.sagest and tipoentrada == 'SAGEST'%}#}
                {#                    var num_notificaciones = {{ persona.num_notificaciones.sagest }}#}
                {#                    {% if persona.num_notificaciones.sagest > 1 %}#}
                {#                        var msg = `Tiene ${num_notificaciones} notificaciones`;#}
                {#                    {% else %}#}
                {#                        var msg = `Tiene ${num_notificaciones} notificación`;#}
                {#                    {% endif %}#}
                {#                    NotificationJG.info(msg, "SAGEST");#}
                {#                {% endif %}#}
                {##}
                {#                {% for notificacion in  notificaciones %}#}
                {#                    {% if notificacion.type == 'error' %}#}
                {#                        NotificationJG.error("{{ notificacion.body  }}", "{{ notificacion.title }}");#}
                {#                    {% endif %}#}
                {#                    {% if notificacion.type == 'succes' %}#}
                {#                        NotificationJG.success("{{ notificacion.body  }}", "{{ notificacion.title }}");#}
                {#                    {% endif %}#}
                {#                    {% if notificacion.type == 'warning' %}#}
                {#                        NotificationJG.warning("{{ notificacion.body  }}", "{{ notificacion.title }}");#}
                {#                    {% endif %}#}
                {#                    {% if notificacion.type == 'info' %}#}
                {#                        NotificationJG.info("{{ notificacion.body  }}", "{{ notificacion.title }}");#}
                {#                    {% endif %}#}
                {#                {% endfor %}#}

                $(".viewProfile").click(function () {
                    var panelProfile = $(".panelProfile");
                    if (panelProfile.css('display') == 'none') {
                        // Acción si el elemento no es visible
                        panelProfile.css('display', 'block');
                    } else {
                        // Acción si el elemento es visible
                        panelProfile.css('display', 'none');
                    }
                });

                $(".viewPeriodosAcademicos").click(function () {
                    var panelPeriodosAcademicos = $(".panelPeriodosAcademicos");
                    if (panelPeriodosAcademicos.css('display') == 'none') {
                        // Acción si el elemento no es visible
                        panelPeriodosAcademicos.css('display', 'block');
                        //panelProfile.addClass('has_active');
                    } else {
                        // Acción si el elemento es visible
                        panelPeriodosAcademicos.css('display', 'none');
                    }
                });

                $(document).on("click", function (e) {
                    var panelProfile = $(".panelProfile");
                    var viewProfile = $(".viewProfile");
                    var viewPeriodosAcademicos = $(".viewPeriodosAcademicos");
                    var panelPeriodosAcademicos = $(".panelPeriodosAcademicos");
                    if (!panelProfile.is(e.target) && panelProfile.has(e.target).length === 0 && !viewProfile.is(e.target) && viewProfile.has(e.target).length === 0) {
                        if (panelProfile.css('display') == 'block') {
                            //Acción si el elemento no es visible
                            panelProfile.css('display', 'none');
                        }
                    }

                    if (!panelPeriodosAcademicos.is(e.target) && panelPeriodosAcademicos.has(e.target).length === 0 && !viewPeriodosAcademicos.is(e.target) && viewPeriodosAcademicos.has(e.target).length === 0) {
                        if (panelPeriodosAcademicos.css('display') == 'block') {
                            //Acción si el elemento no es visible
                            panelPeriodosAcademicos.css('display', 'none');
                        }
                    }

                });

                $('.action_info_menu_admin').popover({
                    placement: 'left',
                    html: true,
                    trigger: 'hover',
                    delay: {
                        show: "1",
                        hide: "100"
                    }
                }).on('shown.bs.popover', function () {
                    setTimeout(function () {
                        $('.action_info_menu_admin').popover('hide');
                    }, 1000);
                });

            });
        });

    </script>

    <script src='/static/fullcalendar-6.1.4/dist/index.global.js?v={{ version_static|default_if_none:'0.1' }}'></script>
    {% block heading %}{% endblock %}
</head>

<body>
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="check-circle-fill" fill="currentColor" viewBox="0 0 16 16">
    <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zm-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-.01-1.05z"/>
  </symbol>
  <symbol id="info-fill" fill="currentColor" viewBox="0 0 16 16">
    <path d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16zm.93-9.412-1 4.705c-.07.34.029.533.304.533.194 0 .487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703 0-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381 2.29-.287zM8 5.5a1 1 0 1 1 0-2 1 1 0 0 1 0 2z"/>
  </symbol>
  <symbol id="exclamation-triangle-fill" fill="currentColor" viewBox="0 0 16 16">
    <path d="M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995A.905.905 0 0 1 8 5zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"/>
  </symbol>
</svg>
{#NAVBAR#}
<nav class="navbar navbar-expand-lg navbar-dark bg-sga navbar-fixed-top">
    <div class="container px-0">
        <a class="navbar-brand" href="/">
            {% if tipoentrada == 'SGA' %}
{#                {% if DIA_CANCER_MAMA_19_OCTUBRE %}#}
{#                    <img src='/static/logos/LOGO_SGA_BLANCO.svg' style="height: 40px;"/>#}
{#                {% else %}#}
                    <img src="/static/logos/sgaplus_white.svg" alt="" style="height: 40px;"/>
{#                {% endif %}#}
            {% elif tipoentrada == 'SAGEST' %}
{#                {% if DIA_CANCER_MAMA_19_OCTUBRE %}#}
{#                    <img src='/static/logos/LOGO_SAGEST_BLANCO.png' style="height: 40px;"/>#}
{#                {% else %}#}
                    <img src='/static/logos/sagestplus_white.svg' style="height: 40px;"/>
{#                {% endif %}#}
            {% elif tipoentrada == 'POSGRADO' %}
                <img src="/static/logos/login_posgrado_blanco.png" alt="" style="height: 40px;"/>
                {#                <span style="vertical-align: middle;"><span#}
                {#                        style="font-weight: bold; font-size: 20px;">{{ tipoentrada }}</span> | Sistema de Admisión Posgrado</span>#}
            {% elif tipoentrada == 'POSTULACIONPOSGRADO' %}
                <span style="vertical-align: middle;"><span style="font-weight: bold; font-size: 20px;">POSGRADO</span> | Sistema de Selección Docentes Posgrado</span>
            {% endif %}
        </a>
        <ul class="navbar-nav navbar-right-wrap ms-auto d-flex nav-top-wrap" style="margin-top: 6px">
            {% if not tipoentrada == 'SAGEST' %}
                {% if periodo %}
                    <li class="dropdown ms-2">
                        <a class="hidden-phone hidden-tablet btn-link-periodos d-none d-md-block d-lg-block"
                           href="javascript:void(0);" role="button" id="panelPeriodosAcademicos"
                           style="font-size: 12px !important; text-decoration: none; padding:13px 7px 10px 7px;"
                           data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            {{ periodo.tipo }} {{ periodo.nombre }}
                        </a>
                        {% if periodos|length > 0 %}
                            <a class="hidden-desktop btn btn-light btn-icon rounded-circle text-muted"
                               href="javascript:void(0);" style="margin-top: 2px; width: 41px; height: 40px;"
                               role="button" id="panelPeriodosAcademicos" data-bs-toggle="dropdown" aria-haspopup="true"
                               aria-expanded="false">
                                <i class="fa fa-filter" style="margin-top: 10px;"></i>
                            </a>

                            <div class="dropdown-menu dropdown-menu-end dropdown-menu-xs"  aria-labelledby="panelPeriodosAcademicos">
                                <div class="mx-5 mb-3">
                                    <input type="search" id="buscarPeriodo" autocomplete="off" class="form-control px-3 rounded-pill"
                                           style="font-family:Arial, FontAwesome;"
                                           placeholder=" &#xF002 Buscar periodo académico">

                                </div>
                                <ul class="listaPeriodosMenu list-group list-group-flush" data-simplebar>
                                    {% for periodo2 in periodos %}
                                        <li class="list-group-item items-periodos_lista p-0 px-3 m-0">
                                            <div class="row my-2">
                                                <div class="col">
                                                    <a class="text-body periodoselector" href='javascript:void(0);'
                                                       pid='{{ periodo2.id|encrypt }}'>
                                                        <div class="d-flex">
                                                            <div class="ms-3" style="">
                                                                <p class="text-body">{{ periodo2 }}</p>
                                                            </div>
                                                        </div>
                                                    </a>
                                                </div>
                                                <div class="col-auto text-center me-2">
                                                    <a href="javascript:void(0);" style=""
                                                       class="badge-dot {% if periodo2.id == periodo.id %}bg-warning{% else %}bg-secondary{% endif %}"
                                                       data-bs-toggle="tooltip" data-bs-placement="top"
                                                       {% if periodo2.id == periodo.id %}title="Periodo Actual"{% endif %}>
                                                    </a>
                                                </div>
                                            </div>
                                        </li>
                                    {% endfor %}
                                </ul>
                                <div class="border-top px-3 pt-3 pb-0 text-center">
                                    <a href="javascript:void(0);" onclick="openModalperiodos()" class="text-link fw-semi-bold">
                                        <i class="fa fa-calendar"></i> Ver todos los periodos
                                    </a>
                                </div>
                            </div>
                        {% endif %}
                    </li>
                {% endif %}
            {% endif %}
             {% if totnotificationasesor %}
                <li class="dropdown ms-2">
                    <a class="btn-icon {% if totnotificationasesor > 0 %}rounded-circle indicator indicator-primary{% endif %} text-muted"
                       href="#" role="button" id="panelNotificacionesUsuarioAsesor" data-bs-toggle="dropdown" aria-haspopup="true"
                       aria-expanded="false">
                        <i class="fa fa-bell {% if totnotificationasesor > 0 %}text-white{% else %}text-white{% endif %}"></i>
                    </a>
                    <div class="dropdown-menu dropdown-menu-end dropdown-menu-xs"
                         aria-labelledby="panelNotificacionesUsuarioAsesor">
                        <ul class="listaNotiMenu list-group list-group-flush" data-simplebar
                            {% if not listnotificationasesor %}style="height: 236px !important;"{% endif %}>
                            {% for notificacion in listnotificationasesor %}
                                <li class="list-group-item" style="padding: 0px 27px; !important;">
                                    <div class="row">
                                        <div class="col">
                                            <a _href="{{ notificacion.url }}" href="javascript:void(0)"
                                               id="{{ notificacion.id }}" class="viewNotification_b">
                                                <div class="d-flex">
                                                    {% if notificacion.tipo == 1 %}
                                                        <img src="/static/logos/noti_mensaje.svg" style="width: 30px">
                                                    {% elif notificacion.tipo == 2 %}
                                                        {% if notificacion.en_proceso %}
                                                            <img src="/static/logos/noti_proceso.svg" style="width: 30px">
                                                        {% elif notificacion.error %}
                                                            <img src="/static/logos/noti_error.svg" style="width: 30px">
                                                        {% else %}
                                                            <img src="/static/logos/noti_fin.svg" style="width: 30px">
                                                        {% endif %}
                                                    {% elif notificacion.tipo == 3 %}
                                                        <img src="/static/logos/noti_info.svg" style="width: 30px">
                                                    {% endif %}
                                                    <div class="ms-3">
                                                        <span class="text-body">{{ notificacion.titulo }}</span><br>
                                                        <span class="text-muted">
                                                        <i class="fa fa-calendar me-1"></i> hace {{ notificacion.diasingresado }} dias                                        </span>
                                                    </div>
                                                </div>
                                            </a>
                                        </div>
                                    </div>
                                </li>
                                {% empty %}
                                <li class="list-group-item">
                                    <div class="row">
                                        <div class="col">
                                            <a class="text-body" href="#">
                                                <div class="ms-3" style="text-align: center">
                                                    <img src="/static/logos/notificacion.svg" style="width: 150px">
                                                    <p class="mb-3" style="color: #7C7C7C">Actualmente no tiene nuevas
                                                        notificaciones</p>
                                                </div>
                                            </a>
                                        </div>
                                    </div>
                                </li>
                            {% endfor %}
                        </ul>

                        <div class="border-top px-3 pt-3 pb-0 text-center">
                            <a href="/notificacion" class="text-link fw-semi-bold">
                                <i class="fa fa-bell"></i> Ver mis notificaciones
                            </a>
                        </div>
                    </div>
                </li>
            {% endif %}
            {% if totnotification %}
                <li class="dropdown ms-2">
                    <a class="btn-icon {% if totnotification > 0 %}rounded-circle indicator indicator-primary{% endif %} text-muted"
                       href="#" role="button" id="panelNotificacionesUsuario" data-bs-toggle="dropdown" aria-haspopup="true"
                       aria-expanded="false">
                        <i class="fa fa-bell {% if totnotification > 0 %}text-warning{% else %}text-white{% endif %}"></i>
                    </a>
                    <div class="dropdown-menu dropdown-menu-end dropdown-menu-xs"
                         aria-labelledby="panelNotificacionesUsuario">
                        <ul class="listaNotiMenu list-group list-group-flush" data-simplebar
                            {% if not listnotification %}style="height: 236px !important;"{% endif %}>
                            {% for notificacion in listnotification %}
                                <li class="list-group-item" style="padding: 0px 27px; !important;">
                                    <div class="row">
                                        <div class="col">
                                            <a _href="{{ notificacion.url }}" href="javascript:void(0)"
                                               id="{{ notificacion.id }}" class="viewNotification_b">
                                                <div class="d-flex">
                                                    {% if notificacion.tipo == 1 %}
                                                        <img src="/static/logos/noti_mensaje.svg" style="width: 30px">
                                                    {% elif notificacion.tipo == 2 %}
                                                        {% if notificacion.en_proceso %}
                                                            <img src="/static/logos/noti_proceso.svg" style="width: 30px">
                                                        {% elif notificacion.error %}
                                                            <img src="/static/logos/noti_error.svg" style="width: 30px">
                                                        {% else %}
                                                            <img src="/static/logos/noti_fin.svg" style="width: 30px">
                                                        {% endif %}
                                                    {% elif notificacion.tipo == 3 %}
                                                        <img src="/static/logos/noti_info.svg" style="width: 30px">
                                                    {% endif %}
                                                    <div class="ms-3">
                                                        <span class="text-body">{{ notificacion.titulo }}</span><br>
                                                        <span class="text-muted">
                                                        <i class="fa fa-calendar me-1"></i> hace {{ notificacion.diasingresado }} dias                                        </span>
                                                    </div>
                                                </div>
                                            </a>
                                        </div>
                                    </div>
                                </li>
                                {% empty %}
                                <li class="list-group-item">
                                    <div class="row">
                                        <div class="col">
                                            <a class="text-body" href="#">
                                                <div class="ms-3" style="text-align: center">
                                                    <img src="/static/logos/notificacion.svg" style="width: 150px">
                                                    <p class="mb-3" style="color: #7C7C7C">Actualmente no tiene nuevas
                                                        notificaciones</p>
                                                </div>
                                            </a>
                                        </div>
                                    </div>
                                </li>
                            {% endfor %}
                        </ul>

                        <div class="border-top px-3 pt-3 pb-0 text-center">
                            <a href="/notificacion" class="text-link fw-semi-bold">
                                <i class="fa fa-bell"></i> Ver mis notificaciones
                            </a>
                        </div>
                    </div>
                </li>
            {% endif %}
            {% if persona %}
                <li class="dropdown ms-2">
                    <a class="rounded-circle" href="#" role="button" id="panelPerfilUsuario" data-bs-toggle="dropdown"
                       aria-expanded="false">
                        <div class="avatar avatar-md" style="height: 51px; width: 54px;">
                            {% if persona.foto %}
                                <img style="height: 43px;margin-top: 2.5px;"
                                     src="https://sga.unemi.edu.ec{{ persona.foto.foto.url }}"
                                     onerror="this.onerror=null;this.src='/static/images/image.png'" width="25" height="25"
                                     class="rounded-circle">
                            {% else %}
                                <img style="background-color: #FFFFFF; height: 43px"
                                     src="/static/images/iconos/{% if persona.sexo.id == 2 %}hombre.png{% else %}mujer.png{% endif %}"
                                     onerror="this.onerror=null;this.src='/static/images/image.png'" width="25" height="25"
                                     class="rounded-circle">
                            {% endif %}
                        </div>
                    </a>
                    <div class="dropdown-menu dropdown-menu-end dropdown-menu-xs" aria-labelledby="panelPerfilUsuario">
                        <div class="dropdown-item">
                            <div class="d-flex">
                                <div class="avatar avatar-md" style="height: 51px; width: 54px;">
                                    {% if persona.foto %}
                                        <img style="margin-top: 0.5px; height: 43px"
                                             src="https://sga.unemi.edu.ec{{ persona.foto.foto.url }}"
                                             onerror="this.onerror=null;this.src='/static/images/image.png'" width="25"
                                             height="25" class="rounded-circle">
                                    {% else %}
                                        <img style="margin-top: 0.5px; background-color: #FFFFFF; height: 43px"
                                             src="/static/images/iconos/{% if persona.sexo.id == 2 %}hombre.png{% else %}mujer.png{% endif %}"
                                             onerror="this.onerror=null;this.src='/static/images/image.png'" width="25"
                                             height="25" class="rounded-circle">
                                    {% endif %}
                                </div>
                                <div class="lh-1">
                                    <label class="label label-success">{{ perfilprincipal.tipo }}{% if persona.sexo_id == 1 and perfilprincipal.tipo == 'PROFESOR'%}A{% endif %}</label>
                                    <h5 class="mb-1">{{ persona.nombre_completo }}</h5>
                                    <p class="mb-0 text-muted">{{ persona.emailinst }}</p>
                                </div>
                            </div>
                        </div>
                        <div class="dropdown-divider"></div>
                        <ul class="list-unstyled">
                            <li><a href="/th_hojavida" class="dropdown-item bloqueo_pantalla"><img
                                    src="/static/logos/icon_editar_perfil.svg" style="width:28px">&nbsp; Gestionar mi perfil</a>
                            </li>
                            {#                        {% if perfilprincipal.es_administrativo and request.user.is_superuser %}#}
                            {#                            <li><a href="/my_faceid" class="dropdown-item bloqueo_pantalla"><img src="/static/logos/icon_editar_perfil.svg" style="width:28px">&nbsp; Gestionar mi FaceID</a></li>#}
                            {#                        {% endif %}#}
                            <li><a href="/pass" class="dropdown-item bloqueo_pantalla"><img
                                    src="/static/logos/icon_cambiar_password.svg" style="width:28px">&nbsp; Cambiar
                                contraseña</a></li>
                            <!--<li><a href="/my_devices" class="dropdown-item bloqueo_pantalla"><img
                                    src="/static/logos/icon_mis_dispositos.svg" style="width:28px">&nbsp; Mis
                                dispositivos</a></li>-->
                            <li><a href="/my_profile/security" class="dropdown-item bloqueo_pantalla"><img
                                    src="/static/logos/shield-check.svg" style="width:24px">&nbsp; Gestionar seguridad</a>
                            </li>
                            {% if request.user.is_superuser %}
                                <li><a href="/unemi_2021_admin_desarrollo_" target="_blank" class="dropdown-item"><img
                                        src="/static/logos/icon_administrador.svg" style="width:28px">&nbsp; Administrar
                                    Django</a></li>
                            {% endif %}
                        </ul>
                        <div class="dropdown-divider"></div>
                        <ul class="list-unstyled" style="font-size: 12px;">
                            {% for perfil in perfiles_usuario %}
                                {% if perfil.activo %}
                                    <li class="dropdown-item {% if perfilprincipal.id == perfil.id %}active{% endif %}">
                                        <a {% if perfilprincipal.id == perfil.id %} href='javascript:;' {% else %}
                                                                                    href='/cudu?id={{ perfil.id|encrypt }}'
                                                                                    class="dropdown-item bloqueo_pantalla" {% endif %}>
                                            {% if perfilprincipal.id == perfil.id %}
                                                <img src="/static/logos/icon_radiobutton.svg"
                                                     style="width: 25px">{% endif %} {{ perfil.tipo }}{% if persona.sexo_id == 1 and perfil.tipo == 'PROFESOR'%}A{% endif %}
                                        </a>
                                    </li>
                                {% endif %}
                            {% endfor %}
                        </ul>
                        <div class="dropdown-divider"></div>
                        <ul style="text-align: center" class="list-unstyled">
                            <li>
                                <a class="dropdown-item logoutuser" href="javascript:;">
                                    <img src="/static/logos/icon_cerrar_sesion.svg" style="width: 28px"> Cerrar sesión
                                </a>
                            </li>
                        </ul>
                    </div>
                </li>
            {% endif %}
        </ul>
    </div>
</nav>
<div class="bg-sga-2 navbar-fixed-top" style="height: 11px;"></div>
{#NAVBAR#}

<div id="app" class="my-4">
    <div class="container">
        {% if ruta and not useModal and not request.path == '/' %}
            <div class="row-fluid">
                <div class="col-lg-12" style="width: 100%;">
                    <ul class="breadcrumb2" style="color: black">
                        {% for r in ruta %}
                            <li>
                                        <span {% if not forloop.first %}class="hidden-phone hidden-tablet visible-desktop"{% endif %}>
                                            <a href="{{ r.0 }}" class="bloqueo_pantalla">{{ r.1 }}</a>
                                            <span class="divider">/</span>
                                        </span>
                            </li>
                        {% endfor %}
                        <li style="float: right;" class="float-sm-right">
                            <a style="float: right; !important"
                               href="{% if ret %}{{ ret }}{% else %}{% block atras %}/{% endblock %}{% endif %}"
                               class='btn btn-default btn-xs urlatrasbutton bloqueo_pantalla' id="urlatrasbutton"><span
                                    class="fa fa-arrow-left"></span> Atr&aacute;s</a>
                        </li>
                    </ul>
                </div>
            </div>
        {% endif %}
        {% block canvas %}{% endblock %}
    </div>
</div>

{#MODALES#}

<div class="modal fade opacity" id="modalConfirm" style="z-index: 2060; background-color: rgba(0, 0, 0, 0.4); transition: background-color 0.1s;" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered modal-dialog-scrollable">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title m-2">Confirmación</h4>
            </div>
            <div class="modal-body p-5">
                <p style="font-weight: bold"></p>
            </div>
            <div class="modal-footer m-2">
                <a href="javascript:;" class="btn btn-success action_yes">Si</a>
                <a href="javascript:;" class="btn btn-default action_not">No</a>
            </div>
        </div>
    </div>
</div>

<div class="modal fade opacity static" tabindex="-1" role="dialog" aria-hidden="true" id="confirmacionmodal">
    <div class="modal-dialog modal-lg modal-dialog-scrollable">
        <div class="modal-content">
        </div>
    </div>
</div>

<div class="modal fade opacity static" tabindex="-1" role="dialog" aria-hidden="true" id="eliminacionmodal">
    <div class="modal-dialog modal-lg modal-dialog-scrollable">
        <div class="modal-content">
        </div>
    </div>
</div>

<div class="modal fade opacity static" tabindex="-1" role="dialog" aria-hidden="true" id="viewhtml">
    <div class="modal-dialog modal-lg modal-dialog-scrollable">
        <div class="modal-content">
        </div>
    </div>
</div>

<div class="modal fade opacity " id="modalConfirmAjax" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered modal-dialog-scrollable">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title m-2">Confirmación</h4>
            </div>
            <div class="modal-body p-5">
            </div>
            <div class="modal-footer m-2">
                <a href="javascript:;" class="btn btn-success action_yes">Si, segur{% if persona and persona.sexo_id == 1 %}a{% elif persona and persona.sexo_id == 2 %}o{% else %}o/a{% endif %}</a>
                <a href="javascript:;" class="btn btn-default action_not">No, llévame de vuelta</a>
            </div>
        </div>
    </div>
</div>

<div class="modal fade static" id="modalfirmaelectronida" style="display: none;">
    <div class="modal-dialog modal-dialog-centered modal-xl" role="document" id="wmodal-firma">
        <div class="modal-content">
            <div class="modal-header">
                <h4><i class="fa fa-list"></i> <b class="paneltitle-firma">FORMULARIO MODAL</b></h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close">
                </button>
            </div>
            <div class="modal-body">
                <form autocomplete="off" method="post"
                      enctype="multipart/form-data" action="{{ request.path }}">
                    {% csrf_token %}
                    <div class="row-fluid panelbody-firma">
                    </div>
                </form>
            </div>
            <div class="modal-footer" id="footermodal-firma">
                <a href="javascript:;" class="btn btn-default" data-bs-dismiss="modal"><i
                        class="fa fa-window-close"></i>
                    Cerrar</a>
            </div>
        </div>
    </div>
</div>

<div class="modal fade static" id="formatoreporte" style="display: none;">
    <div class="modal-dialog modal-dialog-centered modal-md" role="document" id="wmodal-reporte">
        <div class="modal-content">
            <div class="modal-header">
                <h4 id="paneltitle"><i class="fa fa-print"></i> Formato de reporte</h4>
                <button type="button" class="btn-close btn-cerrar-modal fs-5 cerrar" data-toggle="modal"
                        data-bs-dismiss="modal" aria-label="Close">X</button>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-12">
                        <label for="" class="fw-bold">Formato de reporte <span class="text-danger">*</span>:</label>
                        <select style="width: 100%;" id="formatoreporte_formato">
                            <option id="formatopdf" value="0">PORTABLE DOCUMENT FORMAT (PDF)</option>
                            <option id="formatodoc" value="1">MICROSOFT WORD (DOCX)</option>
                            <option id="formatoxls" value="2">MICROSOFT EXCEL (XLXS)</option>
                            <option id="formatocsv" value="3">COMMA-SEPARATED VALUES (CSV)</option>
                        </select>
                    </div>
                </div>

                <div class="row mt-3">
                    <div class="col-12 text-end">
                        <a href="javascript:;" id="formatoreporte_run" class="btn btn-orange fs-5"><i class="fa fa-download"></i> Ejecutar</a>
                        <a href="javascript:;" id="formatoreporte_close" class="btn btn-cian-secondary fs-5"><i class="fa fa-close"></i> Cerrar</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade static" id="modalPeriodos" style="display: none;">
    <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable modal-lg modal-fullscreen-lg-down" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title"><i class="fa fa-calendar"></i> Listado de periodos académicos</h4>
                <button type="button" class="btn-close btn-cerrar-modal fs-5" data-toggle="modal"
                        data-bs-dismiss="modal" aria-label="Close">X</button>
            </div>
            <div class="modal-body">

            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-cian-secondary fs-5 action-close" data-bs-dismiss="modal"><i class="fa fa-close"></i> Cerrar </button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade static" id="itemspanelbase" style="display: none;">
    <div class="modal-dialog modal-dialog-centered modal-lg modal-dialog-scrollable" role="document" id="wmodalbase">
        <div class="modal-content border-radius-modal">
            <div class="modal-header" style="padding-bottom: .7rem !important">
                <h4 class="mb-0"><i class="fa fa-outdent" id="titleicon"></i> <b class="paneltitle-base"> FORMULARIO MODAL</b></h4>
                <button type="button" class="btn-close btn-cerrar-modal fs-5 cerrar" data-toggle="modal"
                        data-bs-dismiss="modal" aria-label="Close">X
                </button>
            </div>
            <div class="modal-body p-0">
                <form class="form-horizontal form-modal" autocomplete="off" method="post"
                      enctype="multipart/form-data" action="{{ request.path }}">
                    {% csrf_token %}
                    <div class="panelbody-base m-3">
                    </div>
                </form>
            </div>
            <div class="modal-footer" id="footermodalbase">
                <button type="button" class="btn btn-default cerrar" data-bs-dismiss="modal" id="cerrar"><i
                        class="fa fa-times"></i> Cerrar
                </button>
            </div>
        </div>
    </div>
</div>

{#<div id="loading">#}
{#    <div id="loading-center" style="opacity: 2 !important;">#}
{#        <span class="spinner-grow spinner-border-lg" role="status" aria-hidden="true" style="width: 10rem; height: 10rem; background-color: #F8C471 ; color: #F8C471 ; !important"></span>#}
{#    </div>#}
{#</div>#}

{#MODALES#}

{% if not request.user.is_anonymous and not useModal %}
    <br>
    <br>

    <div id="footer" class="bg-footer text-center">
        <span class="mt-8"><b>{{ institucion }}</b> Todos los derechos reservados </span>
        <span id="ipcapturada"></span> - {% if remotenameaddr %}{{ remotenameaddr }}{% endif %} - S{{ server_response }}
        <div style="text-align: right; float: right">
            <a href="javascript:;" class="text-black"
               style="font-size: 18px;line-height: 18px;color:#222;!important; font-weight: bold" id="clock"></a> &nbsp;&nbsp;
        </div>
    </div>
{% endif %}

{#<script src="/static/bootstrap4/plugins/bootstrap/js/bootstrap.bundle.min.js?v={{ version_static|default_if_none:'0.1' }}"></script>#}
{#<script src="/static/bootstrap5/js/bootstrap.bundle.min.js?v={{ version_static|default_if_none:'0.1' }}"></script>#}
{#<script src="/static/bootstrap5/bootstrap.bundle.min.js?v={{ version_static|default_if_none:'0.1' }}"></script>#}
{#<script src="/static/bootstrap5/libs/bootstrap/dist/js/bootstrap.bundle.min.js?v={{ version_static|default_if_none:'0.1' }}"></script>#}
<script src="/static/bootstrap5/libs/bootstrap/libs/bootstrap.bundle.min.js?v={{ version_static|default_if_none:'0.1' }}"></script>
{#<script src="/static/bootstrap5/js/bootstrap.bundle.min_.js?v={{ version_static|default_if_none:'0.1' }}"></script> actual#}
{#<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"#}
{#        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"#}
{#        crossorigin="anonymous"></script>#}
<script src="/static/bootstrap5/libs/magnific-popup/dist/jquery.magnific-popup.min.js?v={{ version_static|default_if_none:'0.1' }}"></script>
<script src="/static/bootstrap5/libs/inputmask/dist/jquery.inputmask.min.js?v={{ version_static|default_if_none:'0.1' }}"></script>
<script src="/static/bootstrap5/libs/dragula/dist/dragula.min.js?v={{ version_static|default_if_none:'0.1' }}"></script>
<script src="/static/bootstrap5/js/theme.min.js?v={{ version_static|default_if_none:'0.1' }}"></script>
{#<script src="/static/bootstrap5/libs/odometer/odometer.min.js?v={{ version_static|default_if_none:'0.1' }}"></script>#}
{#<script src="/static/bootstrap5/libs/bootstrap-select/dist/js/bootstrap-select.min.js?v={{ version_static|default_if_none:'0.1' }}"></script>#}
{#<script src="/static/bootstrap5/libs/flatpickr/dist/flatpickr.min.js?v={{ version_static|default_if_none:'0.1' }}"></script>#}
{#<script src="/static/bootstrap5/libs/apexcharts/dist/apexcharts.min.js?v={{ version_static|default_if_none:'0.1' }}"></script>#}
{#<script src="/static/bootstrap5/libs/file-upload-with-preview/dist/file-upload-with-preview.min.js?v={{ version_static|default_if_none:'0.1' }}"></script>#}
{#<script src="/static/bootstrap5/libs/dropzone/dist/min/dropzone.min.js?v={{ version_static|default_if_none:'0.1' }}"></script>#}
{#<script src="/static/bootstrap5/libs/jQuery.print/jQuery.print.js?v={{ version_static|default_if_none:'0.1' }}"></script>#}
{#<script src="/static/bootstrap5/libs/prismjs/prism.js?v={{ version_static|default_if_none:'0.1' }}"></script>#}
{#<script src="/static/bootstrap5/libs/prismjs/components/prism-scss.min.js?v={{ version_static|default_if_none:'0.1' }}"></script>#}
{#<script src="/static/bootstrap5/libs/%40yaireo/tagify/dist/tagify.min.js?v={{ version_static|default_if_none:'0.1' }}"></script>#}
{#<script src="/static/bootstrap5/libs/typed.js/lib/typed.min.js?v={{ version_static|default_if_none:'0.1' }}"></script>#}
{#<script src="/static/bootstrap5/libs/jsvectormap/dist/js/jsvectormap.min.js?v={{ version_static|default_if_none:'0.1' }}"></script>#}
{#<script src="/static/bootstrap5/libs/jsvectormap/dist/maps/world.js?v={{ version_static|default_if_none:'0.1' }}"></script>#}
{#<script src="/static/bootstrap5/libs/datatables.net/js/jquery.dataTables.min.js?v={{ version_static|default_if_none:'0.1' }}"></script>#}
{#<script src="/static/bootstrap5/libs/datatables.net-bs5/js/dataTables.bootstrap5.min.js?v={{ version_static|default_if_none:'0.1' }}"></script>#}
{#<script src="/static/bootstrap5/libs/datatables.net-responsive/js/dataTables.responsive.min.js?v={{ version_static|default_if_none:'0.1' }}"></script>#}
{#<script src="/static/bootstrap5/libs/datatables.net-responsive-bs5/js/responsive.bootstrap5.min.js?v={{ version_static|default_if_none:'0.1' }}"></script>#}
{#<script src="/static/bootstrap5/libs/datatables.net-bs5/js/es-ES.json?v={{ version_static|default_if_none:'0.1' }}"></script>#}
{#<script src="/static/bootstrap5/libs/prismjs/plugins/toolbar/prism-toolbar.min.js?v={{ version_static|default_if_none:'0.1' }}"></script>#}
{#<script src="/static/bootstrap5/libs/prismjs/plugins/copy-to-clipboard/prism-copy-to-clipboard.min.js?v={{ version_static|default_if_none:'0.1' }}"></script>#}
{#<script src="/static/bootstrap5/libs/fullcalendar/main.min.js?v={{ version_static|default_if_none:'0.1' }}"></script>#}
{#<script src="/static/bootstrap5/libs/simplebar/dist/simplebar.min.js?v={{ version_static|default_if_none:'0.1' }}"></script>#}
{#<script src="/static/bootstrap5/libs/nouislider/dist/nouislider.min.js?v={{ version_static|default_if_none:'0.1' }}"></script>#}
{#<script src="/static/bootstrap5/libs/wnumb/wNumb.min.js?v={{ version_static|default_if_none:'0.1' }}"></script>#}
{#<script src="/static/bootstrap5/libs/glightbox/dist/js/glightbox.min.js?v={{ version_static|default_if_none:'0.1' }}"></script>#}

<div id="csrf_tokendiv" style="display: none;">{{ csrf_token }}</div>

{% block moreblock %}
{% endblock %}

<!-- Datatable -->
<link rel="stylesheet" href="/static/datatables/datatables.css?v={{ version_static|default_if_none:'0.1' }}">
<script src="/static/datatables/datatables.js?v={{ version_static|default_if_none:'0.1' }}"></script>
{#<link rel="stylesheet" href="/static/datatables/html2canvas.min.js">#}
<link rel="stylesheet" href="/static/datatables/responsive.bootstrap.min.css?v={{ version_static|default_if_none:'0.2' }}">
<script src="/static/datatables/dataTables.responsive.min.js?v={{ version_static|default_if_none:'0.1' }}"></script>
{#<script type='text/javascript' src='/static/js/jquery.dataTables.min.js?v={{ version_static|default_if_none:'0.1' }}'></script>#}
<script src="/static/datatables/responsive.bootstrap.min.js?v={{ version_static|default_if_none:'0.1' }}"></script>
<link rel="stylesheet" href="/static/datatables/dataTables.bootstrap.min.css?v={{ version_static|default_if_none:'0.1' }}">
<link rel="stylesheet" href="/static/datatables/buttons.bootstrap.min.css?v={{ version_static|default_if_none:'0.1' }}">
<link rel="stylesheet" href="/static/datatables/bootstrap-toggle.min.css?v={{ version_static|default_if_none:'0.1' }}">
<script src="/static/datatables/dataTables.buttons.min.js?v={{ version_static|default_if_none:'0.1' }}"></script>
<script src="/static/bootstrap5/js/utils.js?v=1.3"></script>
<script type="text/javascript">

    $(function () {
        $(".tl").tooltip({placement: "top"});

        let obj_tr = $('.tabla_responsive tbody tr');
        let total = obj_tr.length ;
        if (total == 1){
            total = obj_tr.find('td').length;
        }
        if (total > 1) {
            const tabla = $('.tabla_responsive').DataTable({
                responsive: true,
                ordering: false,
                paging: false,
                searching: false,
                bInfo: false,
                dom: 'Bfrtip',
                language: {
                    "url": '/static/js/i18n/Spanish.json'
                },
                buttons: []
            });

            tabla.buttons().container().appendTo('.tabla_responsive .col-md-6:eq(0)');

            $('.tabla_responsive tbody').on('click', 'tr', function () {
                var data = tabla.row(this).data();
            });
            $(".action-close", $("#modalPeriodos")).click(function () {
                $("#modalPeriodos").modal('hide');
            })
        }

    });

    function openModalperiodos()  {
        bloqueointerface()
        //$("#modalPeriodos").modal({"backdrop": "static"}).modal("show");
        $.ajax({
            type: "POST",
            url: '/',
            data: {
                'action': 'lista_periodos',
            },
            success: function (data) {
                $.unblockUI();
                if (data.result) {

                    $('.modal-body', $("#modalPeriodos")).html(data.html);
                    $("#modalPeriodos").modal({backdrop: 'static', width: '900px'}).modal('show').on('hidden.bs.modal', function (e) {
                        $('.modal-body', $("#modalPeriodos")).empty();
                    });
                } else {
                    mensajeDanger(data.message);
                }
            },
            error: function () {
                $.unblockUI();
                mensajeDanger("Error de conexión.");
            },
            dataType: "json"
        });
        //bloqueointerface();
        /*$.ajax({
            type: "GET",
            url: "/adm_criteriosactividades",
            data: {'action': action1, id: id},
            success: function (data) {
                $.unblockUI();
                if (data.result === 'ok') {
                    $("#modal_body_periodos").html(data.html);
                    $("#modalperiodosrelacionados").modal({"backdrop": "static", "width": "900px"}).modal("show");
                } else {
                    smoke.alert(data.mensaje);

                }
            },
            error: function () {
                $.unblockUI();
                smoke.alert("Error de conexión.");
            },
            dataType: "json"
        });*/
    };

    function eliminarajax(pk, nombre, accion, url = '{{ request.path }}', titulo = 'Estás por eliminar este registro:') {
        Swal.fire({
            html: `<b>${titulo}</b> ${nombre}`,
            text: "Esta acción es irreversible",
            type: 'question',
            showCancelButton: true,
            allowOutsideClick: false,
            confirmButtonColor: '#3085d6',
            cancelButtonColor: '#d33',
            confirmButtonText: 'Si, deseo hacerlo',
            cancelButtonText: 'Cancelar'
        }).then((result) => {
            if (result.value) {
                bloqueointerface();
                $.ajax({
                    type: 'POST',
                    url: '{{ reques.path }}',
                    async: false,
                    data: {
                        csrfmiddlewaretoken: '{{ csrf_token }}',
                        action: accion,
                        id: pk,
                    },
                    dataType: "json",
                    beforeSend: function () {
                        bloqueointerface();
                    }
                }).done(function (data) {
                    setTimeout($.unblockUI, 1);
                    console.log(data)
                    if (data.error === false) {
                        if(data.to){
                            location = data.to;
                        }else if(data.refresh){
                            refreshElement(data)
                        }else{
                            location.reload();
                        }
                    }else{
                        mensajeDanger(data.message)
                    }
                }).fail(function (jqXHR, textStatus, errorThrown) {
                    setTimeout($.unblockUI, 1);
                    NotificationJG.error('Error en el servidor', 'Advertencia!', 10000);
                }).always(function () {
                });
            } else {
            }
        })
    }

    function mensajeFlotante(tipo, mensaje) {
        Swal.fire({
            toast: false,
            position: 'center',
            icon: "info",
            type: 'info',
            title: mensaje,
            html: tipo,
            showConfirmButton: false
        });
    }

    function alertaSuccess(mensaje, time = 5000) {
        Swal.fire({
            toast: true,
            position: 'top-end',
            type: 'success',
            title: mensaje,
            showConfirmButton: false,
            timer: time
        })
    }

    function alertaWarning(mensaje, time = 5000) {
        Swal.fire({
            toast: true,
            position: 'top-end',
            type: 'warning',
            title: mensaje,
            showConfirmButton: false,
            timer: time
        })
    }

    function alertaDanger(mensaje, time = 5000) {
        Swal.fire({
            toast: true,
            position: 'top-end',
            type: 'error',
            title: mensaje,
            showConfirmButton: false,
            timer: time
        })
    }

    function alertaInfo(mensaje, time = 5000) {
        Swal.fire({
            toast: true,
            position: 'top-end',
            type: 'info',
            title: mensaje,
            showConfirmButton: false,
            timer: time
        })
    }

    function mensajeSuccess(mensaje, titulo = '') {
        Swal.fire(titulo, mensaje, 'success')
    }

    function mensajeWarning(mensaje, titulo = '') {
        Swal.fire(titulo, mensaje, 'warning')
    }

    function mensajeDanger(mensaje, titulo = '') {
        Swal.fire(titulo, mensaje, 'error')
    }

    function mensajeInfo(mensaje, titulo = '') {
        Swal.fire(titulo, mensaje, 'info')
    }

    function mensajeWarningSwal(titulo, mensaje) {
        Swal.fire({
            allowOutsideClick: false,
            allowEscapeKey: false,
            allowEnterKey: false,
            type: 'warning',
            title: titulo,
            html: mensaje,
            confirmButtonText: 'Aceptar',
        })
    }

    function mensajeErrorSwal(titulo, mensaje) {
        Swal.fire({
            allowOutsideClick: false,
            allowEscapeKey: false,
            allowEnterKey: false,
            type: 'error',
            title: titulo,
            html: mensaje,
            confirmButtonText: 'Aceptar',
        })
    }

    function mensajeSuccessSwal(titulo, mensaje, url) {
        Swal.fire({
            scrollbarPadding: false,
            allowOutsideClick: false,
            allowEscapeKey: false,
            allowEnterKey: false,
            type: 'success',
            title: titulo,
            html: mensaje,
            confirmButtonText: 'Aceptar',
        }).then((result) => {
            if (result.value) {
                if(url){
                    bloqueointerface();
                    location.href = url;
                }
            }
        })
    }

    function mensajeConfirmSwal(titulo, mensaje, ajaxprocess, url, action, id, urlDestino='{{ request.path }}') {
        Swal.fire({
            allowOutsideClick: false,
            allowEscapeKey: false,
            allowEnterKey: false,
            type: 'question',
            title: titulo,
            html: mensaje,
            confirmButtonText: 'Aceptar',
            showCancelButton: true,
            cancelButtonText: 'Cancelar'
        }).then((result) => {
            if (result.value) {
                if (!ajaxprocess) {
                    bloqueointerface();
                    location.href = urlDestino;
                    $.unblockUI();
                } else {
                    bloqueointerface();
                    $.ajax({
                        type: "POST",
                        url: url,
                        data: {
                            action: action,
                            csrfmiddlewaretoken: '{{ csrf_token }}',
                            id: id,
                        },
                        success: function (data) {
                            if (data.result == 'ok') {
                                if (data.showSwal) {
                                    $.unblockUI();
                                    mensajeSuccessSwal(data.titulo, data.mensaje, urlDestino);
                                } else {
                                    location.href = urlDestino;
                                }
                            } else {
                                $.unblockUI();
                                if (data.swalType == 'warning')
                                    mensajeWarningSwal(data.titulo, data.mensaje);
                                else
                                    mensajeErrorSwal(data.titulo, data.mensaje);
                            }
                        },
                        error: function () {
                            $.unblockUI();
                            mensajeErrorSwal("No se puede procesar", "Error al enviar los datos");
                        },
                        dataType: "json"
                    });
                }
            }
        })
    }

    function CargarSwitchery(){
        var elems = Array.prototype.slice.call(document.querySelectorAll('.js-switch'));
        elems.forEach(function (html) {
            switchery = new Switchery(html, {
                size: 'small',
                color: 'rgba(17,218,35,0.56)',
                secondaryColor: 'rgba(218,0,7,0.74)'
            });
        });
    }

    function formModalBase(id, text, action, idex = '', dimension = 'modal-lg', footer = true, icon = 'fa fa-outdent') {
        bloqueointerface()
        $.ajax({
            type: "GET",
            url: `{{ request.path }}`,
            data: {'action': action, 'id': id, 'idex': idex},
            success: function (data) {
                $.unblockUI();
                footer ? $('#footermodalbase').hide() : $('#footermodalbase').show();
                $('#titleicon').removeClass().addClass(icon);
                $('#wmodalbase').removeClass('modal-lg modal-sm modal-xl modal-md modal-fullscreen').addClass(dimension);
                if (data.result === true) {
                    $('#itemspanelbase .panelbody-base').html(data.data);
                    $('#itemspanelbase .paneltitle-base').html(text.charAt(0).toUpperCase() + text.slice(1).toLowerCase());
                    $("#itemspanelbase").modal({backdrop: 'static'}).modal('show');
                    if(dimension == 'modal-fullscreen'){
                        $('#wmodalbase .modal-content').removeClass('border-radius-modal');
                    }
                    {#if(typeof data.template_id === 'undefined' || !data.template_id){#}
                    {#    $("#id_objeto").val(id)#}
                    {#    console.log('hola')#}
                    {# }#}
                } else {
                    mensajeDanger(data.mensaje);
                }
            },
            error: function () {
                $.unblockUI();
                mensajeDanger("Error de conexión.");
            },
            dataType: "json"
        });
    }

</script>
<script>
    function getCookie(name) {
        var cookieValue = null;
        if (document.cookie && document.cookie !== '') {
            var cookies = document.cookie.split(';');
            for (var i = 0; i < cookies.length; i++) {
                var cookie = jQuery.trim(cookies[i]);
                // Does this cookie string begin with the name we want?
                if (cookie.substring(0, name.length + 1) === (name + '=')) {
                    cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                    break;
                }
            }
        }
        return cookieValue;
    }

    var csrftoken = getCookie('csrftoken');

    function csrfSafeMethod(method) {
        return (/^(GET|HEAD|OPTIONS|TRACE)$/.test(method));
    }

    $.ajaxSetup({
        beforeSend: function (xhr, settings) {
            if (!csrfSafeMethod(settings.type) && !this.crossDomain) {
                xhr.setRequestHeader("X-CSRFToken", csrftoken);
            }
        }
    });
</script>

<script>

    $(window).on("load", function (e) {
        $('#loading').fadeOut(100);
    })

    {#console.log('%cUNIVERSIDAD ESTATAL DE MILAGRO', 'color:red; font-size: 2em;')#}
    {#console.log('%cTodos los derechos reservados © 2012', 'color:red; font-size: 2em;')#}
</script>

{#NOTIFICACIONES WEB#}
{% if request.user.is_authenticated and permiteWebPush %}
    <script src="/static/webpush/registerSw.js?v={{ version_static|default_if_none:'0.1' }}"></script>
    <script>

        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.ready.then(registration => {
                registration.active.postMessage({type: 'PORT_INITIALIZATION'});
                if ('SyncManager' in window) {
                    registration.sync.register('sync-data');
                }
                navigator.serviceWorker.addEventListener('message', (event) => {
                    var data = event.data;
                    if (data.error) {
                        mensajeDanger(data.mensaje)
                    } else if (data.mensaje) {
                        mensajeSuccess(data.mensaje)
                    }
                    if (data.noti_mensaje) {
                        alertaSuccess(data.noti_mensaje)
                    }
                    {#if (data.btn_notificaciones) {#}
                    {#    $('#btnNotificacionTareas').html(data.btn_notificaciones);#}
                    {# }#}
                });
            });
        }
    </script>
{% endif %}
{#NOTIFICACIONES WEB#}

{% block extraJs %}{% endblock %}
</body>

</html>