{% extends "basebs.html" %}
{% load sga_extras %}
{% block heading %}
    <link href="/static/css/table-responsive.css?1.0.0" type="text/css" rel="stylesheet" />
    <script type="text/javascript">
        $(function() {
            var informacion_cliente = function(window) {
                {
                    var unknown = '-';

                    // screen
                    var screenSize = '';
                    if (screen.width) {
                        width = (screen.width) ? screen.width : '';
                        height = (screen.height) ? screen.height : '';
                        screenSize += '' + width + " x " + height;
                    }

                    // browser
                    var nVer = navigator.appVersion;
                    var nAgt = navigator.userAgent;
                    var browser = navigator.appName;
                    var version = '' + parseFloat(navigator.appVersion);
                    var majorVersion = parseInt(navigator.appVersion, 10);
                    var nameOffset, verOffset, ix;

                    // Opera
                    if ((verOffset = nAgt.indexOf('Opera')) != -1) {
                        browser = 'Opera';
                        version = nAgt.substring(verOffset + 6);
                        if ((verOffset = nAgt.indexOf('Version')) != -1) {
                            version = nAgt.substring(verOffset + 8);
                        }
                    }
                    // Opera Next
                    if ((verOffset = nAgt.indexOf('OPR')) != -1) {
                        browser = 'Opera';
                        version = nAgt.substring(verOffset + 4);
                    }
                    // MSIE
                    else if ((verOffset = nAgt.indexOf('MSIE')) != -1) {
                        browser = 'Microsoft Internet Explorer';
                        version = nAgt.substring(verOffset + 5);
                    }
                    // Chrome
                    else if ((verOffset = nAgt.indexOf('Chrome')) != -1) {
                        browser = 'Chrome';
                        version = nAgt.substring(verOffset + 7);
                    }
                    // Safari
                    else if ((verOffset = nAgt.indexOf('Safari')) != -1) {
                        browser = 'Safari';
                        version = nAgt.substring(verOffset + 7);
                        if ((verOffset = nAgt.indexOf('Version')) != -1) {
                            version = nAgt.substring(verOffset + 8);
                        }
                    }
                    // Firefox
                    else if ((verOffset = nAgt.indexOf('Firefox')) != -1) {
                        browser = 'Firefox';
                        version = nAgt.substring(verOffset + 8);
                    }
                    // MSIE 11+
                    else if (nAgt.indexOf('Trident/') != -1) {
                        browser = 'Microsoft Internet Explorer';
                        version = nAgt.substring(nAgt.indexOf('rv:') + 3);
                    }
                    // Other browsers
                    else if ((nameOffset = nAgt.lastIndexOf(' ') + 1) < (verOffset = nAgt.lastIndexOf('/'))) {
                        browser = nAgt.substring(nameOffset, verOffset);
                        version = nAgt.substring(verOffset + 1);
                        if (browser.toLowerCase() == browser.toUpperCase()) {
                            browser = navigator.appName;
                        }
                    }
                    // trim the version string
                    if ((ix = version.indexOf(';')) != -1) version = version.substring(0, ix);
                    if ((ix = version.indexOf(' ')) != -1) version = version.substring(0, ix);
                    if ((ix = version.indexOf(')')) != -1) version = version.substring(0, ix);

                    majorVersion = parseInt('' + version, 10);
                    if (isNaN(majorVersion)) {
                        version = '' + parseFloat(navigator.appVersion);
                        majorVersion = parseInt(navigator.appVersion, 10);
                    }

                    // mobile version
                    var mobile = /Mobile|mini|Fennec|Android|iP(ad|od|hone)/.test(nVer);

                    // cookie
                    var cookieEnabled = (navigator.cookieEnabled) ? true : false;

                    if (typeof navigator.cookieEnabled == 'undefined' && !cookieEnabled) {
                        document.cookie = 'testcookie';
                        cookieEnabled = (document.cookie.indexOf('testcookie') != -1) ? true : false;
                    }

                    // system
                    var os = unknown;
                    var clientStrings = [
                        {s:'Windows 10', r:/(Windows 10.0|Windows NT 10.0)/},
                        {s:'Windows 8.1', r:/(Windows 8.1|Windows NT 6.3)/},
                        {s:'Windows 8', r:/(Windows 8|Windows NT 6.2)/},
                        {s:'Windows 7', r:/(Windows 7|Windows NT 6.1)/},
                        {s:'Windows Vista', r:/Windows NT 6.0/},
                        {s:'Windows Server 2003', r:/Windows NT 5.2/},
                        {s:'Windows XP', r:/(Windows NT 5.1|Windows XP)/},
                        {s:'Windows 2000', r:/(Windows NT 5.0|Windows 2000)/},
                        {s:'Windows ME', r:/(Win 9x 4.90|Windows ME)/},
                        {s:'Windows 98', r:/(Windows 98|Win98)/},
                        {s:'Windows 95', r:/(Windows 95|Win95|Windows_95)/},
                        {s:'Windows NT 4.0', r:/(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/},
                        {s:'Windows CE', r:/Windows CE/},
                        {s:'Windows 3.11', r:/Win16/},
                        {s:'Android', r:/Android/},
                        {s:'Open BSD', r:/OpenBSD/},
                        {s:'Sun OS', r:/SunOS/},
                        {s:'Linux', r:/(Linux|X11)/},
                        {s:'iOS', r:/(iPhone|iPad|iPod)/},
                        {s:'Mac OS X', r:/Mac OS X/},
                        {s:'Mac OS', r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},
                        {s:'QNX', r:/QNX/},
                        {s:'UNIX', r:/UNIX/},
                        {s:'BeOS', r:/BeOS/},
                        {s:'OS/2', r:/OS\/2/},
                        {s:'Search Bot', r:/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver)/}
                    ];
                    for (var id in clientStrings) {
                        var cs = clientStrings[id];
                        if (cs.r.test(nAgt)) {
                            os = cs.s;
                            break;
                        }
                    }

                    var osVersion = unknown;

                    if (/Windows/.test(os)) {
                        osVersion = /Windows (.*)/.exec(os)[1];
                        os = 'Windows';
                    }

                    switch (os) {
                        case 'Mac OS X':
                            osVersion = /Mac OS X (10[\.\_\d]+)/.exec(nAgt)[1];
                            break;

                        case 'Android':
                            osVersion = /Android ([\.\_\d]+)/.exec(nAgt)[1];
                            break;

                        case 'iOS':
                            osVersion = /OS (\d+)_(\d+)_?(\d+)?/.exec(nVer);
                            osVersion = osVersion[1] + '.' + osVersion[2] + '.' + (osVersion[3] | 0);
                            break;
                    }

                    // flash (you'll need to include swfobject)
                    /* script src="//ajax.googleapis.com/ajax/libs/swfobject/2.2/swfobject.js" */
                    var flashVersion = 'no check';
                    if (typeof swfobject != 'undefined') {
                        var fv = swfobject.getFlashPlayerVersion();
                        if (fv.major > 0) {
                            flashVersion = fv.major + '.' + fv.minor + ' r' + fv.release;
                        }
                        else  {
                            flashVersion = unknown;
                        }
                    }
                }

                window.jscd = {
                    screen: screenSize,
                    browser: browser,
                    browserVersion: version,
                    browserMajorVersion: majorVersion,
                    mobile: mobile,
                    os: os,
                    osVersion: osVersion,
                    cookies: cookieEnabled,
                    flashVersion: flashVersion
                };
            };

            informacion_cliente(window);

            var navegador = jscd.browser +' '+ jscd.browserMajorVersion;
            var os =  jscd.os +' '+ jscd.osVersion;
            var screensize = jscd.screen;


            $(".videozoom").click(function () {
                bloqueointerface();
                var idhe = $(this).attr('idhe');
                var idma = $(this).attr('idma');

                $.post("/alu_documentos", {
                    'action': 'addcliczoom' ,'idhe':idhe,'idma':idma,'navegador': navegador,'os': os,'screensize': screensize,
                }, function (data) {
                    $.unblockUI();
                    if (data.result == 'ok') {
                        NotificationJG.success("Se ha guardado con éxito, su asistencia.");
                    } else{
                        smoke.alert("Error de conexión.");
                    }
                }, 'json');
            });

            eliminardiv = function (nombrediv) {
                $("#"+nombrediv).remove();
            };

            $(".silabo").click(function() {
                var idm = $(this).attr('idm');
                var idp = $(this).attr('idp');
                $.get("/alu_documentos", {'action':'silabo', 'idm': idm,'idp':idp}, function(data) {
                    if (data.result == 'ok') {
                        $.unblockUI();
                        $(".panelbody").html(data.data);
                        $("#itemspanelsilabo").modal({backdrop:'static', width: '1000px'}).modal('show');
                    }
                }, 'json');
            });

            $("#itemspanelsilabo .btn-cerrar").click(function() {
                $("#itemspanelsilabo").modal("hide");
                $.unblockUI();
            });

            $(".leer").click(function() {
                var descripcion = $(this).attr('descripcion');
                var valor = $(this).attr('v');
                var ver = $(this).attr('ver');
                var texto = ''; var nleer = ''; var accion = '';
                if (ver == 1){
                    $(this).attr({'ver': 2});
                    texto = descripcion;
                    nleer = 'Leer menos';
                }
                if (ver == 2){
                    $(this).attr({'ver': 1});
                    texto = descripcion.substr(0,200) + '...';
                    nleer = 'Leer mas'
                }
                if (valor == 1){
                    accion = 'menmision'
                }
                if (valor == 2){
                    accion ='menperfil'
                }
                if (valor == 3){
                    accion ='menegreso'
                }
                if (valor == 4){
                    accion ='menobjetivo'
                }
                document.getElementById(accion).innerHTML = texto;
                document.getElementById('nleer'+valor).innerHTML = nleer;
            });

            setTimeout(function() {
                $("#contenidocentral").remove();
            }, 34000)

            verificarhorarios = function(){
                bloqueointerface();
                location.reload();
            };
            var chequeo = setInterval(verificarhorarios, 1000000);


        });

        function vistaprevia(idm, idp){
            openwindow('POST' ,'/alu_documentos', {action:'mostrarsilabodigital',idm:idm, idp:idp}, '_blank');
        }

    </script>
    <style>
        #top_menu .nav > li, ul.top-menu > li {
            float: left;
        }
        .notify-row {
            /*float: left;
            margin-top: 15px;
            margin-left: 92px;*/
        }
        ul.top-menu > li > a {
            color: #666666;
            font-size: 16px;
            border-radius: 4px;
            -webkit-border-radius: 4px;
            border:1px solid #f0f0f8 !important;
            padding: 2px 6px;
            margin-right: 15px;
        }
        .notify-row .badge {
            position: absolute;
            right: 3px;
            top: -9px;
            z-index: 100;
        }
        /*badge*/
        .badge.bg-primary {
            background: #8075c4;
        }

        .badge.bg-success {
            background: #a9d86e;
        }

        .badge.bg-warning {
            background: #FCB322;
        }

        .badge.bg-important {
            background: #ff6c60;
        }

        .badge.bg-info {
            background: #41cac0;
        }

        .badge.bg-inverse {
            background: #2A3542;
        }
    </style>
{% endblock %}
{% block atras %}/{% endblock %}
{% block canvas %}
    <div class='row-fluid'>
        <div class='span12'>
            <h4>{{ title }} </h4>
            {#            <h5>Nivel: {{ matricula.inscripcion.sesion }}</h5>#}
            <h4>{{ matricula.inscripcion.carrera }}<br/> {{ matricula.inscripcion.modalidad }}, {{ matricula.inscripcion.sesion.nombre }}{{ matricula.inscripcion.centroinformacion|default:"" }} </h4>
            {#            <h5>{{ carrera }}{{ matricula.nivel }}<br>{{ matricula.nivel.paralelo }}#}
            {#                {% if matricula.nivel.cerrado %} <label class='label label-important'>CERRADO</label>{% endif %}</h5>#}
            {#            <h5>Estudiante: {{ matricula.inscripcion }}</h5>#}
            {% if matricula.bloqueomatricula and  matricula.inscripcion.carrera.id != 113 %}
                <br>
                <div class="alert alert-danger">
                    <div class="form-horizontal">
                        <h4 class="alert-heading">MATRÍCULA BLOQUEADA</h4>
                        <h5>Estimado/a estudiante, mantiene cuotas vencidas en el módulos "Mis Finanzas" por lo tanto
                            su matrícula se encuentra bloqueada para asistencia, tareas y registro de calificaciones.
                        </h5>
                    </div>
                </div>
            {% endif %}
            <br>
            <div class="alert alert-info">
                <div class="form-horizontal">
                    <h4 class="alert-heading">ACCESO AL EXAMEN</h4>
                    <h5>Estimado/a estudiante, si no le sale el botón de acceso al examen, debe actualizar la página.
                        Recuerde que el botón se habilita 15 minutos antes de la hora programada del inicio al examen y finaliza en la hora exacta.
                    </h5>
                </div>
            </div>
        </div>
        {% if contar_llenos > 0 %}
            <div id="contenidocentral">
                {% if inscripcionmalla.malla.perfilprofesional %}
                    <div class="span{% if contar_llenos == 4 %}3{% elif contar_llenos == 3 %}4{% elif contar_llenos == 2 %}6{% elif contar_llenos == 1 %}12{% endif %}" id="primero">
                        <div class="alert alert-info" style="text-align: justify">
                            <a  href="javascript:;" class="close" onclick="eliminardiv('primero')" data-dismiss="alert">×</a>
                            <h4 class="alert-heading">PERFIL PROFESIONAL</h4>
                            <p id="menperfil">
                                {{ inscripcionmalla.malla.perfilprofesional|substraerconpunto:200|linebreaksbr }}
                            </p>
                            {% if inscripcionmalla.malla.perfilprofesional|contarcaracter:200 %}
                                <a href="javascript:;" class="alert-link leer" id="nleer2" descripcion="{{ inscripcionmalla.malla.perfilprofesional|linebreaksbr }}" v="2" ver="1">Leer mas</a>
                            {% endif %}

                        </div>
                    </div>
                {% endif %}
                {#                {% if inscripcionmalla.malla.misioncarrera %}#}
                {#                    <div class="span{% if contar_llenos == 4 %}3{% elif contar_llenos == 3 %}4{% elif contar_llenos == 2 %}6{% elif contar_llenos == 1 %}12{% endif %}" id="segundo">#}
                {#                        <div class="alert alert-info" style="text-align: justify">#}
                {#                            <a  href="javascript:;" class="close" onclick="eliminardiv('segundo')" data-dismiss="alert">×</a>#}
                {#                            <h4 class="alert-heading">MISIÓN DE LA CARRERA</h4>#}
                {#                            <p id="menmision">#}
                {#                                {{ inscripcionmalla.malla.misioncarrera|substraerconpunto:200|linebreaksbr }}#}
                {#                            </p>#}
                {#                            {% if inscripcionmalla.malla.misioncarrera|contarcaracter:200 %}#}
                {#                                <a href="javascript:;" class="alert-link leer" id="nleer1" descripcion="{{ inscripcionmalla.malla.misioncarrera|linebreaksbr }}" v="1" ver="1">Leer mas</a>#}
                {#                            {% endif %}#}
                {#                        </div>#}
                {#                    </div>#}
                {#                {% endif %}#}
                {% if inscripcionmalla.malla.perfilegreso %}
                    <div class="span{% if contar_llenos == 4 %}3{% elif contar_llenos == 3 %}4{% elif contar_llenos == 2 %}6{% elif contar_llenos == 1 %}12{% endif %}" id="tercero">
                        <div class="alert alert-info" style="text-align: justify">
                            <a  href="javascript:;" class="close" onclick="eliminardiv('tercero')" data-dismiss="alert">×</a>
                            <h4 class="alert-heading">PERFIL DE EGRESO</h4>
                            <p id="menegreso">
                                {{ inscripcionmalla.malla.perfilegreso|substraerconpunto:200|linebreaksbr }}
                            </p>
                            {% if inscripcionmalla.malla.perfilegreso|contarcaracter:200 %}
                                <a href="javascript:;" class="alert-link leer" id="nleer3" descripcion="{{ inscripcionmalla.malla.perfilegreso|linebreaksbr }}" v="3" ver="1">Leer mas</a>
                            {% endif %}
                        </div>
                    </div>
                {% endif %}
                {% if inscripcionmalla.malla.objetivocarrera %}
                    <div class="span{% if contar_llenos == 4 %}3{% elif contar_llenos == 3 %}4{% elif contar_llenos == 2 %}6{% elif contar_llenos == 1 %}12{% endif %}" id="cuarto">
                        <div class="alert alert-info" style="text-align: justify">
                            <a  href="javascript:;" class="close" onclick="eliminardiv('cuarto')" data-dismiss="alert">×</a>
                            <h4 class="alert-heading">OBJETIVO DE LA CARRERA</h4>
                            <p id="menobjetivo">
                                {{ inscripcionmalla.malla.objetivocarrera|substraerconpunto:200|linebreaksbr }}
                            </p>
                            {% if inscripcionmalla.malla.objetivocarrera|contarcaracter:200 %}
                                <a href="javascript:;" class="alert-link leer" id="nleer4" descripcion="{{ inscripcionmalla.malla.objetivocarrera|linebreaksbr }}" v="4" ver="1">Leer mas</a>
                            {% endif %}
                        </div>
                    </div>
                {% endif %}
            </div>
        {% endif %}
        <div id="no-more-tables"><!-- inicio no more tables-->
            <div class='span12'>
                <table class='table table-bordered table-striped' >
                    <thead>
                    <tr>
                        <th>Materia/Profesor</th>
                        <th style="width: 150px; text-align: center">Chats</th>
                        <th style="width: 90px;text-align: center;">Fecha Inicio/Fin</th>
                        {% if not OCULTAR_EXAMEN %}
                            <th style="width: 200px;text-align: center;">Fecha Examen</th>
                        {% endif %}
                        {#                        <th style="width: 200px;text-align: center;">Fecha Examen</th>#}
                        <th style="text-align: center;width: 350px;">Documentos/Recursos</th>
                        {% if usa_planificacion %}
                            <th style="text-align: center;width: 110px;">Acciones</th>
                        {% else %}
                            <th style="text-align: center;width: 110px;">Deberes</th>
                        {% endif %}
                    </tr>
                    </thead>
                    <tbody>
                    {% for materiaasignada in materiasasignadas %}
                        {#                    {% with silabo=profesormateria.materia|args:profesormateria.profesor|call:"syllabus" %}#}
                        {% if periodo.clasificacion == 1 %}
                            {% with profesormateria=materiaasignada.materia.profesor_materia_principal_sinautor mi_silabo=materiaasignada.materia|args:materiaasignada.materia.profesor_principal_sinautor|call:"mi_silabo_activo"  archivoword=materiaasignada.materia|call:"syllabusword" %}
                            <tr>
                                <td data-title='Materia/Prof.'>
                                    {% if periodo.id == 95 %}
                                        {{ materiaasignada.materia.nombre_mostrar_sin_profesor }}
                                    {% else %}
                                        {{ profesormateria.materia.nombre_completo}} - {{ profesormateria.profesor}}
                                    {% endif %}

                                    <br><b>Horas total de la materia: </b>{{ materiaasignada.materia.horas }}
                                    {% if materiaasignada.materia.asignaturamalla.asignatura.id == 4837 and materiaasignada.materia.nivel.periodo.id == 123 %}
                                        <br>
                                        <a class="btn btn-warning btn-mini" href="https://facebook.com/UniversidadEstatalDeMilagro/live" target="_blank"><i class="fa fa-link"></i> Ir a clase</a>
                                    {% endif %}
                                    <br><b>Asistencia Final:</b> {{ materiaasignada.asistenciafinal|floatformat:0 }}%
                                </td>
                                <td data-title='Chats' style="height: 60px">
                                    <div class="nav notify-row" id="top_menu" >
                                        <ul class="nav top-menu">
                                            <li id="header_notification_bar" class="dropdown" style="margin-left: 5px;">
                                                <a class="btn btn-default btn-mini tu " data-original-title="Tiene mensaje nuevo" href="/alu_documentos?action=controlacademico&id={{ materiaasignada.id|encrypt_alu }}">
                                                    <i class="fa fa-comments"></i>
                                                    <span class="badge bg-warning">{{ materiaasignada.materia.totalpreguntasalumnos }}</span>
                                                </a>
                                            </li>
                                            <li id="header_notification_bar" class="dropdown" style="margin-left: 5px;">
                                                <a class="btn btn-default btn-mini tu " data-original-title="Comunicados" href="/alu_documentos?action=comunicacion&id={{ materiaasignada.id|encrypt_alu }}">
                                                    <i class="fa fa-comment"></i>
                                                    <span class="badge bg-warning">{{ materiaasignada.materia.totalcomunicacionmasiva }}</span>
                                                </a>
                                            </li>
                                        </ul>
                                    </div>
                                </td>
                                <td data-title='Fecha Inicio/Fin' style="text-align: center;">
                                    {#                                    {% if profesormateria %}{{ profesormateria.desde|date:"d-m-Y" }} <br> {{ profesormateria.hasta|date:"d-m-Y" }}{% endif %}#}
                                    {{ materiaasignada.materia.inicio|date:"Y-m-d" }} - {{ materiaasignada.materia.fin|date:"Y-m-d" }}
                                </td>
                                {% if not OCULTAR_EXAMEN %}
                                    <td data-title='Fecha Exam.' style="text-align: left">
                                        {% for detalle in materiaasignada.materia.horarioexamen %}
{#                                            {{ detalle.detallemodelo.modelo.asistenciaaprobar }} - #}
                                            <strong>{{ detalle.detallemodelo.parcialconfiguraexamen }}: </strong> {{ detalle.fecha|date:'d-m-Y' }} <br>
                                            {% for detallehora in detalle.detallehoraexamen %}
                                                <strong>{{ detallehora.get_tipogrupo_display }}</strong> | {{ detallehora.horainicio|time:"H:i" }} - {{ detallehora.horafin|time:"H:i" }}<br>
                                            {% endfor %}
                                            {#                                        <strong>Comienza:</strong> {{ detalle.turno.comienza|time:"H:i a" }} <br>#}
                                            {%  if detalle.disponibleexamen  %}
                                                {% if detalle.detallemodelo.nombre  == 'EX2'  %}
                                                    {% if materiaasignada.asistenciafinal >= detalle.detallemodelo.modelo.asistenciaaprobar  %}
                                                        {% if materiaasignada.materia.profesor_principal.urlzoom %}
                                                            <a href="{{ materiaasignada.materia.profesor_principal.urlzoom }}" idma="{{ materiaasignada.id|encrypt_alu }}" idhe="{{ detalle.id|encrypt_alu }}" target="_blank" style="background-color: #2d8cff!important;" class='btn btn-primary btn-large videozoom'>
                                                                1 <i class="fa fa-video-camera"></i> Acceso al examen
                                                            </a><br>
                                                        {% endif %}
                                                        {% if materiaasignada.materia.profesor_principal.urlzoomdos %}
                                                            <br><a href="{{ materiaasignada.materia.profesor_principal.urlzoomdos }}" idma="{{ materiaasignada.id|encrypt_alu }}"  idhe="{{ detalle.id|encrypt_alu }}" target="_blank" style="background-color: #2d8cff!important;" class='btn btn-primary btn-large videozoom'>
                                                            2 <i class="fa fa-video-camera"></i> Acceso al examen
                                                        </a><br>
                                                        {% endif %}
                                                    {% else %}
                                                        <span class="label label-info">
                                                            No cumple con la asistencia
                                                        </span>
                                                    {% endif %}
                                                {% else %}
                                                    {% if materiaasignada.materia.profesor_principal.urlzoom %}
                                                        <a href="{{ materiaasignada.materia.profesor_principal.urlzoom }}" idma="{{ materiaasignada.id|encrypt_alu }}" idhe="{{ detalle.id|encrypt_alu }}" target="_blank" style="background-color: #2d8cff!important;" class='btn btn-primary btn-large videozoom'>
                                                            1 <i class="fa fa-video-camera"></i> Acceso al examen
                                                        </a><br>
                                                    {% endif %}
                                                    {% if materiaasignada.materia.profesor_principal.urlzoomdos %}
                                                        <br><a href="{{ materiaasignada.materia.profesor_principal.urlzoomdos }}" idma="{{ materiaasignada.id|encrypt_alu }}"  idhe="{{ detalle.id|encrypt_alu }}" target="_blank" style="background-color: #2d8cff!important;" class='btn btn-primary btn-large videozoom'>
                                                        2 <i class="fa fa-video-camera"></i> Acceso al examen
                                                    </a><br>
                                                    {% endif %}
                                                {% endif %}
                                            {% endif %}
                                        {% endfor %}
                                    </td>
                                {% endif %}
                                <td data-title='Doc/Recursos'>
                                    {% if materiaasignada.materia.documentos %}
                                        <div class="accordion" id="accordion{{ forloop.counter}}">
                                            <div class="accordion-group">
                                                <div class="accordion-heading">
                                                    <span class="accordion-toggle">
                                                <a class="btn btn-mini btn-info" data-toggle="collapse" data-parent="#accordion{{ forloop.counter}}" href="#collapseOne{{ forloop.counter}}"><i class="fa fa-list"></i></a>
                                                <a data-toggle="collapse" data-parent="#accordion{{ forloop.counter}}" href="#collapseOne{{ forloop.counter}}">Click para ver los recursos</a>
                                            </span>
                                                </div>
                                                <div id="collapseOne{{ forloop.counter}}" class="accordion-body collapse in">
                                                    <div class="accordion-inner">
                                                        {% for documento in materiaasignada.materia.documentos %}
                                                            <ol>
                                                                <span class="smaller"><a target="_blank" href="{{ documento.archivo.url }}">{{ forloop.counter }}. - {{ documento.nombre }}</a></span>
                                                            </ol>
                                                        {% endfor %}
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    {% endif %}
                                </td>
                                <td data-title='{% if usa_planificacion %}Acciones{% else %}Deberes{% endif %}'
                                    style="text-align: center">
                                    <div class="btn-group" style="text-align: center">
                                        <a class="btn btn-mini dropdown-toggle" data-toggle="dropdown" href="javascript:;">Acciones<span class="caret"></span></a>
                                        <ul class="dropdown-menu pull-right list-group" style="text-align: left;">
                                            {% if not materiaasignada.cerrado %}

                                                <li>
                                                    <a href="/alu_asistencias" class="bloqueo_pantalla" title="Asistencias"><i class="fa fa-tasks"></i> Asistencias</a>
                                                    {#                                                    <a href="/alu_documentos?action=asistenciazoom&id={{ materiaasignada.id|encrypt_alu }}"#}
                                                    {#                                                       title="Asistencias"><i class="fa fa-tasks"></i> Asistencias zoom#}
                                                    {#                                                    </a>#}
                                                </li>
                                            {% endif %}

                                            {%  if materiaasignada.materia.idcursomoodle %}
                                                {% if materiaasignada.materia.asignaturamalla.malla.modalidad_id == 1 or materiaasignada.materia.asignaturamalla.malla.modalidad_id == 2 %}
                                                    <li><a href="{{ periodo.urlmoodle }}/course/view.php?id={{ materiaasignada.materia.idcursomoodle }}" class="" target="_blank"><span class="fa fa-file-pdf-o"></span> Ir al curso de moodle</a> </li>
                                                {% elif materiaasignada.materia.asignaturamalla.malla.modalidad_id == 3 %}
                                                    <li><a href="{{ periodo.urlmoodleenlinea }}/course/view.php?id={{ materiaasignada.materia.idcursomoodle }}" class="" target="_blank"><span class="fa fa-file-pdf-o"></span> Ir al curso de moodle</a> </li>
                                                {% endif %}
                                            {% endif %}

                                            {% if usa_planificacion %}
                                                {#                                                {% if materiaasignada.tiene_planificaciones  %}#}
                                                {%  if not materiaasignada.materia.idcursomoodle  %}
                                                    <li><a href="/alu_documentos?action=planificacion&id={{ materiaasignada.id|encrypt_alu }}" class="bloqueo_pantalla" title="Control de Tareas"><i class="fa fa-tasks"></i> Control de Tareas </a></li>
                                                {% endif %}
                                                {#                                                {% endif %}#}
                                            {% else %}
                                                {% for profesor in materiaasignada.profesores %}
                                                    {% if materiaasignada.materia.deber %}
                                                        <li><a href='/alu_documentos?action=deberes&id={{ materiaasignada.materia.id }}&p={{ profesor.id }}' class="bloqueo_pantalla"></a></li>
                                                    {% else %}
                                                        <span class="label label-important">SIN DEBERES</span>
                                                    {% endif %}
                                                {% endfor %}
                                                {% if materiaasignada.materia.deber %}
                                                    <li><a class="bloqueo_pantalla" href='/alu_documentos?action=deberes&id={{ materiaasignada.materia.id|encrypt_alu }}'>{{ materiaasignada.materia.deber.count }} - Deber{% if materiaasignada.materia.deber.count > 1 %}es{% endif %}</a></li>
                                                {% endif %}
                                            {% endif %}
                                            <li><a class="bloqueo_pantalla" title="Acompañamiento Académico" href="/alu_documentos?action=controlacademico&id={{ materiaasignada.id|encrypt_alu }}"><i class="fa fa-comment"></i> Acompañamiento Académico</a></li>
                                            {% if mi_silabo %}
                                                {% if mi_silabo.estado_planificacion_clases >= 100 %}
                                                    <li><a href="javascript:;" id="silabo" class='silabo bloqueo_pantalla' idm="{{ materiaasignada.materia.id|encrypt_alu}}"><i class="fa fa-file-pdf-o  "></i> Sílabo</a></li>
                                                {% endif %}
                                            {% endif %}
                                            <li><a href='/alu_documentos?action=bibliografia&id={{ materiaasignada.materia.id|encrypt_alu }}'><i class="fa fa-book"></i> Bibliografía</a></li>
                                            {% if mi_silabo %}
                                                {% if mi_silabo.numero_guia_practicas > 0 %}
                                                    <li><a href='/alu_documentos?action=guiapracticas&id={{ materiaasignada.materia.id|encrypt_alu }}'><i class="fa fa-list"></i> Guías de prácticas</a></li>
                                                {% endif %}
                                            {% endif %}
                                            {% if archivoword.archivo %}
                                                <li><a target="_blank" href="{{ archivoword.download_link }}"><i class="fa fa-download "></i> Descargar sílabo</a></li>
                                            {% endif %}
                                        </ul>
                                    </div>
                                    {#                            <td style="text-align: center">#}
                                    {#                                {% if usa_planificacion %}#}
                                    {#                                    {% if materiaasignada.tiene_planificaciones  %}#}
                                    {#                                        <a href="/alu_documentos?action=planificacion&id={{ materiaasignada.id|encrypt_alu }}" class="btn {% if materiaasignada.tareas_planificadas_activas %}btn-danger{% else %}btn-success{% endif %} tl" title="Control de Tareas"><i class="fa fa-tasks"></i></a>#}
                                    {#                                    {% endif %}#}
                                    {#                                {% else %}#}
                                    {#                                    {% for profesor in materiaasignada.profesores %}#}
                                    {#                                        {% if materiaasignada.materia.deber %}#}
                                    {#                                            <a href='/alu_documentos?action=deberes&id={{ materiaasignada.materia.id }}&p={{ profesor.id }}'></a>#}
                                    {#                                        {% else %}#}
                                    {#                                            <span class="label label-important">SIN DEBERES</span>#}
                                    {#                                        {% endif %}#}
                                    {#                                    {% endfor %}#}
                                    {#                                    {% if materiaasignada.materia.deber %}#}
                                    {#                                        <a href='/alu_documentos?action=deberes&id={{ materiaasignada.materia.id|encrypt_alu }}'>{{ materiaasignada.materia.deber.count }} - Deber{% if materiaasignada.materia.deber.count > 1 %}es{% endif %}</a>#}
                                    {#                                    {% endif %}#}
                                    {#                                {% endif %}#}
                                    {#                                <a class="btn btn-info pull-right tl" title="Acompañamiento Académico" href="/alu_documentos?action=controlacademico&id={{ materiaasignada.id|encrypt_alu }}"><i class="fa fa-comment"></i></a>#}
                                    {#                            </td>#}
                            </tr>
                        {% endwith %}
                        {% else %}
                            {% with profesormateria=materiaasignada.materia.profesor_materia_principal mi_silabo=materiaasignada.materia|args:materiaasignada.materia.profesor_principal|call:"mi_silabo_activo"  archivoword=materiaasignada.materia|call:"syllabusword" %}
                            <tr>
                                <td data-title='Materia/Prof.'>
                                    {% if periodo.id == 95 %}
                                        {{ materiaasignada.materia.nombre_mostrar_sin_profesor }}
                                    {% else %}
                                        {{ materiaasignada.materia.nombre_mostrar }}
                                    {% endif %}

                                    <br><b>Horas total de la materia: </b>{{ materiaasignada.materia.horas }}
                                    {% if materiaasignada.materia.asignaturamalla.asignatura.id == 4837 and materiaasignada.materia.nivel.periodo.id == 123 %}
                                        <br>
                                        <a class="btn btn-warning btn-mini" href="https://facebook.com/UniversidadEstatalDeMilagro/live" target="_blank"><i class="fa fa-link"></i> Ir a clase</a>
                                    {% endif %}
                                    <br><b>Asistencia Final:</b> {{ materiaasignada.asistenciafinal|floatformat:0 }}%
                                </td>
                                <td data-title='Chats' style="height: 60px">
                                    <div class="nav notify-row" id="top_menu" >
                                        <ul class="nav top-menu">
                                            <li id="header_notification_bar" class="dropdown" style="margin-left: 5px;">
                                                <a class="btn btn-default btn-mini tu " data-original-title="Tiene mensaje nuevo" href="/alu_documentos?action=controlacademico&id={{ materiaasignada.id|encrypt_alu }}">
                                                    <i class="fa fa-comments"></i>
                                                    <span class="badge bg-warning">{{ materiaasignada.materia.totalpreguntasalumnos }}</span>
                                                </a>
                                            </li>
                                            <li id="header_notification_bar" class="dropdown" style="margin-left: 5px;">
                                                <a class="btn btn-default btn-mini tu " data-original-title="Comunicados" href="/alu_documentos?action=comunicacion&id={{ materiaasignada.id|encrypt_alu }}">
                                                    <i class="fa fa-comment"></i>
                                                    <span class="badge bg-warning">{{ materiaasignada.materia.totalcomunicacionmasiva }}</span>
                                                </a>
                                            </li>
                                        </ul>
                                    </div>
                                </td>
                                <td data-title='Fecha Inicio/Fin' style="text-align: center;">
                                    {#                                    {% if profesormateria %}{{ profesormateria.desde|date:"d-m-Y" }} <br> {{ profesormateria.hasta|date:"d-m-Y" }}{% endif %}#}
                                    {{ materiaasignada.materia.inicio|date:"Y-m-d" }} - {{ materiaasignada.materia.fin|date:"Y-m-d" }}
                                </td>
                                {% if not OCULTAR_EXAMEN %}
                                    <td data-title='Fecha Exam.' style="text-align: left">
                                        {% for detalle in materiaasignada.materia.horarioexamen %}
{#                                            {{ detalle.detallemodelo.modelo.asistenciaaprobar }} - #}
                                            <strong>{{ detalle.detallemodelo.parcialconfiguraexamen }}: </strong> {{ detalle.fecha|date:'d-m-Y' }} <br>
                                            {% for detallehora in detalle.detallehoraexamen %}
                                                <strong>{{ detallehora.get_tipogrupo_display }}</strong> | {{ detallehora.horainicio|time:"H:i" }} - {{ detallehora.horafin|time:"H:i" }}<br>
                                            {% endfor %}
                                            {#                                        <strong>Comienza:</strong> {{ detalle.turno.comienza|time:"H:i a" }} <br>#}
                                            {%  if detalle.disponibleexamen  %}
                                                {% if detalle.detallemodelo.nombre  == 'EX2'  %}
                                                    {% if materiaasignada.asistenciafinal >= detalle.detallemodelo.modelo.asistenciaaprobar  %}
                                                        {% if materiaasignada.materia.profesor_principal.urlzoom %}
                                                            <a href="{{ materiaasignada.materia.profesor_principal.urlzoom }}" idma="{{ materiaasignada.id|encrypt_alu }}" idhe="{{ detalle.id|encrypt_alu }}" target="_blank" style="background-color: #2d8cff!important;" class='btn btn-primary btn-large videozoom'>
                                                                1 <i class="fa fa-video-camera"></i> Acceso al examen
                                                            </a><br>
                                                        {% endif %}
                                                        {% if materiaasignada.materia.profesor_principal.urlzoomdos %}
                                                            <br><a href="{{ materiaasignada.materia.profesor_principal.urlzoomdos }}" idma="{{ materiaasignada.id|encrypt_alu }}"  idhe="{{ detalle.id|encrypt_alu }}" target="_blank" style="background-color: #2d8cff!important;" class='btn btn-primary btn-large videozoom'>
                                                            2 <i class="fa fa-video-camera"></i> Acceso al examen
                                                        </a><br>
                                                        {% endif %}
                                                    {% else %}
                                                        <span class="label label-info">
                                                            No cumple con la asistencia
                                                        </span>
                                                    {% endif %}
                                                {% else %}
                                                    {% if materiaasignada.materia.profesor_principal.urlzoom %}
                                                        <a href="{{ materiaasignada.materia.profesor_principal.urlzoom }}" idma="{{ materiaasignada.id|encrypt_alu }}" idhe="{{ detalle.id|encrypt_alu }}" target="_blank" style="background-color: #2d8cff!important;" class='btn btn-primary btn-large videozoom'>
                                                            1 <i class="fa fa-video-camera"></i> Acceso al examen
                                                        </a><br>
                                                    {% endif %}
                                                    {% if materiaasignada.materia.profesor_principal.urlzoomdos %}
                                                        <br><a href="{{ materiaasignada.materia.profesor_principal.urlzoomdos }}" idma="{{ materiaasignada.id|encrypt_alu }}"  idhe="{{ detalle.id|encrypt_alu }}" target="_blank" style="background-color: #2d8cff!important;" class='btn btn-primary btn-large videozoom'>
                                                        2 <i class="fa fa-video-camera"></i> Acceso al examen
                                                    </a><br>
                                                    {% endif %}
                                                {% endif %}
                                            {% endif %}
                                        {% endfor %}
                                    </td>
                                {% endif %}
                                <td data-title='Doc/Recursos'>
                                    {% if materiaasignada.materia.documentos %}
                                        <div class="accordion" id="accordion{{ forloop.counter}}">
                                            <div class="accordion-group">
                                                <div class="accordion-heading">
                                                    <span class="accordion-toggle">
                                                <a class="btn btn-mini btn-info" data-toggle="collapse" data-parent="#accordion{{ forloop.counter}}" href="#collapseOne{{ forloop.counter}}"><i class="fa fa-list"></i></a>
                                                <a data-toggle="collapse" data-parent="#accordion{{ forloop.counter}}" href="#collapseOne{{ forloop.counter}}">Click para ver los recursos</a>
                                            </span>
                                                </div>
                                                <div id="collapseOne{{ forloop.counter}}" class="accordion-body collapse in">
                                                    <div class="accordion-inner">
                                                        {% for documento in materiaasignada.materia.documentos %}
                                                            <ol>
                                                                <span class="smaller"><a target="_blank" href="{{ documento.archivo.url }}">{{ forloop.counter }}. - {{ documento.nombre }}</a></span>
                                                            </ol>
                                                        {% endfor %}
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    {% endif %}
                                </td>
                                <td data-title='{% if usa_planificacion %}Acciones{% else %}Deberes{% endif %}'
                                    style="text-align: center">
                                    <div class="btn-group" style="text-align: center">
                                        <a class="btn btn-mini dropdown-toggle" data-toggle="dropdown" href="javascript:;">Acciones<span class="caret"></span></a>
                                        <ul class="dropdown-menu pull-right list-group" style="text-align: left;">
                                            {% if not materiaasignada.cerrado %}

                                                <li>
                                                    <a href="/alu_asistencias" class="bloqueo_pantalla" title="Asistencias"><i class="fa fa-tasks"></i> Asistencias</a>
                                                    {#                                                    <a href="/alu_documentos?action=asistenciazoom&id={{ materiaasignada.id|encrypt_alu }}"#}
                                                    {#                                                       title="Asistencias"><i class="fa fa-tasks"></i> Asistencias zoom#}
                                                    {#                                                    </a>#}
                                                </li>
                                            {% endif %}

                                            {%  if materiaasignada.materia.idcursomoodle %}
                                                {% if materiaasignada.materia.asignaturamalla.malla.modalidad_id == 1 or materiaasignada.materia.asignaturamalla.malla.modalidad_id == 2 %}
                                                   <li><a href="{{ periodo.urlmoodle }}/course/view.php?id={{ materiaasignada.materia.idcursomoodle }}" class="" target="_blank"><span class="fa fa-file-pdf-o"></span> Ir al curso de moodle</a> </li>
                                                {% elif materiaasignada.materia.asignaturamalla.malla.modalidad_id == 3 %}
                                                    <li><a href="{{ periodo.urlmoodleenlinea }}/course/view.php?id={{ materiaasignada.materia.idcursomoodle }}" class="" target="_blank"><span class="fa fa-file-pdf-o"></span> Ir al curso de moodle</a> </li>
                                                {% endif %}
                                            {% endif %}

                                            {% if usa_planificacion %}
                                                {#                                                {% if materiaasignada.tiene_planificaciones  %}#}
                                                {%  if not materiaasignada.materia.idcursomoodle  %}
                                                    <li><a href="/alu_documentos?action=planificacion&id={{ materiaasignada.id|encrypt_alu }}" class="bloqueo_pantalla" title="Control de Tareas"><i class="fa fa-tasks"></i> Control de Tareas </a></li>
                                                {% endif %}
                                                {#                                                {% endif %}#}
                                            {% else %}
                                                {% for profesor in materiaasignada.profesores %}
                                                    {% if materiaasignada.materia.deber %}
                                                        <li><a href='/alu_documentos?action=deberes&id={{ materiaasignada.materia.id }}&p={{ profesor.id }}' class="bloqueo_pantalla"></a></li>
                                                    {% else %}
                                                        <span class="label label-important">SIN DEBERES</span>
                                                    {% endif %}
                                                {% endfor %}
                                                {% if materiaasignada.materia.deber %}
                                                    <li><a class="bloqueo_pantalla" href='/alu_documentos?action=deberes&id={{ materiaasignada.materia.id|encrypt_alu }}'>{{ materiaasignada.materia.deber.count }} - Deber{% if materiaasignada.materia.deber.count > 1 %}es{% endif %}</a></li>
                                                {% endif %}
                                            {% endif %}
                                            <li><a class="bloqueo_pantalla" title="Acompañamiento Académico" href="/alu_documentos?action=controlacademico&id={{ materiaasignada.id|encrypt_alu }}"><i class="fa fa-comment"></i> Acompañamiento Académico</a></li>
                                            {% if mi_silabo %}
                                                {% if mi_silabo.estado_planificacion_clases >= 100 %}
                                                    <li><a href="javascript:;" id="silabo" class='silabo bloqueo_pantalla' idm="{{ materiaasignada.materia.id|encrypt_alu}}"><i class="fa fa-file-pdf-o  "></i> Sílabo</a></li>
                                                {% endif %}
                                            {% endif %}
                                            <li><a href='/alu_documentos?action=bibliografia&id={{ materiaasignada.materia.id|encrypt_alu }}'><i class="fa fa-book"></i> Bibliografía</a></li>
                                            {% if mi_silabo %}
                                                {% if mi_silabo.numero_guia_practicas > 0 %}
                                                    <li><a href='/alu_documentos?action=guiapracticas&id={{ materiaasignada.materia.id|encrypt_alu }}'><i class="fa fa-list"></i> Guías de prácticas</a></li>
                                                {% endif %}
                                            {% endif %}
                                            {% if archivoword.archivo %}
                                                <li><a target="_blank" href="{{ archivoword.download_link }}"><i class="fa fa-download "></i> Descargar sílabo</a></li>
                                            {% endif %}
                                        </ul>
                                    </div>
                                    {#                            <td style="text-align: center">#}
                                    {#                                {% if usa_planificacion %}#}
                                    {#                                    {% if materiaasignada.tiene_planificaciones  %}#}
                                    {#                                        <a href="/alu_documentos?action=planificacion&id={{ materiaasignada.id|encrypt_alu }}" class="btn {% if materiaasignada.tareas_planificadas_activas %}btn-danger{% else %}btn-success{% endif %} tl" title="Control de Tareas"><i class="fa fa-tasks"></i></a>#}
                                    {#                                    {% endif %}#}
                                    {#                                {% else %}#}
                                    {#                                    {% for profesor in materiaasignada.profesores %}#}
                                    {#                                        {% if materiaasignada.materia.deber %}#}
                                    {#                                            <a href='/alu_documentos?action=deberes&id={{ materiaasignada.materia.id }}&p={{ profesor.id }}'></a>#}
                                    {#                                        {% else %}#}
                                    {#                                            <span class="label label-important">SIN DEBERES</span>#}
                                    {#                                        {% endif %}#}
                                    {#                                    {% endfor %}#}
                                    {#                                    {% if materiaasignada.materia.deber %}#}
                                    {#                                        <a href='/alu_documentos?action=deberes&id={{ materiaasignada.materia.id|encrypt_alu }}'>{{ materiaasignada.materia.deber.count }} - Deber{% if materiaasignada.materia.deber.count > 1 %}es{% endif %}</a>#}
                                    {#                                    {% endif %}#}
                                    {#                                {% endif %}#}
                                    {#                                <a class="btn btn-info pull-right tl" title="Acompañamiento Académico" href="/alu_documentos?action=controlacademico&id={{ materiaasignada.id|encrypt_alu }}"><i class="fa fa-comment"></i></a>#}
                                    {#                            </td>#}
                            </tr>
                        {% endwith %}
                        {% endif %}
                        {% if not materiasasignadas %}
                            <tr><td colspan="4" align='center'>NO EXISTEN MATERIAS</td></tr>
                        {% endif %}
                    {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <div class="modal fade static" id="itemspanelsilabo" style="display: none;">
        <div class="modal-header">
            <h3 class="paneltitle">Listado de sílabos </h3>
        </div>
        <div class="modal-body panelbody">
        </div>
        <div class="modal-footer">
            <table class="pull-right">
                <tr>
                    <td><a href="javascript:;" class="btn btn-cerrar btn-info">Cerrar</a></td>
                </tr>
            </table>
        </div>
    </div>
{% endblock %}
