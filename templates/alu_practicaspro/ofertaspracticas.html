{% extends "basebs.html" %}
{% load sga_extras %}
{% block heading %}
    <link href="/static/css/table-responsive.css?1.0.0" type="text/css" rel="stylesheet"/>
    <script type="text/javascript">
        desplegar_obj = true;

        $(document).ready(function () {
            $(".primerfilaacoordion").on('show.bs.collapse', function () {
                $(this).parent().find(".fa").removeClass("fa-chevron-down").addClass("fa-chevron-up");
            }).on('hide.bs.collapse', function () {
                $(this).parent().find(".fa").removeClass("fa-chevron-up").addClass("fa-chevron-down");
            });

            $(".segundafilaacoordion").on('show.bs.collapse', function () {
                $(this).parent().find(".fa").removeClass("fa-chevron-down").addClass("fa-chevron-up");
            }).on('hide.bs.collapse', function () {
                $(this).parent().find(".fa").removeClass("fa-chevron-up").addClass("fa-chevron-down");
            });
        });

        $(function () {

            $('#desplegar_obj').click(function () {
                if (desplegar_obj) {
                    $('#desplegar_obj').parent().find(".fa").removeClass("fa-chevron-down").addClass("fa-chevron-up");
                    $(".primerfilaacoordion").each(function () {
                        $(this).parent().find(".fa").removeClass("fa-chevron-down").addClass("fa-chevron-up");
                        $(this).collapse('show')
                    });
                    $(".segundafilaacoordion").each(function () {
                        $(this).parent().find(".fa").removeClass("fa-chevron-down").addClass("fa-chevron-up");
                        $(this).collapse('show')
                    });
                    desplegar_obj = false;
                } else {
                    $('#desplegar_obj').parent().find(".fa").removeClass("fa-chevron-up").addClass("fa-chevron-down");
                    $(".primerfilaacoordion").each(function () {
                        $(this).parent().find(".fa").removeClass("fa-chevron-up").addClass("fa-chevron-down");
                        $(this).collapse('hide')
                    });
                    $(".segundafilaacoordion").each(function () {
                        $(this).parent().find(".fa").removeClass("fa-chevron-up").addClass("fa-chevron-down");
                        $(this).collapse('hide')
                    });
                    desplegar_obj = true;
                }
            });

            busqueda = function () {
                var term = $("#searchinput").val().toUpperCase().trim();
                var tipobuse = $("#tipobusqueda").val();
                if (term.length > 0) {
                    location.href = "/alu_practicaspro?action=ofertaspracticas&s=" + term;
                }
            };

            $("#search").click(function () {
                busqueda();
            });

            $('#searchinput').keyup(function (e) {
                if (e.keyCode == 13) {
                    busqueda();
                }
            });
        });
    </script>
    <style>
        .result-list {
            list-style-type: none;
            margin: 0;
            padding: 0;
            width: 100%
        }

        .result-list:after, .result-list:before {
            content: '';
            display: table;
            clear: both
        }

        .result-list > li {
            background: #fff;
            overflow: hidden;
            position: relative;
            display: -webkit-box;
            display: -ms-flexbox;
            display: flex;
            -webkit-flex-wrap: wrap;
            -ms-flex-wrap: wrap;
            flex-wrap: wrap;
            -webkit-border-radius: 6px;
            border-radius: 6px
        }

        .result-list > li:after, .result-list > li:before {
            content: '';
            display: table;
            clear: both
        }

        @media (max-width: 991.98px) {
            .result-list > li {
                padding-top: 160px
            }
        }

        @media (max-width: 575.98px) {
            .result-list > li {
                display: block
            }
        }

        .result-list > li + li {
            margin-top: 10px
        }

        .result-list > li .result-image {
            width: 240px;
            padding: 0;
            overflow: hidden;
            background: #2d353c;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat
        }

        @media (max-width: 1199.98px) {
            .result-list > li .result-image {
                width: 180px
            }
        }

        @media (max-width: 991.98px) {
            .result-list > li .result-image {
                width: auto;
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
                height: 160px
            }
        }

        .result-list > li .result-image a {
            display: block
        }

        .result-list > li .result-image img {
            width: 100%
        }

        .result-list > li .result-image:focus, .result-list > li .result-image:hover {
            opacity: .8
        }

        .result-list > li .result-info {
            padding: 4px;
            position: relative;
            -webkit-box-flex: 1;
            -ms-flex: 1;
            flex: 1
        }

        @media (max-width: 1199.98px) {
            .result-list > li .result-info {
                padding: 4px
            }
        }

        .result-list > li .result-info .title {
            margin: 0 0 5px;
            font-size: 18px;
            line-height: 22px
        }

        @media (max-width: 991.98px) {
            .result-list > li .result-info .title {
                font-size: 16px;
                line-height: 20px
            }
        }

        .result-list > li .result-info .title a {
            color: #2d353c
        }

        .result-list > li .result-info .location {
            color: #6f8293;
            margin-bottom: 15px
        }

        .result-list > li .result-info .decs {
            margin-bottom: 20px;
            max-height: 32px;
            overflow: hidden;
            text-overflow: ellipsis;
            line-height: 16px
        }

        .result-list > li .result-info .btn-row {
            display: -webkit-box;
            display: -ms-flexbox;
            display: flex;
            -webkit-flex-wrap: wrap;
            -ms-flex-wrap: wrap;
            flex-wrap: wrap
        }

        .result-list > li .result-info .btn-row:after, .result-list > li .result-info .btn-row:before {
            content: '';
            display: table;
            clear: both
        }

        .result-list > li .result-info .btn-row a {
            color: #2d353c;
            background: #f2f3f4;
            font-size: 14px;
            line-height: 18px;
            padding: 8px 10px;
            -webkit-border-radius: 4px;
            border-radius: 4px
        }

        .result-list > li .result-info .btn-row a + a {
            margin-left: 5px
        }

        .result-list > li .result-info .btn-row a:focus, .result-list > li .result-info .btn-row a:hover {
            background: #d5dbe0
        }

        .result-list > li .result-price {
            width: 240px;
            font-size: 28px;
            text-align: center;
            background: #f2f3f4;
            color: #2d353c;
            padding: 20px;
            position: relative;
            display: -webkit-box;
            display: -ms-flexbox;
        {#display: flex;#} -webkit-box-orient: vertical;
            -webkit-box-direction: normal;
            -ms-flex-direction: column;
            flex-direction: column;
            -webkit-box-pack: center;
            -ms-flex-pack: center;
            justify-content: center;
            -ms-flex-align: center;
            align-items: center
        }

        @media (max-width: 1199.98px) {
            .result-list > li .result-price {
                width: 180px;
                padding: 15px
            }
        }

        @media (max-width: 575.98px) {
            .result-list > li .result-price {
                width: auto
            }
        }

        .result-list > li .result-price small {
            display: block;
            font-size: 11px;
            font-weight: 600;
            color: #6f8293
        }

        .result-list > li .result-price .btn {
            margin-top: 30px
        }

        @media (max-width: 575.98px) {
            .result-list > li .result-price .btn {
                margin-top: 15px
            }
        }

        .row > [class^=col-].ui-sortable {
            min-height: 50px
        }

        @-webkit-keyframes rotation {
            from {
                -webkit-transform: rotate(0);
                -moz-transform: rotate(0);
                -ms-transform: rotate(0);
                -o-transform: rotate(0);
                transform: rotate(0)
            }
            to {
                -webkit-transform: rotate(359deg);
                -moz-transform: rotate(359deg);
                -ms-transform: rotate(359deg);
                -o-transform: rotate(359deg);
                transform: rotate(359deg)
            }
        }

        @-moz-keyframes rotation {
            from {
                -webkit-transform: rotate(0);
                -moz-transform: rotate(0);
                -ms-transform: rotate(0);
                -o-transform: rotate(0);
                transform: rotate(0)
            }
            to {
                -webkit-transform: rotate(359deg);
                -moz-transform: rotate(359deg);
                -ms-transform: rotate(359deg);
                -o-transform: rotate(359deg);
                transform: rotate(359deg)
            }
        }

        @-o-keyframes rotation {
            from {
                -webkit-transform: rotate(0);
                -moz-transform: rotate(0);
                -ms-transform: rotate(0);
                -o-transform: rotate(0);
                transform: rotate(0)
            }
            to {
                -webkit-transform: rotate(359deg);
                -moz-transform: rotate(359deg);
                -ms-transform: rotate(359deg);
                -o-transform: rotate(359deg);
                transform: rotate(359deg)
            }
        }

        @keyframes rotation {
            from {
                -webkit-transform: rotate(0);
                -moz-transform: rotate(0);
                -ms-transform: rotate(0);
                -o-transform: rotate(0);
                transform: rotate(0)
            }
            to {
                -webkit-transform: rotate(359deg);
                -moz-transform: rotate(359deg);
                -ms-transform: rotate(359deg);
                -o-transform: rotate(359deg);
                transform: rotate(359deg)
            }
        }
    </style>
{% endblock %}
{% block atras %}/alu_practicaspro{% endblock %}
{% block canvas %}
    <div class='row-fluid'>
        <div class='span12'>
            <h4>{{ title }}</h4>
        </div>
        <div class="span5"></div>
        <div class="span6">
            <form class="form-search">
                <input class='searchinput' type='text' id='searchinput' value='{{ search }}' autocomplete="off"/>
                <a href="javascript:;" id='search' class='btn btn-info'><span class="fa fa-search "></span> Buscar</a>
                {% if search or ids %}
                    <a href="/alu_practicaspro?action=ofertaspracticas" id='allresults' class='btn btn-info'><span
                            class="fa fa-refresh "></span> Todos</a>
                {% endif %}
            </form>
        </div>
    </div>

    <div id="no-more-tables"><!-- inicio no more tables-->
        <div class='row-fluid'>
            <div class='span12'>
                <table class='table table-striped table-bordered' cellpadding="0" cellspacing="0">
                    <thead>
                    <tr>
                        <th style="width: 100px;text-align: center;">Empresa</th>
                        <th style="width: 25px;text-align: center;">Estado</th>
                        <th style="width: 100px;text-align: center;">Detalles</th>
                        <th style="width: 150px;text-align: center;">Carreras / Itinerarios<br><a class="btn btn-block"
                                                                                                  id="desplegar_obj"><span
                                class="fa fa-chevron-down"></span> Desplegar todo</a></th>
                        <th style="width: 25px;text-align: center;">Ins./Cup.</th>
                        <th style="width: 100px;text-align: center;">Fechas</th>
                        <th style="width: 40px;text-align: center;">Inscribirse</th>
                    </tr>
                    </thead>
                    <tbody>
                    {% for ofe in ofertas %}
                        <tr>
                            <td data-title='Empresa:' style="text-align: justify;">
                                {% if not ofe.otraempresa %}{{ ofe.empresa }}{% else %}
                                    {{ ofe.otraempresaempleadora }}{% endif %}<br>
                                <strong>Otra empresa:</strong><span
                                    class="label label-{% if ofe.otraempresa %}info{% else %}default{% endif %}">{% if ofe.otraempresa %}
                                SI{% else %}NO{% endif %}</span><br/>
                                <strong>Tipo:</strong> {{ ofe.get_tipo_display }}<br>
                                <strong>Horas:</strong> {{ ofe.numerohora }}<br>
                            </td>
                            <td data-title='Estado:' style="text-align: center;">
                                <span class="label label-{% if ofe.esta_en_fecha.0 == 1 %}warning{% elif ofe.esta_en_fecha.0 == 2 %}success{% else %}important{% endif %}">{{ ofe.esta_en_fecha.1 }}</span>
                            </td>
                            <td data-title='Detalles:' style="text-align: justify;">
                                {% if ofe.departamento %}<b>Departamento:</b> {{ ofe.departamento|default_if_none:"" }}
                                    <br/>{% endif %}
                                {% if ofe.horario %}<b>Horario:</b> {{ ofe.horario }}<br/>{% endif %}
                                {% if ofe.requisito %}<b>Requisitos: </b>{{ ofe.requisito }}<br/>{% endif %}
                                {% if ofe.habilidad %}<b>Habilidades: </b>{{ ofe.habilidad }}{% endif %}
                            </td>
                            <td data-title='Car./ Iti:' style="text-align: justify;">
                                {% if ofe.vercarreras %}
                                    <div class="accordion-group">
                                        <div class="accordion-heading" style="background-color:#f0f0f0">
                                            <a style="color: black" class="accordion-toggle" data-toggle="collapse"
                                               data-parent="#accordion2" href="#collapseTwo{{ forloop.counter }}">
                                                <span class="fa fa-chevron-down"></span> Carreras
                                            </a>
                                        </div>
                                        <div id="collapseTwo{{ forloop.counter }}"
                                             class="accordion-body collapse segundafilaacoordion in">
                                            <div class="accordion-inner">
                                                {% for carrera in ofe.vercarreras %}
                                                    {{ forloop.counter }}. {{ carrera }}<br/>
                                                {% endfor %}
                                            </div>
                                        </div>
                                    </div>
                                {% endif %}
                                {% if ofe.veritinerarios %}
                                    <div class="accordion-group">
                                        <div class="accordion-heading" style="background-color:#f0f0f0">
                                            <a style="color: black" class="accordion-toggle" data-toggle="collapse"
                                               data-parent="#accordion1" href="#collapseOne{{ forloop.counter }}">
                                                <span class="fa fa-chevron-down"></span> Itinerarios
                                            </a>
                                        </div>
                                        <div id="collapseOne{{ forloop.counter }}"
                                             class="accordion-body collapse primerfilaacoordion in">
                                            <div class="accordion-inner">
                                                {% for itinerario in ofe.veritinerarios %}
                                                    {{ forloop.counter }}. {{ itinerario }}<br/>
                                                {% endfor %}
                                            </div>
                                        </div>
                                    </div>
                                {% endif %}
                            </td>
                            <td data-title='Cupos:' style="text-align: center;">
                                {% if ofe.cupos > ofe.total_inscritos %}
                                    {{ ofe.total_inscritos }}/{{ ofe.cupos }}
                                {% else %}
                                    {{ ofe.total_inscritos }}/{{ ofe.total_inscritos }}
                                {% endif %}
                            </td>
                            <td data-title='Fechas:'>
                                <span style="font-size: 10px">
                                    <b>F.Ini Ofer: </b><span
                                        class="label label-warning">{{ ofe.inicio|date:'d-m-Y' }}</span><br>
                                    <b>F.Fin Ofer:</b> <span
                                        class="label label-warning">{{ ofe.fin|date:'d-m-Y' }}</span><br>
                                    <b>F.Ini Pract: </b><span
                                        class="label label-info">{{ ofe.iniciopractica|date:'d-m-Y' }}</span><br>
                                    <b>F.Fin Pract:</b> <span
                                        class="label label-info">{{ ofe.finpractica|date:'d-m-Y' }}</span>
                                </span>
                            </td>
                            <td data-title='Inscribirse:' style="text-align: center">
                                {% if ofe.haycupo %}
                                    <a href='/alu_practicaspro?action=addoferta&id={{ ofe.id|encrypt_alu }}'
                                       class="btn btn-success"><span class="fa fa-plus"></span></a>
                                {% else %}
                                    <span class="label label-important">CUPO LLENO</span>
                                {% endif %}
                            </td>
                        </tr>
                    {% endfor %}
                    {% if not ofertas %}
                        <tr>
                            <td colspan="11" style="text-align: center">
                                NO EXISTEN OFERTAS
                            </td>
                        </tr>
                    {% endif %}
                    </tbody>
                </table>
            </div>
        </div>
        <div class='row-fluid'>
            <div class="span12">
                {% if paging.num_pages > 20 %}
                    <div class='pagination'>
                        <ul>
                            {% if paging.primera_pagina %}
                                <li>
                                    <a href="/alu_practicaspreprofesionalesinscripcion?action=ofertaspracticas&{% if search %}s={{ search }}&{% endif %}page=1">1</a>
                                </li>
                                <li>
                                    <a href="/alu_practicaspreprofesionalesinscripcion?action=ofertaspracticas&{% if search %}s={{ search }}&{% endif %}page={{ paging.ellipsis_izquierda }}"
                                       class="active">...</a></li>
                            {% endif %}
                            {% for pagenumber in paging.paginas %}
                                <li {%  if pagenumber == page.number %}class='active'{% endif %}><a
                                        href="/alu_practicaspreprofesionalesinscripcion?action=ofertaspracticas&{% if search %}s={{ search }}&{% endif %}page={{ pagenumber }}&tipobus={{ tipobus }}">{{ pagenumber }}</a>
                                </li>
                            {% endfor %}
                            {% if paging.ultima_pagina %}
                                <li>
                                    <a href="/alu_practicaspreprofesionalesinscripcion?action=ofertaspracticas&{% if search %}s={{ search }}&{% endif %}page={{ paging.ellipsis_derecha }}&tipobus={{ tipobus }}"
                                       class="active">...</a></li>
                                <li>
                                    <a href="/alu_practicaspreprofesionalesinscripcion?action=ofertaspracticas&{% if search %}s={{ search }}&{% endif %}page={{ paging.num_pages }}&tipobus={{ tipobus }}">{{ paging.num_pages }}</a>
                                </li>
                            {% endif %}
                        </ul>
                    </div>
                {% else %}
                    <div class='pagination'>
                        <ul>
                            {% for pagenumber in paging.page_range %}
                                <li {%  if pagenumber == page.number %}class='active'{% endif %}><a
                                        href="/alu_practicaspreprofesionalesinscripcion?action=ofertaspracticas&{% if search %}s={{ search }}&{% endif %}page={{ pagenumber }}&tipobus={{ tipobus }}">{{ pagenumber }}</a>
                                </li>
                            {% endfor %}
                        </ul>
                    </div>
                {% endif %}
            </div>
        </div>
    </div>
{% endblock %}
