{% extends "basebs.html" %}
{% load sga_extras %}
{% block heading %}
    <script src="/static/adicionalesjs/formquestion.js?0.24"></script>
    <style>
        table.dataTable tbody th, table.dataTable tbody td {
            padding: 5px 3px 5px 10px !important;
        }
    </style>
    <script>
    var tiposolicitud = 0;
    var estadosolicitud = 0;
        $(document).ready(function () {
            var table_solicitado = $('.resultados_SOLICITADO').DataTable({"autoWidth": false, "pageLength": 100});
            var table_programado = $('.resultados_PROGRAMADO').DataTable({"autoWidth": false, "pageLength": 100, paging: false});
            {#var table_ejcutado = $('.resultados_EJECUTADO').DataTable({"autoWidth": false, "pageLength": 100});#}
            //var table_cancelado = $('.resultados_CANCELADO').DataTable({"autoWidth": false, "pageLength": 100});
            $('.resultados_SOLICITADO thead tr').clone(true).appendTo('.resultados_SOLICITADO thead');
            $('.resultados_SOLICITADO thead tr:eq(1) th').each(function (i) {
                var title = $(this).text();
                if (i >= 1 && i <= 5) {
                    $(this).html('<input type="text" style="width: 100%;" class="data-filtro" placeholder="Buscar ' + title + '" />');

                } else {
                    $(this).html('<input type="hidden"/>');
                }

                $('input', this).on('keyup change', function () {
                    if (table_solicitado.column(i).search() !== this.value) {
                        table_solicitado
                            .column(i)
                            .search(this.value)
                            .draw();
                    }
                });
            });
            $("#btnbuscarestado2").click(function () {
                var term = $("#inputsearchestado2").val().toUpperCase();
                location.href = "/solicitud_productos?s2=" + term;
            });

            $('#inputsearchestado2').keyup(function (e) {
                if (e.keyCode == 13) {
                    $("#btnbuscarestado2").trigger("click");
                }
            });
            estadosolicitud
            $("#id_tipo").change(function () {
                tiposolicitud = $("#id_tipo").val();
            });

            $("#id_estadosolicitud").change(function () {
                estadosolicitud = $("#id_estadosolicitud").val();
            });

            $("#btnbuscarestado3").click(function () {
                var term = $("#inputsearchestado3").val().toUpperCase();
                location.href = "/solicitud_productos?s3=" + term;
            });

            $('#inputsearchestado3').keyup(function (e) {
                if (e.keyCode == 13) {
                    $("#btnbuscarestado3").trigger("click");
                }
            });

            $("#btnbuscarestado4").click(function () {
                var term = $("#inputsearchestado4").val().toUpperCase();
                location.href = "/solicitud_productos?s4=" + term;
            });

            $('#inputsearchestado4').keyup(function (e) {
                if (e.keyCode == 13) {
                    $("#btnbuscarestado4").trigger("click");
                }
            });

        });
        $(function () {
            $("select").select2({minimumResultsForSearch: 5});

            $('.reporte_ejecucion_tutorias').click(function () {
                $('#modal_reportes2').modal({backdrop: 'static', width: '450px'}).modal('show');
                $('#periodo_group2').fadeIn();
                $('#estado_group2').fadeIn();

                $('#id_periodo2').empty().append('<option value="">----------</option>').val(0).trigger("change");

                $.ajax({
                    type: "GET",
                    url: `{{ request.path }}`,
                    data: {'action': 'cargar_periodo'},
                    success: function (data) {
                        if (data.result == 'ok') {
                            for (elemento in data.lista) {
                                $('#id_periodo2').append('<option value="' + data.lista[elemento].id + '">' + data.lista[elemento].nombre + '</option>');
                            }
                        } else {
                            smoke.alert(data.mensaje);
                        }
                    },
                    error: function () {
                        smoke.alert("Error de conexion.");
                    },
                    dataType: "json"
                });
            });

            $('#download_report2').click(function () {
                var periodo = $('#id_periodo2').val();
                var estado = $('#id_estado2').val();
                openwindow('GET', '/solicitud_productos', {action: 'reportetutoria', 'periodo': periodo, 'estado': estado}, '_blank');
                $('#modal_reportes2').modal('hide');
            });

            var tutoria = localStorage.getItem('tutoria');
            if (!tutoria) {
                tutoria = "#1";
                localStorage.setItem("tutoria", tutoria);
            }

            $('.tabs').each(function () {
                if ($(this).attr('href') == tutoria) {
                    $(this).trigger('click');
                }
            }).click(function () {
                localStorage.setItem("tutoria", $(this).attr('href'));
            });

            $("#search").click(function () {
                var term = $("#searchinput").val().toUpperCase();
                location.href = "/solicitud_productos?s=" + term;
            });

            $('#searchinput').keyup(function (e) {
                if (e.keyCode == 13) {
                    $("#search").trigger("click");
                }
            });

            $("#programarsolicitudes").click(function () {
                var lista = actualizar_lista();
                if (lista.length > 0) {
                    location.href = "solicitud_productos?action=programarsolicitudes&listasolicitudes=" + lista;
                } else {
                    smoke.alert("Debe seleccionar al menos una solicitud.");
                }
            });

            $("#reprogramarsolicitudes").click(function () {
                var lista = actualizar_lista_rep();
                if (lista.length > 0) {
                    location.href = "solicitud_productos?action=reprogramarsolicitudes&listasolicitudes=" + lista;
                } else {
                    smoke.alert("Debe seleccionar al menos una solicitud a reprogramar.");
                }
            });

            $("#asistenciamasivo").click(function () {
                $('.text-danger').hide();
                $("#itemspaneljustificacionmasivo").modal({backdrop: 'static', width: '500'}).modal('show');

            });

            $('.selectortodos').click(function () {
                if ($('.selectortodos').is(":checked")) {
                    $('.selector').each(function () {
                        var ids = $(this).attr('ids');
                        if ($('.sol' + ids).is(":checked")) {
                            $(this).prop('checked', true);
                        } else {
                            $(this).prop('checked', true);
                        }
                    });
                } else {
                    $('.selector').each(function () {
                        var ids = $(this).attr('ids');
                        if ($('.sol' + ids).is(":checked")) {
                            $(this).prop('checked', false);
                        } else {
                            $(this).prop('checked', false);
                        }
                    });
                }
            });

            $('.selectortodosrep').click(function () {
                if ($('.selectortodosrep').is(":checked")) {
                    $('.selectorrep').each(function () {
                        var ids = $(this).attr('ids');
                        if ($('.sol' + ids).is(":checked")) {
                            $(this).prop('checked', true);
                        } else {
                            $(this).prop('checked', true);
                        }
                    });
                } else {
                    $('.selectorrep').each(function () {
                        var ids = $(this).attr('ids');
                        if ($('.sol' + ids).is(":checked")) {
                            $(this).prop('checked', false);
                        } else {
                            $(this).prop('checked', false);
                        }
                    });
                }
            });

            $('#tab_programado').on('click', function (e) {
                $('#programarsolicitudes').hide();
                $('#reprogramarsolicitudes').show();
                $('#asistenciamasivo').hide();
                $('#tabla_indicaciones').hide();
            });
            $('#tab_solicitado').on('click', function (e) {
                $('#programarsolicitudes').show();
                $('#reprogramarsolicitudes').hide();
                $('#asistenciamasivo').hide();
                $('#tabla_indicaciones').hide();
            });
            $('#tab_ejecutado').on('click', function (e) {
                $('#programarsolicitudes').hide();
                $('#reprogramarsolicitudes').hide();
                $('#asistenciamasivo').hide();
                $('#tabla_indicaciones').show();
            });
            $('#tab_cancelado').on('click', function (e) {
                $('#programarsolicitudes').hide();
                $('#reprogramarsolicitudes').hide();
                $('#asistenciamasivo').show();
                $('#tabla_indicaciones').hide();
            });

            $('.tabs').each(function () {
                if ($(this).attr('href') === '#1' && $(this).parent().hasClass('active')) {
                    $('#programarsolicitudes').show();
                    $('#reprogramarsolicitudes').hide();
                    $('#asistenciamasivo').hide();
                    $('#tabla_indicaciones').hide();
                }
                if ($(this).attr('href') === '#2' && $(this).parent().hasClass('active')) {
                    $('#reprogramarsolicitudes').show();
                    $('#programarsolicitudes').hide;
                    $('#asistenciamasivo').hide();
                    $('#tabla_indicaciones').hide();
                }
                if ($(this).attr('href') === '#3' && $(this).parent().hasClass('active')) {
                    $('#reprogramarsolicitudes').hide();
                    $('#programarsolicitudes').hide;
                    $('#asistenciamasivo').hide();
                    $('#tabla_indicaciones').show();
                }
                if ($(this).attr('href') === '#4' && $(this).parent().hasClass('active')) {
                    $('#reprogramarsolicitudes').hide();
                    $('#programarsolicitudes').hide;
                    $('#asistenciamasivo').show();
                    $('#tabla_indicaciones').hide();
                }
            });

            actualizar_lista = function () {
                var lista = '';
                $('.selector').each(function () {
                    if ($(this).is(":checked")) {
                        lista += $(this).attr('ids') + ',';
                    }
                });
                if (lista.length > 0) {
                    lista = lista.substring(0, lista.length - 1);
                }
                return lista;
            };

            actualizar_lista_rep = function () {
                var lista = '';
                $('.selectorrep').each(function () {
                    if ($(this).is(":checked")) {
                        lista += $(this).attr('ids') + ',';
                    }
                });
                if (lista.length > 0) {
                    lista = lista.substring(0, lista.length - 1);
                }
                return lista;
            };

            $(".ingresarobservacion").click(function () {
                var ids = $(this).attr("ids");
                $("#id_solicitud").val(ids)
                $("#itemspanel").modal({backdrop: 'static', width: '900'}).modal('show');
            });


            $("#itemspanel .btn-adicionar").click(function () {
                var id_solicitud = $("#id_solicitud").val();
                var id_respuestapregunta = 0;
                if ($("#id_respuestapregunta").is(':checked')) {
                    var id_respuestapregunta = 1;
                }
                var id_observacion = $("#id_observacion").val();
                if (id_solicitud > 0 && id_observacion != "") {
                    $.post("/solicitud_productos", {
                        'action': 'ingresarobservacion',
                        'id_solicitud': id_solicitud,
                        'id_respuestapregunta': id_respuestapregunta,
                        'id_observacion': id_observacion
                    }, function (data) {
                        $.unblockUI();
                        if (data.result == 'ok') {
                            $("#itemspanel").modal("hide");
                            location.reload();
                        } else {
                            NotificationJG.warning(data.mensaje);
                        }
                    }, "json");
                }
            });

            $(".btn-cerrar").click(function () {
                $("#itemspanel").modal("hide");
            });


            $(".cancelartutoria").click(function () {
                var ids = $(this).attr("ids");
                $("#id_solicitudcancelar").val(ids)
                $("#itemspanelcancelar").modal({backdrop: 'static', width: '900'}).modal('show');
            });


            $("#itemspanelcancelar .btn-adicionar-cancelar").click(function () {
                var id_solicitud = $("#id_solicitudcancelar").val();
                var id_observacion = $("#id_observacioncancelar").val();
                if (id_solicitud > 0 && id_observacion != "") {
                    $.post("/solicitud_productos", {
                        'action': 'cancelarsolicitud',
                        'id': id_solicitud,
                        'id_observacion': id_observacion
                    }, function (data) {
                        $.unblockUI();
                        if (data.result == 'ok') {
                            $("#itemspanelcancelar").modal("hide");
                            location.reload();
                        } else {
                            NotificationJG.warning(data.mensaje);
                        }
                    }, "json");
                }
            });

            $(".btn-cerrar-cancelar").click(function () {
                $("#itemspanelcancelar").modal("hide");
            });


            $(".addclasetutoria").click(function () {
                $.post("/solicitud_productos", {'action': 'addclasetutoria'}, function (data) {
                    if (data.result == 'ok') {
                        var d = 0;
                    }
                }, 'json');
            });

            $(".asistenciamanual").on('click', function () {
                $('.text-danger').hide();
                $("#itemspaneljustificacion").modal({backdrop: 'static', width: '500'}).modal('show');
                let pk = $(this).attr('idsol');
                $("#id_solicitud_justificacion").val(pk);
            });

            $("#itemspaneljustificacion .btn-adicionar").click(function () {
                var id_solicitud = $("#id_solicitud_justificacion").val();
                var id_justificacion = $("#id_justificacion").val();
                if (id_solicitud !== "" && id_justificacion !== "") {
                    Swal.fire({
                        title: `Desea registrar la asistencia de este alumno manualmente?`,
                        text: "Esta acción es irreversible",
                        type: 'warning',
                        showCancelButton: true,
                        allowOutsideClick: false,
                        confirmButtonColor: '#3085d6',
                        cancelButtonColor: '#d33',
                        confirmButtonText: 'Si, deseo hacerlo',
                        cancelButtonText: 'Cancelar'
                    }).then((result) => {
                        if (result.value) {
                            bloqueointerface();
                            $.ajax({
                                type: "POST",
                                url: "/solicitud_productos",
                                data: {'action': 'asitenciamanual', 'pk': id_solicitud, 'justificacion': id_justificacion},
                                success: function (data) {
                                    if (data.result === 'ok') {
                                        location.reload();
                                    } else {
                                        $.unblockUI();
                                        NotificationJG.error(data.mensaje, 'Advertencia!', 10000);
                                    }
                                },
                                error: function () {
                                    $.unblockUI();
                                    smoke.alert("Error de conexión.");
                                },
                                dataType: "json"
                            });
                        } else {
                            NotificationJG.error('Acción Anulada', 'Advertencia!', 10000);
                        }
                    });
                } else {
                    $('.text-danger').show();
                }
            });

            $("#itemspaneljustificacionmasivo .btn-adicionarmasivo").click(function () {
                var id_solicitud = $("#id_solicitud_justificacionmasivo").val();
                var id_justificacion = $("#id_justificacionmasivo").val();

                if (id_solicitud !== "" && id_justificacion !== "") {
                    Swal.fire({
                        title: `Desea registrar la asistencia de todos los alumnos?`,
                        text: "Esta acción es irreversible",
                        type: 'warning',
                        showCancelButton: true,
                        allowOutsideClick: false,
                        confirmButtonColor: '#3085d6',
                        cancelButtonColor: '#d33',
                        confirmButtonText: 'Si, deseo hacerlo',
                        cancelButtonText: 'Cancelar'
                    }).then((result) => {
                        if (result.value) {
                            bloqueointerface();
                            $.ajax({
                                type: "POST",
                                url: "/solicitud_productos",
                                data: {'action': 'asitenciamanualmasivo', 'pk': id_solicitud, 'justificacion': id_justificacion},
                                success: function (data) {
                                    if (data.result === 'ok') {
                                        location.reload();
                                    } else {
                                        $.unblockUI();
                                        NotificationJG.error(data.mensaje, 'Advertencia!', 10000);
                                    }
                                },
                                error: function () {
                                    $.unblockUI();
                                    smoke.alert("Error de conexión.");
                                },
                                dataType: "json"
                            });
                        } else {
                            NotificationJG.error('Acción Anulada', 'Advertencia!', 10000);
                        }
                    });
                } else {
                    $('.text-danger').show();
                }
            });

            $('#itemspaneljustificacion').on('hidden.bs.modal', function (e) {
                $('#id_justificacion').val('');
            });

            $('#itemspaneljustificacionmasivo').on('hidden.bs.modal', function (e) {
                $('#id_justificacionmasivo').val('');
            });

        });

        function formModal(id, text, action, footer = true) {
            $('.panelbodyreasigna').empty();
            $('.panelbody').empty();
            $('.panelbodyproceso').empty();
            $('.panelbodyform').empty();
            bloqueointerface();
            $.ajax({
                type: "GET",
                url: "/solicitud_productos",
                data: {
                    'action': action,
                    'id': id,
                },
                success: function (data) {
                    $.unblockUI();
                    if (data.result === true) {
                        if (footer === true) {
                            $('#footermodal').hide();
                        }
                        $('.panelbody').html(data.data);
                        $('#itemspanel .paneltitle').html(text);
                        $("#itemspanel").modal({backdrop: 'static', width: '85%'}).modal('show');
                    } else {
                        smoke.alert(data.mensaje);
                    }
                },
                error: function () {
                    $.unblockUI();
                    smoke.alert("Error de conexión.");
                },
                dataType: "json"
            });
        }

        function modalreportesolicitudes(id, text, action, footer = true) {
            $('.panelbodyreasigna').empty();
            $('.panelbody').empty();
            $('.panelbodyproceso').empty();
            $('.panelbodyform').empty();
            bloqueointerface();
            $.ajax({
                type: "GET",
                url: "/solicitud_productos",
                data: {
                    'action': action,
                    'id': id,
                },
                success: function (data) {
                    $.unblockUI();
                    if (data.result === true) {
                        if (footer === true) {
                            $('#footermodal').hide();
                        }
                        $('.panelbody').html(data.data);
                        $('#itemspanel .paneltitle').html(text);
                        $("#itemspanel").modal({backdrop: 'static', width: '25%'}).modal('show');
                    } else {
                        smoke.alert(data.mensaje);
                    }
                },
                error: function () {
                    $.unblockUI();
                    smoke.alert("Error de conexión.");
                },
                dataType: "json"
            });
        }

        function rechazarsolicitud(id, text, action, footer = true) {
            $('.panelbodyreasigna').empty();
            $('.panelbody').empty();
            $('.panelbodyproceso').empty();
            $('.panelbodyform').empty();
            bloqueointerface();
            $.ajax({
                type: "GET",
                url: "/solicitud_productos",
                data: {
                    'action': action,
                    'id': id,
                },
                success: function (data) {
                    $.unblockUI();
                    if (data.result === true) {
                        if (footer === true) {
                            $('#footermodal').hide();
                        }
                        $('.panelbody').html(data.data);
                        $('#rechazosolicitud .paneltitle').html(text);
                        $("#rechazosolicitud").modal({backdrop: 'static', width: '38%'}).modal('show');
                    } else {
                        smoke.alert(data.mensaje);
                    }
                },
                error: function () {
                    $.unblockUI();
                    smoke.alert("Error de conexión.");
                },
                dataType: "json"
            });
        }
        function cerrarmodalreportesolicitudes(){
            $("#itemspanel_reportesolicitudproductos").modal("hide");
            return false;
        }
        cargar_opcionessolicitud = function (nombreselect, accion) {
            $(nombreselect).empty().append('<option value="0">--Seleccione--</option>').val(0).trigger("change");
            var control = $(nombreselect);
            if (control) {
                bloqueointerface();
                $.ajax({
                    type: "GET",
                    url: "/solicitud_productos",
                    data: {'action': accion},
                    success: function (data) {
                        $(nombreselect).empty().append('<option value="0">--Seleccione--</option>').val(0).trigger("change");
                        if (data.result == 'ok') {
                            for (elemento in data.lista) {
                                console.log(data.lista[elemento][0]);
                                $(nombreselect).append('<option value="' + data.lista[elemento][0] + '">' + data.lista[elemento][1] + '</option>');
                            }
                        } else {
                            control.val(0).trigger("change");
                            smoke.alert(data.mensaje);
                        }
                        $.unblockUI();
                    },
                    error: function () {
                        $.unblockUI();
                        control.val(0).trigger("change");
                        smoke.alert("Error de conexion.");
                    },
                    dataType: "json"
                });
            }
        };

        function reportesolicitudesproductos(){
            var nombreselect = '#id_tipo'
            var accion = 'cargarcombo_tiposolicitud'
            cargar_opcionessolicitud(nombreselect, accion);
            nombreselect = '#id_estadosolicitud'
            accion = 'cargarcombo_estadosolicitud'
            cargar_opcionessolicitud(nombreselect, accion)
            $("#itemspanel_reportesolicitudproductos").modal({backdrop: 'static', width: '450px'}).modal('show');
            $("#id_tipo").select2({'width':'100%'})
            $("#id_estadosolicitud").select2({'width':'100%'})
        }

        function reportesolicitudproductos(){
            if ((tiposolicitud == 0) || (estadosolicitud == 0)){
                Swal.fire({
                            title: 'Advertencia!',
                            text: 'Por favor, seleccione un tipo o estado',
                            type: 'warning',
                            showCancelButton: false,
                            allowOutsideClick: false,
                            confirmButtonColor: '#3085d6',
                            cancelButtonColor: '#d33',
                            showConfirmButton: false,
                            timer : 3000,
                })
            }else{
                openwindow('GET', '/solicitud_productos', {action: 'reportesolicitudesproductos', 'idtipo':tiposolicitud, 'estadosolicitud':estadosolicitud}, '_blank');
            }
        }

    </script>
{% endblock %}
{% block atras %}/solicitud_productos?action=solicitudrecursos{% endblock %}
{% block canvas %}
    <div class='row-fluid'>
        <div class='span12'>
            <h4>{{ title }}</h4>
        </div>
    </div>
    <a style="margin-bottom: 10px" href="/solicitud_productos?action=catalogoproductos" class='btn btn-info' target="_blank"><span
                class="fa fa-list"></span> Catálogo de productos</a>
    <div class="btn-group" style="margin-bottom:9px">
        <a class="btn dropdown-toggle" data-toggle="dropdown" href="javascript:;"> Reportes<span
                class="caret"></span></a>
        <ul class="dropdown-menu pull-left" style="width: 160px;">
            <li><a onclick="reportesolicitudesproductos()" href="javascript:void(0)";
                   class="tu reporte"><i class="fa fa-file-excel-o"></i> Reporte de solicitudes</a></li></ul>
{#            <li><a href="/solicitud_productos?action=reportedeproductoscomu" target="_blank"#}
{#                   class="tu reporte"><i class="fa fa-file-pdf-o"></i> Reporte de productos</a></li>#}
    </div>
    <ul class="nav nav-tabs" style=" justify-content: right;">

        <li>
            <a class="tabs active" href="#1" data-toggle="tab" id="tab_solicitado">
                <i class="fa fa-clock-o"></i> PENDIENTES
{#                <span title="Solicitudes" class="btn btn-default">#}
{##}
{#                </span>&nbsp;#}
            </a>
        </li>
        <li>
            <a class="tabs" href="#2" data-toggle="tab" id="tab_programado"><i class="fa fa-check"></i> APROBADOS
{#                <span title="Solicitudes" class="btn btn-default">#}
{##}
{#                </span>&nbsp;#}
            </a>
        </li>
        <li>
            <a class="tabs" href="#3" data-toggle="tab" id="tab_ejecutado"><i class="fa fa-ban"></i> RECHAZADOS
{#                <span title="Solicitudes" class="btn btn-default">#}
{##}
{#                </span>&nbsp;#}
            </a>
        </li>
{#        <li>#}
{#            <a class="tabs" href="#4" data-toggle="tab" id="tab_ejecutado"><i class="fa fa-briefcase"></i> OCULTADOS#}
{#                <span title="Solicitudes" class="btn btn-default">#}
{##}
{#                </span>&nbsp;#}
{#            </a>#}
{#        </li>#}

    </ul>



    <div class="tab-content">
        <div id="1" class="tab-pane">
            <div class="row-fluid">
                <div class="span12">
                </div>
            </div>
            <div class="row-fluid" style="margin-bottom: 50px">
                <div class='span12'>
                    <table class='table table-bordered resultados_SOLICITADO' cellpadding="0" cellspacing="0">
                        <thead>
                        <tr>
                            <th style="width: 10%; text-align: center">Solicitante</th>
                            <th style="width: 10%; text-align: center">Descripción</th>
                            <th style="width: 10%; text-align: center">Objetivo</th>
                            <th style="width: 8%; text-align: center">Fecha <br>solicitud</th>
                            <th style="width: 10%; text-align: center">Tipo</th>
                            <th style="width: 10%; text-align: center">Estado</th>
                            <th style="width: 5%; text-align: center"></th>
                        </tr>
                        </thead>
                        <tbody>
                        {% for solicitud in pendientes %}
                            <tr>
                                <td style="width: 12%; text-align: center">
                                    {{ solicitud.solicitante }}
                                </td>
                                <td style="width: 12%; text-align: center">
                                    {{ solicitud.descripcion }}
                                </td>
                                <td style="width: 10%; text-align: center">
                                    {{ solicitud.objetivo }}
                                </td>
                                <td style="width: 14%; text-align: center">
                                    {{ solicitud.fechasolicitud|date:"Y-m-d"|default_if_none:"" }}
                                </td>
                                <td style="width: 14%; text-align: center">
                                    {% if solicitud.tipo == 1 %}
                                        CREACIÓN
                                    {% else %}
                                        REVISIÓN
                                    {% endif %}
                                </td>
                                <td style="width: 8%; text-align: center">
                                <label class="label label-warning">PENDIENTE</label>
                                </td>
                                <td style="text-align: center">
                                    <div class="btn-group" style="text-align: left">
                                        <a class="btn btn-mini dropdown-toggle" data-toggle="dropdown"
                                           href="javascript:;">Acciones<span
                                                class="caret"></span>
                                        </a>
                                        <ul class="dropdown-menu pull-right">
                                            <li>
                                                <a style="cursor: pointer;" onclick="formModal('{{ solicitud.pk }}', 'Ver Solicitud de {{ solicitud.solicitante }}', 'visualizarsolicitud', false)"><span
                                                        class="fa fa-eye"></span> Visualizar solicitud</a>
                                            </li>
                                            {% if solicitud.tipo == 2 %}
                                                {% if solicitud.tienemultimedia == 2 %}
                                                    <li>
                                                        <a style="cursor: pointer;" href="/media/{{ solicitud.archivo }}" target="_blank"><span
                                                                class="fa fa-arrow-down"></span> Descargar archivo</a>
                                                    </li>
                                                {% endif %}
                                            {% endif %}
                                            <li>
                                                <a style="cursor: pointer;" onclick="rechazarsolicitud('{{ solicitud.pk }}', 'Rechazo de solicitud de {{ solicitud.solicitante }}', 'rechazarsolicitud', false)"><span
                                                        class="fa fa-minus"></span> Rechazar</a>
                                            </li>
                                        </ul>
                                    </div>
                        </td>
                            </tr>
                            {% empty %}
                            <tr>
                                <td colspan="9">
                                    NO EXISTEN SOLICITUDES PENDIENTES
                                </td>
                            </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <div id="2" class="tab-pane">
            <div class="row-fluid">
                <div class="span12">
                </div>
            </div>
            <div class='row-fluid'>
                <div class="span12">
                    <form class="form-search">
                        <input type='text' id='inputsearchestado2' value='{{ search2 }}' autocomplete="off"/>
                        <a href="javascript:;" id='btnbuscarestado2' class='btn btn-info'><span
                                class="fa fa-search "></span> Buscar</a>
                        {% if search2 %}
                            <a href="/solicitud_productos" id='allresults' class='btn btn-info'><span
                                    class="fa fa-refresh "></span> Todos</a>
                        {% endif %}
                    </form>
                </div>
            </div>
            <div class="row-fluid">
                <div class='span12'>
                    <table class='table table-bordered resultados_PROGRAMADO' cellpadding="0" cellspacing="0" style="width: 100%">
                        <thead>
                        <tr>
                            <th style="width: 10%;text-align: center">Solicitante</th>
                            <th style="width: 10%;text-align: center">Descripción</th>
                            <th style="width: 10%;text-align: center">Objetivo</th>
                            <th style="width: 8%;text-align: center">Fecha <br>solicitud</th>
                            <th style="width: 8%;text-align: center">Tipo</th>
{#                            <th style="width: 8%;text-align: center">Archivo</th>#}
                            <th style="width: 10%;text-align: center">Estado</th>
                            <th style="width: 5%;text-align: center"></th>
                        </tr>
                        </thead>
                        <tbody>
                        {% for solicitud in aceptados %}
                            <tr>
                                <td style="width: 12%;text-align: center">
                                    {{ solicitud.solicitante }}
                                </td>
                                <td style="width: 12%;text-align: center">
                                    {{ solicitud.descripcion }}
                                </td>
                                <td style="width: 10%;text-align: center">
                                    {{ solicitud.objetivo }}
                                </td>
                                <td style="width: 8%;text-align: center">
                                    {{ solicitud.fechasolicitud|date:"Y-m-d"|default_if_none:"" }}
                                </td>
                                <td style="width: 8%;text-align: center">
                                    {% if solicitud.tipo == 1 %}
                                        CREACIÓN
                                    {% else %}
                                        REVISIÓN
                                    {% endif %}
                                </td>
{#                                <td style="width: 7%;text-align: center">#}
{#                                    {% if solicitud.archivo %}#}
{#                                        <a class="btn btn-primary btn-mini tu btn-fancybox"#}
{#                                           href="/media/{{ solicitud.archivo }}" target="_blank" data-fancybox-type="iframe"#}
{#                                           title="Descargar producto"><i class="fa fa-arrow-down"></i></a>#}
{#                                    {% endif %}#}
{#                                    {% if solicitud.manual %}#}
{#                                        <a class="btn btn-success btn-mini tu btn-fancybox"#}
{#                                           href="/media/{{ solicitud.manual }}" target="_blank" data-fancybox-type="iframe"#}
{#                                           title="Descargar manual"><i class="fa fa-arrow-down"></i></a>#}
{#                                    {% endif %}#}
{#                                </td>#}
                                <td style="width: 8%;text-align: center">
                                    <label class="label label-success">APROBADO</label>
                                </td>
                                <td style="text-align: center" class="caja">
                                    <div class="btn-group" style="text-align: left">
                                        <a class="btn btn-mini dropdown-toggle" data-toggle="dropdown"
                                           href="javascript:;">Acciones<span
                                                class="caret"></span></a>
                                        <ul class="dropdown-menu pull-right list-group">
                                            <li>
                                                <a style="cursor: pointer;" onclick="formModal('{{ solicitud.pk }}', 'Solicitud aprobada de {{ solicitud.solicitante }}', 'vistapreviasolicitud', false)"><span
                                                        class="fa fa-eye"></span> Visualizar solicitud</a>
                                            </li>
                                            {% if solicitud.tipo == 2 %}
                                                {% if solicitud.tienemultimedia == 2 %}
                                                    <li>
                                                        <a style="cursor: pointer;" href="/media/{{ solicitud.archivo }}" target="_blank"><span
                                                                class="fa fa-arrow-down"></span> Descargar archivo</a>
                                                    </li>
                                                {% endif %}
                                            {% endif %}
                                        </ul>
                                    </div>
                                </td>
                            </tr>
                            {% empty %}
                            <tr>
                                <td colspan="9">
                                    NO EXISTEN SOLICITUDES APROBADAS
                                </td>
                            </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                    <div class='row-fluid'>
                        {% if paging_estado2.num_pages > 20 %}
                            <div class='pagination'>
                                <ul>
                                    {% if paging_estado2.primera_pagina %}
                                        <li><a href="/solicitud_productos?page_estado2=1">1</a></li>
                                        <li>
                                            <a href="/adm_requerimiento?page_estado2={{ paging_estado2.ellipsis_izquierda }}"
                                               class="active">...</a></li>
                                    {% endif %}
                                    {% for pagenumber in paging_estado2.paginas %}
                                        <li {% if pagenumber == page_estado2.number %}class='active'{% endif %}>
                                            <a href="/solicitud_productos?page_estado2={{ pagenumber }}">{{ pagenumber }}</a>
                                        </li>
                                    {% endfor %}
                                    {% if paging_estado2.ultima_pagina %}
                                        <li>
                                            <a href="/solicitud_productos?page_estado2={{ paging_estado2.ellipsis_derecha }}"
                                               class="active">...</a></li>
                                            <a href="/solicitud_productos?page_estado2={{ paging_estado2.num_pages }}">{{ paging_estado2.num_pages }}</a>
                                        </li>
                                    {% endif %}
                                </ul>
                            </div>
                        {% else %}
                            <div class='pagination'>
                                <ul>
                                    {% for pagenumber in paging_estado2.page_range %}
                                        <li {% if pagenumber == page_estado2.number %}class='active'{% endif %}>
                                            <a href="/solicitud_productos?{% if search2 %}s2={{ search1 }}&{% endif %}page_estado2={{ pagenumber }}">{{ pagenumber }}</a>
                                        </li>
                                    {% endfor %}
                                </ul>
                            </div>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>

        <div id="3" class="tab-pane">
            <div class='row-fluid'>
                <div class="span12">
                    <form class="form-search">
                        <input type='text' id='inputsearchestado3' value='{{ search3 }}' autocomplete="off"/>
                        <a href="javascript:;" id='btnbuscarestado3' class='btn btn-info'><span
                                class="fa fa-search "></span> Buscar</a>
                        {% if search3 %}
                            <a href="/solicitud_productos" id='allresults' class='btn btn-info'><span
                                    class="fa fa-refresh "></span> Todos</a>
                        {% endif %}
                    </form>
                </div>
            </div>

            <div class="row-fluid">
                <div class='span12'>
                    <table class='table table-bordered resultados_EJECUTADO' cellpadding="0" cellspacing="0">
                        <thead>
                        <tr>
                            <th style="width: 10%;text-align: center">Solicitante</th>
                            <th style="width: 10%;text-align: center">Descripción</th>
                            <th style="width: 10%;text-align: center">Objetivo</th>
                            <th style="width: 10%;text-align: center">Tipo</th>
                            <th style="width: 8%;text-align: center">Fecha <br>solicitud</th>
                            <th style="width: 10%;text-align: center">Estado</th>
                            <th style="width: 5%;text-align: center"></th>
                        </tr>
                        </thead>
                        <tbody>
                        {% for solicitud in rechazados %}
                            <tr>
                                <td style="width: 12%;text-align: center">
                                    {{ solicitud.solicitante }}
                                </td>
                                <td style="width: 12%;text-align: center">
                                    {{ solicitud.descripcion }}
                                </td>
                                <td style="width: 10%;text-align: center">
                                    {{ solicitud.objetivo }}
                                </td>
                                <td style="width: 10%;text-align: center">
                                    {% if solicitud.tipo == 1  %}
                                        CREACIÓN
                                    {% else %}
                                        REVISIÓN
                                    {% endif %}
                                </td>
                                <td style="width: 14%;text-align: center">
                                    {{ solicitud.fechasolicitud|date:"Y-m-d"|default_if_none:"" }}
                                </td>
                                <td style="width: 8%;text-align: center">
                                    <label class="label label-important">RECHAZADO</label>
                                </td>
                                <td style="text-align: center" class="caja">
                                    <div class="btn-group" style="text-align: left">
                                        <a class="btn btn-mini dropdown-toggle" data-toggle="dropdown"
                                           href="javascript:;">Acciones<span
                                                class="caret"></span></a>
                                        <ul class="dropdown-menu pull-right list-group">
                                            <li>
                                                <a style="cursor: pointer;"
                                                   onclick="formModal('{{ solicitud.pk }}', 'Solicitud aprobada de {{ solicitud.solicitante }}', 'visualizarrechazado', false)"><span
                                                        class="fa fa-eye"></span> Visualizar solicitud</a>
                                            </li>
                                            {% if solicitud.tipo == 2 %}
                                                {% if solicitud.tienemultimedia == 2 %}
                                                    <li>
                                                        <a style="cursor: pointer;" href="/media/{{ solicitud.archivo }}" target="_blank"><span
                                                                class="fa fa-arrow-down"></span> Descargar archivo</a>
                                                    </li>
                                                {% endif %}
                                            {% endif %}
                                        </ul>
                                    </div>
                                </td>
                            </tr>
                            {% empty %}
                            <tr>
                                <td colspan="9">
                                    NO EXISTEN SOLICITUDES RECHAZADAS
                                </td>
                            </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                    <div class='row-fluid'>
                        {% if paging_estado3.num_pages > 20 %}
                            <div class='pagination'>
                                <ul>
                                    {% if paging_estado3.primera_pagina %}
                                        <li><a href="/solicitud_productos?page_estado3=1">1</a></li>
                                        <li>
                                            <a href="/adm_requerimiento?page_estado3={{ paging_estado3.ellipsis_izquierda }}"
                                               class="active">...</a></li>
                                    {% endif %}
                                    {% for pagenumber in paging_estado3.paginas %}
                                        <li {% if pagenumber == page_estado3.number %}class='active'{% endif %}>
                                            <a href="/solicitud_productos?page_estado3={{ pagenumber }}">{{ pagenumber }}</a>
                                        </li>
                                    {% endfor %}
                                    {% if paging_estado3.ultima_pagina %}
                                        <li>
                                            <a href="/solicitud_productos?page_estado3={{ paging_estado3.ellipsis_derecha }}"
                                               class="active">...</a></li>
                                        <li>
                                            <a href="/solicitud_productos?page_estado3={{ paging_estado3.num_pages }}">{{ paging_estado3.num_pages }}</a>
                                        </li>
                                    {% endif %}
                                </ul>
                            </div>
                        {% else %}
                            <div class='pagination'>
                                <ul>
                                    {% for pagenumber in paging_estado3.page_range %}
                                        <li {% if pagenumber == page_estado3.number %}class='active'{% endif %}>
                                            <a href="/solicitud_productos?{% if search3 %}s3={{ search3 }}&{% endif %}page_estado3={{ pagenumber }}">{{ pagenumber }}</a>
                                        </li>
                                    {% endfor %}
                                </ul>
                            </div>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>

{#        <div id="4" class="tab-pane">#}
{#            <div class='row-fluid'>#}
{#                <div class="span12">#}
{#                    <form class="form-search">#}
{#                        <input type='text' id='inputsearchestado4' value='{{ search4 }}' autocomplete="off"/>#}
{#                        <a href="javascript:;" id='btnbuscarestado4' class='btn btn-info'><span#}
{#                                class="fa fa-search "></span> Buscar</a>#}
{#                        {% if search4 %}#}
{#                            <a href="/solicitud_productos" id='allresults' class='btn btn-info'><span#}
{#                                    class="fa fa-refresh "></span> Todos</a>#}
{#                        {% endif %}#}
{#                    </form>#}
{#                </div>#}
{#            </div>#}
{#        </div>#}
    </div>

    <div class="modal fade static modal-xl" id="itemspanel" style="display: none;">
        <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
            <h4><i class="fa fa-list"></i> <b class="paneltitle">FORMULARIO MODAL</b></h4>
        </div>
        <div class="modal-body">
            <form autocomplete="off" method="post"
                  enctype="multipart/form-data" action="/solicitud_productos">
                {% csrf_token %}
                <div class="row-fluid panelbody">
                </div>
            </form>
        </div>
        <div class="modal-footer" id="footermodal">
            <a href="javascript:;" class="btn btn-default" data-dismiss="modal"><i class="fa fa-window-close"></i> Cerrar</a>
        </div>
    </div>

    <div class="modal fade static modal-xl" id="rechazosolicitud" style="display: none;">
        <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
            <h4><i class="fa fa-list"></i> <b class="paneltitle">FORMULARIO MODAL</b></h4>
        </div>
        <div class="modal-body">
            <form autocomplete="off" method="post"
                  enctype="multipart/form-data" action="/solicitud_productos">
                {% csrf_token %}
                <div class="row-fluid panelbody">
                </div>
            </form>
        </div>
        <div class="modal-footer" id="footermodal">
            <a href="javascript:;" class="btn btn-default" data-dismiss="modal"><i class="fa fa-window-close"></i> Cerrar</a>
        </div>
    </div>

    <div class="modal fade static" id="itemspanelcancelar" style="display: none;">
        <div class="modal-header">
            <h4><i class="fa fa-list"></i> <b class="paneltitle">CANCELAR TUTORÍA</b></h4>
        </div>
        <div class="modal-body">
            <div class="row-fluid panelbody">
                <input type="hidden" id="id_solicitudcancelar" value="0">
                <label>Ingresar observación:</label>
                <textarea id="id_observacioncancelar" style="width: 100%" rows="3"></textarea><br>
            </div>
        </div>
        <div class="modal-footer">
            <a href="javascript:;" class="btn btn-adicionar-cancelar btn-success"><i class="fa fa-save"></i> Guardar</a>
            <a href="javascript:;" class="btn btn-cerrar-cancelar btn-info"><i class="fa fa-close"></i>Cerrar</a>
        </div>
    </div>

    <div class="modal fade static" id="itemspaneljustificacion" style="display: none;">
        <div class="modal-header">
            <h4><i class="fa fa-check-circle"></i> <b class="paneltitle">INGRESO DE ASISTENCIA MANUAL</b></h4>
        </div>
        <div class="modal-body">
            <div class="row-fluid panelbody">
                <input type="hidden" id="id_solicitud_justificacion" value="0">
                <label style="font-size: 14px" for="id_justificacion"><b>Ingrese el motivo de la falta:</b></label>
                <textarea id="id_justificacion" style="width: 100%" rows="3" required></textarea>
                <p class="text-danger" style="display: none; color: red">Debe ingresar un motivo</p>
            </div>
        </div>
        <div class="modal-footer">
            <a href="javascript:;" class="btn btn-adicionar btn-success"><i class="fa fa-save"></i> Guardar</a>
            <a href="javascript:;" class="btn btn-cerrar btn-danger" data-dismiss="modal"><i class="fa fa-close"></i> Cerrar</a>
        </div>
    </div>

    <div class="modal fade static" id="itemspaneljustificacionmasivo" style="display: none;">
        <div class="modal-header">
            <h4><i class="fa fa-check-circle"></i> <b class="paneltitle">INGRESO DE ASISTENCIA MASIVO</b></h4>
        </div>
        <div class="modal-body">
            <div class="row-fluid panelbody">
                <input type="hidden" id="id_solicitud_justificacion" value="0">
                <label style="font-size: 14px" for="id_justificacionmasivo"><b>Ingrese el motivo de la falta:</b></label>
                <textarea id="id_justificacionmasivo" style="width: 100%" rows="3" required></textarea>
                <p class="text-danger" style="display: none; color: red">Debe ingresar un motivo</p>
            </div>
        </div>
        <div class="modal-footer">
            <a href="javascript:;" class="btn btn-adicionarmasivo btn-success"><i class="fa fa-save"></i> Guardar</a>
            <a href="javascript:;" class="btn btn-cerrar btn-danger" data-dismiss="modal"><i class="fa fa-close"></i> Cerrar</a>
        </div>
    </div>

    {#    Reporte Tutorias Modal#}
    <div class="modal fade static" id="modal_reportes2" style="display: none;">
        <div class="modal-header">
            <h3 class="paneltitle">Reporte de Tutorías</h3>
        </div>
        <div class="modal-body panelbody">
            <div class="row-fluid">
                <div class="span12">


                    <div class="form-group" id="periodo_group2" style="display: none">
                        <span> <b> Periodo: </b>  </span>
                        <form class="form-search">
                            <select id="id_periodo2" name="Periodo" style="width: 415px;">
                                <option value="0">--------</option>
                            </select>
                        </form>
                        <br>
                    </div>

                    <div class="form-group" id="estado_group2" style="display: none">
                        <span> <b> Estado: </b> </span>
                        <form class="form-search">
                            <select id="id_estado2" name="Estado" style="width: 415px;">
                                <option value="0">--------</option>
                                <option value="1">SOLICITADO</option>
                                <option value="2">PROGRAMADO</option>
                                <option value="3">EJECUTADO</option>
                                <option value="4">CANCELADO</option>
                            </select>
                        </form>
                    </div>

                </div>
            </div>
        </div>

        <div class="modal-footer">
            <table class="pull-right">
                <tr>
                    <td><a class="btn btn-success " id="download_report2"><i class="fa fa-download"></i> Descargar Reporte</a>
                    </td>
                    <td><a class="btn btn-danger" data-dismiss="modal"><i class="fa fa-close"></i> Cerrar</a></td>
                </tr>
            </table>
        </div>
    </div>

    <div class="modal fade static" id="itemspanel_reportesolicitudproductos" style="display: none;">
        <div class="modal-header">
            <h4 id="paneltitle">Seleccione el tipo</h4>
        </div>
        <div class="modal-body">
            <div class='row-fluid' style="height: 80px">
                <form class="form-search">
                    <i class="fa fa-user"></i> Tipo de solicitud: <br>
                    <select formwidth="350px" id="id_tipo" name="tipo" tabindex="-1" class="select2-accessible">
                    </select>
                    <i class="fa fa-user"></i> Estado de solicitud: <br>
                    <select formwidth="350px" id="id_estadosolicitud" name="estadosolicitud" tabindex="-1" class="select2-accessible">
                    </select>
                </form>
            </div>
        </div>
        <div class="modal-footer">
            <input type='hidden' id="evento" name='idp' value='0'/>
            <a onclick="reportesolicitudproductos()" class="btn btn-success btn-aceptar" style="cursor: pointer"> Generar reporte</a>
            <a style="cursor: pointer" onclick="cerrarmodalreportesolicitudes()" class="btn btn-cerrar">Cerrar</a>
        </div>
    </div>

{% endblock %}
