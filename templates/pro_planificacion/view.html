{% extends "base.html" %}
{% load sga_extras %}
{% block heading %}
    <script type="text/javascript" src="/static/js/jquery.fancybox.pack.js?v=1.0.0"></script>
    <link rel="stylesheet" href="/static/css/jquery.fancybox.css?v=1.0.0" type="text/css" media="screen"/>
    <link href="/static/css/table-responsive.css?1.0.0" type="text/css" rel="stylesheet"/>
    <style>
        @media (max-width: 768px) {
            .dropbottom button.btn {
                width: 100%;
                height: 100%;
                display: block;
            }
        }
    </style>
    <script type="text/javascript">

        $(function () {
            $(".detalleppl").click(function () {
                bloqueointerface();
                $.ajax({
                    type: "GET",
                    url: "/pro_planificacion",
                    data: {'action': 'listadoppl'},
                    success: function(data) {
                        $.unblockUI();
                        if (data.result === 'ok') {
                            $("#body-modal").html(data.data);
                            $("#paneltitle").html('DETALLE DE ALUMNOS');
                            $("#showdetalle").modal({backdrop:'static', width: '650px'}).modal('show');
                        } else {
                            smoke.alert(data.mensaje);
                        }
                    },
                    error: function() {
                        $.unblockUI();
                        smoke.alert("Error de conexión.");
                    },
                    dataType: "json"
                });
            });
            if ($(".recorreonline").length == 0) {
                $("#generappl").css("display", "none");
            }

            $("#cerrardetallemodal").click(function () {
                $("#showdetalle").modal("hide");
            });
            $(".btn-cerrarmalla").click(function () {
                $("#malla").modal('hide');
            });
            $(".btn-cerrarmateria").click(function () {
                $("#materias").modal('hide');
            });
            $(".btn-cerrarprogramamalla").click(function () {
                $("#programamalla").modal('hide');
            });
            $(".btn-cerrarprogramamateria").click(function () {
                $("#programamateria").modal('hide');
            });
            $(".btn-malla").click(function () {
                var id = $(this).attr('id');
                bloqueointerface();
                $.ajax({
                    type: "GET",
                    url: "/pro_planificacion",
                    data: {"action": "syllabusmalla", "id": id},
                    success: function (data) {
                        var contenido;
                        var i;
                        $.unblockUI();
                        $("#malla").modal({width: "700px"}).modal('show');
                        if (data.result == 'ok') {
                            contenido = "";
                            if (data.materias.length > 0) {
                                for (i = 0; i <= (data.materias.length - 1); i++) {
                                    materia = data.materias[i];
                                    contenido += "<tr><td>" + materia[0] + "</td><td style='text-align: center;'><a href='" + materia[1] + "' class='btn btn-mini'>Descargar</a></td></tr>";
                                }
                            } else {
                                contenido += "<tr><td colspan='2'>NO EXISTEN SILABOS EN LAS MALLAS PARA ESTA MATERIA</td></tr>";
                            }
                            $("#mallacontenido").html(contenido);
                        }
                    },
                    error: function () {
                        $.unblockUI();
                    },
                    dataType: "json"
                });
            });
            $(".btn-materias").click(function () {
                var id = $(this).attr('id');
                bloqueointerface();
                $.ajax({
                    type: "GET",
                    url: "/pro_planificacion",
                    data: {"action": "syllabusmateria", "id": id},
                    success: function (data) {
                        var contenido;
                        var i;
                        $.unblockUI();
                        $("#materias").modal({width: "700px"}).modal('show');
                        if (data.result == 'ok') {
                            contenido = "";
                            if (data.materias.length > 0) {
                                for (i = 0; i <= (data.materias.length - 1); i++) {
                                    materia = data.materias[i];
                                    contenido += "<tr><td>" + materia[0] + "</td><td style='text-align: center;'><a href='" + materia[1] + "' class='btn btn-mini'>Descargar Word</a></td><td style='text-align: center;'><a href='" + materia[2] + "' class='btn btn-mini'>Descargar Pdf</a></td></tr>";
                                }
                            } else {
                                contenido += "<tr><td colspan='2'>NO EXISTEN SILABOS EN LAS MALLAS PARA ESTA MATERIA</td></tr>";
                            }
                            $("#materiascontenido").html(contenido);
                        }
                    },
                    error: function () {
                        $.unblockUI();
                    },
                    dataType: "json"
                });
            });
            $(".btn-programa-malla").click(function () {
                var id = $(this).attr('id');
                bloqueointerface();
                $.ajax({
                    type: "GET",
                    url: "/pro_planificacion",
                    data: {"action": "syllabusprogramamalla", "id": id},
                    success: function (data) {
                        var contenido;
                        var i;
                        $.unblockUI();
                        $("#programamalla").modal({width: "700px"}).modal('show');
                        if (data.result == 'ok') {
                            contenido = "";
                            if (data.materias.length > 0) {
                                for (i = 0; i <= (data.materias.length - 1); i++) {
                                    materia = data.materias[i];
                                    contenido += "<tr><td>" + materia[0] + "</td><td style='text-align: center;'><a href='" + materia[1] + "' class='btn btn-mini'>Descargar PDF</a></td><td style='text-align: center;'><a href='" + materia[2] + "' class='btn btn-mini'>Descargar WORD</a></td></tr>";
                                }
                            } else {
                                contenido += "<tr><td colspan='2'>NO EXISTEN PLAN DE ESTUDIO EN LA MALLA</td></tr>";
                            }
                            $("#programamallacontenido").html(contenido);
                        }
                    },
                    error: function () {
                        $.unblockUI();
                    },
                    dataType: "json"
                });
            });
            $(".btn-programa-materia").click(function () {
                var id = $(this).attr('id');
                bloqueointerface();
                $.ajax({
                    type: "GET",
                    url: "/pro_planificacion",
                    data: {"action": "syllabusprogramamateria", "id": id},
                    success: function (data) {
                        var contenido;
                        var i;
                        $.unblockUI();
                        $("#programamateria").modal({width: "700px"}).modal('show');
                        if (data.result == 'ok') {
                            contenido = "";
                            if (data.materias.length > 0) {
                                for (i = 0; i <= (data.materias.length - 1); i++) {
                                    materia = data.materias[i];
                                    contenido += "<tr><td>" + materia[0] + "</td><td style='text-align: center;'><a href='" + materia[1] + "' class='btn btn-mini'>Descargar PDF</a></td><td style='text-align: center;'><a href='" + materia[2] + "' class='btn btn-mini'>Descargar WORD</a></td></tr>";
                                }
                            } else {
                                contenido += "<tr><td colspan='2'>NO EXISTEN PROGRAMA ANALÍTICO EN LA MATERIA</td></tr>";
                            }
                            $("#programamateriacontenido").html(contenido);
                        }
                    },
                    error: function () {
                        $.unblockUI();
                    },
                    dataType: "json"
                });
            });
            $(".silabo").click(function () {
                var id = $(this).attr('idm');
                bloqueointerface();
                $.ajax({
                    type: "GET",
                    url: "/pro_planificacion",
                    data: {"action": "tiene_programaanalitico", "id": id},
                    success: function (data) {
                        if (data.result == 'ok') {
                            location.href = "/pro_planificacion?action=silabo&materia=" + id;
                        } else {
                            $.unblockUI();
                            mensajeDanger(data.mensaje);
                        }
                    },
                    error: function () {
                        $.unblockUI();
                    },
                    dataType: "json"
                });
            });
            $(".silaboposgrado").click(function () {
                var id = $(this).attr('idm');
                bloqueointerface();
                $.ajax({
                    type: "GET",
                    url: "/pro_planificacion",
                    data: {"action": "tiene_programaanalitico", "id": id},
                    success: function (data) {
                        $.unblockUI();
                        if (data.result == 'ok') {
                            location.href = "/pro_planificacion?action=silaboposgrado&materia=" + id;
                        } else {
                            smoke.alert(data.mensaje);
                        }
                    },
                    error: function () {
                        $.unblockUI();
                    },
                    dataType: "json"
                });
            });
            $(document).ready(function () {
                $(".fancybox").fancybox();
                $(document).ready(function () {
                    $(".reportmatriculados").click(function () {
                        var matId = $(this).data('id');
                        reportematriculados(matId);
                    });

                    $(".individual").click(function () {
                        var idmat = $(this).attr('idm');
                        openwindow('POST', '/pro_cronograma', {action: 'reporteindividual', idmat: idmat}, '_blank');
                    });
                    $(".masivo").click(function () {
                        var idmat = $(this).attr('idm');
                        openwindow('POST', '/pro_cronograma', {action: 'reporteimasivo', idmat: idmat}, '_blank');
                    });
                });
            });
        });

        function reportematriculados(matId) {
            bloqueointerface();
            $.ajax({
                type: "GET",
                url: '{{ request.path }}',
                data: {
                    'action': 'reportematriculados',
                    'materia': matId,
                },
                success: function (data) {
                    $.unblockUI();
                    if (data.result) {
                       NotificationJG.success(data.mensaje);
                    } else {
                        NotificationJG.error(data.mensaje);
                    }
                },
                error: function () {
                    $.unblockUI();
                    NotificationJG.error(data.mensaje);
                },
                dataType: "json"
            });

        }

        function formModalOffCanvaDetalle(materia, profesor, text, action) {
            bloqueointerface();
            $.ajax({
                type: "GET",
                url: '{{ request.path }}',
                data: {
                    'action': action,
                    'materia': materia,
                    'profesor': profesor,
                },
                success: function (data) {
                    $.unblockUI();
                    if (data.result) {
                        var myOffcanvas = document.getElementById('offcanvasRight')
                        var bsOffcanvas = new bootstrap.Offcanvas(myOffcanvas)
                        $('.contenido-offcanva').html(`<div class="text-justify">${data.html}</div>`)
                        bsOffcanvas.show();
                    } else {
                        mensajeDanger(data.mensaje);
                    }
                },
                error: function () {
                    $.unblockUI();
                    mensajeDanger("Error de conexión.");
                },
                dataType: "json"
            });

        }

        function vistaprevia(idproprag) {
            openwindow('POST', '/pro_planificacion', {action: 'programanaliticopdf', id: idproprag}, '_blank');
        }
    </script>
    <style>
        .box-cursos {
            border-bottom: 5px solid #ffaa46 !important;
        }

        .btn-close {
            padding: 7px!important;
        }
        .btn-cerrar-modal{
            font-size: 14px!important;
            height: 19px!important;
        }

        .btn-cerrar-offcanvas {
            color: white;
            width: 19px;
            height: 25px;
            border-radius: 100%;
            background: #1c3247;
            margin-right: 30px;
            margin-bottom: 5px;
            transition: .3s;
            opacity: 100%;
            font-size: 19px;
        }
    </style>
{% endblock %}
{% block atras %}/{% endblock %}
{% block canvas %}
    <div class="container-fluid">
        <div class='row'>
            <div class='col-lg-8'>
                <div class="headtitle" style="margin-left: 0px">
                    <h3 class="texto-blue">{{ title }}</h3>
                    <h6>Asignaturas</h6>
                </div>
            </div>
            <div class='col-lg-4'>
                <div class="dropbottom" style="text-align: right">
                    <button type="button" class="btn btn-default btn-lg dropdown-toggle" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                        <i class="icon fas fa-cog fa-fw"></i> <i class="fa fa-angle-down"></i>
                    </button>
                    <ul class="dropdown-menu" x-placement="right-start">
                        <li class="dropdown-item"><a href="/pro_planificacion?action=listadogrupotitulacion" class="bloqueo_pantalla"><span class="fa fa-signature"></span> Firmar actas de titulación</a></li>
                        <li class="dropdown-item"><a href="/pro_planificacion?action=listadodisertacion" class="bloqueo_pantalla"><span class="fa fa-calendar-o"></span> Disertaciones</a></li>
                        <li class="dropdown-item"><a href="javascript:;" id="generappl" class="detalleppl"><span class="fa fa-list"></span> Listado PPL</a></li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="row">
            {% for materia in materias %}
                {% with profesormaterias=materia|args:profesor.id|call:"tipoprofesormateriasinautor" %}
                    {% if profesormaterias %}
                        <div class="col-lg-3" style="padding-bottom: 15px;">
                            <div class="card card-hover mb-3 h-100" style="width: 100%;padding-right: 0">
                                <div class="card-body ">
                                    <div class="d-flex align-items-center justify-content-between" style="margin-bottom: -15px!important;">
                                        <a style="line-height: 17px;font-size: 16px">
                                            <b class="mb-3 texto-azul">{{ materia.asignatura.nombre|lower|capfirst }}</b>
                                        </a>
                                        <div class="d-flex align-items-center">
                                            <div class="d-flex align-items-center">
                                                <div class="dropbottom">
                                                    <button type="button" class="btn border-0 dropdown-toggle" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                                        <i class="fa fa-ellipsis-v"></i>
                                                    </button>
                                                    <ul class="dropdown-menu" x-placement="right-start">
{#                                                        {% if materia.coordinacion.id != 8 %}#}
                                                            <li><a class="dropdown-item"
                                                                   href='/pro_planificacion?action=tomandom&materia={{ materia.id|encrypt }}'><span
                                                                    class="fa fa-user dropdown-item-icon mb-1"></span>
                                                                Matriculados en la asignatura</a></li>
                                                            <li>
                                                                <a type="button" class="dropdown-item reportmatriculados" data-id='{{ materia.id|encrypt }}'>
                                                                    <span class="fa fa-file-pdf dropdown-item-icon mb-1"></span>Reporte de Matriculados
                                                                </a>
                                                            </li>
{#                                                         {% endif %}#}
                                                        {% if materia.idcursomoodle %}
                                                            {% if materia.coordinacion.id == 9 %}
                                                                <li><a class="dropdown-item"
                                                                       href="{{ periodo.urlmoodle2 }}/course/view.php?id={{ materia.idcursomoodle }}"
                                                                       target="_blank"><span
                                                                        class="fa fa-file-pdf-o dropdown-item-icon mb-1"></span>
                                                                    Ir al curso de moodle</a></li>

                                                            {% elif materia.coordinacion.id == 8 %}
                                                                 <li><a class="dropdown-item"
                                                                       href="{{ periodo.urlmoodle }}/course/view.php?id={{ materia.idcursomoodle }}"
                                                                       target="_blank"><span
                                                                        class="fa fa-file-pdf-o dropdown-item-icon mb-1"></span>
                                                                    Ir al curso de moodle</a></li>


                                                            {% elif materia.coordinacion.id == 7 %}
                                                                 <li><a class="dropdown-item"
                                                                       href="{{ periodo.urlmoodle }}/course/view.php?id={{ materia.idcursomoodle }}"
                                                                       target="_blank"><span
                                                                        class="fa fa-file-pdf-o dropdown-item-icon mb-1"></span>
                                                                    Ir al curso de moodle</a></li>

                                                            {% elif materia.asignaturamalla.malla.modalidad_id == 1 or materia.asignaturamalla.malla.modalidad_id == 2 %}
                                                                <li><a class="dropdown-item"
                                                                       href="{{ periodo.urlmoodle }}/course/view.php?id={{ materia.idcursomoodle }}"
                                                                       target="_blank"><span
                                                                        class="fa fa-file-pdf-o dropdown-item-icon mb-1"></span>
                                                                    Ir al curso de moodle</a></li>

                                                            {% elif materia.asignaturamalla.malla.modalidad_id == 3 %}
                                                                <li><a class="dropdown-item"
                                                                       href="{{ periodo.urlmoodleenlinea }}/course/view.php?id={{ materia.idcursomoodle }}"
                                                                       target="_blank"><span
                                                                        class="fa fa-file-pdf-o dropdown-item-icon mb-1"></span>
                                                                    Ir al curso de moodle</a></li>
                                                            {% endif %}
                                                        {% endif %}
                                                        {% with dato=materia|call:"coordinacion" %}
                                                            {% if materia.idcursomoodle and not materia.cerrado  %}
                                                                <li><a class="dropdown-item"
                                                                       href="/pro_planificacion?action=notasmoodle&id={{ materia.id|encrypt }}"><i
                                                                        class="fa fa-star dropdown-item-icon mb-1"></i>
                                                                    Calificaciones de moodle</a></li>
                                                            {% endif %}
                                                            {% if dato.id != 9  %}
                                                                {% if periodo.usa_moodle %}
                                                                    {% if materia.nivel.sesion.id == 13 and materia.coordinacion.id != 8%}
                                                                        <li><a class="dropdown-item recorreonline"
                                                                               href="/media/htmlmoodlestatic/{{ materia.namehtml }}"
                                                                               target="_blank"><span
                                                                                class="fa fa-link dropdown-item-icon mb-1"></span>
                                                                            Ver planificación semanal (carreras en
                                                                            línea) </a></li>
                                                                    {% endif %}
                                                                    {% if materia.idcursomoodle and not materia.cerrado %}
                                                                        <div class="dropdown-divider"></div>
                                                                        <div class="dropdown-submenu dropdown-hover dropdown-menu-right">
                                                                            <li class="dropdown-item dropdown-submenu">
                                                                                <a id="dropsubmenu"
                                                                                   class="dropdown-toggle" href="#"
                                                                                   role="button"
                                                                                   data-bs-toggle="dropdown"
                                                                                   aria-haspopup="true"
                                                                                   aria-expanded="false">
                                                                                    <i class="fa fa-refresh dropdown-item-icon mb-1"></i>
                                                                                    Actualizaciones moodle
                                                                                </a>
                                                                                <ul class="dropdown-menu border-0"
                                                                                    aria-labelledby="dropsubmenu"
                                                                                    style="position: absolute; transform: translate3d(-200px, 0px, 0px); top: 0px; left: -19px;width: 220px; will-change: transform;">
                                                                                                                                                                  <li>
                                                                                                                                                                        <a class="confirmacionmodal dropdown-item"
                                                                                                                                                                           href="javascript:;"
                                                                                                                                                                          nhref='/pro_planificacion?action=confirmar_actualizacion_estudiantes&id={{ materia.id }}'><span
                                                                                                                                                                               class="fa fa-users dropdown-item-icon"></span>
                                                                                                                                                                           Actualizar
                                                                                                                                                                          estudiantes</a></li>
                                                                                    {% if not materia.modelotarjeta %}
                                                                                        {% if materia.tiene_silabo_semanal %}
                                                                                            <li>
                                                                                                <a class="confirmacionmodal dropdown-item"
                                                                                                   href="javascript:;"
                                                                                                   nhref='/pro_planificacion?action=confirmar_actualizacion_silabos&id={{ materia.id }}'><span
                                                                                                        class="fa fa-server dropdown-item-icon"></span>
                                                                                                    Actualizar
                                                                                                    sílabo</a></li>
                                                                                        {% endif %}
                                                                                    {% endif %}
                                                                                    <li>
                                                                                        <a class="confirmacionmodal dropdown-item"
                                                                                           href="javascript:;"
                                                                                           nhref='/pro_planificacion?action=confirmar_actualizacion_docentes&id={{ materia.id }}'><span
                                                                                                class="fa fa-users dropdown-item-icon"></span>&nbsp;
                                                                                            Actualizar docente
                                                                                            moodle</a></li>
                                                                                    <li>
                                                                                        <a class="confirmacionmodal dropdown-item"
                                                                                           href="javascript:;"
                                                                                           nhref='/pro_planificacion?action=confirmar_actualizacion_silabomoodle&id={{ materia.id }}'><span
                                                                                                class="fa fa-retweet dropdown-item-icon"></span> Actualizar sílabo en moodle</a>
                                                                                    </li>
                                                                                    <li>
                                                                                        <a class="confirmacionmodal dropdown-item"
                                                                                           href="javascript:;"
                                                                                           nhref='/pro_planificacion?action=confirmar_actualizacion_modevaluativo_moodle&id={{ materia.id }}'><span
                                                                                                class="fa fa-retweet dropdown-item-icon"></span> Actualizar modelo evaluativo</a>
                                                                                    </li>
                                                                                </ul>
                                                                            </li>
                                                                        </div>
                                                                        <div class="dropdown-divider"></div>
                                                                    {% endif %}
                                                                    {#                                                                        {% else %}#}
                                                                    {#                                                                            {% if not materia.idcursomoodle or materia.id == 28124 %}#}
                                                                    {#                                                                                <li><a href="/pro_planificacion?action=planificaciones&id={{ materia.id|encrypt }}"><span class="fa fa-file-pdf-o"></span> Control de Tareas</a> </li>#}
                                                                    {#                                                                            {% endif %}#}
                                                                {% endif %}
                                                                {#                                                            <li><a class="dropdown-item"#}
                                                                {#                                                                   href="/pro_planificacion?action=controlacademico&id={{ materia.id|encrypt }}"><span#}
                                                                {#                                                                    class="fa fa-address-book-o dropdown-item-icon mb-1"></span>#}
                                                                {#                                                                Registrar tutoría y acompañamiento académico#}
                                                                {#                                                                individual</a></li>#}
                                                                {#                                                            <li><a class="tu dropdown-item"#}
                                                                {#                                                                   href="/pro_cronograma?action=tutoriaclase&id={{ materia.id|encrypt }}"><span#}
                                                                {#                                                                    class="fa fa-plus dropdown-item-icon mb-1"></span>#}
                                                                {#                                                                Registrar tutoría y acompañamiento académico#}
                                                                {#                                                                grupal </a></li>#}
                                                                <li><a class="dropdown-item"
                                                                       href="/pro_planificacion?action=comunicacionmasivaview&materia={{ materia.id|encrypt }}"><span
                                                                        class="fa fa-comments-o dropdown-item-icon mb-1"></span>
                                                                    Comunicación Masiva</a></li>
                                                                {#                                                            <li><a class="individual dropdown-item"#}
                                                                {#                                                                   idm="{{ materia.id|encrypt }}"#}
                                                                {#                                                                   idmn="{{ materia.nombre }}"#}
                                                                {#                                                                   href="javascript:;"><span#}
                                                                {#                                                                    class="fa fa-print dropdown-item-icon mb-1"></span>#}
                                                                {#                                                                Imprimir tutoría y acompañamiento académico#}
                                                                {#                                                                individual</a></li>#}
                                                                {#                                                            <li><a class="masivo dropdown-item"#}
                                                                {#                                                                   idm="{{ materia.id|encrypt }}"#}
                                                                {#                                                                   href="javascript:;"><span#}
                                                                {#                                                                    class="fa fa-print dropdown-item-icon mb-1"></span>#}
                                                                {#                                                                Imprimir tutoría y acompañamiento académico#}
                                                                {#                                                                grupal</a></li>#}
                                                            {% else %}
                                                                {% if materia.coordinacion.id == 9 %}
                                                                    <li><a class="dropdown-item recorreonline"
                                                                           href="/pro_planificacion?action=comunicacionmasivaview&materia={{ materia.id|encrypt }}"><span
                                                                            class="fa fa-comments-o dropdown-item-icon mb-1"></span>
                                                                        Comunicación Masiva</a></li>
                                                                    <li><a class="dropdown-item"
                                                                           href="?action=urlexamen&id={{ materia.id|encrypt }}"><span
                                                                            class="fa fa-file dropdown-item-icon mb-1"></span>
                                                                        Url Examen</a></li>
                                                                    {% if materia.idcursomoodle and not materia.cerrado %}
                                                                        <div class="dropdown-divider"></div>
                                                                        <div class="dropdown-submenu dropdown-hover dropdown-menu-right">
                                                                            <li class="dropdown-item dropdown-submenu">
                                                                                <a id="dropsubmenu"
                                                                                   class="dropdown-toggle" href="#"
                                                                                   role="button"
                                                                                   data-bs-toggle="dropdown"
                                                                                   aria-haspopup="true"
                                                                                   aria-expanded="false">
                                                                                    <i class="fa fa-refresh dropdown-item-icon mb-1"></i>
                                                                                    Actualizaciones moodle </a>
                                                                                <ul class="dropdown-menu border-0"
                                                                                    aria-labelledby="dropsubmenu"
                                                                                    style="position: absolute; transform: translate3d(-200px, 0px, 0px); top: 0px; left: 0px;width: 200px; will-change: transform;">
                                                                                                                                                                    <li>
                                                                                                                                                                        <a class="confirmacionmodal dropdown-item"
                                                                                                                                                                          href="javascript:;"
                                                                                                                                                                          nhref='/pro_planificacion?action=confirmar_actualizacion_estudiantes&id={{ materia.id }}'><span
                                                                                                                                                                              class="fa fa-users dropdown-item-icon mb-1"></span>
                                                                                                                                                                          Actualizar
                                                                                                                                                                            estudiantes</a></li>
                                                                                    <li>
                                                                                        <a class="confirmacionmodal dropdown-item"
                                                                                           href="javascript:;"
                                                                                           nhref='/pro_planificacion?action=confirmar_actualizacion_docentes&id={{ materia.id }}'><span
                                                                                                class="fa fa-users dropdown-item-icon mb-1"></span>
                                                                                            Actualizar docente
                                                                                            moodle</a></li>
                                                                                </ul>
                                                                            </li>
                                                                        </div>
                                                                        <div class="dropdown-divider"></div>
                                                                    {% endif %}
                                                                {% endif %}
                                                            {% endif %}
                                                            {% if dato.id != 8 %}
                                                                {% if dato.id != 7 %}
                                                                    <li>
                                                                        <a class="dropdown-item silabo {% if not materia.modeloevaluativo %}disabled{% endif %}" href="javascript:void(0);" idm="{{ materia.id|encrypt }}">
                                                                            <span class="fa fa-book dropdown-item-icon mb-1"></span>
                                                                            Sílabos
                                                                        </a>
                                                                    </li>
                                                                {% else %}
                                                                    <li><a href="javascript:;"
                                                                           idm="{{ materia.id|encrypt }}"
                                                                           class="silaboposgrado dropdown-item"><span
                                                                            class="fa fa-book dropdown-item-icon mb-1"></span>
                                                                        Sílabos</a></li>
                                                                {% endif %}
                                                            {% endif %}
                                                        {% endwith %}
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <ul class="list-inline text-secondary" style="margin-bottom: 7px;font-size: 13px;">
                                        {#                                    {% if materia.profesor_principal %}#}
                                        {#                                        <li class="list-inline-item">#}
                                        {#                                            {{ materia.profesor_principal.persona.primerNombre|lower|capfirst }} {{ materia.profesor_principal.persona.apellido1|lower|capfirst }} (Tutor principal)#}
                                        {#                                        </li>#}
                                        {#                                        <br>#}
                                        {#                                    {% endif %}#}
                                        <li class="list-inline-item">
                                            <b><i class="fa fa-book"></i> Carrera:</b> {{ materia.asignaturamalla.malla.carrera.alias }}
                                        </li>
                                        <br>
                                        {% if materia.asignaturamalla %}
                                            <li class="list-inline-item">
                                                <b><i class="fa fa-chalkboard"></i> Nivel:</b> {{ materia.asignaturamalla.nivelmalla|lower|capfirst }} &nbsp;{% if materia.paralelo %}<b>Paralelo:</b> {{ materia.paralelo }}{% endif %}
                                            </li>
                                        {% endif %}
                                        <li class="list-inline-item">
                                            <b><i class="fa fa-clock"></i> Horas:</b> {{ materia.horas }}
                                        </li>
                                        <br>
                                        <li class="list-inline-item">
                                            {#                                        <b><i class="fa fa-calendar"></i> Inicio:</b> {{ materia.inicio|date:"d-m-Y" }} &nbsp;<b>Fin:</b> {{ materia.fin|date:"d-m-Y" }}#}
                                            <b><i class="fa fa-calendar"></i> Inicio:</b> {{ profesormaterias.first.desde|date:"d-m-Y" }} &nbsp;<b>Fin:</b> {{ profesormaterias.first.hasta|date:"d-m-Y" }}
                                        </li>
                                    </ul>
                                    <div class="lh-1">
                                        {% for tp in profesormaterias %}
                                            <span class="{% if forloop.counter|divisibleby:2 %}texto-azul-claro{% else %}texto-naranja{% endif %}"
                                                  style="font-size: 12px">
                                                    {{ tp.tipoprofesor }} {% if not forloop.last %}/{% endif %}
                                                </span>
                                        {% endfor %}
                                    </div>
                                    <div>
                                        {% if not materia.asignaturamalla.malla.carrera.mi_coordinacion2 == 9 %}
                                            <span class="badge bg-success">Pregrado</span>
                                        {% else %}
                                            <span class="badge bg-primary">Nivelación</span>
                                        {% endif %}
                                        {% if not materia.modeloevaluativo %}
                                            <span class="text-danger"> sin modelo evaluativo</span>
                                        {% endif %}
                                    </div>
                                </div>
                                <div class="card-footer">
                                    <div class="row align-items-center g-0">
                                        {% with examendetalles=materia|args:persona|call:"horarioexamendetalleprofesor" tiene_examen_virtual=materia|args:profesor|call:"tiene_examen_virtual" %}
                                            <div class="col-auto">
                                                <a class="btn btn-default btn-mini tb bloqueo_pantalla"
                                                   title="Mensajes"
                                                   href="/pro_planificacion?action=controlacademico&id={{ materia.id|encrypt }}">
                                                    <i class="fa fa-comments"></i>
                                                    <span class="badge bg-warning">{{ materia.totalpreguntasdocentes }}</span>
                                                </a>
                                            </div>
                                            <div class="col-auto" style="padding-top: 12px;margin-left: 7px;text-align: left">
                                                {% if materia.cerrado %}
                                                    <h5>
                                                        <span class="text-success"><i class="fa fa-check-circle"></i> Finalizada</span>
                                                    </h5>
                                                {% endif %}
                                            </div>
                                            {#                                        {{ materia.id }} / {{ materia.visiblehorarioexamen }} / {{ examendetalles }}#}
                                            {% if not materia.cerrado and materia.visiblehorarioexamen %}
                                                {% if examendetalles %}
                                                    <div class="col-auto">
                                                        <a class="btn btn-default" onclick="formModalOffCanvaDetalle('{{ materia.id }}', {{ persona.id }}, 'Ver Detalle', 'detalleexamen')" href="#horarioExamen{{ materia.id }}">
                                                            <i class="fa fa-calendar"></i> Horarios de Exámenes
                                                        </a>
                                                    </div>
                                                {% endif %}
                                            {% endif %}
                                        {% endwith %}
                                    </div>
                                </div>
                            </div>
                        </div>
                    {% endif %}
                {% endwith %}
            {% empty %}
                <div class="col-lg-12">
                    <div class="card card-hover mb-3 h-100" style="width: 100%;padding-right: 0px">
                        <div class="card-body">
                            <b style="font-size: 14px" class="text-danger"><i class="fa fa-info-circle"></i> Sin materias asignadas.</b>
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>
    </div>
    <div class="offcanvas offcanvas-end" id="offcanvasRight" style="width: 800px;">
        <div class="offcanvas-body" data-simplebar>
{#            <div class="offcanvas-header px-2 pt-0">#}
                {#                <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas"#}
                {#                        aria-label="Close"></button>#}
                <button type="button" class="btn-close  btn-cerrar-modal" data-bs-dismiss="offcanvas" aria-label="Close"><i class="fa fa-times"></i></button>
{#            </div>#}
            <!-- card body -->
            <div class="container">
                <!-- form -->
                <div class="row">
                    <div class="contenido-offcanva">

                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade static" id="malla" style="display: none;">
        <div class="modal-dialog modal-dialog-centered modal-lg" role="document" id="wmodal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 id="paneltitle1"> Silabo Malla</h3>
                </div>
                <div class="modal-body">
                    <table class="table table-bordered table-striped">
                        <thead>
                        <tr>
                            <th>Malla</th>
                            <th style="text-align: center;width: 90px;">Silabo Malla</th>
                        </tr>
                        </thead>
                        <tbody id="mallacontenido"></tbody>
                    </table>
                </div>
                <div class="modal-footer">
                    <a href="javascript:;" class="btn btn-cerrarmalla btn-info" data-bs-dismiss="modal">Cerrar</a>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade static" id="materias" style="display: none;">
        <div class="modal-dialog modal-dialog-centered modal-lg" role="document" id="wmodal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 id="paneltitle1"> Silabo Materia</h3>
                </div>
                <div class="modal-body">
                    <table class="table table-bordered table-striped">
                        <thead>
                        <tr>
                            <th>Materia</th>
                            <th style="text-align: center;width: 90px;" colspan="2">Silabo Materia</th>
                        </tr>
                        </thead>
                        <tbody id="materiascontenido"></tbody>
                    </table>
                </div>
                <div class="modal-footer">
                    <a href="javascript:;" class="btn btn-cerrarmateria btn-info">Cerrar</a>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade static" id="programamalla" style="display: none;">
        <div class="modal-dialog modal-dialog-centered modal-lg" role="document" id="wmodal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 id="paneltitle1"> Plan de estudio malla</h3>
                </div>
                <div class="modal-body">
                    <table class="table table-bordered table-striped">
                        <thead>
                        <tr>
                            <th>Malla</th>
                            <th style="text-align: center;width: 90px;" colspan="2">Plan de Estudio Malla</th>
                        </tr>
                        </thead>
                        <tbody id="programamallacontenido"></tbody>
                    </table>
                </div>
                <div class="modal-footer">
                    <a href="javascript:;" class="btn btn-cerrarprogramamalla btn-info">Cerrar</a>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade static" id="programamateria" style="display: none;">
        <div class="modal-dialog modal-dialog-centered modal-lg" role="document" id="wmodal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 id="paneltitle1"> Programa Anal&iacute;tico Asignatura Malla</h3>
                </div>
                <div class="modal-body">
                    <table class="table table-bordered table-striped">
                        <thead>
                        <tr>
                            <th>Asignatura Malla</th>
                            <th style="text-align: center;width: 90px;" colspan="2">Programa Anal&iacute;tico Asignatura
                                Malla
                            </th>
                        </tr>
                        </thead>
                        <tbody id="programamateriacontenido"></tbody>
                    </table>
                </div>
                <div class="modal-footer">
                    <a href="javascript:;" class="btn btn-cerrarprogramamateria btn-info">Cerrar</a>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade static" id="modalcreavideo" style="display: none; z-index: 1080;">
        <div class="modal-dialog modal-dialog-centered modal-lg" role="document" id="wmodal">
            <div class="modal-content" style="width: 68%!important;">
                <div class="modal-header">
                    <h3 class="paneltitle"><i class="fa fa-link"></i> Link del exámen</h3>
                </div>
                <div class="modal-body panelbodyforo">
                    Enlace a la grabación 1
                    <span style="color:#FF0000" ;>* Obligatorio</span>
                    <br>
                    <input type="hidden" id="id_clasevideo" name="id_clasevideo" value="0">
                    <textarea rows="3" name="id_observacionvideo" id="id_observacionvideo"
                              style="width: 500px"></textarea><br>
                    Enlace a la grabación 2<br>
                    <textarea rows="3" name="id_enlace2video" id="id_enlace2video" style="width: 500px"></textarea><br>
                    Enlace a la grabación 3<br>
                    <textarea rows="3" name="id_enlace3video" id="id_enlace3video" style="width: 500px"></textarea>
                </div>
                <div class="modal-footer">
                    <table class="pull-right">
                        <tr>
                            <td><a href="javascript:;" class="btn btn-success savelink">Crear</a></td>
                            <td><a href="javascript:;" class="btn btn-default cancelalink">Cancelar</a></td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="showdetalle" style="display: none;">
        <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 id="paneltitle"></h4>
                    <br>
                </div>
                <div class="modal-body" id="body-modal">
                    <div class="tabbable"> <!-- Only required for left/right tabs -->
                    </div>
                </div>
                <div class="row-fluid">
                    <div class="span12">
                        <div class="modal-footer">
                            <a  href="javascript:;" id="cerrardetallemodal" class="btn btn-success">Cerrar</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}
