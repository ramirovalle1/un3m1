    {% extends "base.html" %}
{% load sga_extras %}
{% block heading %}
    <style>
        .dataTables_filter {
            padding-bottom: 15px;
        }

        .table.dataTable tfoot th, table.dataTable tfoot td {
            border-top: 1px solid #E5E8E8 !important;
        }

        .tab-content {
            overflow: initial;
        !important;
        }
    </style>
    <link href="/static/css/table-responsive.css?1.0.0" type="text/css" rel="stylesheet"/>
    <script src="/static/adicionalesjs/formquestionb4.js?0.24"></script>
    <script type="text/javascript" src="/static/js/jquery.fancybox.pack.js?v=1.0.0"></script>
    <link rel="stylesheet" href="/static/css/jquery.fancybox.css?v=1.0.0" type="text/css" media="screen"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
    <script type="text/javascript" src='/static/js/select2.js?v=1.0.0'></script>
    <link type='text/css' rel='stylesheet' href="/static/css/select2.css?v=1.0.0"/>
    <script type="text/javascript" src='/static/js/fontawesomev3.js?v=1.0.0'></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/momentjs/latest/moment.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"></script>
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css"/>



    {#    <script type="text/javascript" src="https://cdn.datatables.net/buttons/1.5.6/js/dataTables.buttons.min.js"></script>#}
    {#    <script type="text/javascript" src="https://cdn.datatables.net/buttons/1.5.6/js/buttons.bootstrap.min.js"></script>#}
    {#    <script type="text/javascript" src="https://cdn.datatables.net/buttons/1.5.6/js/buttons.colVis.min.js"></script>#}
    {#    <link href="https://gitcdn.github.io/bootstrap-toggle/2.2.2/css/bootstrap-toggle.min.css" rel="stylesheet">#}
    {#    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jszip/2.5.0/jszip.min.js"></script>#}
    {#    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.36/pdfmake.min.js"></script>#}
    {#    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.36/vfs_fonts.js"></script>#}
    {#    <script type="text/javascript" src="https://cdn.datatables.net/buttons/1.5.6/js/buttons.flash.min.js"></script>#}
    {#    <script type="text/javascript" src="https://cdn.datatables.net/buttons/1.5.6/js/buttons.html5.min.js"></script>#}
    <script type="text/javascript">

        $(function () {
            $(".showmodal").click(function () {
                var id = $(this).attr("id");
                bloqueointerface();
                $.ajax({
                    type: "GET",
                    url: "{{ request.path }}",
                    data: {'action': 'alumalla', 'id': id},
                    success: function (data) {
                        $.unblockUI();
                        if (data.result == 'ok') {
                            $("#body-modal").html(data.data);
                            $("#showdetalle").modal({
                                backdrop: 'static',
                                width: $(window).width() - 100,
                                height: $(window).height() - 100
                            }).modal('show');
                        } else {
                            smoke.alert(data.mensaje);
                        }
                    },
                    error: function () {
                        $.unblockUI();
                        smoke.alert("Error de conexión.");
                    },
                    dataType: "json"
                });
            });
            $("#cerrardetallemodal").click(function () {
                $("#showdetalle").modal("hide");
            });
        });

        var desde = '', hasta = '';

        function formEliminar(id, text, action) {
            bloqueointerface();
            $.ajax({
                type: "GET",
                url: `{{ request.path }}`,
                data: {
                    'action': action,
                    'id': id,
                },
                success: function (data) {
                    $.unblockUI();
                    if (data.result === true) {
                        $('.panelbodymodalform').html(data.data);
                        $('#itemspanelmodalform .paneltitle').html(text);
                        $("#itemspanelmodalform").modal({backdrop: 'static', width: '900'}).modal('show');
                    } else {
                        smoke.alert(data.mensaje);
                    }
                },
                error: function () {
                    $.unblockUI();
                    smoke.alert("Error de conexión.");
                },
                dataType: "json"
            });
        }

        $(document).ready(function () {
            $("select").select2({minimumResultsForSearch: 10});
            $(".primerfilaacoordion").on('show.bs.collapse', function () {
                $(".primerfilaacoordion.in").each(function () {
                    $(this).parent().find(".far").removeClass("fa-chevron-up").addClass("fa-chevron-down");
                    $(this).collapse('hide')
                });
                $(this).parent().find(".far").removeClass("fa-chevron-down").addClass("fa-chevron-up");
            }).on('hide.bs.collapse', function () {
                $(this).parent().find(".far").removeClass("fa-chevron-up").addClass("fa-chevron-down");
            });
            $(".segundafilaacoordion").on('show.bs.collapse', function () {
                $(".segundafilaacoordion.in").each(function () {
                    $(this).parent().find(".far").removeClass("fa-chevron-up").addClass("fa-chevron-down");
                    $(this).collapse('hide')
                });
                $(this).parent().find(".far").removeClass("fa-chevron-down").addClass("fa-chevron-up");
            }).on('hide.bs.collapse', function () {
                $(this).parent().find(".far").removeClass("fa-chevron-up").addClass("fa-chevron-down");
            });
            $(".tercerafilaacoordion").on('show.bs.collapse', function () {
                $(".tercerafilaacoordion.in").each(function () {
                    $(this).parent().find(".fra").removeClass("fa-chevron-up").addClass("fa-chevron-down");
                    $(this).collapse('hide')
                });
                $(this).parent().find(".far").removeClass("fa-chevron-down").addClass("fa-chevron-up");
            }).on('hide.bs.collapse', function () {
                $(this).parent().find(".far").removeClass("fa-chevron-up").addClass("fa-chevron-down");
            });
            $(".cuartafilaacoordion").on('show.bs.collapse', function () {
                $(".cuartafilaacoordion.in").each(function () {
                    $(this).parent().find(".far").removeClass("fa-chevron-up").addClass("fa-chevron-down");
                    $(this).collapse('hide')
                });
                $(this).parent().find(".far").removeClass("fa-chevron-down").addClass("fa-chevron-up");
            }).on('hide.bs.collapse', function () {
                $(this).parent().find(".far").removeClass("fa-chevron-up").addClass("fa-chevron-down");
            });
        });

        $(function () {
            {#$("#select_estado").select2();#}

            busqueda = function () {
                {#debugger;#}
                var term = $("#searchinput").val().trim().toUpperCase();
                var idest = $("#select_estado").val();
                var idcar = $("#select_carrera").val();
                var iditi = $("#select_itinerario").val();
                var docu = $("#option1").val();
                let href = "{{ request.path|safe }}?action=listapreinscritos&id={{ preinscripcion.id|encrypt }}&s=" + term;
                if (parseInt(idest)){
                    href += "&idest=" + idest;
                }
                if (parseInt(idcar)){
                    href += "&idcar=" + idcar;
                }
                if (parseInt(iditi)){
                    href += "&iditi=" + iditi;
                }
                if (parseInt(docu)){
                    href += "&docu=" + docu;
                }
                location.href = href;
                bloqueointerface();
                //return false;

            };

            $("#search").click(function () {
                busqueda();
            });

            $('#searchinput').keyup(function (e) {
                if (e.keyCode == 13) {
                    busqueda();
                }
            });

            $("#select_carrera, #select_itinerario, #select_estado, #option1").select2().on("select2:select", function (e) {
                busqueda();
            });

            if ('{{ idcar }}'.length){
                $('#select_carrera').val('{{ idcar }}').trigger('change');
            }
            if ('{{ iditi }}'.length){
                $('#select_itinerario').val('{{ iditi }}').trigger('change');
            }
            if ('{{ idest }}'.length){
                $('#select_estado').val('{{ idest }}').trigger('change');
            }
            if ('{{ docu }}'.length){
                $('#option1').val('{{ docu }}').trigger('change');
            }

            $("#itemspanel #cerrar").click(function () {
                $("#itemspanel").modal("hide");
            });
            $("#itemspanel #ejecutar").click(function () {
                var id = $("#idm").val();
                var action = $("#action").val();
                var item = $("#respuesta_estado").val();
                if (action.length > 0 && id.length > 0) {
                    $.post("{{ request.path }}", {'action': action, 'id': id}, function (data) {
                        if (data.result == 'ok') {
                            $.unblockUI();
                            t = '';
                            tt = '';
                            f = '';
                            $("#estador" + id).empty();
                            if (data.activo) {
                                t = 'Desactivar respuesta';
                                tt = 'Desactivar';
                                f = 'fa fa-check';
                            } else {
                                t = 'Activar respuesta';
                                tt = 'Activar';
                                f = 'fa fa-close';
                            }
                            $("#estador" + id).append("<a class='estado_respuesta tu' idr='" + id + "' respt='" + item + "' titulo='" + t + "' title='" + tt + "'> <span class='" + f + "'></span></a>");
                            $("#itemspanel").modal("hide");
                            controlado_respuesta();
                        }
                    }, 'json');

                } else {
                    smoke.alert("Error al obtener os datos.");
                }
            });
            controlado_respuesta = function () {
                $(".estado_respuesta").click(function () {
                    $("#action").val('estado_respuesta');
                    $("#idm").val($(this).attr('idr'));
                    $(".paneltitle").html($(this).attr('titulo'));
                    $("#respuesta_estado").html($(this).attr('respt'));
                    $("#item_modal").html($(this).attr('titulo').toLowerCase());
                    $("#itemspanel").modal({backdrop: 'static', width: '400px'}).modal('show');
                });
            };
            $(".eliminarrespuesta").click(function () {
                $("#idm").val($(this).attr('idr'));
                $("#respuesta_estado").html($(this).attr('rd'));
                $("#itemspaneleliminarrespuesta").modal({backdrop: 'static', width: '400px'}).modal('show');
            });
            $("#itemspaneleliminarrespuesta #eliminar").click(function () {
                var id = $("#idm").val();
                $.post("{{ request.path }}", {
                    'action': 'eliminarrespuesta',
                    'id': id
                }, function (data) {
                    if (data.result == 'ok') {
                        $.unblockUI();
                        $("#filarespuesta" + id).hide();
                    } else {
                        smoke.alert(data.mensaje);
                    }
                    $("#itemspaneleliminarrespuesta").modal("hide");
                }, 'json');
            });
            $("#itemspaneleliminarrespuesta #cerrar").click(function () {
                $("#itemspaneleliminarrespuesta").modal("hide");
            });
            $(".observacion").click(function () {
                var id = $(this).attr('id');
                bloqueointerface();
                $.post("{{ request.path }}", {
                    'action': 'detalleobservacion',
                    'id': id
                }, function (data) {
                    if (data.result == 'ok') {
                        $.unblockUI();
                        $(".panelbodyobs").html(data.data);
                        $("#itemspanelobservacion").modal({backdrop: 'static', width: '800px'}).modal('show');
                    } else {
                        smoke.alert(data.mensaje);
                    }
                }, 'json');
            });
            $("#itemspanelobservacion #cerrar").click(function () {
                $("#itemspanelobservacion").modal("hide");
            });
            $("#boton_aceptacionaprobada").click(function () {
                var iscarrera = $('#select_carrera').val();
                var idestado = $('#select_estado').val();
                bloqueointerface();
                $.ajax({
                    type: "POST",
                    url: "{{ request.path }}",
                    data: {
                        'action': 'aprobarsolicitados',
                        'iscarrera': iscarrera,
                        'idestado': idestado,
                        'idpreinscripcion': {{ preinscripcion.id }}
                    },
                    error: function () {
                        $.unblockUI();
                        smoke.alert("Error al obtener los datos.");
                    },
                    success: function (data) {
                        if (data.result == "ok") {
                            alert(data.total)
                            $("#modalasignacionaprobacionmasiva").modal({
                                backdrop: 'static',
                                width: '600px'
                            }).modal('hide');
                            location.reload();
                        } else {
                            $.unblockUI();
                            smoke.alert(data.mensaje);
                        }
                    }
                });

            });
            $("#cancel_cancelaaprobacion").click(function () {
                $('#modalasignacionaprobacionmasiva').modal('hide');
            });
            $('#reporteseguimiento').on('click', function () {
                $('#fechas').val('');
                $('#modal_reporteseguimiento').modal({backdrop: 'static', width: '500px'}).modal('show');
            });
            $("#download_report").click(function () {
                openwindow('GET', '{{ request.path }}', {
                    action: 'excelseguimiento',
                    desde: desde,
                    hasta: hasta,
                    id: '{{ preinscripcion.pk }}'
                }, '_blank');
                $('#modal_reporteseguimiento').modal('hide');
            });
            $('input[name="fechas"]').daterangepicker({
                showDropdowns: true,
                autoUpdateInput: false,
                opens: "center",
                drops: "up",
                minDate: moment().subtract(5, 'years').startOf('year'),
                maxDate: moment().endOf('year'),
                startDate: moment(),
                endDate: moment(),
                locale: {
                    format: 'YYYY-MM-DD',
                    applyLabel: '<i class="fas fa-check"></i> Selecionar',
                    cancelLabel: '<i class="fa fa-eraser"></i> Limpiar',
                    showButtonPanel: false,
                    customRangeLabel: "Custom",
                    daysOfWeek: [
                        "Dom",
                        "Lun",
                        "Mar",
                        "Mie",
                        "Jue",
                        "Vie",
                        "Sáb"
                    ],
                    monthNames: [
                        "Enero",
                        "Febrero",
                        "Marzo",
                        "Abril",
                        "Mayo",
                        "Junio",
                        "Julio",
                        "Agosto",
                        "Septiembre",
                        "Octubre",
                        "Noviembre",
                        "Diciembre"
                    ],
                    firstDay: 1
                }
            }).on('apply.daterangepicker', function (ev, picker) {
                desde = picker.startDate.format('YYYY-MM-DD');
                hasta = picker.endDate.format('YYYY-MM-DD');
                $(this).val(desde + ' - ' + hasta);
            }).on('cancel.daterangepicker', function (ev, picker) {
                desde = '';
                hasta = '';
                $(this).val('');
            });

        });

        function preinscriptos_excel(id) {
            openwindow('POST', '{{ request.path }}', {
                action: 'preinscriptos_excel',
                'id': id
            }, '_blank');
        }

        function datospersonales_excel(id) {
            openwindow('POST', '{{ request.path }}', {
                action: 'datospersonales_excel',
                'id': id
            }, '_blank');
        }

        function asignados_excel(id) {
            openwindow('POST', '{{ request.path }}', {
                action: 'estudiantes_asignados_excel',
                'id': id
            }, '_blank');
        }

        function asignacionmasiva(idpreinscripcion) {
            var nomcarrera = $('select[id="select_carrera"] option:selected').text();
            var estado = $('select[id="select_estado"] option:selected').text();
            bloqueointerface();
            $(".aprobacionmasivabody").html("<p style=\"margin-top: 16px;\">Esta seguro(a) que desea asignar y aprobar masivamente la carrera " + nomcarrera + " con estado " + estado + "?</p>")
            $("#modalasignacionaprobacionmasiva").modal({backdrop: 'static', width: '600px'}).modal('show');
            $.unblockUI();
        }

        $(function () {
            $("select").select2({minimumResultsForSearch: 10});

            $(".select2hidden").each(function () {
                var id = $(this).attr("id");
                $("#" + id + "_select2").html('<option>' + $(this).attr("descripcion") + '</option>').trigger('change');
            });
        });

        function formModal(id, text, action, footer = true) {
            bloqueointerface();
            $('.panelbodylistado').empty();
            $('.panelbodyproceso').empty();
            $('.panelbodyform').empty();
            $.ajax({
                type: "GET",
                url: `{{ request.path }}`,
                data: {
                    'action': action,
                    'id': id,
                },
                success: function (data) {
                    $.unblockUI();
                    if (data.result === true) {
                        if (footer === true) {
                            $('#footermodallistado').hide();
                        }
                        $('.panelbodylistado').html(data.data);
                        $('#itemspanellistado .paneltitlelistado').html(text);
                        $("#itemspanellistado").modal({backdrop: 'static', width: '85%'}).modal('show');
                    } else {
                        smoke.alert(data.mensaje);
                    }
                },
                error: function () {
                    $.unblockUI();
                    smoke.alert("Error de conexión.");
                },
                dataType: "json"
            });
        }

        function formModalObsLlamadas(id, text, action, width, footer = true) {
            bloqueointerface();
            $('.anilladobodylistado').empty();
            $('.panelbodyproceso').empty();
            $('.panelbodyform').empty();
            $.ajax({
                type: "GET",
                url: `{{ request.path }}`,
                data: {
                    'action': action,
                    'id': id,
                },
                success: function (data) {
                    $.unblockUI();
                    if (data.result === true) {
                        if (footer === true) {
                            $('#footermodalobservacionllamadaslistado').hide();
                        }
                        $('.anilladobodylistado').html(data.data);
                        $('#itemsobservacionllamadas .panelobservacionllamadastitle').html(text);
                        $("#itemsobservacionllamadas").modal({backdrop: 'static', width: width}).modal('show');
                    } else {
                        smoke.alert(data.mensaje);
                    }
                },
                error: function () {
                    $.unblockUI();
                    smoke.alert("Error de conexión.");
                },
                dataType: "json"
            });
        }

    </script>
    <script>
        $(function () {

            var tabpanel = localStorage.getItem('tabpanel');
            if (!tabpanel) {
                tabpanel = "#1";
                localStorage.setItem("tabpanel", tabpanel);
            }

            $('.tabs').each(function () {
                if ($(this).attr('href') == tabpanel) {
                    $(this).trigger('click');
                }
            }).click(function () {
                localStorage.setItem("tabpanel", $(this).attr('href'));
            });

            $(".seleccionar_periodo").click(function () {
                bloqueointerface();
                $("#seleccionarperiodomodalform").modal({backdrop: 'static', width: '1000px'}).modal('show');
                $.unblockUI();
            });

            $(".masivomigrarest").click(function () {
                var text = $(this).attr('text');
                var id = $(this).attr('id');
                var periodo_masivo = $("#select_periodo_masivo").val();
                var nivel_masivo = $("#select_nivel_masivo").val();
                console.log('periodo_masivo');
                console.log(periodo_masivo);
                if (periodo_masivo > 0){
                    bloqueointerface();
                    $("#seleccionarperiodomodalform").modal('hide');
                    $.ajax({
                        type: "GET",
                        url: `{{ request.path }}`,
                        data: {'action': 'migrarmasivoperiodo', 'id': id, 'periodo_masivo':periodo_masivo, 'nivel_masivo':nivel_masivo},
                        success: function (data) {
                            $.unblockUI();
                            if (data.result == 'ok') {
                                $('#itemspanelmigrarmasivopc .modal-footer').hide();
                                $(".panelbodyevidencia").html(data.data);
                                $('#itemspanelmigrarmasivopc .paneltitle').html(text);
                                $("#itemspanelmigrarmasivopc").modal({backdrop: 'static', width: '1000px'}).modal('show');
                            } else {
                                alertaDanger(data.mensaje);
                            }
                        },
                        error: function () {
                            $.unblockUI();
                            alertaDanger("Error de conexión.");
                        },
                        dataType: "json"
                    });
                }else{
                    alertaDanger("Seleccione un periodo académico, para continuar.");
                }
            });

            $(".grupoorden").click(function () {

                let text = $(this).attr('text');
                var id = $(this).attr('id');

                bloqueointerface();
                $.ajax({
                    type: "GET",
                    url: `{{ request.path }}`,
                    data: {'action': 'ordenprioridad', 'id': id},
                    success: function (data) {
                        $.unblockUI();
                        if (data.result == 'ok') {
                            $('#itemspanelmigrarmasivopc .modal-footer').hide();
                            $(".panelbodyevidencia").html(data.data);
                            $('#itemspanelmigrarmasivopc .paneltitle').html(text);
                            $("#itemspanelmigrarmasivopc").modal({backdrop: 'static', width: '1000px'}).modal('show');
                        } else {
                            alertaDanger(data.mensaje);
                        }
                    },
                    error: function () {
                        $.unblockUI();
                        alertaDanger("Error de conexión.");
                    },
                    dataType: "json"
                });
            });

        });

        $(document).ready(function () {
            const tabla_paginada = $('.tabla_paginada').DataTable({
                responsive: true,
                ordering: false,
                paging: true,
                searching: true,
                bInfo: true,
                dom: "<<'col-sm-12 col-md-3'f><'col-sm-12 col-md-3'l><'col-sm-12 col-md-12'B>>" +
                    "<<'col-sm-12'tr>>" +
                    "<<'col-md-6 col-sm-12'i><'col-md-4 col-sm-12'p>>",
                buttons: []
            });
            $('.tabla_paginada tbody').on('click', 'tr', function () {
                var data = tabla_paginada.row(this).data();
            });
        });

        function confirmacionAccion(id, title, text, action) {
            Swal.fire({
                title: title,
                text: text,
                type: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#3085d6',
                cancelButtonColor: '#d33',
                confirmButtonText: 'Si, ejecutar!',
                cancelButtonText: 'Cancelar'
            }).then((result) => {
                if (result.value) {
                    bloqueointerface();
                    $.ajax({
                        type: 'POST',
                        url: '{{ reques.path }}',
                        async: false,
                        data: {
                            csrfmiddlewaretoken: '{{ csrf_token }}',
                            action: action,
                            id: id,
                        },
                        dataType: "json",
                        beforeSend: function () {
                            bloqueointerface();
                        }
                    }).done(function (data) {
                        setTimeout($.unblockUI, 1);
                        if (data.result === 'ok') {
                            Swal.fire(
                                'Se ha ejecutado correctamente!',
                                '',
                                'success'
                            ).then(function () {
                                bloqueointerface();
                                location.reload();
                            });
                        } else {
                            Swal.fire(data.mensaje);
                        }
                    }).fail(function (jqXHR, textStatus, errorThrown) {
                        setTimeout($.unblockUI, 1);
                        Swal.fire({
                                    text: 'Error al intentar conectar con el servidor',
                                    type: 'error',
                                    icon: 'error'
                                });
                    }).always(function () {
                    });
                }
            })
        }

    </script>
{% endblock %}
{% block atras %}{{ request.path }}?action=confpreinscripciones&id={{ preinscripcion.id|encrypt }}{% endblock %}
{% block canvas %}

    <div class="modal fade static" id="showdetalle" style="display: none;">
        <div class="modal-dialog modal-dialog-centered modal-xl" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 id="paneltitle">Malla Estudiante</h4>
                </div>
                <div class="modal-body" id="body-modal">
                </div>
                <div class="modal-footer">
                    <a href="javascript:;" id="cerrardetallemodal" class="btn btn-success">Cerrar</a>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade static" id="itemspanellistado" style="display: none;">
        <div class="modal-dialog modal-dialog-centered modal-xl" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h4><i class="fa fa-list"></i> <b class="paneltitlelistado">FORMULARIO MODAL</b></h4>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close">
                    </button>
                </div>
                <div class="modal-body">
                    <form autocomplete="off" method="post"
                          enctype="multipart/form-data" action="{{ request.path }}">
                        {% csrf_token %}
                        <div class="panelbodylistado">
                        </div>
                    </form>
                </div>
                <div class="modal-footer" id="footermodallistado">
                    <a href="javascript:;" class="btn btn-default" data-bs-dismiss="modal"><i
                            class="fa fa-window-close"></i>
                        Cerrar</a>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade static" id="itemspanelmodalform" style="display: none;">
        <div class="modal-dialog modal-dialog-centered modal-xl" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h4><i class="fa fa-list"></i> <b class="paneltitle">FORMULARIO MODAL</b></h4>
                </div>
                <div class="modal-body">
                    <form id="form2" class="form-horizontal form-modal" autocomplete="off" method="post"
                          enctype="multipart/form-data" action="{{ request.path }}">
                        {% csrf_token %}
                        <div class="row-fluid panelbodymodalform">

                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade static" id="seleccionarperiodomodalform" style="display: none;">
        <div class="modal-dialog modal-dialog-centered modal-md" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h4><i class="fa fa-list"></i> <b class="paneltitle">Selección de estudiantes aptos y no aptos</b></h4>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                        <div class="row-fluid panelbodyseleccionarperiodo">
                            <div class="input-group">
                                <select class="selector" id="select_periodo_masivo" style="width: 100%">
                                    <option value="0"> Seleccione un periodo </option>
                                    {% for p in periodosacademicos %}
                                        <option {% if p.id == periodo.id %}selected{% endif %}
                                                value="{{ p.id }}">{{ p }})</option>
                                    {% endfor %}
                                </select><br><br>
                                <select class="selector" id="select_nivel_masivo" style="width: 100%">
                                    <option value="0"> Todos niveles</option>
                                    <option value="7"> 8vo Nivel </option>
                                    <option value="8"> 9no Nivel </option>
                                </select>
                            </div>
                        </div>
                </div>
                <div class="modal-footer" id="footermodal">
                    <div style="float: right">
                        <a class="masivomigrarest btn btn-success" text="{{ preinscripcion.motivo }}" href="javascript:;" id="{{ preinscripcion.id|encrypt }}"><i class="fa fa-gears"></i> Ejecutar</a>
                        <button type="button" class="btn btn-default" data-bs-dismiss="modal"><i
                                class="fa fa-window-close"></i> Cerrar
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class='row'>
        <div class='col-lg-4'>
            <div class="headtitle">
                <h3><i class="texto-blue"></i> {{ title }}</h3>
                <h6><i class="fa fa-tag"></i> {{ preinscripcion.motivo }}</h6>
                <h6><i class="fa fa-calendar"></i> Fecha de: {{ preinscripcion.fechainicio|date:"d-m-Y" }}
                    hasta {{ preinscripcion.fechafin|date:"d-m-Y" }}</h6>
            </div>
        </div>
        <div class='col-lg-6'>
            <div class="headtitlenobar">
                <h3 class="texto-blue"><i class="fa fa-user"></i> Detalle preinscritos</h3>
                <h6>Total de Pre Inscripciones: <span class="text-warning"> {{ preinscripcion.cant_preinscripciones }}</span> &nbsp;
                    Pre Inscripciones por busqueda: <span class="text-info"> {{ cant_inscritos_busqueda }}</span>
                </h6>
{#                <h6>#}
{#                </h6>#}
                <h6>Estudiantes preinscritos: <span class="text-success"> {{ insinscritoscount0 }}</span> &nbsp;
                    Pre Inscripciones con solicitud: <span class="text-success"> {{ inssolicitudcount }}</span> /
                    <span class="text-danger"> {{ inspendsolicitudcount }}</span>
                </h6>
{#                <h6></h6>#}
            </div>
        </div>
{#        <div class='col-lg-4'>#}
{#            <div class="headtitlenobar">#}
{#                <h3 class="texto-blue"><i class="fa fa-phone"></i> Detalle Llamadas</h3>#}
{#                <h6>Pendientes: <span class="text-secondary"> {{ cant_llamadas__pendientes }}</span></h6>#}
{#                <h6>#}
{#                    Contestadas: <span class="text-info"> {{ cant_llamadas_contestadas }}</span> / No Contestadas:#}
{#                    <span class="badge bg-danger"> {{ cant_llamadas__no_contestadas }}</span></h6>#}
{#                <h6>#}
{#                    Confirmación de Participación: <span#}
{#                        class="text-success"> {{ cant_llamadas_confirmar_participacion }}</span> / No Interesados:#}
{#                    <span class="badge bg-warning"> {{ cant_llamadas_no_interesados }}</span>#}
{#                </h6>#}
{#            </div>#}
{#        </div>#}
    </div>

    <div class='row'>
            <div class="col-lg-12 col-md-12 col-12">
                <div class="d-md-flex align-items-center px-2">
                    <div class="btn-group ">
                        <button type="button" class="btn btn-default dropdown-toggle" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <i class="fa fa-paperclip" aria-hidden="true"></i> Reportes
                        </button>
                        <ul class="dropdown-menu" style="font-size: 16px">
                            <a class="btn btn-default dropdown-item" href="javascript:;" onclick="datospersonales_excel({{ preinscripcion.id }})">
                                <i class="fa fa-file-excel-o"></i>&nbsp; Reporte Datos Personales
                            </a>
                            <a class="btn btn-default dropdown-item" href="javascript:;" onclick="preinscriptos_excel({{ preinscripcion.id }})">
                                <i class="fa fa-file-excel-o"></i>&nbsp; Reporte Estudiantes
                            </a>
                            <a class="btn btn-default dropdown-item" href="javascript:;" onclick="asignados_excel({{ preinscripcion.id }})">
                                <i class="fa fa-file-excel-o"></i>&nbsp; Reporte empresa asignada estudiante
                            </a>
                            <a class="btn btn-default dropdown-item" href="javascript:;" id="reporteseguimiento"><i class="fa fa-file-excel-o"></i>&nbsp; Reporte
                                Seguimiento</a>
                        </ul>
                    </div>
                    <div class="btn-group ">
                        <button type="button" class="btn btn-default dropdown-toggle" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <i class="fas fa-tasks" aria-hidden="true"></i> Masivos
                        </button>
                        <ul class="dropdown-menu" style="font-size: 16px">
{#                            {% if idest == 1 and  idcar != 0 and cant_inscritos_busqueda != 0 %}#}
{#                                <a class="btn btn-default dropdown-item" href='{{ request.path }}?action=gestionar_preins_indmasivo&id={{ preinscripcion.id|encrypt }}&idcar={{ idcar }}&idest={{ idest }}'>#}
{#                                    <i class="fa fa-mail-forward"></i>&nbsp; Asignar y Aprobar Masivamente#}
{#                                    ({{ cant_inscritos_busqueda }})#}
{#                                </a>#}
{#                            {% endif %}#}
                            <a href="{{ request.path }}?action=addmasivopreinscripccion&id={{ preinscripcion.id|encrypt }}"
                                class='btn btn-default dropdown-item'><i class="fa fa-user-plus"></i>&nbsp; Adicionar Masivo</a>
                            <a href="{{ request.path }}?action=gestionar_preins_masivo&id={{ preinscripcion.id|encrypt }}"
                                class='btn btn-default dropdown-item'><i class="fa fa-table"></i>&nbsp; Gestionar Masivo</a>
                            <a href="{{ request.path }}?action=masivoactualizaempresa&id={{ preinscripcion.id|encrypt }}"
                                class='btn btn-default dropdown-item'><i class="fas fa-hospital-user"></i>&nbsp; Asignar empresa Masivo</a>
                            <a href="{{ request.path }}?action=gestionar_tipo_masivo&id={{ preinscripcion.id|encrypt }}&tipo=1"
                                class='btn btn-default dropdown-item'><i class="fa fa-users"></i>&nbsp; Asignar supervisor Masivo</a>
                            <a href="{{ request.path }}?action=gestionar_tipo_masivo&id={{ preinscripcion.id|encrypt }}&tipo=2"
                                class='btn btn-default dropdown-item'><i class="fa fa-users"></i>&nbsp; Asignar tutor Masivo</a>
                            <a href="{{ request.path }}?action=gestionar_tipo_masivo&id={{ preinscripcion.id|encrypt }}&tipo=3"
                                class='btn btn-default dropdown-item'><i class="fa fa-users"></i>&nbsp; Asignar responsable centro salud Masivo</a>
                            <a class="btn btn-default dropdown-item" onclick="formEliminar('{{ preinscripcion.pk }}','ELIMINAR PRE INSCRIPCIÓN DE FORMA MASIVA','eliminarmasivopreinscripcion')"
                               href="javascript:void(0);"><i class="fa fa-trash-o"></i>&nbsp; Eliminar Masivo</a>
                        </ul>
                    </div>

                    <div class="btn-group ">
                        <button type="button" class="btn btn-default dropdown-toggle" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <i class="fa fa-cogs" aria-hidden="true"></i> Acciones
                        </button>
                        <ul class="dropdown-menu" style="font-size: 16px">
                            <a href='{{ request.path }}?action=configurarofertasinscripcion&id={{ preinscripcion.id|encrypt }}'
                                class="btn btn-default dropdown-item"><i class="fas fa-hospital-user"></i>&nbsp; Gestionar ofertas</a>
                            <a href="/pro_revisionactividadevidencia?action=validardocumentossalud&id={{ preinscripcion.id|encrypt }}"
                                class='btn btn-default dropdown-item'><i class="fas fa-file-invoice"></i>&nbsp; Validar documentos</a>
                            <a href="{{ request.path }}?action=solicitudaempresas&id={{ preinscripcion.id }}"
                                class='btn btn-default dropdown-item'><i class="fa fa-building "></i>&nbsp; Solicitudes a Empresas</a>
                            <a href="{{ request.path }}?action=asignaciontutor&id={{ preinscripcion.id }}"
                                class='btn btn-default dropdown-item'><i class="fa fa-book"></i>&nbsp; Solicitudes de Asignación Tutor</a>
                        </ul>
                    </div>
                    <a href="{{ request.path }}?action=adddetallepreinscripcion&id={{ preinscripcion.id|encrypt }}"
                       class='btn btn-success'><i class="fa fa-plus "></i> Adicionar</a>
                    <a class="seleccionar_periodo btn btn-primary" title="Visualizar Estudiantes a migrar" data-bs-toggle="tooltip" data-bs-placement="top" text="{{ preinscripcion.motivo }}" href="javascript:;" id="{{ preinscripcion.id|encrypt }}"><i class="fa fa-gears"></i> Pre inscripción masiva</a>
{#                    <a class="masivomigrarest btn btn-primary" title="Visualizar Estudiantes a migrar" data-bs-toggle="tooltip" data-bs-placement="top" text="{{ preinscripcion.motivo }}" href="javascript:;" id="{{ preinscripcion.id|encrypt }}"><i class="fa fa-gears"></i> Pre inscripción masiva</a>#}
                    <a class="grupoorden btn btn-secondary tu" title="Establecer orden de prioridad" data-bs-placement="top" text="{{ preinscripcion.motivo }}" href="javascript:;" id="{{ preinscripcion.id|encrypt }}"><i class="fas fa-sort-numeric-down"></i> Orden</a>

                </div>
            </div>
    </div>

    <div class='row'>
            <div class="col-lg-12 col-md-12 col-12">
                <div class="d-md-flex align-items-center py-2">

                    <input type="hidden" name="action" value="{{ action }}">
                    <input type="hidden" name="id" value="{{ id }}">

                    <div class="col-lg-2 ms-2">
                        <div class="input-group">
                            Carrera:
                            <select class="selector" id="select_carrera" style="width: 100%">
                                <option value="0">TODOS</option>
                                {% for item in carreras %}
                                    <option {% if item.0 == idcar %}selected{% endif %}
                                            value="{{ item.0 }}">{{ item.1 }}</option>
                                {% endfor %}
                            </select>
                            </td>
                        </div>
                    </div>

                    <div class="col-lg-2 ms-2">
                        <div class="input-group">
                            Itinerario:
                            <select class="selector" id="select_itinerario" style="width: 100%">
                                <option value="0">TODOS</option>
                                {% for item in itinerarios %}
                                    <option {% if item.id == iditi %}selected{% endif %}
                                            value="{{ item.id }}">{{ item.nombreitinerario }})</option>
                                {% endfor %}
                            </select>
                            </td>
                        </div>
                    </div>

                    <div class="col-lg-2 ms-2">
                        <div class="input-group">
                            Estados:
                            <select class="selector" id="select_estado" style="width: 100%">
                                <option value="0">TODOS</option>
                                {% for est in estados %}
                                    <option {% if est.0 == idest %}selected{% endif %}
                                            value="{{ est.0 }}">{{ est.1 }}</option>
                                {% endfor %}
                                <option {% if 6 == idest %}selected{% endif %} value="6">SOLICITAN EMPRESA</option>
                                <option {% if 7 == idest %}selected{% endif %} value="7">SOLICITAN ASIGNACIÓN TUTOR</option>
                            </select>
                        </div>
                    </div>

                    <div class="col-lg-2 ms-2">
                        <div class="input-group">
                            Más Filtros:
                            <select class="selector" id="option1" style="width: 100%">
                                <option value="0">TODOS</option>
                                <option value="1" {% if docu == '1' %}checked{% endif %}>CON DOCUMENTOS</option>
                                <option value="2" {% if docu == '2' %}checked{% endif %}>SIN DOCUMENTOS</option>
                            </select>
                        </div>
                    </div>

                    <div class="col-lg-2 ms-2">
                        <div class="input-group">
                            Estudiantes:
                            <input style="width: 100%" class='searchinput' type='text' id='searchinput'
                                   value='{{ search }}' placeholder="Buscar..." autocomplete="off"/>
                        </div>
                    </div>
                    <div class="col-lg-2 ms-2"><br>
                        <div class="input-group-append">
                            <a href="javascript:;" id='search' class='btn btn-primary-old'><span
                                    class="fa fa-search "></span></a>
                            {% if search or ids or idest or idcar or iditi or docu %}
                                <a href="{{ request.path }}?action=listapreinscritos&id={{ preinscripcion.id|encrypt }}"
                                   id='allresults' class='btn btn-default'><span class="fa fa-refresh "></span> </a>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>

    </div>

    <div class="card mb-4">
        <div class="card-body border-top rounded-3">
            <div class="header border-bottom-0 p-0">
                <ul class="nav nav-lb-tab mt-0" id="tab" role="tablist">
                    <li class='nav-item active'>
                        <a class="tabs nav-link py-1" href="#tabla" data-bs-toggle="pill" role="tab" aria-controls="table">
                            <i class="fa fa-list"></i> Listado
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="tabs nav-link py-1" href="#resumen" data-bs-toggle="pill" role="tab" aria-controls="resumen">
                            <i class="fas fa-grip-horizontal"></i> Resumen
                        </a>
                    </li>
                </ul>
            </div>
            <div class="card-body">
                <div class="tab-content">
                    <div class="tab-pane fade show active" id="tabla" role="tabpanel">
                        <table class='table table-striped table-bordered table_primary' cellpadding="0" cellspacing="0">
                            <thead>
                            <tr>
                                <th style="width: 30%;text-align: left;">Estudiante</th>
                                <th style="width: 30%;text-align: center;">Carrera</th>
                                <th style="width: 30%;text-align: center;">Itinerario</th>
{#                                <th style="width: 8%; text-align: center">Solicitud</th>#}
{#                                <th style="width: 10%; text-align: center">Estado Seguimiento</th>#}
                                <th style="width: 10%;text-align: center;">Acciones</th>
                            </tr>
                            </thead>
                            <tbody>
                            {% for p in preinscripciones %}
                                <tr>
                                    <td style="text-align: left">
                                        <a href="javascript:void(0)" class="tr" title="Cod. {{ p.pk }}"
                                           style="color: black"><b>{{ p.inscripcion|default_if_none:'' }}</b></a>
                                        {% if grupoorden and p.inscripcion.ordenprioridadinscripcion_set.first %}
                                            {% with turno=p.inscripcion.ordenprioridadinscripcion_set.first|args:grupoorden|args:p.preinscripcion|call:"obtenerturnoinscripcion" %}
                                                <a href="javascript:void(0)"
                                                    class="btn btn-{% if turno.activo %}info{% else %}secondary{% endif %} btn-mini tu" title="Turno {% if turno.activo %}activo{% else %}inactivo{% endif %}: {{ turno.orden }}{% if turno.etiqueta %} - {{ turno.etiqueta }}{% endif %}"
                                                    onclick="confirmacionAccion('{{ turno.id }}','¿Esta seguro de {% if turno.activo %}DESACTIVAR{% else %}ACTIVAR{% endif %} el Turno?', `Al confirmar, se actualizará a ESTADO {% if turno.activo %}INACTIVO{% else %}ACTIVO{% endif %} el turno del estudiante {{ p.inscripcion|default_if_none:'' }}.`, 'actualizarestadoturno')">
                                                    <i class="fas {% if turno.activo %}fa-check-square{% else %}fa-window-close{% endif %}"></i> {{ turno.orden }}
                                                </a>
                                            {% endwith %}
                                        {% endif %}
                                        {% if p.inscripcion.persona.ppl %}
                                            <a href="javascript:void(0);" class="btn btn-inverse btn-mini tr"
                                               title="Persona Privada de Libertad: {{ p.inscripcion.persona.observacionppl }}">
                                                <i class="fa fa-user-injured"></i> PPL
                                            </a>
                                        {% endif %}
                                        {% if p.inscripcion.persona.tiene_discapasidad %}
                                            <a href="javascript:void(0);" class="btn btn-primary btn-mini tr"
                                               title="Discapacidad {% for dis in  p.inscripcion.persona.tiene_discapasidad %}{{ dis.tipodiscapacidad.nombre }}{% endfor %}">
                                                <i class="fa fa-wheelchair"></i>
                                            </a>
                                        {% endif %}
                                        <br>
                                        <b>C.I: </b>{{ p.inscripcion.persona.cedula }}<br>
                                        <b>Tel: </b>{{ p.inscripcion.persona.telefono }}
                                        {% if p.inscripcion.persona.telefono and p.inscripcion.persona.telefono %}
                                            <a href='https://web.whatsapp.com/send?l=en&phone=+593{{ p.inscripcion.persona.telefono }}&text=Hola {{ p.inscripcion.persona }}'
                                               target="_blank" class="btn btn-mini btn-success tu"
                                               title="Enviar mensaje por whatsapp"><i class="fa fa-whatsapp"></i></a>
                                        {% endif %}
                                        {% if p.inscripcion.persona.misvacunascovid %}
                                            <a href="javascript:void(0);" class="btn btn-warning btn-mini tr"
                                               title="Vacunación Covid 19: {% for dis in p.inscripcion.persona.misvacunascovid %}{{ dis.tipovacuna.nombre }} Dosis Completa:{% if dis.recibiovacuna %}SI{% else %}NO{% endif %}  |  {% endfor %}">
                                                <i class="fa fa-syringe"></i>
                                            </a>
                                        {% endif %}
                                        <br>
                                        <b>Email: </b> <a
                                            href="mailto:{{ p.inscripcion.persona.emailinst }}">{{ p.inscripcion.persona.emailinst }}</a><br>
                                        <b>Dirección: </b><span style="font-size: 10px;">
                                        {% if p.inscripcion.persona.canton %}
                                            {{ p.inscripcion.persona.canton }} -
                                        {% endif %}
                                        {% if p.inscripcion.persona.direccion %}
                                            {{ p.inscripcion.persona.direccion }}
                                        {% endif %}
                                        {% if p.inscripcion.persona.direccion2 %}
                                            {{ p.inscripcion.persona.direccion2 }}
                                        {% endif %}</span><br>
                                        {% if p.recorrido %}
                                            <span class="text{% if p.recorrido.estado == 1 %}-warning{% elif p.recorrido.estado == 2 %}-success {% elif p.recorrido.estado == 4 or p.recorrido.estado == 5 %}-info {% else %}-danger{% endif %}">{{ p.recorrido.get_estado_display }}</span>
                                        {% else %}
                                            <span class="text{% if p.estado == 1 %}-warning{% elif p.estado == 2 %}-success {% else %}-danger{% endif %}">{{ p.get_estado_display }}</span>
                                        {% endif %}
                                        {% if p.estado_estudiantes %}
                                            <span class="text{% if p.estado_estudiantes.estado == 5 %}-info{% elif p.estado_estudiantes.estado == 3 %}-danger{% endif %}">{{ p.estado_estudiantes.get_estado_display }}</span>
                                        {% endif %}
                                        {% if p.recorrido %}
                                            <a class="btn btn-default btn-tini tu observacion" id="{{ p.id }}"
                                               title="Observación"><i class="fa fa-eye"></i></a>
                                        {% endif %}
                                        {% if p.periodoppp %}<br>
                                            <b>Per. Evidencia:</b> {{ p.periodoppp.nombre }}
                                        {% endif %}
                                        {% if p.solicitud_asignacion_tutor %}
                                            <label class="{{ p.solicitud_asignacion_tutor.estado_label|safe }}">ASIGNACIÓN: {{ p.solicitud_asignacion_tutor.get_estado_display }}</label>
                                        {% endif %}
                                    </td>
                                    <td style="text-align: center">
                                        {{ p.inscripcion.carrera.malla }}<br>
                                        <b><i class="fa fa-info-circle"></i> Nivel Malla:</b> <label
                                            class="text-success">{{ p.inscripcion.mi_nivel }}</label><br>
                                        {% if p.inscripcion.coordinacion.id != 1 %}
                                            <strong><i class="fa fa-book"></i> Nivel Prácticas:</strong>
                                            {% if p.nivelmalla %}
                                                <span class="text-info">{{ p.nivelmalla.nombre }}</span>
                                            {% else %}
                                                <span class="text-warning">No Asignado</span>
                                            {% endif %}
                                            <br>
                                        {% endif %}
                                        {% if p.preinscripcion.preguntas %}
                                            <div class="accordion-group">
                                                <div class="accordion-heading" style="background-color:#f0f0f0">
                                                    <a style="color: black" class="accordion-toggle"
                                                       data-bs-toggle="collapse"
                                                       data-parent="#accordion3" href="#collapse3{{ forloop.counter }}">
                                                        <b> <span class="fa fa-chevron-down far"></span> Preguntas <span
                                                                class="text-warning">{{ p.cant_respuestas }}</span></b>
                                                    </a>
                                                </div>
                                                <div id="collapse3{{ forloop.counter }}"
                                                     class="accordion-body collapse tercerafilaacoordion in">
                                                    <div class="accordion-inner" style="text-align: left">
                                                        {% for res in p.mis_respuesta %}
                                                            <b>{{ res.pregunta }}</b><br>
                                                            &nbsp;&nbsp;&nbsp;<i class="fa fa-check"></i>
                                                            {{ res|upper }}
                                                            <br>
                                                        {% endfor %}
                                                    </div>
                                                </div>
                                            </div>
                                        {% endif %}
                                    </td>
                                    <td style="text-align: left;">
                                        {% if p.itinerariomalla %}
                                            <i class="fa fa-book tu" title="Cod Malla: {{ p.itinerariomalla.malla.id }}"></i> {{ p.itinerariomalla.id }} - {{ p.itinerariomalla.nombre }} -
                                            {{ p.itinerariomalla.nivel }} -
                                            <b>({{ p.itinerariomalla.horas_practicas }} HORAS )</b>
                                        {% else %}
                                            <span class="text-warning">No tiene Itinerario</span>
                                        {% endif %}
{#                                        {% if p.empresaempleadora or p.otraempresaempleadora %}<br><b>Empresa: </b>#}
{#                                            {% if p.empresaempleadora %}#}
{#                                                {{ p.empresaempleadora }}{% elif p.otraempresaempleadora %}#}
{#                                                {{ p.otraempresaempleadora }}{% endif %}{% endif %}#}
{#                                        {% if p.departamento %}<br><b>Departamento:</b> {{ p.departamento }}{% endif %}#}
                                        {% if p.get_practicainscripcion %}
                                            {% if p.get_practicainscripcion.asignacionempresapractica %}
                                                <br><b>Empresa Asignada: </b>
                                                {{ p.get_practicainscripcion.asignacionempresapractica }}
                                            {% endif %}
                                            {% if p.get_practicainscripcion.convenio %}
                                                <br><b>Convenio: </b>
                                                {{ p.get_practicainscripcion.convenio.empresaempleadora }}
                                            {% endif %}
{#                                            {% if p.get_practicainscripcion.acuerdo %}<br><b>Acuerdo: </b>#}
{#                                                {{ p.get_practicainscripcion.acuerdo }}{% endif %}#}

                                            {% with pext=p.get_practicainscripcion.practicaspreprofesionalesinscripcionextensionsalud_set.first %}
                                            {% if pext.responsable %}
                                                <br><b>Responsable centro salud:</b> {{ pext.responsable.persona }}
                                            {% endif %}
                                            {% endwith %}
                                        {% endif %}
                                        {% if p.tutorunemi %}<br><b>Tutor Unemi:</b> {{ p.tutorunemi }}{% endif %}
                                        {% if p.supervisor %}<br><b>Supervisor Unemi:</b> {{ p.supervisor }}{% endif %}

                                    </td>
                                    <td style="text-align: center">
                                        <div class="dropbottom">
                                            <button type="button" class="btn btn-default dropdown-toggle" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                                Acciones <i class="fa fa-angle-down"></i>
                                            </button>
                                            <ul class="dropdown-menu pull-right">
                                            {% if p.get_datoempresa %}
                                                <li class="dropdown-item">
                                                    <a href="javascript:void(0);"
                                                       onclick="formModal('{{ p.pk }}', 'SOLICITAR EMPRESA', 'missolicitudesempresa', false)">
                                                        <i class="fa fa-building"></i> Solicitud Empresa
                                                    </a>
                                                </li>
                                                {% endif %}
                                                {#                                    {% if p.estado_estudiantes == 1 or p.accion == 2 %}#}
                                                {% if p.estado == 1 or p.estado == 4 %}
                                                <li class="dropdown-item">
                                                    <a class="bloqueo_pantalla"
                                                       href='{{ request.path }}?action=gestionar_preins_ind&id={{ p.id|encrypt }}'>
                                                        <span class="fa fa-arrow-right"></span> Gestionar
                                                    </a>
                                                </li>
                                                {#                                {% else %}#}
                                                {#                                    {% if p.recorrido.estado == 2 or p.recorrido.estado == 4 %}#}
                                                {#                                    <a class="btn btn-info btn-mini"#}
                                                {#                                       href='{{ request.path }}?action=editgestionar_preins_ind&id={{ p.id|encrypt }}'><span#}
                                                {#                                            class="fa fa-edit"></span></a>#}
                                                {#                                    {% endif %}#}
                                                {% endif %}
                                                {% if not p.puede_eliminar_preinscripcion or PUEDE_ELIMINAR_PPP %}
{#                                                {% if not p.puede_eliminar_preinscripcion or True %}#}
                                                    <li class="dropdown-item">
                                                        <a class="eliminacionmodal" href="javascript:;"
                                                           nhref='{{ request.path }}?action=delpreinscripcion&id={{ p.id }}'>
                                                            <span class="fa fa-trash"></span> Eliminar
                                                        </a>
                                                    </li>
                                                {% endif %}
                                                <li class="dropdown-item">
                                                    <a href='javascript:;' id="{{ p.inscripcion.id }}"
                                                       class="showmodal">
                                                        <i class="fa fa-list"></i> Malla Estudiante
                                                    </a>
                                                </li>
                                            </ul>
                                        </div>
                                    </td>
                                </tr>
                                {% empty %}
                                <tr>
                                    <td colspan="11" style="text-align: center">
                                        NO EXISTEN REGISTROS DE APERTURAS
                                    </td>
                                </tr>
                            {% endfor %}
                            </tbody>
                        </table>
                        <div class="card-footer border-top-0">
                    <div class="row my-3 px-3">
                        <nav class="col-lg-12">
                            <nav>
                                {% if paging.num_pages > 20 %}
                                    <ul class="pagination justify-content-center m-0">
                                        {% if paging.primera_pagina %}
                                            <li class="page-item">
                                                <a class="page-link" href="{{ request.path }}?action=listapreinscritos&id={{ preinscripcion.id|encrypt }}{% if search %}&s={{ search }}{% endif %}{% if iditi %}&iditi={{ iditi }}{% endif %}{% if idest %}&idest={{ idest }}{% endif %}{% if idcar %}&idcar={{ idcar }}{% endif %}&page=1">1</a>
                                            </li>
                                            <li class="page-item">
                                                <a class="page-link" href="{{ request.path }}?action=listapreinscritos&id={{ preinscripcion.id|encrypt }}{% if search %}&s={{ search }}{% endif %}{% if iditi %}&iditi={{ iditi }}{% endif %}{% if idest %}&idest={{ idest }}{% endif %}{% if idcar %}&idcar={{ idcar }}{% endif %}&page={{ paging.ellipsis_izquierda }}"
                                                   class="active">...</a></li>
                                        {% endif %}
                                        {% for pagenumber in paging.paginas %}
                                            <li {% if pagenumber == page.number %}class='active page-item'{% else %}class='page-item'{% endif %}><a
                                                    class="page-link" href="{{ request.path }}?action=listapreinscritos&id={{ preinscripcion.id|encrypt }}{% if search %}&s={{ search }}{% endif %}{% if iditi %}&iditi={{ iditi }}{% endif %}{% if idest %}&idest={{ idest }}{% endif %}{% if idcar %}&idcar={{ idcar }}{% endif %}&page={{ pagenumber }}">{{ pagenumber }}</a>
                                            </li>
                                        {% endfor %}
                                        {% if paging.ultima_pagina %}
                                            <li class="page-item">
                                                <a href="{{ request.path }}?action=listapreinscritos&id={{ preinscripcion.id|encrypt }}{% if search %}&s={{ search }}{% endif %}{% if iditi %}&iditi={{ iditi }}{% endif %}{% if idest %}&idest={{ idest }}{% endif %}{% if idcar %}&idcar={{ idcar }}{% endif %}&page={{ paging.ellipsis_derecha }}"
                                                   class="page-link active">...</a></li>
                                            <li class="page-item">
                                                <a class="page-link" href="{{ request.path }}?action=listapreinscritos&id={{ preinscripcion.id|encrypt }}{% if search %}&s={{ search }}{% endif %}{% if iditi %}&iditi={{ iditi }}{% endif %}{% if idest %}&idest={{ idest }}{% endif %}{% if idcar %}&idcar={{ idcar }}{% endif %}&page={{ paging.num_pages }}">{{ paging.num_pages }}</a>
                                            </li>
                                        {% endif %}
                                    </ul>
                                {% else %}
                                    <ul class="pagination justify-content-center m-0">
                                        {% for pagenumber in paging.page_range %}
                                            <li {% if pagenumber == page.number %}class='active page-item'{% else %}class="page-item"{% endif %}><a
                                                    class="page-link" href="{{ request.path }}?action=listapreinscritos&id={{ preinscripcion.id|encrypt }}{% if search %}&s={{ search }}{% endif %}{% if iditi %}&iditi={{ iditi }}{% endif %}{% if idest %}&idest={{ idest }}{% endif %}{% if idcar %}&idcar={{ idcar }}{% endif %}&page={{ pagenumber }}">{{ pagenumber }}</a>
                                            </li>
                                        {% endfor %}
                                    </ul>
                                {% endif %}
                            </nav>
                    </div>
                </div>
                    </div>
                    <div class="tab-pane fade" id="resumen" role="tabpanel">
                        <div class="row my-3 px-3">
                            <div class="col-lg-6">
                                <table class="table table-striped table-bordered table_primary">
                                <thead>
                                <tr>
                                    <th style="text-align: center"><i class="fa fa-briefcase"></i> Total Vinculados Prácticas: <label class="text-black">{{ totalconpracticas }}</label></th>
                                    <th style="text-align: center"><i class="fa fa-user-plus"></i> Total Preinscritos: <label class="text-black">{{ totalpreinscritos }}</label></th>
                                </tr>
                                <tr>
                                    <th style="text-align: center"><i class="fa fa-calendar"></i> Mes</th>
                                    <th style="text-align: center"><i class="fa fa-users"></i> Total</th>
                                </tr>
                                </thead>
                                <tbody>
                                {% for m in meses_totales %}
                                    <tr>
                                        <td style="text-align: center">
                                            {% if m.month == 1 %}
                                                Enero
                                            {% elif m.month == 2 %}
                                                Febrero
                                            {% elif m.month == 3 %}
                                                Marzo
                                            {% elif m.month == 4 %}
                                                Abril
                                            {% elif m.month == 5 %}
                                                Mayo
                                            {% elif m.month == 6 %}
                                                Junio
                                            {% elif m.month == 7 %}
                                                Julio
                                            {% elif m.month == 8 %}
                                                Agosto
                                            {% elif m.month == 9 %}
                                                Septiembre
                                            {% elif m.month == 10 %}
                                                Octubre
                                            {% elif m.month == 11 %}
                                                Noviembre
                                            {% elif m.month == 12 %}
                                                Diciembre
                                            {% endif %} {{ m.year }}
                                        </td>
                                        <td style="text-align: center">{{ m.count }}</td>
                                    </tr>
                                    {% empty %}
                                    <tr>
                                        <td colspan="2" style="text-align: center">
                                            <i class="fa fa-info-circle"></i> SIN REGISTROS
                                        </td>
                                    </tr>
                                {% endfor %}
                                </tbody>
                            </table>
                            </div>
                            <div class="col-lg-6">
                                <table class="table table-striped table-bordered table_primary">
                                <thead>
                                <tr>
                                    <th style="text-align: center"><i class="fa fa-tag"></i> Estado</th>
                                    <th style="text-align: center"><i class="fa fa-users"></i> Total</th>
                                </tr>
                                </thead>
                                <tbody>
                                <tr>
                                    <td style="text-align: center"><i class="fa fa-circle" style="color: #F4D03F; font-size: 18px"></i> Solicitados</td>
                                    <td style="text-align: center">{{ ins_solicitados }}</td>
                                </tr>
                                <tr>
                                    <td style="text-align: center"><i class="fa fa-circle" style="color: #2ECC71; font-size: 18px"></i> Asignados</td>
                                    <td style="text-align: center">{{ ins_asignados }}</td>
                                </tr>
                                <tr>
                                    <td style="text-align: center"><i class="fa fa-circle" style="color: #E74C3C; font-size: 18px"></i> Rechazados</td>
                                    <td style="text-align: center">{{ ins_rechazados }}</td>
                                </tr>
                                <tr>
                                    <td style="text-align: center"><i class="fa fa-circle" style="color: #5DADE2; font-size: 18px"></i> Pendientes</td>
                                    <td style="text-align: center">{{ ins_pendiente }}</td>
                                </tr>
                                <tr>
                                    <td style="text-align: center"><i class="fa fa-circle" style="color: #DCDCDC; font-size: 18px"></i> Aceptados</td>
                                    <td style="text-align: center">{{ ins_aceptados }}</td>
                                </tr>
                                </tbody>
                            </table>
                            </div>
                            <div class="col-lg-12">
                                <table class="table table-bordered table-striped table_primary">
                                    <thead>
                                    <tr>
                                        <th style="text-align: center"><i class="fa fa-book"></i> Carrera</th>
                                        {% for m in meses_totales %}
                                            <th style="text-align: center">
                                                <i class="fa fa-calendar"></i> {% if m.month == 1 %}
                                                Enero
                                            {% elif m.month == 2 %}
                                                Feb.
                                            {% elif m.month == 3 %}
                                                Mar.
                                            {% elif m.month == 4 %}
                                                Abr.
                                            {% elif m.month == 5 %}
                                                May.
                                            {% elif m.month == 6 %}
                                                Jun.
                                            {% elif m.month == 7 %}
                                                Jul.
                                            {% elif m.month == 8 %}
                                                Ago.
                                            {% elif m.month == 9 %}
                                                Sept.
                                            {% elif m.month == 10 %}
                                                Oct.
                                            {% elif m.month == 11 %}
                                                Nov.
                                            {% elif m.month == 12 %}
                                                Dic.
                                            {% endif %} {{ m.year }}
                                            </th>
                                        {% endfor %}
                                        <th style="text-align: center"><i class="fa fa-users"></i> Total Preinscritos</th>
                                        <th style="text-align: center"><i class="fa fa-briefcase"></i> Total Vinculados</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    {% for car in porcarreras %}
                                        <tr>
                                            <td style="text-align: center">{{ car.inscripcion__carrera__nombre }}</td>
                                            {% for m in meses_totales %}
                                                <td style="text-align: center">
                                                    0
                                                </td>
                                            {% endfor %}
                                            <td style="text-align: center">{{ car.total }}</td>
                                            <td style="text-align: center">0</td>
                                        </tr>
                                        {% empty %}
                                        <tr>
                                            <td colspan="10" style="text-align: center">
                                                <i class="fa fa-info-circle"></i> SIN REGISTROS
                                            </td>
                                        </tr>
                                    {% endfor %}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            </div>
        </div>
    </div>


    <div class="modal fade static" id="itemspanel" style="display: none;">
        <div class="modal-dialog modal-dialog-centered modal-xl" role="document">
            <div class="modal-content">
                <input type="hidden" id="action" value="">
                <input type="hidden" id="idm" value="">
                <div class="modal-header">
                    <h3 class="paneltitle"></h3>
                </div>
                <div class="modal-body panelbody">
                    <p style="margin-top: 10px;">Esta seguro(a) que desea <span id="item_modal"></span>: <b
                            id="respuesta_estado"></b></p>
                </div>
                <div class="modal-footer">
                    <p style="text-align: right; margin-bottom: 0">
                        <a href="javascript:;" id="ejecutar" class='btn btn-danger btn-form'><i class="fa fa-refresh"></i>
                            Ejecutar</a>
                        <a href="javascript:;" id="cerrar" class="btn btn-info"><i class="fa fa-close"></i> Cerrar</a>
                    </p>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade static" id="itemspaneleliminarrespuesta" style="display: none;">
        <div class="modal-dialog modal-dialog-centered modal-xl" role="document">
            <div class="modal-content">
                <input type="hidden" id="idm" value="">
                <div class="modal-header">
                    <h3 class="paneltitle">Eliminar respesta</h3>
                </div>
                <div class="modal-body panelbody">
                    <p style="margin-top: 10px;">Esta seguro(a) que desea eliminar la respuesta: <b id="respuesta_estado"></b>
                    </p>
                </div>
                <div class="modal-footer">
                    <p style="text-align: right; margin-bottom: 0">
                        <a href="javascript:;" id="eliminar" class='btn btn-danger'><i class="fa fa-tasks"></i> Eliminar</a>
                        <a href="javascript:;" id="cerrar" class="btn btn-info"><i class="fa fa-close"></i> Cerrar</a>
                    </p>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade static" id="itemspanelobservacion" style="display: none;">
        <div class="modal-dialog modal-dialog-centered modal-xl" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="paneltitle">Observación</h3>
                </div>
                <div class="modal-body panelbodyobs">
                </div>
                <div class="modal-footer">
                    <p style="text-align: right; margin-bottom: 0">
                        <a href="javascript:;" id="cerrar" class="btn btn-info"><i class="fa fa-close"></i> Cerrar</a>
                    </p>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade static" id="modalasignacionaprobacionmasiva" style="display: none;">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 id="paneltitle">Asignar y aprobar</h4>
                </div>
                <div class="modal-body aprobacionmasivabody">

                </div>
                <div class="modal-footer">
                    <p style="text-align: right; margin-bottom: 0">
                        <a href="javascript:;" id="boton_aceptacionaprobada" class='btn btn-success'> Asignar y Aprobar</a>
                        <a href="javascript:;" id="cancel_cancelaaprobacion" class='btn btn-danger'> Cancelar</a>
                    </p>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade static" id="modal_reporteseguimiento" style="display: none;">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="paneltitle">Reporte Seguimiento LLamadas Telefónicas</h3>
                </div>
                <div class="modal-body panelbody">
                    <div class="row-fluid">
                        <div class="span12">
                            <div class="form-group" id="fechas_group">
                                <br>
                                <div class="input-group input-daterange px-2">
                                    <input type="text" name="fechas" id="fechas" class="form-control" value=""
                                           autocomplete="off"
                                           placeholder="BUSCAR POR RANGO DE FECHAS">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <table class="pull-right">
                        <tr>
                            <td><a class="btn btn-success" id="download_report"><i class="fa fa-download"></i> Descargar Reporte</a>
                            </td>
                            <td><a class="btn btn-danger" data-bs-dismiss="modal"><i class="fa fa-close"></i> Cerrar</a></td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade static" id="itemsobservacionllamadas" style="display: none;">
        <div class="modal-dialog modal-dialog-centered modal-xl" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h4><i class="fa fa-list"></i> <b class="panelobservacionllamadastitle">FORMULARIO MODAL</b></h4>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close">
                    </button>
                </div>
                <div class="modal-body">
                    <form autocomplete="off" method="post"
                          enctype="multipart/form-data" action="{{ request.path }}">
                        {% csrf_token %}
                        <div class="anilladobodylistado">
                        </div>
                    </form>
                </div>
                <div class="modal-footer" id="footermodalobservacionllamadaslistado">
                    <a href="javascript:;" class="btn btn-default" data-bs-dismiss="modal"><i
                            class="fa fa-window-close"></i>
                        Cerrar</a>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade static" id="itemspanelmigrarmasivopc" style="display: none;">
        <div class="modal-dialog modal-dialog-scrollable modal-dialog-centered modal-xl">
            <div class="modal-content px-2">
                <div class="modal-header border-0">
                    <div class="headtitle mt-3 ms-0"><h4 class="ps-1 py-0 paneltitle"></h4></div>
                    <button type="button" class="btn btn-close btn-cian-secondary rounded-circle p-3 my-0" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="formulariomodal" class="form-horizontal form-modal" autocomplete="off" method="post" enctype="multipart/form-data" action="{{ request.path }}">
                        {% csrf_token %}
                        <div class="row panelbodyevidencia"></div>
                    </form>
                </div>
                <div class="modal-footer border-0 pe-2">
                    <a href="javascript:;" class="btn btn-migrarmasivoest btn-success py-2 me-1"><i class="fa fa-gears"></i> Migrar</a>
                    <a href="javascript:;" class="btn btn-danger py-2" data-bs-dismiss="modal"><i class="fa fa-times"></i> Cerrar</a>
                </div>
            </div>
        </div>
    </div>

{% endblock %}
