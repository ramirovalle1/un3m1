{% extends "base.html" %}
{% load sga_extras %}
{% block heading %}
    <script src="/static/js/highcharts.js"></script>
    <script src="/static/js/exporting.js"></script>
    <script src="/static/js/data.js"></script>
    <script src="/static/adicionalesjs/formquestionb4.js?0.24"></script>
{#    <script src="/static/adicionalesjs/formquestion.js?0.24"></script>#}
    {#    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>#}
{#    <script src="/static/js/jquery.table2excel.js"></script>#}
    <script type="text/javascript">
    var idactivo = 0;
    var idresponsable = 0;
    var idselectactivo = '';
    var idselectresponsable = '';
    var idestadoubicacion = 0;
    var idestadofuncionamiento = 0;
    var estadogeneralseleccionado = [];
        $(function () {

            tooltips();
            $(document).ready(function () {

            });

            $(".descargarexcel").click(function () {
            });


            {#$("#id_estadogeneral").change(function() {#}
            {#    for (var option of document.getElementById('id_estadogeneral').options) {#}
            {#        if (option != estadogeneralseleccionado) {#}
            {#            estadogeneralseleccionado.push(option.value);#}
            {#            alert(JSON.stringify(estadogeneralseleccionado))#}
            {#        }#}
            {#    }#}

            let $select = $('#id_estadogeneral');
            $select.on('change', () => {
              let selecteds = [];
              // Buscamos los option seleccionados
              $select.children(':selected').each((idx, el) => {
                // Obtenemos los atributos que necesitamos
                selecteds.push(parseInt(el.value));
                console.log(selecteds)
              });
              estadogeneralseleccionado = selecteds
              console.log(estadogeneralseleccionado)
            });

            $("select").select2({width: '100%'});

            $(".detalleactivo").click(function () {
                var id = $(this).attr("cid");
                bloqueointerface();
                $.ajax({
                    type: "POST",
                    url: "/inventario_activofijo",
                    data: {'action': 'detalle_activo', 'id': id},
                    success: function (data) {
                        $.unblockUI();
                        if (data.result == 'ok') {
                            $("#detalleactivomodal_body").html(data.html);
                            $("#detalleactivomodal").modal({"backdrop": "static", "width": "1000px"}).modal("show");
                        } else {
                            smoke.alert(data.mensaje);
                        }
                    },
                    error: function () {
                        $.unblockUI();
                        smoke.alert("Error de conexión.");
                    },
                    dataType: "json"
                });
                return false;
            });
            $("#detalleactivomodal_aceptar").click(function () {
                $("#detalleactivomodal").modal("hide");
            });
            $(".detallemantenimiento").click(function () {
                var id = $(this).attr("idact");
                bloqueointerface();
                $.ajax({
                    type: "POST",
                    url: "/inventario_activofijo",
                    data: {'action': 'detalle_mantenimiento', 'id': id},
                    success: function (data) {
                        $.unblockUI();
                        if (data.result == 'ok') {
                            $("#detalleactivomantenimientomodal_body").html(data.html);
                            $("#detalleactivomantenimientomodal").modal({
                                "backdrop": "static",
                                "width": "1000px"
                            }).modal("show");
                        } else {
                            smoke.alert(data.mensaje);
                        }
                    },
                    error: function () {
                        $.unblockUI();
                        smoke.alert("Error de conexión.");
                    },
                    dataType: "json"
                });
                return false;
            });
            $("#detalleactivomantenimientomodal_aceptar").click(function () {
                $("#detalleactivomantenimientomodal").modal("hide");
            });
            $("#detalledificiomodal_aceptar").click(function () {
                $("#detalledificiomodal").modal("hide");
            });

            busqueda = function () {
                var codigo = $("#grupo_list").val();
                bloqueointerface();
                location.href = "/inventario_activofijo?action=inventario&codigo=" + codigo;
            };

            $("#grupo_list").change(function () {
                busqueda();
            });

            $(".filterable tr:has(td)").each(function () {
                var t = $(this).text().toLowerCase();
                $("<td class='indexColumn'></td>").hide().text(t).appendTo(this);
            });

            $("#FilterTextBox").keyup(function () {
                var s = $(this).val().toLowerCase().split(" ");
                $(".filterable tr:hidden").show();
                $.each(s, function () {
                    $(".filterable tr:visible .indexColumn:not(:contains('" + this + "'))").parent().hide();
                });
                $(".filterable3 tr:hidden").show();
            });

            $(".filterable2 tr:has(td)").each(function () {
                var t = $(this).text().toLowerCase();
                $("<td class='indexColumn2'></td>").hide().text(t).appendTo(this);
            });

            $("#FilterTextBox2").keyup(function () {
                var s = $(this).val().toLowerCase().split(" ");
                $(".filterable2 tr:hidden").show();
                $.each(s, function () {
                    $(".filterable2 tr:visible .indexColumn2:not(:contains('" + this + "'))").parent().hide();
                });
            });

            $("#id_grupoactivos").change(function () {
                idactivo = $("#id_grupoactivos").val();
            });

            $("#id_gruporesponsables").change(function () {
                idresponsable = $("#id_gruporesponsables").val();
            });

            $("#id_responsable").change(function () {
                idresponsable = $("#id_responsable").val();
            });

            $("#id_grupoactivo").change(function () {
                idactivo = $("#id_grupoactivo").val();
            });

            $("#id_estadoubicacion").change(function () {
                idestadoubicacion = $("#id_estadoubicacion").val();
            });

            $("#id_estadofuncionamiento").change(function () {
                idestadofuncionamiento = $("#id_estadofuncionamiento").val();
            });

        });

            function formModal(id, text, action, width, height, activo, responsable) {
                bloqueointerface();
                $.ajax({
                    type: "GET",
                    url: "/inventario_activofijo",
                    data: {
                        'action': action,
                        'id': id,
                        'activo':activo,
                        'responsable':responsable
                    },
                    success: function (data) {
                        $.unblockUI();
                        if (data.result === true) {
                            $('.panelbody').html(data.data);
                            $('#itemspanel .paneltitle').html(text);
                            $("#itemspanel").modal({backdrop: 'static', width: width, height: height}).modal('show');
                        } else {
                            smoke.alert(data.mensaje);
                        }
                    },
                    error: function () {
                        $.unblockUI();
                        smoke.alert("Error de conexión.");
                    },
                    dataType: "json"
                });
            }

            cargar_opciones = function (nombreselect, accion) {
            {#$(nombreselect).empty().append('<option value="0" disabled>--Seleccione--</option>').val(0).trigger("change");#}
            var control = $(nombreselect);
            if (control) {
                bloqueointerface();
                $.ajax({
                    type: "GET",
                    url: "/inventario_activofijo",
                    data: {'action': accion},
                    success: function (data) {
                        {#$(nombreselect).empty().append('<option value="0" disabled>--Seleccione--</option>').val(0).trigger("change");#}
                        if (data.result == 'ok') {
                            for (elemento in data.lista) {
                                console.log(data.lista[elemento][0]);
                                $(nombreselect).append('<option value="' + data.lista[elemento][0] + '">' + data.lista[elemento][1] + '</option>');
                            }
                        } else {
                            control.val(0).trigger("change");
                            smoke.alert(data.mensaje);
                        }
                        $.unblockUI();
                    },
                    error: function () {
                        $.unblockUI();
                        control.val(0).trigger("change");
                        smoke.alert("Error de conexion.");
                    },
                    dataType: "json"
                });
            }
        };

    </script>
    <style>
        .factIva {
            font-family: Geneva, Arial, Helvetica, sans-serif;
            font-size: 12px;
            background-color: #FFFFFF;
            border: 1px solid #999999;
            border-bottom: 1px solid #CCCCCC;
        }

        .caja {
            font-family: Arial, Helvetica, sans-serif;
            font-size: 8pt;
            text-decoration: none;
            color: #000000;
            font-weight: normal;
            border-top: 1px solid #CCCCCC;
            border-right: 1px solid #CCCCCC;
            border-bottom: 0px solid #CCCCCC;
            border-left: 0px solid #CCCCCC;
            text-align: left;
        }

    </style>
    <script>

        function cerrarmodalreporteinventariotics(){
            $("#itemspanel_reporteinventariotics").modal("hide");
            return false;
        }

        function reporteinforme(tpreporte) {
            $('#id_action').val(tpreporte)
            valuelist_ = $('#grupo_list').val();
            $('#id_lista').val(valuelist_)
            $('#id_action').val(tpreporte)
            $("#repinforme").modal({backdrop: 'static', width: '600px'}).modal('show');
        }

        function repall() {
            var cadena = $("#grupo_list").val()
            var url = "/inventario_activofijo?action=excellistadoactivos&cadenatexto=" + cadena;
            $(location).attr('href', url);
        }

        function repallpdfactivotodos() {
            var cadena = $("#grupo_list").val()
            var url = "/inventario_activofijo?action=pdflistadoactivostodos&cadenatexto=" + cadena;
            $(location).attr('href', url);
        }

        function repallpdfbajatodos() {
            var cadena = $("#grupo_list").val()
            var url = "/inventario_activofijo?action=pdflistadoactivosinactiostodos&cadenatexto=" + cadena;
            $(location).attr('href', url);
        }

        function notificacion(id){
            openwindow('POST', '/inventario_activofijo', {
                action: 'reporte_certificadoprevio',
                'id': id
            }, '_blank');
        }

         function busquedaActivo(){
            var term = $("#FilterTextBox").val().trim().toUpperCase();
            {#var codigo = $("#grupo_list").val();#}
            if (term.length > 0) {
                bloqueointerface();
                location.href = "/inventario_activofijo?action=inventariotics&idperiodoinv={{ idperiodoinv }}&s=" + term;
            } else {
                bloqueointerface();
                location.href = "/inventario_activofijo?action=inventariotics&idperiodoinv={{ idperiodoinv }}";
            }
            return false;
        }
        function cerrarmodalreporte(){
            $("#itemspanel_reporteactivo").modal("hide");
            return false;
        }

        function cerrarmodal(){
            $("#itemspanel_reporteresponsableactivo").modal("hide");
            return false;
        }

        function cerrarmodalResponsable(){
            $("#itemspanel_reporteresponsable").modal("hide");
            return false;
        }

        cargar_activos = function () {
            $(idselectactivo).empty().append('<option value="0">--Seleccione--</option>').val(0).trigger("change");
            var control = $(idselectactivo);
            if (control) {
                bloqueointerface();
                $.ajax({
                    type: "POST",
                    url: "/inventario_activofijo",
                    data: {'action': 'cargarcombo_activo'},
                    success: function (data) {
                        $(idselectactivo).empty().append('<option value="">--Seleccione--</option>').val(0).trigger("change");
                        if (data.result == 'ok') {
                            for (elemento in data.lista) {
                                console.log(data.lista[elemento][0]);
                                $(idselectactivo).append('<option value="' + data.lista[elemento][0] + '">' + data.lista[elemento][1] + ' - Cod.Inv. ' + data.lista[elemento][2] + ' - Cod.Gob.  ' + data.lista[elemento][3] + ' - Cod.Tics. ' + data.lista[elemento][4] + '</option>');
                            }
                        } else {
                            control.val(0).trigger("change");
                            smoke.alert(data.mensaje);
                        }
                        $.unblockUI();
                    },
                    error: function () {
                        $.unblockUI();
                        control.val(0).trigger("change");
                        smoke.alert("Error de conexion.");
                    },
                    dataType: "json"
                });
            }
        };

        cargar_responsable = function () {
            $(idselectresponsable).empty().append('<option value="0">--Seleccione--</option>').val(0).trigger("change");
            var control = $(idselectresponsable);
            if (control) {
                bloqueointerface();
                $.ajax({
                    type: "POST",
                    url: "/inventario_activofijo",
                    data: {'action': 'cargarcombo_responsable'},
                    success: function (data) {
                        $(idselectresponsable).empty().append('<option value="">--Seleccione--</option>').val(0).trigger("change");
                        if (data.result == 'ok') {
                            for (elemento in data.lista) {
                                console.log(data.lista[elemento][0]);
                                $(idselectresponsable).append('<option value="' + data.lista[elemento][0] + '">' + data.lista[elemento][1] + ' ' + data.lista[elemento][2] + ' ' +  data.lista[elemento][3] + ' - Identificación ' + data.lista[elemento][4] + '</option>');
                            }
                        } else {
                            control.val(0).trigger("change");
                            smoke.alert(data.mensaje);
                        }
                        $.unblockUI();
                    },
                    error: function () {
                        $.unblockUI();
                        control.val(0).trigger("change");
                        smoke.alert("Error de conexion.");
                    },
                    dataType: "json"
                });
            }
        };

        function activoinventario() {
            idselectactivo = '#id_grupoactivos'
            idactivo = 0
            cargar_activos();
            $("#itemspanel_reporteactivo").modal({backdrop: 'static', width: '450px'}).modal('show');
        }

        function reporteresponsableactivo(){
            idselectactivo = '#id_grupoactivo'
            idselectresponsable = '#id_gruporesponsables'
            idactivo = 0
            idresponsable   = 0
            cargar_activos();
            cargar_responsable();
            $("#itemspanel_reporteresponsableactivo").modal({backdrop: 'static', width: '450px'}).modal('show');
        }

        function reporteresponsableinventario(){
            idresponsable = 0
            idselectresponsable = '#id_responsable'
            cargar_responsable();
            $("#itemspanel_reporteresponsable").modal({backdrop: 'static', width: '450px'}).modal('show');
        }

        function reporteactivoinventario(){
            if (idactivo == 0){
                Swal.fire({
                            title: 'Advertencia!',
                            text: 'Por favor, seleccione un activo',
                            type: 'warning',
                            showCancelButton: false,
                            allowOutsideClick: false,
                            confirmButtonColor: '#3085d6',
                            cancelButtonColor: '#d33',
                            showConfirmButton: false,
                            timer : 3000,
                })
            }else{
                openwindow('POST', '/inventario_activofijo', {action: 'reporteactivoinventario', 'activotecnologico': idactivo}, '_blank');
            }
        }

        function reporteresponsableactivoinventario(){
            if ((idactivo == 0) || (idresponsable == 0)){
                Swal.fire({
                            title: 'Advertencia!',
                            text: 'Por favor, llene todos los campos',
                            type: 'warning',
                            showCancelButton: false,
                            allowOutsideClick: false,
                            confirmButtonColor: '#3085d6',
                            cancelButtonColor: '#d33',
                            showConfirmButton: false,
                            timer : 3000,
                })
            }else{
                openwindow('POST', '/inventario_activofijo', {action: 'reporteresponsableactivoinventario', 'activotecnologico': idactivo, 'responsable':idresponsable}, '_blank');
            }
        }

        function reporteresponsable(){
            if (idresponsable == 0){
                Swal.fire({
                            title: 'Advertencia!',
                            text: 'Por favor, seleccione un responsable',
                            type: 'warning',
                            showCancelButton: false,
                            allowOutsideClick: false,
                            confirmButtonColor: '#3085d6',
                            cancelButtonColor: '#d33',
                            showConfirmButton: false,
                            timer : 3500,
                })
            }else{
                openwindow('POST', '/inventario_activofijo', {action: 'reporteresponsableactivoinventario', 'responsable':idresponsable}, '_blank');
            }
        }

        function generarreporteinventariotics(){
            if ((idestadoubicacion == 0) || (idestadofuncionamiento == 0)){
                Swal.fire({
                            title: 'Advertencia!',
                            text: 'Por favor, seleccione estado de ubicación o funcionamiento',
                            type: 'warning',
                            showCancelButton: false,
                            allowOutsideClick: false,
                            confirmButtonColor: '#3085d6',
                            cancelButtonColor: '#d33',
                            showConfirmButton: false,
                            timer : 3000,
                })
            }else{
                {#openwindow('GET', '/inventario_activofijo', {action: 'reportegeneralinventario', 'idubicacion':idestadoubicacion, 'idfuncionamiento':idestadofuncionamiento, 'idestadogeneral':JSON.stringify(estadogeneralseleccionado), 'idperiodoinv':{{idperiodoinv }} }, '_blank');#}
                openwindow('GET', '/inventario_activofijo', {action: 'reportegeneralinventario', 'idubicacion':idestadoubicacion, 'idfuncionamiento':idestadofuncionamiento, 'idperiodoinv':{{idperiodoinv }} }, '_blank');
            }
        }

        function reporteinventariotics(){
            var nombreselect = '#id_estadogeneral'
            var accion = 'cargarcombo_estadogeneral'
            {#cargar_opciones(nombreselect, accion);#}
            $("#itemspanel_reporteinventariotics").modal({backdrop: 'static', width: '450px', height: '140px'}).modal('show');
            $("#id_estadoubicacio").select2({'width':'100%'})
            $("#id_estadofuncionamiento").select2({'width':'100%'})
            {#$("#id_estadogeneral").select2({'width':'100%'})#}
        }
    </script>
{% endblock %}
{% block atras %}/inventario_activofijo?action=periodoinventario{% endblock %}
{% block canvas %}

    <div class='row'>
        <div class='col-lg-12'>
            <div class="headtitle">
                <h3 class="texto-blue">{{ title }}</h3>
                {% if periodoinventario %}
                    <h6>Periodo: {{ periodoinventario }}</h6>
                {% endif %}
            </div>
        </div>
    </div>
{#    <div class='row-fluid'>#}
{#        <div class='span12'>#}
{#            <h4>{{ title }}</h4>#}
{#            {% if periodoinventario %}#}
{#                <h4>Periodo: {{ periodoinventario }}</h4>#}
{#            {% endif %}#}
{#        </div>#}
{#    </div>#}

    <div class="mt-1 mb-1">

        {% if periodoinventarioat.0.estado == 1 %}
        <a onclick="formModal('0','INVENTARIO','adicionarinventario', '700', '650',0,0)"
                                           href="javascript:void(0)"; class='btn btn-success'><span
                    class="fa fa-plus"></span> Adicionar</a>
        <a href="/inventario_activofijo?action=verestadosgenerales&idperiodoinv={{ idperiodoinv }}" class='btn btn-primary'><span
                    class="fa fa-list"></span> Estados generales</a>
        {% endif %}
        <a href="/inventario_activofijo?action=asignacioncierreinventario&idperiodoinv={{ periodoinventarioat.0.id }}" class='btn btn-warning'><span
                    class="fa fa-gear"></span> Cierre de inventario</a>
        <div class="btn-group">
            <a class="btn dropdown-toggle" data-toggle="dropdown" href="javascript:;">Reportes de Inventario <span
                    class="fa fa-caret-down"></span></a>
            <ul class="dropdown-menu" style="width: 270px;">
    {#            <li><a href="/inventario_activofijo?action=reportegeneralinventario&idperiodoinv={{ idperiodoinv }}" target="_blank"#}
    {#                   class="tu reporte"><i class="fa fa-file-excel-o"></i> Reporte en general</a></li>#}
                <li class="dropdown-item"><a onclick="reporteinventariotics()"
                       class="tu reporte" style="cursor: pointer"><i class="fa fa-file-excel-o"></i> Reporte general</a></li>
                <li class="dropdown-item"><a onclick="reporteresponsableinventario()"
                       href="javascript:void(0)"
                       class="tu reporte"><i class="fa fa-file-pdf-o"></i> Reporte por Responsable</a></li>
                <li class="dropdown-item"><a onclick="activoinventario()"
                       href="javascript:void(0)"
                       class="tu reporte"><i class="fa fa-file-pdf-o"></i> Reporte por Activo Fijo</a></li>
                <li class="dropdown-item"><a onclick="reporteresponsableactivo()"
                       href="javascript:void(0)"
                       class="tu reporte"><i class="fa fa-file-pdf-o"></i> Reporte por responsable y activo fijo</a></li>
            </ul>
        </div>
    </div>



    <div class="modal fade static" id="repinforme" style="display: none;">
        <div class="modal-header">
            <h4 class="paneltitle"><i class="fa fa-file-pdf-o"></i> Generación de Informes</h4>
        </div>
        <form method="GET" action="{{ request.path }}" target="_blank">
            <input type="hidden" name="action" value="" id="id_action">
            <input type="hidden" name="cadenatexto" value="" id="id_lista">
            <div class="modal-body">
                <div class="row-fluid">
                    <div class="span6">
                        <label for=""><b>Fecha Ingreso Desde:</b> <span class="text-error">*</span></label>
                        <input type="date" required name="fechadesde" id="id_fechadesde" width="100%"
                               class="form-control"
                               style="width: 100%">
                    </div>
                    <div class="span6">
                        <label for=""><b>Fecha Ingreso Hasta:</b> <span class="text-error">*</span></label>
                        <input type="date" required name="fechahasta" id="id_fechahasta" width="100%"
                               class="form-control"
                               style="width: 100%">
                    </div>
                </div>
            </div>
            <div class="modal-footer" style="text-align: right">
                <button type="submit" class='btn btn-success'>
                    <span class="fa fa-download"></span> Generar
                </button>
                <a href="javascript:;" class="btn btn-default" data-dismiss="modal"><i class="fa fa-window-close"></i>
                    Cerrar</a>
            </div>
        </form>
    </div>
{#    <div class="" style="display: inline-block;text-align: left;border: 1px solid #e3e3e3;border-radius: 5px;width: 100%">#}

    <div class='row-fluid'>
    <div class='span7' style="margin-left: 0px;margin-bottom: 5px">
        <table class="" style="background:rgba(0, 0, 0, 0);border-color: transparent">
            <tr>
                <td style="width: 15%">
                    <form class="form-search" onsubmit="busquedaActivo()">
                        <input type="search" style="text-transform: uppercase; margin-bottom: 0px;" class=""
                               id="FilterTextBox" name="FilterTextBox" value='{{ search }}'>
                    </form>
                </td>

                <td style="width: 16%; vertical-align: middle">
                    <a class="btn btn-info  tu" title="Buscar" id="busqueda" href='javascript:;'
                       onclick="busquedaActivo()"> <i class='fa fa-search'></i> </a>
                </td>
            </tr>
        </table>
    <label class="label label-info"><i class="fa fa-info-circle"></i> Constatación física {{ constatacion }}</label>
    </div>

            {#    </div>#}

    </div>

    <div class="card mb-4">
        <div class="card-body border-top border-6 rounded-3 border-dark-info">
            <div class="table-responsive-xxl">
                <table class="table table-bordered table-striped" id="">
                    <thead>
                        <tr class="text-center">
                            <th style="text-align: center; width: 3px" class="caja">Código tics</th>
                            <th style="text-align: center; width: 6px" class="caja">Código gobierno</th>
                            <th style="text-align: center; width: 120px" class="caja">Descripción</th>
                            <th style="text-align: center; width: 50px" class="caja">Responsable actual</th>
                            <th style="text-align: center; width: 50px" class="caja">Fecha de inventario</th>

                            <th style="text-align: center; width: 80px" class="caja">Estado ubicación</th>
                            <th style="text-align: center; width: 30px" class="caja">Estado funcionamiento</th>
                            <th style="text-align: center; width: 80px" class="caja">Estados generales</th>
                            {#                <th style="text-align: center; width: 80px" class="caja">Movimiento</th>#}
                            <th style="text-align: center; width: 80px" class="caja">Observación</th>
                            <th style="text-align: center; width: 60px" class="caja">Estado</th>
    {#                        <th style="text-align: center; width: 80px" class="caja"></th>#}
                            {#                <th style="text-align: center; width: 50px" class="caja"></th>#}
                        </tr>
                    </thead>
                    <tbody>
                        {% for listado in listadocatalogo %}
                            <tr >
                                <td  class="caja text-center">
                                    {{ listado.obtenercodigotic|default_if_none:'' }}
                                </td>
                                <td class="caja text-center">
                                    {{ listado.activotecnologico.codigogobierno }}
                                </td>
                                <td class="caja text-center">
                                    <div class="seleccionados"
                                         idsele="{{ listado.activotecnologico.id }}">{{ listado.activotecnologico.codigointerno }}
                                        - {{ listado.activotecnologico.descripcion }}</div>
                                    <label class="label label-info tu">
                                        {{ listado.activotecnologico.fechaingreso|date:"Y-m-d" }}
                                    </label>
                                </td>
                                <td class="caja text-center">
                                    {{ listado.activotecnologico.responsable }}
                                </td>
                                <td class="caja text-center">
                                    {{ listado.fechainventario|date:"SHORT_DATE_FORMAT" }}
                                    {{ listado.fechainventario|time:"h:i a" }}
                                </td>

                                <td class="caja text-center">
                                    {{ listado.get_estadoubicacion_display }}
                                </td>
                                <td class="caja text-center">
                                    {{ listado.get_estadofuncionamiento_display }}
                                </td>
                                <td class="caja text-center">

                                    <div class="accordion" id="accordionExample{{ listado.id }}">
                                        <div class="accordion-item acordeon">
                                            <h2 class="accordion-header" id="headingOne">
                                                <button class="accordion-button estadosactivo" idestado="{{ listado.id }}" type="button" data-bs-toggle="collapse"
                                                        data-bs-target="#collapseOne{{ listado.id }}" aria-expanded="true"
                                                        aria-controls="collapseOne">
                                                    ESTADOS ({{ listado.estadosasignados.count }})
                                                </button>
                                            </h2>
                                            <div id="collapseOne{{ listado.id }}" class="accordion-collapse collapse"
                                                     aria-labelledby="headingOne" data-bs-parent="#accordionExample{{ listado.id }}" style="text-align: left;">
                                                {% for asig in listado.estadosasignados %}

                                                        <div class="accordion-body" style="margin-bottom:-10px">
                                                            <strong>{{ forloop.counter }}) {{ asig.estadogeneral.descripcion }}</strong>
                                                        </div>

                                                {% endfor %}
                                            </div>
                                        </div>
                                     </div>
                                </td>
                                <td class="caja text-center">
                                    {{ listado.activo.estado }}
                                </td>
                                <td class="caja text-center">
                                    <div class="dropbottom">
                                        <a class="btn btn-mini dropdown-toggle" data-toggle="dropdown"
                                           href="javascript:;">Acciones<span
                                                class="fa fa-caret-down"></span></a>
                                        <ul class="dropdown-menu">
                                                <li class="dropdown-item"><a onclick="formModal('0','INVENTARIO','editarregistroinventario', '700', '640','{{ listado.id }}',0)"
                                                   href="javascript:void(0)"; ><i
                                                    class="fa fa-pencil-square-o"></i>  Editar </a></li>
            {#                            <li><a onclick="notificacion('{{ listado.id }}')" class="confirmacionmodal" style="cursor:pointer"><i#}
            {#                                        class="fa fa-close"></i>  Vista previa </a></li>#}
                                        </ul>

                                    </div>
                                </td>
                            </tr>
                            <tr>
                                {% empty %}
                                <td colspan="8" class="text-center">NO TIENE REGISTROS DE ACTIVOS</td>
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>



    <div class="modal fade static" id="detalleactivomodal" style="display: none;">
        <div class="modal-header">
            <h3 class="paneltitle">Detalles de activo</h3>
        </div>
        <div class="modal-body" id="detalleactivomodal_body"></div>
        <div class="modal-footer">
            <div style="float: right">
                <a href="javascript:;" id="detalleactivomodal_aceptar" class="btn btn-info btn-aceptar"> Aceptar</a>
            </div>
        </div>
    </div>

    <div class="modal fade static" id="detalleactivomantenimientomodal" style="display: none;">
        <div class="modal-header">
            <h3 class="paneltitle">Detalles de mantenimientos</h3>
        </div>
        <div class="modal-body" id="detalleactivomantenimientomodal_body"></div>
        <div class="modal-footer">
            <div style="float: right">
                <a href="javascript:;" id="detalleactivomantenimientomodal_aceptar" class="btn btn-info btn-aceptar">
                    Aceptar</a>
            </div>
        </div>
    </div>

    <div class="modal fade static" id="detalledificiomodal" style="display: none;">
        <div class="modal-header">
            <h3 class="paneltitle">Detalles Mantenimiento Preventivo</h3>
        </div>
        <div class="modal-body" id="detalledificiomodal_body"></div>
        <div class="modal-footer">
            <div style="float: right">
                <a href="javascript:;" id="detalledificiomodal_aceptar" class="btn btn-info btn-aceptar"> Aceptar</a>
            </div>
        </div>
    </div>

    <div class="modal" tabindex="null" role="dialog" id="itemspanel">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h4><i class="fa fa-list"></i> <b class="paneltitle">FORMULARIO MODAL</b></h4>
                </div>
                <div class="modal-body">
                    <form class="form-horizontal form-modal" autocomplete="off" method="post"
                          enctype="multipart/form-data" action="{{ request.path }}">
                        {% csrf_token %}
                        <div class="row-fluid panelbody">
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade static" id="itemspanel_reporteactivo" style="display: none;">

        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 id="paneltitle">Seleccione el activo tecnológico</h4>
                </div>
                <div class="modal-body">
                    <form class="form-search">
                        <i class="fa fa-graduation-cap"></i> Activos: <br>
                        <select formwidth="350px" id="id_grupoactivos" name="activos" tabindex="-1"
                                class="select2-accessible">
                        </select>
                    </form>
                </div>
                <div class="modal-footer">
                    <input type='hidden' id="evento" name='idp' value='0'/>
                    <a onclick="reporteactivoinventario()" class="btn btn-success btn-aceptar" style="cursor: pointer"> Generar reporte</a>
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal" id="itemspanel_reporteresponsableactivo" style="display: none;">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 id="paneltitle">Seleccione el responsable y activo fijo</h4>
                </div>
                <div class="modal-body">
                    <form class="form-search">
                        <i class="fa fa-graduation-cap"></i> Activo: <br>
                        <select formwidth="350px" id="id_grupoactivo" name="activos" tabindex="-1"
                                class="select2-accessible">
                        </select>
                        <i class="fa fa-user"></i> Responsable: <br>
                        <select formwidth="350px" id="id_gruporesponsables" name="responsables" tabindex="-1"
                                class="select2-accessible">
                        </select>
                    </form>
                </div>
                <div class="modal-footer">
                    <input type='hidden' id="evento" name='idp' value='0'/>
                    <a onclick="reporteresponsableactivoinventario()" class="btn btn-success btn-aceptar" style="cursor: pointer"> Generar reporte</a>
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal" id="itemspanel_reporteresponsable" style="display: none;">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 id="paneltitle">Seleccione el responsable</h4>
                </div>
                <div class="modal-body">
                    <form class="form-search">
                        <i class="fa fa-user"></i> Responsable: <br>
                        <select formwidth="350px" id="id_responsable" name="responsables" tabindex="-1"
                                class="select2-accessible">
                        </select>
                    </form>
                </div>
                <div class="modal-footer">
                    <input type='hidden' id="evento" name='idp' value='0'/>
                    <a onclick="reporteresponsable()" class="btn btn-success btn-aceptar" style="cursor: pointer">
                        Generar reporte</a>
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal" role="dialog" id="itemspanel_reporteinventariotics">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 id="paneltitle">Seleccione</h4>
                </div>
                <div class="modal-body">
                    <div class='row-fluid'>
                        <form class="form-search">
                            <i class="fa fa-map-marker"></i> Estado ubicación: <br>
                            <select formwidth="350px" id="id_estadoubicacion" name="estadoubicacion" tabindex="-1"
                                    class="select2-accessible">
                                <option value="0" selected="selected">-------------</option>
                                <option value="1">ENCONTRADO</option>
                                <option value="2">NO ENCONTRADO</option>
                                <option value="3">AMBOS</option>
                            </select>
                            <i class="fa fa-tools" style="margin-top: 15px"></i> Estado funcionamiento: <br>
                            <select formwidth="350px" id="id_estadofuncionamiento" name="estadofuncionamiento"
                                    tabindex="-1" class="select2-accessible">
                                <option value="0" selected="selected">-------------</option>
                                <option value="1">FUNCIONANDO</option>
                                <option value="2">NO FUNCIONANDO</option>
                                <option value="3">NO DETALLADO</option>
                                <option value="4">TODOS</option>
                            </select>
{#                            <i class="fa fa-info-circle" style="margin-top: 15px"></i> Estado general: <br>#}
{#                            <select formwidth="350px" id="id_estadogeneral" name="estadogeneral" tabindex="-1"#}
{#                                    class="select2-accessible" multiple="multiple">#}
{#                            </select>#}
                        </form>
                    </div>
                </div>
                <div class="modal-footer">
                    <input type='hidden' id="evento" name='idp' value='0'/>
                    <a onclick="generarreporteinventariotics()" class="btn btn-success btn-aceptar"
                       style="cursor: pointer"> Generar reporte</a>
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                </div>
            </div>
        </div>
    </div>



    <div class='row my-3 px-3'>
        <div class="col-lg-12">
            <nav>
                 {% if paging.num_pages > 20 %}
                    <ul class="pagination justify-content-center m-0">
                        {% if paging.primera_pagina %}

                            <li class="page-item">

                                <a class="page-link bloqueo_pantalla" href="/inventario_activofijo?action=inventariotics&{% if search %}s={{ search }}&{% endif %}{% if perfil %}perfil={{ perfil }}&{% endif %}idperiodoinv={{ idperiodoinv }}&page=1">1</a>
                            </li>
                            <li class="page-item">
                                <a class="active page-link bloqueo_pantalla" href="/inventario_activofijo?action=inventariotics&{% if search %}s={{ search }}&{% endif %}{% if perfil %}perfil={{ perfil }}&{% endif %}idperiodoinv={{ idperiodoinv }}&page={{ paging.ellipsis_izquierda }}">...</a>
                            </li>

                        {% endif %}

                        {% for pagenumber in paging.paginas %}
                            <li {% if pagenumber == page.number %}class='active page-item '{% else %}class='page-item'{% endif %}><a class="page-link bloqueo_pantalla" href="/inventario_activofijo?action=inventariotics&{% if search %}s={{ search }}&{% endif %}{% if perfil %}perfil={{ perfil }}&{% endif %}idperiodoinv={{ idperiodoinv }}&page={{ pagenumber }}">{{ pagenumber }}</a></li>
                        {% endfor %}
                        {% if paging.ultima_pagina %}
                            <li class="page-item" >
                                <a class="page-link bloqueo_pantalla" href="/inventario_activofijo?action=inventariotics&{% if search %}s={{ search }}&{% endif %}{% if perfil %}perfil={{ perfil }}&{% endif %}idperiodoinv={{ idperiodoinv }}&page={{ paging.ellipsis_derecha }}" >...</a></li>
                            <li class="page-item">
                                <a class="page-link bloqueo_pantalla" href="/inventario_activofijo?action=inventariotics&{% if search %}s={{ search }}&{% endif %}{% if perfil %}perfil={{ perfil }}&{% endif %}idperiodoinv={{ idperiodoinv }}&page={{ paging.num_pages }}">{{ paging.num_pages }}</a></li>
                        {% endif %}
                    </ul>
                {% else %}
                        <ul class="pagination justify-content-center m-0">
                            {% for pagenumber in paging.page_range %}
                                <li {% if pagenumber == page.number %}class='active page-item'{% else %}class="page-item"{% endif %}>
                                    <a class="page-link bloqueo_pantalla" href="/inventario_activofijo?action=inventariotics&{% if search %}s={{ search }}&{% endif %}{% if perfil %}perfil={{ perfil }}&{% endif %}idperiodoinv={{ idperiodoinv }}&page={{ pagenumber }}">{{ pagenumber }}</a></li>
                            {% endfor %}
                        </ul>
                {% endif %}
            </nav>

        </div>
    </div>

{% endblock %}
