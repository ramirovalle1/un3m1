{% extends "basebs_js.html" %}
{% load sga_extras %}
{% block heading %}
    <script type="text/javascript" src="/static/js/jquery.isloading.min.js"></script>
    <link href="/static/css/table-responsive.css?1.0.0" type="text/css" rel="stylesheet" />
    <link href="/static/widget_ppp.css" rel="stylesheet"/>
    <script type="text/javascript" src="/static/ckeditor/ckeditor-init.js?v=1.0.1" data-ckeditor-basepath="/static/ckeditor/ckeditor/" id="ckeditor-init-script"></script>
    <script type="text/javascript" src="/static/ckeditor/ckeditor/ckeditor.js?v=1.0.1"></script>
    <style type="text/css">

        #form3 .cantidadfloat {
            width: 100%;
        }
        .radio label,
        .checkbox label {
            display: inline-block;
            cursor: pointer;
            color: #0074D9;
            position: relative;
            padding: 5px 15px 5px 51px;
            font-size: 1em;
            border-radius: 5px;
            -webkit-transition: all 0.3s ease;
            -o-transition: all 0.3s ease;
            transition: all 0.3s ease; }
        .radio label:hover,
        .checkbox label:hover {
            background: rgba(255, 65, 54, 0.1); }
        .radio label:before,
        .checkbox label:before {
            content: "";
            display: inline-block;
            width: 17px;
            height: 17px;
            position: absolute;
            left: 15px;
            border-radius: 50%;
            background: none;
            border: 3px solid #0074D9; }
        input[type="radio"] {
            display: none; }
        input[type="radio"]:checked + label:before {
            display: none; }
        input[type="radio"]:checked + label {
            padding: 5px 15px;
            background: #0074D9;
            border-radius: 2px;
            color: #fff; }
        .checkbox label:before {
            border-radius: 3px; }
        .checkbox input[type="checkbox"] {
            display: none; }
        .checkbox input[type="checkbox"]:checked + label:before {
            display: none; }
        .checkbox input[type="checkbox"]:checked + label {
            background: #0074D9;
            color: #fff;
            padding: 5px 15px; }
    </style>
    <script type="text/javascript">
        $.extend(true, $.fn.dataTable.defaults, {
            oLanguage: {
                sSearch: "<span>Filtro:</span> _INPUT_",
                sLengthMenu: "<span>Mostrar Entradas:</span> _MENU_",
                sZeroRecords: "No se encontraron resultados",
                sProcessing: "Procesando...",
                sEmptyTable: "Ningún dato disponible para visualizar",
                sInfo: "Mostrando registros del _START_ al _END_ de un total de _TOTAL_ registros",
                sInfoEmpty: "Mostrando registros del 0 al 0 de un total de 0 registros",
                sLoadingRecords: "Cargando...",
                oPaginate: {
                    sFirst: "<i title='Inicio' class='fa fa-step-backward'></i>",
                    sLast: "<i title='Último' class='fa fa-step-forward'></i>",
                    sNext: "<i title='Siguiente' class='fa fa-fast-forward'></i>",
                    sPrevious: "<i title='Anterior' class='fa fa-fast-backward'></i>"
                },
            }
        });
        const verDetalleCostos = (id, idp) =>{
            bloqueointerface();
                $.ajax({
                    type: "GET",
                    url: "{{ request.path }}",
                    data: {'action': 'loadDetalleCostoNiveles', 'id': id, 'idp': idp},
                    success: function(data) {
                        if (data.result) {
                            desbloqueointerface();
                            $(".modal-body", $("#modalVerDetalleCostosNivel")).html(data.html);
                            $("#modalVerDetalleCostosNivel").modal({backdrop:'static', width: '90%'}).modal('show');
                        } else {
                            desbloqueointerface();
                            NotificationJG.error(data.mensaje);
                        }
                    },
                    error: function() {
                        desbloqueointerface();
                        NotificationJG.error("Error al enviar los datos.");
                    },
                    dataType: "json",
                });
        };
        const actualizarValores = (id, idp) => {
            var eleRangoMinimo = $(`#rangominimo_id_${id}`);
            var eleRangoMaximo = $(`#rangomaximo_id_${id}`);
            var eleCostoOptimo = $(`#costooptimo_id_${id}`);
            let valorMinimo = eleRangoMinimo.val();
            let valorMaximo = eleRangoMaximo.val();
            let valorCostoOptimo = eleCostoOptimo.val();
            if (valorMinimo > 0 && valorMaximo > 0 && valorCostoOptimo > 0){
                bloqueointerface();
                $.ajax({
                    type: "POST",
                    url: "{{ request.path }}",
                    data: {'action': 'saveCostoOptimoMalla', 'id': id, 'idp': idp, 'rangominimo': valorMinimo, 'rangomaximo': valorMaximo, 'costooptimo': valorCostoOptimo},
                    success: function(data) {
                        if (data.result) {
                            desbloqueointerface();
                            $(`#costomatricula_id_${id}`).val(data.aData.costomatricula);
                            $(`.td_id_${id}`).css('background-color', 'rgba(148, 255, 183, 0.23)');
                            $(`#detalle_costos_id_${id}`).removeClass('hidden');
                            numerico($(`#costomatricula_id_${id}`), 0, 0, 2);
                            NotificationJG.success('Se guardo correctamente');
                        } else {
                            desbloqueointerface();
                            NotificationJG.error(data.mensaje);
                        }
                    },
                    error: function() {
                        desbloqueointerface();
                        NotificationJG.error("Error al enviar los datos.");
                    },
                    dataType: "json",
                });
            }
        };
        var ControllerAcademicPeriod = {
            init: function (){
                var self = this;


                self.$table = $('.datatable table');
                $('[name="filter_valida_asistencia"], [name="filter_activo"], [name="filter_visible"], [name="filter_visiblehorario"], [name="filter_matriculacionactiva"], [name="tipos_periodos"], [name="filter_crontabactivo"]').change(function(){
                    self.$table.dataTable().fnDraw();
                });
                $('select').select2({minimumResultsForSearch: 20,})
                self.loadDataTable();
                $("#action_min").click(function(){
                    $("#panel_filter .panel-body").hide();
                    $("#action_min").hide();
                    $("#action_max").show();
                });
                $("#action_max").click(function(){
                    $("#panel_filter .panel-body").show();
                    $("#action_min").show();
                    $("#action_max").hide();
                });

                $(".action-add").click(function(){
                    uiModal.open('new', 0)

                });

                $("#action_min").trigger("click");
            },
            loadDataTable: function(){
                var self = this;
                self.$table.dataTable({
                    responsive: true,
                    searchDelay: 1000,
                    bJQueryUI: false,
                    bAutoWidth: false,
                    //bProcessing: true,
                    bServerSide: true,
                    bSort: false,
                    sPaginationType: "full_numbers",
                    iDisplayLength: 25,
                    sDom: '<"datatable-header"fl><"datatable-scroll"tr><"datatable-footer"ip>',
                    sAjaxSource: "/adm_sistemas/academic_period",
                    sServerMethod: "POST",
                    fnServerParams: function (aoData)
                    {
                        bloqueointerface();
                        var valida_asistencia = $('[name="filter_valida_asistencia"]:checked').val();
                        var visible = $('[name="filter_visible"]:checked').val();
                        var activo = $('[name="filter_activo"]:checked').val();
                        var visiblehorario = $('[name="filter_visiblehorario"]:checked').val();
                        var matriculacionactiva = $('[name="filter_matriculacionactiva"]:checked').val();
                        var tipo_periodo = $('[name="tipos_periodos"]').val();
                        var crontabactivo = $('[name="filter_crontabactivo"]:checked').val();
                        aoData.push(
                            {"name": "action", "value": 'loadDataTable'},
                            {"name": "visible", "value": visible},
                            {"name": "activo", "value": activo},
                            {"name": "valida_asistencia", "value": valida_asistencia},
                            {"name": "visiblehorario", "value": visiblehorario},
                            {"name": "matriculacionactiva", "value": matriculacionactiva},
                            {"name": "tipo_periodo", "value": tipo_periodo},
                            {"name": "crontabactivo", "value": crontabactivo},
                        );
                        //console.log(aoData);
                    },
                    aoColumnDefs:
                        [
                            {
                                aTargets: [0],
                                width: "4%",
                                fnCreatedCell: function(nTd, sData, oData, iRow, iCol)
                                {
                                    if(sData != 'NULL') {
                                        $(nTd).css('text-align', 'center');
                                        $(nTd).css('vertical-align', 'middle');
                                        $(nTd).css('padding', '8px');
                                        $(nTd).attr('data-title', 'ID');
                                    }
                                }
                            },
                            {
                                aTargets: [1],
                                width: "30%",
                                fnCreatedCell: function(nTd, sData, oData, iRow, iCol)
                                {
                                    if(sData != 'NULL') {
                                        $(nTd).css('text-align', 'left');
                                        $(nTd).css('vertical-align', 'middle');
                                        $(nTd).css('padding', '8px');
                                    }
                                }
                            },
                            {
                                aTargets: [2],
                                width: "24%",
                                mRender: function (data, type, row)
                                {
                                    var html = `<table class="table table-hover personal-task">`;
                                    html += `<tbody>`;
                                    html += `<tr><td style="font-weight: bold">Inicio:</td><td style="text-align: center">${data['inicio']}</td></tr>`;
                                    html += `<tr><td style="font-weight: bold">Fin:</td><td style="text-align: center">${data['fin']}</td></tr>`;
                                    html += `<tr><td style="font-weight: bold">Inicio Agregacion (Secretaria):</td><td style="text-align: center">${data['inicio_agregacion']}</td></tr>`;
                                    html += `<tr><td style="font-weight: bold">Fin Agregacion (Secretaria):</td><td style="text-align: center">${data['limite_agregacion']}</td></tr>`;
                                    html += `<tr><td style="font-weight: bold">Fin Retiro (Secretaria):</td><td style="text-align: center">${data['limite_retiro']}</td></tr>`;
                                    html += `<tr><td style="font-weight: bold">Inicio Agregacion (Estudiante):</td><td style="text-align: center">${data['fecha_inicio_agregacion']}</td></tr>`;
                                    html += `<tr><td style="font-weight: bold">Fin Agregacion (Estudiante):</td><td style="text-align: center">${data['fecha_fin_agregacion']}</td></tr>`;
                                    html += `<tr><td style="font-weight: bold">Fin Retiro (Estudiante):</td><td style="text-align: center">${data['fecha_fin_retiro']}</td></tr>`;
                                    html += '</tbody>'
                                    html += '</table>'
                                    return html;
                                },
                                fnCreatedCell: function(nTd, sData, oData, iRow, iCol)
                                {
                                    if(sData != 'NULL') {
                                        $(nTd).css('text-align', 'left');
                                        $(nTd).css('vertical-align', 'middle');
                                        $(nTd).css('padding', '8px');
                                    }
                                }
                            },
                            {
                                aTargets: [3],
                                width: "8%",
                                fnCreatedCell: function(nTd, sData, oData, iRow, iCol)
                                {
                                    if(sData != 'NULL') {
                                        $(nTd).css('text-align', 'center')
                                        $(nTd).css('vertical-align', 'middle')
                                        $(nTd).css('padding', '8px')
                                    }
                                }
                            },
                            {
                                aTargets: [4],
                                width: "24%",
                                mRender: function (data, type, row)
                                {
                                    //console.log(data);
                                    var html = `<table class="table table-hover personal-task">`;
                                    html += `<tbody style="font-weight: bold">`;
                                    if (data['valida_asistencia']){
                                        html += `<tr class=""><td>Valida Asistencia:</td><td style="text-align: center"><span class="label label-success label-mini"><i class="fa fa-check"></i></span></td></tr>`;
                                    }else{
                                        html += `<tr class=""><td>Valida Asistencia:</td><td style="text-align: center"><span class="label label-danger label-mini"><i class="fa fa-remove"></i></span></td></tr>`;
                                    }
                                    if (data['activo']){
                                        html += `<tr class=""><td>Activo:</td><td style="text-align: center"><span class="label label-success label-mini"><i class="fa fa-check"></i></span></td></tr>`;
                                    }else{
                                        html += `<tr class=""><td>Activo:</td><td style="text-align: center"><span class="label label-danger label-mini"><i class="fa fa-remove"></i></span></td></tr>`;
                                    }
                                    if (data['visible']){
                                        html += `<tr class=""><td>Visible:</td><td style="text-align: center"><span class="label label-success label-mini"><i class="fa fa-eye"></i></span></td></tr>`;
                                    }else{
                                        html += `<tr class=""><td>Visible:</td><td style="text-align: center"><span class="label label-info label-mini"><i class="fa fa-eye-slash"></i></span></td></tr>`;
                                    }
                                    if (data['visiblehorario']){
                                        html += `<tr class=""><td>Visible Horario:</td><td style="text-align: center"><span class="label label-success label-mini"><i class="fa fa-eye"></i></span></td></tr>`;
                                    }else{
                                        html += `<tr class=""><td>Visible Horario:</td><td style="text-align: center"><span class="label label-info label-mini"><i class="fa fa-eye-slash"></i></span></td></tr>`;
                                    }
                                    if (data['matriculacionactiva']){
                                        html += `<tr class=""><td>Matrícula Activa:</td><td style="text-align: center"><span class="label label-success label-mini"><i class="fa fa-check"></i></span></td></tr>`;
                                    }else{
                                        html += `<tr class=""><td>Matrícula Activa:</td><td style="text-align: center"><span class="label label-danger label-mini"><i class="fa fa-remove"></i></span></td></tr>`;
                                    }
                                    if (data['crontabactivo']){
                                        html += `<tr class=""><td>Crontab Activo:</td><td style="text-align: center"><span class="label label-success label-mini"><i class="fa fa-check"></i></span></td></tr>`;
                                    }else{
                                        html += `<tr class=""><td>Crontab Activo:</td><td style="text-align: center"><span class="label label-danger label-mini"><i class="fa fa-remove"></i></span></td></tr>`;
                                    }
                                    html += '</tbody>'
                                    html += '</table>'
                                    return html;
                                },
                                fnCreatedCell: function(nTd, sData, oData, iRow, iCol)
                                {
                                    if(sData != 'NULL') {
                                        $(nTd).css('text-align', 'left');
                                        $(nTd).css('vertical-align', 'middle');
                                        $(nTd).css('padding', '8px');
                                    }
                                }
                            },
                            {
                                aTargets: [5],
                                width: "10%",
                                mRender: function (data, type, row)
                                {
                                    return `<input type="hidden" class="dt-col-option" value="${data["id"]}"/> <input type="hidden" class="dt-col-data-nombre" value="${data["nombre"]}"/> <input type="hidden" class="dt-col-data-valida_cronograma" value="${data["valida_cronograma"]? 1:0}"/> <input type="hidden" class="dt-col-data-tiene_cronograma" value="${data["tiene_cronograma"]? 1:0}"/>`;
                                },
                                fnCreatedCell: function(nTd, sData, oData, iRow, iCol)
                                {
                                    if(sData != 'NULL') {
                                        $(nTd).css('text-align', 'center')
                                        $(nTd).css('vertical-align', 'middle')
                                        $(nTd).css('padding', '8px')
                                    }
                                }
                            },
                        ]
                    ,
                    fnDrawCallback: function (oSettingst)
                    {
                        desbloqueointerface();
                        var count = 0;

                        $('.dt-col-option').each(function(){
                            var id = $(this).val();
                            var nombre = $('.dt-col-data-nombre').eq(count).val();
                            var valida_cronograma = $('.dt-col-data-valida_cronograma').eq(count).val().trim() == 1 ? true : false;
                            var tiene_cronograma = $('.dt-col-data-tiene_cronograma').eq(count).val().trim() == 1 ? true : false;
                            var $html = $('#el-templates [element="table-row-actions"] .table-controls').clone();

                            $('.dt-action-view', $html).click(function(){
                                uiModal.open('view', id);
                            });

                            $('.dt-action-edit', $html).click(function(){
                                uiModal.open('edit', id);
                            });

                            $('.dt-action-groups', $html).click(function(){
                                var typeform = $(this).attr('typeform');
                                uiGroupModal.open(typeform, id);
                            });

                            $('.dt-action-matriculacion', $html).click(function(){
                                var typeform = $(this).attr('typeform');
                                uiMatriculacionModal.open(typeform, id);
                            });

                            $('.dt-action-niveles', $html).click(function(){
                                /*var anchor = document.createElement('a');
                                anchor.href = 'https://example.com';
                                anchor.target="_blank";*/
                                var typeform = $(this).attr('typeform');
                                uiNivelesModal.open(typeform, id);

                            });

                            $('.dt-action-finanzas', $html).click(function(){
                                var typeform = $(this).attr('typeform');
                                uiFinancieroModal.open(typeform, id);

                            });

                            $('.dt-action-estadisticas', $html).click(function(){
                                /*var sts = document.createElement('a');
                                sts.href = `/adm_sistemas/academic_period/statistics?id=${id}`;
                                sts.target = "_blank";
                                $('.confirmacionmodal').bind('click.conectar_confirmacion', conectar_confirmacion);
                                location.href = `/adm_sistemas/academic_period/statistics?id=${id}`*/
                                var type_m = $(this).attr('type_m');
                                window.open(`/adm_sistemas/academic_period/statistics?id=${id}&t=${type_m}`, "_blank");

                            });

                            $('.dt-action-academica', $html).click(function (){
                                var typeform = $(this).attr('typeform');
                                uiAcademiaModal.open(typeform, id);
                            });

                            $('.dt-action-crontab', $html).click(function (){
                                var typeform = $(this).attr('typeform');
                                uiCrontabModal.open(typeform, id);
                            });

                            if (valida_cronograma){
                                $('.dt-action-matriculacion-cronograma', $html).click(function(){
                                    var typeform = $(this).attr('typeform');
                                    //window.location.href = "/academic_period?action=loadRegistrationSchedule&idp="+id;
                                    uiCronogramaMatriculacionModal.open(typeform, id);
                                });
                            }else{
                                $('.dt-action-matriculacion-cronograma', $html).hide();
                            }



                            $('.dt-action-delete', $html).click(function(){
                                var question = `Al eliminar el registro no podra volver a recuperar los datos. <br>¿Está seguro de eliminar el periodo académico <span class="label label-warning">${nombre}</span>?`;
                                Confirm.ajax({"model": "Periodo", 'id': id, "permission": "puede_eliminar_periodo_academico", "app_label": "bd"}, function () {
                                    Confirm.question(question, function () {
                                        bloqueointerface();
                                        var aData = {"action": "deleteAcademicPeriod", 'id': id}
                                        $.ajax({
                                            type: "POST",
                                            url: "/adm_sistemas/academic_period",
                                            data: aData,
                                            success: function(data) {
                                                if (data.result == 'ok') {
                                                    self.$table.dataTable().fnDraw(false);
                                                    NotificationJG.success(data.mensaje)
                                                }
                                                else{
                                                    NotificationJG.error(data.mensaje);
                                                }
                                                desbloqueointerface();
                                            },
                                            error: function() {
                                                desbloqueointerface();
                                                NotificationJG.error("Error al enviar los datos.");
                                            },
                                            dataType: "json",
                                        });
                                    }, function () {
                                        NotificationJG.info("Enhorabuena el registro esta salvado.!");
                                        var h = $(window).height() - 350;
                                        $('#modalConfirmAjax').modal({backdrop: 'static', keyboard: false, width: "60%", height: h}).modal('show');
                                    });

                                }, function () {
                                    NotificationJG.info("Enhorabuena el registro esta salvado.!");
                                });
                            });


                            count ++;
                            $(this).after( $html );
                        });
                    }

                });
                $("#dtViewAcademicPeriod_filter input").unbind(); // 'x' es el nombre de tu tabla
                $('#dtViewAcademicPeriod_filter input').bind('keyup', function (e) {
                    if (e.keyCode == 13) {
                        //console.log(this.value);
                        self.$table.dataTable().fnFilter(this.value);
                    }
                });
            }

        };

        var uiModal = {
            init: function () {
                var self = this;
                self.$modalForm = $('#modalAcademicPeriod');
                $('.action-close', self.$modalForm).click(function(){
                    self.close();
                });
                $('.action-edit', self.$modalForm).click(function(){
                    self.setFormType('edit');
                });
                $('.action-save', self.$modalForm).click(function (){
                    self.actionSave();
                });
            },
            close: function (){
                var self = this;
                self.$modalForm.modal('hide');
            },
            open: function(type, id){

                bloqueointerface();

                var self = this;
                self.setFormType(type);

                var h = $(window).height()-450;
                $.ajax({
                    type: "GET",
                    url: "/adm_sistemas/academic_period",
                    data: {'action': 'loadFormAcademicPeriod', 'typeForm': type, 'id': id},
                    success: function(data) {
                        if (data.result == 'ok') {
                            desbloqueointerface();
                            $(".modal-body", self.$modalForm).html(data.html);
                            self.$modalForm.modal({backdrop:'static', width: '40%'}).modal('show');
                        } else {
                            desbloqueointerface();
                            NotificationJG.error(data.mensaje);
                        }
                    },
                    error: function() {
                        desbloqueointerface();
                        NotificationJG.error("Error al enviar los datos.");
                    },
                    dataType: "json",
                });
            },
            setFormType: function( type /* new, edit, view */ )
            {
                var self = this;

                if( type == 'new' )
                {
                    $('.modal-header span', self.$modalForm).html('Nuevo');

                    $('.action-save', self.$modalForm).show();
                    $('.action-edit', self.$modalForm).hide();
                    self.setFormReadOnly(false);
                }
                else if( type == 'edit' )
                {
                    $('.modal-header span', self.$modalForm).html('Editar');

                    $('.action-save', self.$modalForm).show();
                    $('.action-edit', self.$modalForm).hide();
                    self.setFormReadOnly(false);
                }
                else if( type == 'view' )
                {
                    $('.modal-header span', self.$modalForm).html('Ver');

                    $('.action-save', self.$modalForm).hide();
                    $('.action-edit', self.$modalForm).show();
                    self.setFormReadOnly(true);
                }
            },
            setFormReadOnly: function( isFormReadOnly )
            {
                var self = this;

                $('[name="nombre"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="nombre"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="inicio"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="inicio"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="fin"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="fin"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="tipo"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="tipo"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="tipocalculo"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="tipocalculo"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="valida_asistencia"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="valida_asistencia"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="visiblehorario"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="visiblehorario"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="inicio_agregacion"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="inicio_agregacion"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="limite_agregacion"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="limite_agregacion"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="limite_retiro"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="limite_retiro"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="porcentaje_gratuidad"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="porcentaje_gratuidad"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="valor_maximo"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="valor_maximo"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="fecha_inicio_agregacion"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="fecha_inicio_agregacion"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="fecha_fin_agregacion"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="fecha_fin_agregacion"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="fecha_fin_quitar"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="fecha_fin_quitar"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="marcardefecto"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="marcardefecto"]', self.$modalForm).prop('readonly', isFormReadOnly);
            },
            formGetData:function(){
                var self = this;
                var data = new FormData($("#frmAcademicPeriod", self.$modalForm)[0]);
                return data;
            },
            actionSave: function (){
                var self = this;
                $("#frmAcademicPeriod", self.$modalForm).validationEngine('attach',{ scroll: false });
                var valid = $("#frmAcademicPeriod", self.$modalForm).validationEngine('validate', { scroll: false });
                if (!valid){
                    setTimeout(function() {
                        $('.help-text', self.$modalForm).each(function () {
                            var field = $(this);
                            if (field.attr('alert')) {
                                field.html(field.attr('alert'));
                            } else {
                                field.html('');
                            }
                        });
                    }, 8000);
                    desbloqueointerface();
                    return false;
                }
                $('.datepicker', self.$modalForm).css({"display": "none"});
                $('.bootstrap-timepicker-widget', self.$modalForm).css({"display": "none"});

                $('.controls input', self.$modalForm).each(function(){
                    if ($(this).attr('type')=='text'){
                        $(this).val($(this).val().trim());
                    }
                    if ($(this).attr('type')!='file'){
                        if ($(this).css('text-transform')=='uppercase'){
                            if ($(this).attr('type')!='password'){
                                $(this).val($(this).val().toUpperCase());
                            }
                        }
                    }
                });

                var aData = self.formGetData();
                bloqueointerface();
                $.ajax({
                    type: "POST",
                    url: "/adm_sistemas/academic_period",
                    data: aData,
                    success: function(data) {
                        if (data.result == 'ok') {
                            ControllerAcademicPeriod.$table.dataTable().fnDraw(false);
                            self.close();
                            NotificationJG.success(data.mensaje);
                        }
                        else{
                            NotificationJG.error(data.mensaje);
                        }
                        desbloqueointerface();
                    },
                    error: function() {
                        desbloqueointerface();
                        NotificationJG.error("Error al enviar los datos.");
                    },
                    dataType: "json",
                    cache: false,
                    contentType: false,
                    processData: false,
                });
            },
        };

        var uiGroupModal = {
            init: function () {
                var self = this;
                self.$modalForm = $('#modalAcademicPeriodGroups');
                $('.action-close', self.$modalForm).click(function(){
                    self.close();
                });
                $('.action-edit', self.$modalForm).click(function(){
                    self.setFormType('edit');
                });
                $('.action-save', self.$modalForm).click(function (){
                    self.actionSave();
                });
            },
            close: function (){
                var self = this;
                self.$modalForm.modal('hide');
            },
            open: function(type, id){
                bloqueointerface();
                var self = this;
                self.setFormType(type);
                var h = $(window).height()-450;
                $.ajax({
                    type: "GET",
                    url: "/adm_sistemas/academic_period",
                    data: {'action': 'loadFormGroups', 'typeForm': type, 'id': id},
                    success: function(data) {
                        if (data.result == 'ok') {
                            desbloqueointerface();
                            $(".modal-body", self.$modalForm).html(data.html);
                            self.$modalForm.modal({backdrop:'static', width: '40%'}).modal('show');
                        } else {
                            desbloqueointerface();
                            NotificationJG.error(data.mensaje);
                        }
                    },
                    error: function() {
                        desbloqueointerface();
                        NotificationJG.error("Error al enviar los datos.");
                    },
                    dataType: "json",
                });
            },
            setFormType: function( type /* new, edit, view */ )
            {
                var self = this;

                if( type == 'new' )
                {
                    $('.modal-header span', self.$modalForm).html('Nuevo');

                    $('.action-save', self.$modalForm).show();
                    $('.action-edit', self.$modalForm).hide();
                    self.setFormReadOnly(false);
                }
                else if( type == 'edit' )
                {
                    $('.modal-header span', self.$modalForm).html('Editar');

                    $('.action-save', self.$modalForm).show();
                    $('.action-edit', self.$modalForm).hide();
                    self.setFormReadOnly(false);
                }
                else if( type == 'view' )
                {
                    $('.modal-header span', self.$modalForm).html('Ver');

                    $('.action-save', self.$modalForm).hide();
                    $('.action-edit', self.$modalForm).show();
                    self.setFormReadOnly(true);
                }
            },
            setFormReadOnly: function( isFormReadOnly )
            {
                var self = this;

                $('[name="visible"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="visible"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="grupos"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="grupos"]', self.$modalForm).prop('readonly', isFormReadOnly);
                if (isFormReadOnly)
                {
                    $(".searchMultipleCheckbox", self.$modalForm).hide();
                }
                else
                {
                    $(".searchMultipleCheckbox", self.$modalForm).show();
                }
            },
            formGetData:function(){
                var self = this;
                var data = {}
                data['id'] = $('[name="id"]', self.$modalForm).val();
                data['action'] = $('[name="action"]', self.$modalForm).val();
                data['visible'] = $('[name="visible"]', self.$modalForm).is(':checked');
                var grupos = []
                $.each($('[name="grupos"]:checked', self.$modalForm), function() {
                    var value = $(this).val();
                    grupos.push(value);
                });
                data['gruposs'] = JSON.stringify(grupos)
                //console.log(data);
                return data;
            },
            actionSave: function (){
                var self = this;
                $("#frmAcademicPeriodGroups", self.$modalForm).validationEngine('attach',{ scroll: false });
                var valid = $("#frmAcademicPeriodGroups", self.$modalForm).validationEngine('validate', { scroll: false });
                if (!valid){
                    setTimeout(function() {
                        $('.help-text', self.$modalForm).each(function () {
                            var field = $(this);
                            if (field.attr('alert')) {
                                field.html(field.attr('alert'));
                            } else {
                                field.html('');
                            }
                        });
                    }, 8000);
                    desbloqueointerface();
                    return false;
                }
                $('.datepicker', self.$modalForm).css({"display": "none"});
                $('.bootstrap-timepicker-widget', self.$modalForm).css({"display": "none"});

                $('.controls input', self.$modalForm).each(function(){
                    if ($(this).attr('type')=='text'){
                        $(this).val($(this).val().trim());
                    }
                    if ($(this).attr('type')!='file'){
                        if ($(this).css('text-transform')=='uppercase'){
                            if ($(this).attr('type')!='password'){
                                $(this).val($(this).val().toUpperCase());
                            }
                        }
                    }
                });

                var aData = self.formGetData();
                bloqueointerface();
                $.ajax({
                    type: "POST",
                    url: "/adm_sistemas/academic_period",
                    data: aData,
                    success: function(data) {
                        if (data.result == 'ok') {
                            ControllerAcademicPeriod.$table.dataTable().fnDraw(false);
                            self.close();
                            NotificationJG.success(data.mensaje);
                        }
                        else{
                            NotificationJG.error(data.mensaje);
                        }
                        desbloqueointerface();
                    },
                    error: function() {
                        desbloqueointerface();
                        NotificationJG.error("Error al enviar los datos.");
                    },
                    dataType: "json",
                });
            },
        };

        var uiMatriculacionModal = {
            init: function () {
                var self = this;
                self.$modalForm = $('#modalAcademicPeriodMatriculacion');
                self.terminos = null;
                self.terminos_examenes = null;
                $('.action-close', self.$modalForm).click(function(){
                    self.close();
                });
                $('.action-edit', self.$modalForm).click(function(){
                    self.setFormType('edit');
                });
                $('.action-save', self.$modalForm).click(function (){
                    self.actionSave();
                });
            },
            processModalInit: function (){
                var self = this;
                $("#frmAcademicPeriodMatriculacion", self.$modalForm).validationEngine({autoHidePrompt:true, autoHideDelay:1000 });
                $('#id_num_cuotas_rubro, #id_porcentaje_perdidad_parcial_gratuidad, #id_porcentaje_perdidad_total_gratuidad, #id_num_materias_maxima').keyup(function(){
                    numerico($(this),0,0,0);
                });
                $('#id_monto_rubro_cuotas').keyup(function(){
                    numerico($(this),0,0,0);
                });

                $(".action_new_coordinacion", self.$modalForm).click(function (){
                    uiCronogramaModal.open('new', [])
                });

                $(".action_new_fecha", self.$modalForm).click(function (){
                    uiFechaRubroModal.open('new', [])
                });

                /*CKEDITOR.replace('terminos', {
                    height: '100%',
                    width: '100%'
                });*/
                self.terminos = CKEDITOR.replace('terminos');
                self.terminos_examenes = CKEDITOR.replace('terminos_examenes');

            },
            addDataCronograma: function (objCronograma){
                var self = this;

                if (objCronograma.id == 0) {
                    objCronograma.id = (new Date()).getTime();
                }
                var tr = null;
                $('#dataCronograma tbody tr').each(function(index, value){
                    var $_tr = $(this);

                    var data = $_tr.data();
                    if( data.objCronograma.id == objCronograma.id ) {
                        tr = $_tr;
                    }
                });

                var isNew = (tr == null);
                if( isNew ) {
                    tr = $('#el-templates [element="table-row-coordinacion"] tr').clone();
                }

                var $tr = $(tr);
                // console.log($tr);
                $tr.data({objCronograma:objCronograma});
                $('td:nth-child(1)', $tr).html(objCronograma.coordinacion);
                //$('td:nth-child(2)', $tr).html(objCronograma.fechainicio);

                $('td:nth-child(2)', $tr).html(`<input type="text" style="display:none; text-align: center" class="selectorfecha updateCampoText" value="${objCronograma.fechainicio}">
                                <div style="text-align: center" class="updateCampoDiv">
                                    ${objCronograma.fechainicio}
                                </div>`);
                $('td:nth-child(2) .updateCampoDiv', $tr).off('click').on('click', function(){
                    //alert(objCronograma.fechainicio);
                    $(this).hide();
                    $('td:nth-child(2) .updateCampoText', $tr).show();
                });
                $('td:nth-child(2) .selectorfecha', $tr).datepicker({format:"yyyy-mm-dd"});
                $('td:nth-child(2) .updateCampoText', $tr).off('changeDate').on('changeDate', function(ev){
                    $(this).datepicker('hide');
                    $(this).hide();
                    let value = $(this).val();
                    //console.log(value);
                    $('td:nth-child(2) .updateCampoDiv', $tr).html(value).show();
                    objCronograma.fechainicio = value;
                    self.addDataCronograma(objCronograma);
                    NotificationJG.success(`Se cambio fecha de inicio de la coordinación ${objCronograma.coordinacion} correctamente.`);
                });
                //$('td:nth-child(3)', $tr).html(objCronograma.fechafin);
                $('td:nth-child(3)', $tr).html(`<input type="text" style="display:none; text-align: center" class="selectorfecha updateCampoText" value="${objCronograma.fechafin}">
                                <div style="text-align: center" class="updateCampoDiv">
                                    ${objCronograma.fechafin}
                                </div>`);
                $('td:nth-child(3) .updateCampoDiv', $tr).off('click').on('click', function(){
                    $(this).hide();
                    $('td:nth-child(3) .updateCampoText', $tr).show();
                });
                $('td:nth-child(3) .selectorfecha', $tr).datepicker({format:"yyyy-mm-dd"});
                $('td:nth-child(3) .updateCampoText', $tr).off('changeDate').on('changeDate', function(ev){
                    $(this).datepicker('hide');
                    $(this).hide();
                    let value = $(this).val();
                    //console.log(value);
                    $('td:nth-child(3) .updateCampoDiv', $tr).html(value).show();
                    objCronograma.fechafin = value;
                    self.addDataCronograma(objCronograma);
                    NotificationJG.success(`Se cambio fecha de fin de la coordinación ${objCronograma.coordinacion} correctamente.`);
                });
                $('td:nth-child(4)', $tr).html(objCronograma.activo ?
                    `<div class="mb-1"><a class="btn btn-success btn-mini action_activo">SI</a></div>` :
                    `<div class="mb-1"><a class="btn btn-danger btn-mini action_activo">NO</a></div>`);

                $('td:nth-child(4) .action_activo', $tr).off('click').on('click', function(){
                    self.changeActivo(objCronograma);
                });

                $('td:nth-child(5) .action_remove_coordinacion', $tr).off('click').on('click', function(){
                    self.removeCoordinacion(objCronograma);
                });
                $('td:nth-child(5) .action_edit_coordinacion', $tr).off('click').on('click', function(){
                    uiCronogramaModal.open('edit', objCronograma);
                });

                $('#dataCronograma > tbody').append($tr);

            },
            addDataFechaRubro: function (objFecha){
                var self = this;

                if (objFecha.id == 0) {
                    objFecha.id = (new Date()).getTime();
                }
                var tr = null;
                $('#dataFechaCuotas tbody tr').each(function(index, value){
                    var $_tr = $(this);

                    var data = $_tr.data();
                    if( data.objFecha.id == objFecha.id ) {
                        tr = $_tr;
                    }
                });

                var isNew = (tr == null);
                if( isNew ) {
                    tr = $('#el-templates [element="table-row-fecha-rubro"] tr').clone();
                }

                var $tr = $(tr);
                // console.log($tr);
                $tr.data({objFecha:objFecha});
                $('td:nth-child(1)', $tr).html(objFecha.cuota);
                $('td:nth-child(2)', $tr).html(objFecha.fecha);
                $('td:nth-child(2)', $tr).html(`<input type="text" style="display:none; text-align: center" class="selectorfecha updateCampoText" value="${objFecha.fecha}">
                                <div style="text-align: center" class="updateCampoDiv">
                                    ${objFecha.fecha}
                                </div>`);
                $('td:nth-child(2) .updateCampoDiv', $tr).off('click').on('click', function(){
                    $(this).hide();
                    $('td:nth-child(2) .updateCampoText', $tr).show();
                });
                $('td:nth-child(2) .selectorfecha', $tr).datepicker({format:"yyyy-mm-dd"});
                $('td:nth-child(2) .updateCampoText', $tr).off('changeDate').on('changeDate', function(ev){
                    $(this).datepicker('hide');
                    $(this).hide();
                    let value = $(this).val();
                    //console.log(value);
                    $('td:nth-child(2) .updateCampoDiv', $tr).html(value).show();
                    objFecha.fecha = value;
                    self.addDataFechaRubro(objFecha);
                    NotificationJG.success(`Se cambio fecha de la cuota #${objFecha.cuota} correctamente.`);
                });
                $('td:nth-child(3) .action_remove_fecha_rurbo', $tr).off('click').on('click', function(){
                    self.removeFechaRubro(objFecha);
                });
                $('td:nth-child(3) .action_edit_fecha_rurbo', $tr).off('click').on('click', function(){
                    uiFechaRubroModal.open('edit', objFecha);
                });

                $('#dataFechaCuotas > tbody').append($tr);
            },
            changeActivo: function(objCronograma){
                var self = this;
                if( objCronograma.activo == true ) {
                    objCronograma.activo = false
                    NotificationJG.success(`Se inactivo coordinación ${objCronograma.coordinacion} correctamente.`);
                }else{
                    objCronograma.activo = true
                    NotificationJG.success(`Se activo coordinación ${objCronograma.coordinacion} correctamente.`);
                }
                self.addDataCronograma(objCronograma);
            },
            removeCoordinacion: function (objCronograma){
                Confirm.question('Desea eliminar la coordinación seleccionada?', function () {
                    $('#dataCronograma tbody tr').each(function(index, value){
                        var $_tr = $(this);
                        var data = $_tr.data();
                        if( data.objCronograma.id == objCronograma.id ) {
                            $_tr.remove();
                            NotificationJG.success("Se elimino correctamente.");
                        }
                    });
                }, function () {
                    NotificationJG.info("Enhorabuena el registro esta salvado.!");
                });
            },
            removeFechaRubro: function (objFecha){
                Confirm.question('Desea eliminar la fecha seleccionada?', function () {
                    $('#dataFechaCuotas tbody tr').each(function(index, value){
                        var $_tr = $(this);
                        var data = $_tr.data();
                        if( data.objFecha.id == objFecha.id ) {
                            $_tr.remove();
                            NotificationJG.success("Se elimino correctamente.");
                        }
                    });
                }, function () {
                    NotificationJG.info("Enhorabuena el registro esta salvado.!");
                });
            },
            close: function (){
                var self = this;
                self.$modalForm.modal('hide');
            },
            open: function(type, id){
                bloqueointerface();
                var self = this;
                self.setFormType(type);
                var h = $(window).height()-450;
                $.ajax({
                    type: "GET",
                    url: "/adm_sistemas/academic_period",
                    data: {'action': 'loadFormMatriculacion', 'typeForm': type, 'id': id},
                    success: function(data) {
                        if (data.result == 'ok') {
                            desbloqueointerface();
                            $(".modal-body", self.$modalForm).html(data.html);
                            self.$modalForm.modal({backdrop:'static', width: '90%'}).modal('show');
                            $.each(data.cronograma, function (index, value){
                                //console.log(value);
                                self.addDataCronograma(value);
                            });
                            $.each(data.fecha, function (index, value){
                                //console.log(value);
                                self.addDataFechaRubro(value);
                            });
                            self.processModalInit();
                        } else {
                            desbloqueointerface();
                            NotificationJG.error(data.mensaje);
                        }
                    },
                    error: function() {
                        desbloqueointerface();
                        NotificationJG.error("Error al enviar los datos.");
                    },
                    dataType: "json",
                });
            },
            setFormType: function( type /* new, edit, view */ )
            {
                var self = this;

                if( type == 'new' )
                {
                    $('.modal-header span', self.$modalForm).html('Nuevo');

                    $('.action-save', self.$modalForm).show();
                    $('.action-edit', self.$modalForm).hide();
                    self.setFormReadOnly(false);
                }
                else if( type == 'edit' )
                {
                    $('.modal-header span', self.$modalForm).html('Editar');

                    $('.action-save', self.$modalForm).show();
                    $('.action-edit', self.$modalForm).hide();
                    self.setFormReadOnly(false);
                }
                else if( type == 'view' )
                {
                    $('.modal-header span', self.$modalForm).html('Ver');

                    $('.action-save', self.$modalForm).hide();
                    $('.action-edit', self.$modalForm).show();
                    self.setFormReadOnly(true);
                }
            },
            setFormReadOnly: function( isFormReadOnly )
            {
                var self = this;

                $('[name="inicio_agregacion"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="inicio_agregacion"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="limite_agregacion"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="limite_agregacion"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="limite_retiro"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="limite_retiro"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="fecha_inicio_agregacion"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="fecha_inicio_agregacion"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="fecha_fin_agregacion"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="fecha_fin_agregacion"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="fecha_fin_quitar"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="fecha_fin_quitar"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="tipo"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="tipo"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="tipocalculo"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="tipocalculo"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="activo"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="activo"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="valida_cronograma"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="valida_cronograma"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="valida_coordinacion"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="valida_coordinacion"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="valida_materia_carrera"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="valida_materia_carrera"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="valida_seccion"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="valida_seccion"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="valida_cupo_materia"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="valida_cupo_materia"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="valida_horario_materia"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="valida_horario_materia"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="valida_conflicto_horario"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="valida_conflicto_horario"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="ver_cupo_materia"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="ver_cupo_materia"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="ver_horario_materia"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="ver_horario_materia"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="ver_profesor_materia"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="ver_profesor_materia"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="coordinaciones"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="coordinaciones"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="tiporubros"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="tiporubros"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="valida_deuda"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="valida_deuda"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="ver_deduda"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="ver_deduda"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="bloquea_por_deuda"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="bloquea_por_deuda"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="valida_cuotas_rubro"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="valida_cuotas_rubro"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="num_cuotas_rubro"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="num_cuotas_rubro"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="monto_rubro_cuotas"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="monto_rubro_cuotas"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="valida_gratuidad"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="valida_gratuidad"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="porcentaje_perdidad_parcial_gratuidad"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="porcentaje_perdidad_parcial_gratuidad"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="porcentaje_perdidad_total_gratuidad"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="porcentaje_perdidad_total_gratuidad"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="valida_materias_maxima"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="valida_materias_maxima"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="num_materias_maxima"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="num_materias_maxima"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="valida_terminos"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="valida_terminos"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="terminos"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="terminos"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="mostrar_terminos_examenes"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="mostrar_terminos_examenes"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="terminos_examenes"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="terminos_examenes"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="valida_login"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="valida_login"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="valida_redirect_panel"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="valida_redirect_panel"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="valida_envio_mail"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="valida_envio_mail"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="ver_eliminar_matricula"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="ver_eliminar_matricula"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="puede_agregar_materia"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="puede_agregar_materia"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="seguridad_remove_materia"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="seguridad_remove_materia"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="num_matriculas"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="num_matriculas"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="num_materias_maxima_ultima_matricula"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="num_materias_maxima_ultima_matricula"]', self.$modalForm).prop('readonly', isFormReadOnly);

                if (isFormReadOnly)
                {
                    $(".action_new_coordinacion", self.$modalForm).hide();
                    $(".action_remove_coordinacion", self.$modalForm).hide();
                    $(".action_new_fecha", self.$modalForm).hide();
                    $(".action_remove_fecha_rurbo", self.$modalForm).hide();
                }
                else
                {
                    $(".action_new_coordinacion", self.$modalForm).show();
                    $(".action_remove_coordinacion", self.$modalForm).show();
                    $(".action_new_fecha", self.$modalForm).show();
                    $(".action_remove_fecha_rurbo", self.$modalForm).show();
                }
                $('[name="puede_agregar_materia_rubro_pagados"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="puede_agregar_materia_rubro_pagados"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="puede_eliminar_materia_rubro_pagados"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="puede_eliminar_materia_rubro_pagados"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="puede_agregar_materia_rubro_diferidos"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="puede_agregar_materia_rubro_diferidos"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="puede_eliminar_materia_rubro_diferidos"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="puede_eliminar_materia_rubro_diferidos"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="valida_proceos_matricula_especial"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="valida_proceos_matricula_especial"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="proceso_matricula_especial"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="proceso_matricula_especial"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="valida_uso_carnet"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="valida_uso_carnet"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="configuracion_carnet"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="configuracion_carnet"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="valida_configuracion_ultima_matricula"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="valida_configuracion_ultima_matricula"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="configuracion_ultima_matricula"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="configuracion_ultima_matricula"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="valida_rubro_acta_compromiso"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="valida_rubro_acta_compromiso"]', self.$modalForm).prop('readonly', isFormReadOnly);
            },
            formGetData:function(){
                var self = this;
                var data = {}
                data['id'] = $('[name="id"]', self.$modalForm).val();
                data['idpm'] = $('[name="idpm"]', self.$modalForm).val();
                data['action'] = $('[name="action"]', self.$modalForm).val();
                data['inicio_agregacion'] = $('[name="inicio_agregacion"]', self.$modalForm).val();
                data['limite_agregacion'] = $('[name="limite_agregacion"]', self.$modalForm).val();
                data['limite_retiro'] = $('[name="limite_retiro"]', self.$modalForm).val();
                data['fecha_inicio_agregacion'] = $('[name="fecha_inicio_agregacion"]', self.$modalForm).val();
                data['fecha_fin_agregacion'] = $('[name="fecha_fin_agregacion"]', self.$modalForm).val();
                data['fecha_fin_quitar'] = $('[name="fecha_fin_quitar"]', self.$modalForm).val();
                data['tipo'] = $('[name="tipo"]', self.$modalForm).val();
                data['tipocalculo'] = $('[name="tipocalculo"]', self.$modalForm).val();
                data['activo'] = $('[name="activo"]', self.$modalForm).is(':checked');
                data['valida_cronograma'] = $('[name="valida_cronograma"]', self.$modalForm).is(':checked');
                data['valida_coordinacion'] = $('[name="valida_coordinacion"]', self.$modalForm).is(':checked');
                data['valida_materia_carrera'] = $('[name="valida_materia_carrera"]', self.$modalForm).is(':checked');
                data['valida_seccion'] = $('[name="valida_seccion"]', self.$modalForm).is(':checked');
                data['valida_cupo_materia'] = $('[name="valida_cupo_materia"]', self.$modalForm).is(':checked');
                data['valida_horario_materia'] = $('[name="valida_horario_materia"]', self.$modalForm).is(':checked');
                data['valida_conflicto_horario'] = $('[name="valida_conflicto_horario"]', self.$modalForm).is(':checked');
                data['ver_cupo_materia'] = $('[name="ver_cupo_materia"]', self.$modalForm).is(':checked');
                data['ver_horario_materia'] = $('[name="ver_horario_materia"]', self.$modalForm).is(':checked');
                data['ver_profesor_materia'] = $('[name="ver_profesor_materia"]', self.$modalForm).is(':checked');
                data['valida_deuda'] = $('[name="valida_deuda"]', self.$modalForm).is(':checked');
                data['ver_deduda'] = $('[name="ver_deduda"]', self.$modalForm).is(':checked');
                data['bloquea_por_deuda'] = $('[name="bloquea_por_deuda"]', self.$modalForm).is(':checked');
                data['coordinacioness'] = JSON.stringify($('[name="coordinaciones"]', self.$modalForm).val());
                data['tiporubross'] = JSON.stringify($('[name="tiporubros"]', self.$modalForm).val());
                data['fecha_vencimiento_rubro'] = $('[name="fecha_vencimiento_rubro"]', self.$modalForm).val();
                var cronograma = []
                $('#dataCronograma tbody tr').each(function(index, value){
                    var $_tr = $(this);
                    var data = $_tr.data();
                    cronograma.push(data.objCronograma);
                });
                data['cronograma'] = JSON.stringify(cronograma)
                var fechas = []
                $('#dataFechaCuotas tbody tr').each(function(index, value){
                    var $_tr = $(this);
                    var data = $_tr.data();
                    fechas.push(data.objFecha);
                });
                data['valida_cuotas_rubro'] = $('[name="valida_cuotas_rubro"]', self.$modalForm).is(':checked');
                data['num_cuotas_rubro'] = $('[name="num_cuotas_rubro"]', self.$modalForm).val();
                data['monto_rubro_cuotas'] = $('[name="monto_rubro_cuotas"]', self.$modalForm).val();
                data['fechas'] = JSON.stringify(fechas)
                data['valida_gratuidad'] = $('[name="valida_gratuidad"]', self.$modalForm).is(':checked');
                data['porcentaje_perdidad_parcial_gratuidad'] = $('[name="porcentaje_perdidad_parcial_gratuidad"]', self.$modalForm).val();
                data['porcentaje_perdidad_total_gratuidad'] = $('[name="porcentaje_perdidad_total_gratuidad"]', self.$modalForm).val();
                data['valida_materias_maxima'] = $('[name="valida_materias_maxima"]', self.$modalForm).is(':checked');
                data['num_materias_maxima'] = $('[name="num_materias_maxima"]', self.$modalForm).val();
                data['valida_terminos'] = $('[name="valida_terminos"]', self.$modalForm).is(':checked');
                data['terminos'] = self.terminos.getData();
                data['mostrar_terminos_examenes'] = $('[name="mostrar_terminos_examenes"]', self.$modalForm).is(':checked');
                data['terminos_examenes'] = self.terminos_examenes.getData();
                data['valida_login'] = $('[name="valida_login"]', self.$modalForm).is(':checked');
                data['valida_redirect_panel'] = $('[name="valida_redirect_panel"]', self.$modalForm).is(':checked');
                data['valida_envio_mail'] = $('[name="valida_envio_mail"]', self.$modalForm).is(':checked');
                data['ver_eliminar_matricula'] = $('[name="ver_eliminar_matricula"]', self.$modalForm).is(':checked');
                data['puede_agregar_materia'] = $('[name="puede_agregar_materia"]', self.$modalForm).is(':checked');
                data['seguridad_remove_materia'] = $('[name="seguridad_remove_materia"]', self.$modalForm).is(':checked');
                data['num_matriculas'] = $('[name="num_matriculas"]', self.$modalForm).val();
                data['num_materias_maxima_ultima_matricula'] = $('[name="num_materias_maxima_ultima_matricula"]', self.$modalForm).val();
                data['puede_agregar_materia_rubro_pagados'] = $('[name="puede_agregar_materia_rubro_pagados"]', self.$modalForm).is(':checked');
                data['puede_eliminar_materia_rubro_pagados'] = $('[name="puede_eliminar_materia_rubro_pagados"]', self.$modalForm).is(':checked');
                data['puede_agregar_materia_rubro_diferidos'] = $('[name="puede_agregar_materia_rubro_diferidos"]', self.$modalForm).is(':checked');
                data['puede_eliminar_materia_rubro_diferidos'] = $('[name="puede_eliminar_materia_rubro_diferidos"]', self.$modalForm).is(':checked');
                data['valida_proceos_matricula_especial'] = $('[name="valida_proceos_matricula_especial"]', self.$modalForm).is(':checked');
                data['proceso_matricula_especial'] = $('[name="proceso_matricula_especial"]', self.$modalForm).val();
                data['valida_uso_carnet'] = $('[name="valida_uso_carnet"]', self.$modalForm).is(':checked');
                data['configuracion_carnet'] = $('[name="configuracion_carnet"]', self.$modalForm).val();
                data['valida_configuracion_ultima_matricula'] = $('[name="valida_configuracion_ultima_matricula"]', self.$modalForm).is(':checked');
                data['valida_rubro_acta_compromiso'] = $('[name="valida_rubro_acta_compromiso"]', self.$modalForm).is(':checked');
                data['configuracion_ultima_matricula'] = $('[name="configuracion_ultima_matricula"]', self.$modalForm).val();
                return data;
            },
            actionSave: function (){
                var self = this;
                $("#frmAcademicPeriodMatriculacion", self.$modalForm).validationEngine('attach',{ scroll: false });
                var valid = $("#frmAcademicPeriodMatriculacion", self.$modalForm).validationEngine('validate', { scroll: false });
                if (!valid){
                    setTimeout(function() {
                        $('.help-text', self.$modalForm).each(function () {
                            var field = $(this);
                            if (field.attr('alert')) {
                                field.html(field.attr('alert'));
                            } else {
                                field.html('');
                            }
                        });
                    }, 8000);
                    desbloqueointerface();
                    return false;
                }
                $('.datepicker', self.$modalForm).css({"display": "none"});
                $('.bootstrap-timepicker-widget', self.$modalForm).css({"display": "none"});

                $('.controls input', self.$modalForm).each(function(){
                    if ($(this).attr('type')=='text'){
                        $(this).val($(this).val().trim());
                    }
                    if ($(this).attr('type')!='file'){
                        if ($(this).css('text-transform')=='uppercase'){
                            if ($(this).attr('type')!='password'){
                                $(this).val($(this).val().toUpperCase());
                            }
                        }
                    }
                });

                var aData = self.formGetData();
                bloqueointerface();
                $.ajax({
                    type: "POST",
                    url: "/adm_sistemas/academic_period",
                    data: aData,
                    success: function(data) {
                        if (data.result == 'ok') {
                            ControllerAcademicPeriod.$table.dataTable().fnDraw(false);
                            desbloqueointerface();
                            NotificationJG.success(data.mensaje);

                            self.close();

                        }
                        else{
                            NotificationJG.error(data.mensaje);
                            desbloqueointerface();
                        }

                    },
                    error: function() {
                        desbloqueointerface();
                        NotificationJG.error("Error al enviar los datos.");
                    },
                    dataType: "json",
                });
            },
        };

        var uiCronogramaModal = {
            init: function () {
                var self = this;
                self.$modalForm = $('#modalCronograma');
                $('.action-close', self.$modalForm).click(function(){
                    self.close();
                });
                $('.action-edit', self.$modalForm).click(function(){
                    self.setFormType('edit');
                });
                $('.action-save', self.$modalForm).click(function (){
                    self.actionSave();
                });
            },
            processModalInit: function (){
                var self = this;
                $("#frmAcademicPeriodCronograma", self.$modalForm).validationEngine({autoHidePrompt:true, autoHideDelay:1000 });
                $("#id_fechainicio, #id_fechafin", self.$modalForm).datepicker({format:"yyyy-mm-dd"}).on('changeDate', function(ev){ $(this).datepicker('hide'); });
                $("#id_fechainicio, #id_fechafin, #id_coordinaciones", self.$modalForm).css({'text-transform': 'none'}).addClass("validate[required]");
                var eliminar_alertas = function(){
                    setInterval(function() {
                        $('.help-text', $("#frmAcademicPeriodCronograma")).html("");
                    }, 8000);
                };

                eliminar_alertas();
                $("#id_coordinacion", self.$modalForm).select2({minimumResultsForSearch: 20, width: '100%', dropdownParent: self.$modalForm});

            },
            close: function (){
                var self = this;
                self.$modalForm.modal('hide');
            },
            open: function(type, data){
                bloqueointerface();
                var self = this;
                self.setFormType(type);
                self.formSetData(data);
                var h = $(window).height()-450;
                desbloqueointerface();
                //$(".modal-body", self.$modalForm).html(data.html);
                self.processModalInit();
                self.$modalForm.modal({backdrop:'static', width: '50%'}).modal('show');
            },
            setFormType: function( type /* new, edit, view */ )
            {
                var self = this;

                if( type == 'new' )
                {
                    $('.modal-header span', self.$modalForm).html('Nuevo');

                    $('.action-save', self.$modalForm).show();
                    $('.action-edit', self.$modalForm).hide();
                    self.setFormReadOnly(false);
                }
                else if( type == 'edit' )
                {
                    $('.modal-header span', self.$modalForm).html('Editar');

                    $('.action-save', self.$modalForm).show();
                    $('.action-edit', self.$modalForm).hide();
                    self.setFormReadOnly(false);
                }
                else if( type == 'view' )
                {
                    $('.modal-header span', self.$modalForm).html('Ver');

                    $('.action-save', self.$modalForm).hide();
                    $('.action-edit', self.$modalForm).show();
                    self.setFormReadOnly(true);
                }
            },
            setFormReadOnly: function( isFormReadOnly )
            {
                var self = this;

                $('[name="cordinacion"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="cordinacion"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="fechainicio"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="fechainicio"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="fechafin"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="fechafin"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="activo"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="activo"]', self.$modalForm).prop('readonly', isFormReadOnly);
            },
            formSetData: function(data){
                //console.log(data);
                var self = this;

                var id = (data == null) ? 0 : data.id;
                var coordinacion = (data == null) ? 0 : data.coordinacion;
                var coordinacion_id = (data == null) ? 0 : data.coordinacion_id;
                var fechainicio = (data == null) ? '' : data.fechainicio;
                var fechafin = (data == null) ? '' : data.fechafin;
                var activo = (data == null) ? false : data.activo;

                $('[name="id"]', self.$modalForm).val(id);
                $('[name="cordinacion"]', self.$modalForm).val(coordinacion_id).change();
                //$('[name="cordinaciones"]', self.$modalForm).select2("val", coordinacion_id).trigger("change");;
                $('[name="fechainicio"]', self.$modalForm).val(fechainicio);
                $('[name="fechafin"]', self.$modalForm).val(fechafin);
                $('[name="activo"]', self.$modalForm).prop('checked', activo);

            },
            formGetData:function(){
                var self = this;
                var data = {}
                data['id'] = $('[name="id"]', self.$modalForm).val();
                data['coordinacion_id'] = $('[name="coordinacion"]', self.$modalForm).val();
                data['coordinacion'] = $('select[name="coordinacion"] option:selected', self.$modalForm).text();
                data['fechainicio'] = $('[name="fechainicio"]', self.$modalForm).val();
                data['fechafin'] = $('[name="fechafin"]', self.$modalForm).val();
                data['activo'] = $('[name="activo"]', self.$modalForm).is(':checked');
                return data;
            },
            actionSave: function (){
                var self = this;
                bloqueointerface();
                $("#frmAcademicPeriodCronograma", self.$modalForm).validationEngine('attach',{ scroll: false });
                var valid = $("#frmAcademicPeriodCronograma", self.$modalForm).validationEngine('validate', { scroll: false });
                if (!valid){
                    setTimeout(function() {
                        $('.help-text', self.$modalForm).each(function () {
                            var field = $(this);
                            if (field.attr('alert')) {
                                field.html(field.attr('alert'));
                            } else {
                                field.html('');
                            }
                        });
                    }, 8000);
                    desbloqueointerface();
                    return false;
                }
                $('.datepicker', self.$modalForm).css({"display": "none"});
                $('.bootstrap-timepicker-widget', self.$modalForm).css({"display": "none"});

                $('.controls input', self.$modalForm).each(function(){
                    if ($(this).attr('type')=='text'){
                        $(this).val($(this).val().trim());
                    }
                    if ($(this).attr('type')!='file'){
                        if ($(this).css('text-transform')=='uppercase'){
                            if ($(this).attr('type')!='password'){
                                $(this).val($(this).val().toUpperCase());
                            }
                        }
                    }
                });

                if ($('[name="coordinaciones"]', self.$modalForm).val() == 0){
                    smoke.alert('Seleccione una coordinación');
                    desbloqueointerface();
                    return false;
                }

                var aData = self.formGetData();
                //console.log(aData);
                uiMatriculacionModal.addDataCronograma(aData);
                self.close();
                desbloqueointerface();
            },
        };

        var uiFechaRubroModal = {
            init: function () {
                var self = this;
                self.$modalForm = $('#modalFechaRubro');
                $('.action-close', self.$modalForm).click(function(){
                    self.close();
                });
                $('.action-edit', self.$modalForm).click(function(){
                    self.setFormType('edit');
                });
                $('.action-save', self.$modalForm).click(function (){
                    self.actionSave();
                });
            },
            processModalInit: function (){
                var self = this;
                $("#frmFechaRubro", self.$modalForm).validationEngine({autoHidePrompt:true, autoHideDelay:1000 });
                $("#id_fecha", self.$modalForm).datepicker({format:"yyyy-mm-dd"}).on('changeDate', function(ev){ $(this).datepicker('hide'); });
                $("#id_fecha, #id_cuota", self.$modalForm).css({'text-transform': 'none'}).addClass("validate[required]");
                $('#id_cuota').blur(function(){
                    numerico($(this),0,0,0);
                });
                var eliminar_alertas = function(){
                    setInterval(function() {
                        $('.help-text', $("#frmFechaRubro")).html("");
                    }, 8000);
                };

                eliminar_alertas();

            },
            close: function (){
                var self = this;
                self.$modalForm.modal('hide');
            },
            open: function(type, data){
                bloqueointerface();
                var self = this;
                self.setFormType(type);
                self.formSetData(data);
                var h = $(window).height()-450;
                desbloqueointerface();
                //$(".modal-body", self.$modalForm).html(data.html);
                self.processModalInit();
                self.$modalForm.modal({backdrop:'static', width: '50%'}).modal('show');
            },
            setFormType: function( type /* new, edit, view */ )
            {
                var self = this;

                if( type == 'new' )
                {
                    $('.modal-header span', self.$modalForm).html('Nuevo');

                    $('.action-save', self.$modalForm).show();
                    $('.action-edit', self.$modalForm).hide();
                    self.setFormReadOnly(false);
                }
                else if( type == 'edit' )
                {
                    $('.modal-header span', self.$modalForm).html('Editar');

                    $('.action-save', self.$modalForm).show();
                    $('.action-edit', self.$modalForm).hide();
                    self.setFormReadOnly(false);
                }
                else if( type == 'view' )
                {
                    $('.modal-header span', self.$modalForm).html('Ver');

                    $('.action-save', self.$modalForm).hide();
                    $('.action-edit', self.$modalForm).show();
                    self.setFormReadOnly(true);
                }
            },
            setFormReadOnly: function( isFormReadOnly )
            {
                var self = this;

                $('[name="fecha"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="fecha"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="cuota"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="cuota"]', self.$modalForm).prop('readonly', isFormReadOnly);
            },
            formSetData: function(data){
                //console.log(data);
                var self = this;

                var id = (data == null) ? 0 : data.id;
                var cuota = (data == null) ? 0 : data.coordinacion;
                var fecha = (data == null) ? '' : data.fechainicio;

                $('[name="id"]', self.$modalForm).val(id);
                $('[name="cuota"]', self.$modalForm).val(cuota);
                $('[name="fecha"]', self.$modalForm).val(fecha);

            },
            formGetData:function(){
                var self = this;
                var data = {}
                data['id'] = $('[name="id"]', self.$modalForm).val();
                data['cuota'] = $('[name="cuota"]', self.$modalForm).val();
                data['fecha'] = $('[name="fecha"]', self.$modalForm).val();
                return data;
            },
            actionSave: function (){
                var self = this;
                bloqueointerface();
                $("#frmFechaRubro", self.$modalForm).validationEngine('attach',{ scroll: false });
                var valid = $("#frmFechaRubro", self.$modalForm).validationEngine('validate', { scroll: false });
                if (!valid){
                    setTimeout(function() {
                        $('.help-text', self.$modalForm).each(function () {
                            var field = $(this);
                            if (field.attr('alert')) {
                                field.html(field.attr('alert'));
                            } else {
                                field.html('');
                            }
                        });
                    }, 8000);
                    desbloqueointerface();
                    return false;
                }
                $('.datepicker', self.$modalForm).css({"display": "none"});
                $('.bootstrap-timepicker-widget', self.$modalForm).css({"display": "none"});

                $('.controls input', self.$modalForm).each(function(){
                    if ($(this).attr('type')=='text'){
                        $(this).val($(this).val().trim());
                    }
                    if ($(this).attr('type')!='file'){
                        if ($(this).css('text-transform')=='uppercase'){
                            if ($(this).attr('type')!='password'){
                                $(this).val($(this).val().toUpperCase());
                            }
                        }
                    }
                });

                if ($('[name="cuota"]', self.$modalForm).val() <= 0){
                    smoke.alert('Favor ingrese una cuota mayor a cero');
                    desbloqueointerface();
                    return false;
                }
                let isValid = true;
                $('#dataFechaCuotas tbody tr').each(function(index, value){
                    var $_tr = $(this);

                    var data = $_tr.data();
                    //console.log(data);
                    if( data.objFecha.cuota == $('[name="cuota"]', self.$modalForm).val() ) {
                        smoke.alert('Número de cuota ya existe en el registro, favor ingrese otra cuota');
                        desbloqueointerface();
                        isValid = false;
                        return false;
                    }
                    if( data.objFecha.fecha == $('[name="fecha"]', self.$modalForm).val() ) {
                        smoke.alert('Fecha ya existe en el registro, favor ingrese otra fecha');
                        desbloqueointerface();
                        isValid = false;
                        return false;
                    }
                });

                if (!isValid){
                    return false;
                }

                var aData = self.formGetData();
                //console.log(aData);
                uiMatriculacionModal.addDataFechaRubro(aData);
                self.close();
                desbloqueointerface();
            },
        };

        var uiNivelesModal = {
            init: function () {
                var self = this;
                self.$modalForm = $('#modalAcademicPeriodNiveles');
                self.terminos = null;
                $('.action-close', self.$modalForm).click(function () {
                    self.close();
                });
                $('.action-edit', self.$modalForm).click(function () {
                    self.setFormType('edit');
                });
            },
            close: function (){
                var self = this;
                self.$modalForm.modal('hide');
            },
            open: function(type, id){
                bloqueointerface();
                var self = this;
                self.setFormType(type);
                var h = $(window).height()-450;
                $.ajax({
                    type: "GET",
                    url: "/adm_sistemas/academic_period",
                    data: {'action': 'loadFormNiveles', 'typeForm': type, 'id': id},
                    success: function(data) {
                        if (data.result == 'ok') {
                            desbloqueointerface();
                            $(".modal-body", self.$modalForm).html(data.html);
                            self.$modalForm.modal({backdrop:'static', width: '90%'}).modal('show');
                        } else {
                            desbloqueointerface();
                            NotificationJG.error(data.mensaje);
                        }
                    },
                    error: function() {
                        desbloqueointerface();
                        NotificationJG.error("Error al enviar los datos.");
                    },
                    dataType: "json",
                });
            },
            setFormType: function( type /* new, edit, view */ )
            {
                var self = this;

                if( type == 'new' )
                {
                    $('.modal-header span', self.$modalForm).html('Nuevo');

                    //$('.action-save', self.$modalForm).show();
                    //$('.action-edit', self.$modalForm).hide();
                    self.setFormReadOnly(false);
                }
                else if( type == 'edit' )
                {
                    $('.modal-header span', self.$modalForm).html('Editar');

                    //$('.action-save', self.$modalForm).show();
                    //$('.action-edit', self.$modalForm).hide();
                    self.setFormReadOnly(false);
                }
                else if( type == 'view' )
                {
                    $('.modal-header span', self.$modalForm).html('Ver');

                    //$('.action-save', self.$modalForm).hide();
                    //$('.action-edit', self.$modalForm).show();
                    self.setFormReadOnly(true);
                }
            },
            setFormReadOnly: function( isFormReadOnly )
            {
                var self = this;
            },
        };

        var uiFinancieroModal = {
            init: function () {
                var self = this;
                self.$modalForm = $('#modalAcademicPeriodFinanciero');
                self.terminos = null;

                $('.action-close', self.$modalForm).click(function () {
                    self.close();
                });

                $('.action-edit', self.$modalForm).click(function () {
                    self.setFormType('edit');
                });

                $('.action-save', self.$modalForm).click(function () {
                    self.actionSave();
                });



            },
            close: function (){
                var self = this;
                self.$modalForm.modal('hide');
            },
            addDataGrupoSocioeconomico: function (objGrupo){
                var self = this;

                if (objGrupo.id == 0) {
                    objGrupo.id = (new Date()).getTime();
                }
                var tr = null;
                $('#dataGrupoSocioeconomico tbody tr').each(function(index, value){
                    var $_tr = $(this);

                    var data = $_tr.data();
                    if( data.objGrupo.id == objGrupo.id ) {
                        tr = $_tr;
                    }
                });

                var isNew = (tr == null);
                if( isNew ) {
                    tr = $('#el-templates [element="table-row-grupo-socioeconomico"] tr').clone();
                }

                var $tr = $(tr);
                // console.log($tr);
                $tr.data({objGrupo:objGrupo});
                $('td:nth-child(1)', $tr).html(objGrupo.gruposocioeconomico);
                $('td:nth-child(2)', $tr).html(objGrupo.valor);
                $('td:nth-child(3) .action_remove_grupo_socioeconomico', $tr).off('click').on('click', function(){
                    self.removeGrupoSocioeconomico(objGrupo);
                });
                $('td:nth-child(3) .action_edit_grupo_socioeconomico', $tr).off('click').on('click', function(){
                    uiGrupoSocioeconmicoModal.open('edit', objGrupo);
                });

                $('#dataGrupoSocioeconomico > tbody').append($tr);

            },
            removeGrupoSocioeconomico: function (objGrupo){
                Confirm.question('Desea eliminar el grupo socioeconomico seleccionada?', function () {
                    $('#dataGrupoSocioeconomico tbody tr').each(function(index, value){
                        var $_tr = $(this);
                        var data = $_tr.data();
                        if( data.objGrupo.id == objGrupo.id ) {
                            $_tr.remove();
                            NotificationJG.success("Se elimino correctamente.");
                        }
                    });
                }, function () {
                    NotificationJG.info("Enhorabuena el registro esta salvado.!");
                });
            },
            orderData: function(){
                var self = this;
                let dataGrupo = []

                $('#dataGrupoSocioeconomico tbody tr').each(function(index, value){
                    var $_tr = $(this);

                    var data = $_tr.data();
                    dataGrupo.push(data);
                });
                //console.log(aaData);

                let aData= [];
                $.each(dataGrupo, function (index, value){
                    //console.log(value.objGrupo);
                    aData.push(value.objGrupo);
                });
                console.table(aData);
                aData.sort(((a, b) => a.gruposocioeconomico_id - b.gruposocioeconomico_id));
                console.table(aData);

                $.each(aData, function (index, value){
                    self.addDataGrupoSocioeconomico(value);
                });
            },
            processModalInit: function (){
                var self = this;
                $("#frmAcademicPeriodFinanciero", self.$modalForm).validationEngine({autoHidePrompt:true, autoHideDelay:1000 });
                //$("#id_fecha", self.$modalForm).datepicker({format:"yyyy-mm-dd"}).on('changeDate', function(ev){ $(this).datepicker('hide'); });
                //$("#id_fecha, #id_cuota", self.$modalForm).css({'text-transform': 'none'}).addClass("validate[required]");
                /*$('#id_cuota').blur(function(){
                    numerico($(this),0,0,0);
                });*/
                var eliminar_alertas = function(){
                    setInterval(function() {
                        $('.help-text', $("#frmAcademicPeriodFinanciero")).html("");
                    }, 8000);
                };

                eliminar_alertas();
                $('.action_new_grupo_socioeconomico', self.$modalForm).click(function (){
                    uiGrupoSocioeconmicoModal.open('new', 0);
                });
                $('.action_new_periodo_malla', self.$modalForm).click(function (){
                    uiPeriodoMallaModal.open('new', 0, $(this).attr('idp'));
                });

            },

            addDataPeriodoMalla:function (objPeriodoMalla){
                var self = this;

                if (objPeriodoMalla.id == 0) {
                    objPeriodoMalla.id = (new Date()).getTime();
                }
                var tr = null;
                $('#dataPeriodoMalla tbody tr').each(function(index, value){
                    var $_tr = $(this);

                    var data = $_tr.data();
                    if( data.objPeriodoMalla.id == objPeriodoMalla.id ) {
                        tr = $_tr;
                    }
                });

                var isNew = (tr == null);
                if( isNew ) {
                    tr = $('#el-templates [element="table-row-periodo-malla"] tr').clone();
                }

                var $tr = $(tr);
                // console.log($tr);
                $tr.data({objPeriodoMalla:objPeriodoMalla});
                $('td:nth-child(1)', $tr).html(objPeriodoMalla.malla);
                $('td:nth-child(2)', $tr).html('');
                $('td:nth-child(3)', $tr).html(objPeriodoMalla.tipocalculo);
                $('td:nth-child(4)', $tr).html(objPeriodoMalla.vct);
                $('td:nth-child(5) .action_edit_periodo_malla', $tr).off('click').on('click', function(){
                    let idp = $('[name="id"]', self.$modalForm).val();
                    uiPeriodoMallaModal.open('edit',objPeriodoMalla.id,idp);
                });
                $('#dataPeriodoMalla > tbody').append($tr);
            },
            open: function(type, id){
                bloqueointerface();
                var self = this;
                //console.log(type);
                self.setFormType(type);
                var h = $(window).height()-450;
                //self.$modalForm.modal({backdrop:'static', width: '90%'}).modal('show');
                $.ajax({
                    type: "GET",
                    url: "/adm_sistemas/academic_period",
                    data: {'action': 'loadFormFananciero', 'typeForm': type, 'id': id},
                    success: function(data) {
                        if (data.result == 'ok') {
                            desbloqueointerface();
                            $(".modal-body", self.$modalForm).html(data.html);

                            if(data.grupos.length > 0){
                                self.$modalForm.modal({backdrop:'static', width: '60%'}).modal('show');
                                $.each(data.grupos, function (index, value){
                                    //console.log(value);
                                    self.addDataGrupoSocioeconomico(value);
                                });
                                self.orderData();
                            }else{
                                self.$modalForm.modal({backdrop:'static', width: '90%'}).modal('show');
                                $.each(data.mallas, function (index, value){
                                    //console.log(value);
                                    self.addDataPeriodoMalla(value);
                                });
                                $(".action-save", self.$modalForm).hide()
                            }

                            self.processModalInit();

                        } else {
                            desbloqueointerface();
                            NotificationJG.error(data.mensaje);
                        }
                    },
                    error: function() {
                        desbloqueointerface();
                        NotificationJG.error("Error al enviar los datos.");
                    },
                    dataType: "json",
                });
            },
            setFormType: function( type /* new, edit, view */ ) {
                var self = this;

                if( type == 'new' )
                {
                    $('.modal-header span', self.$modalForm).html('Nuevo');

                    $('.action-save', self.$modalForm).show();
                    $('.action-edit', self.$modalForm).hide();
                    self.setFormReadOnly(false);
                }
                else if( type == 'edit' )
                {
                    $('.modal-header span', self.$modalForm).html('Editar');

                    $('.action-save', self.$modalForm).show();
                    $('.action-edit', self.$modalForm).hide();
                    self.setFormReadOnly(false);
                }
                else if( type == 'view' )
                {
                    $('.modal-header span', self.$modalForm).html('Ver');

                    $('.action-save', self.$modalForm).hide();
                    $('.action-edit', self.$modalForm).show();
                    self.setFormReadOnly(true);
                }
            },
            setFormReadOnly: function( isFormReadOnly ) {
                var self = this;
                $('[name="porcentaje_gratuidad"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="porcentaje_gratuidad"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="valor_maximo"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="valor_maximo"]', self.$modalForm).prop('readonly', isFormReadOnly);

                if (isFormReadOnly){
                    $(".action_new_grupo_socioeconomico", self.$modalForm).hide();
                    $(".action_remove_grupo_socioeconomico", self.$modalForm).hide();
                    $(".action_edit_grupo_socioeconomico", self.$modalForm).hide();
                }else{
                    $(".action_new_grupo_socioeconomico", self.$modalForm).show();
                    $(".action_remove_grupo_socioeconomico", self.$modalForm).show();
                    $(".action_edit_grupo_socioeconomico", self.$modalForm).show();
                }
            },
            formGetData:function(){
                var self = this;
                var data = {}
                data['id'] = $('[name="id"]', self.$modalForm).val();
                data['action'] = $('[name="action"]', self.$modalForm).val();
                data['porcentaje_gratuidad'] = $('[name="porcentaje_gratuidad"]', self.$modalForm).val();
                data['valor_maximo'] = $('[name="valor_maximo"]', self.$modalForm).val();
                var grupos = []
                $('#dataGrupoSocioeconomico tbody tr').each(function(index, value){
                    var $_tr = $(this);
                    var data = $_tr.data();
                    grupos.push(data.objGrupo);
                });
                data['grupos'] = JSON.stringify(grupos)
                //console.log(data);
                return data;
            },
            actionSave: function (){
                var self = this;
                $("#frmAcademicPeriodFinanciero", self.$modalForm).validationEngine('attach',{ scroll: false });
                var valid = $("#frmAcademicPeriodFinanciero", self.$modalForm).validationEngine('validate', { scroll: false });
                if (!valid){
                    setTimeout(function() {
                        $('.help-text', self.$modalForm).each(function () {
                            var field = $(this);
                            if (field.attr('alert')) {
                                field.html(field.attr('alert'));
                            } else {
                                field.html('');
                            }
                        });
                    }, 8000);
                    desbloqueointerface();
                    return false;
                }
                $('.datepicker', self.$modalForm).css({"display": "none"});
                $('.bootstrap-timepicker-widget', self.$modalForm).css({"display": "none"});

                $('.controls input', self.$modalForm).each(function(){
                    if ($(this).attr('type')=='text'){
                        $(this).val($(this).val().trim());
                    }
                    if ($(this).attr('type')!='file'){
                        if ($(this).css('text-transform')=='uppercase'){
                            if ($(this).attr('type')!='password'){
                                $(this).val($(this).val().toUpperCase());
                            }
                        }
                    }
                });

                var aData = self.formGetData();
                bloqueointerface();
                $.ajax({
                    type: "POST",
                    url: "/adm_sistemas/academic_period",
                    data: aData,
                    success: function(data) {
                        if (data.result == 'ok') {
                            ControllerAcademicPeriod.$table.dataTable().fnDraw(false);
                            desbloqueointerface();
                            NotificationJG.success(data.mensaje);
                            self.close();
                        }
                        else{
                            NotificationJG.error(data.mensaje);
                            desbloqueointerface();
                        }

                    },
                    error: function() {
                        desbloqueointerface();
                        NotificationJG.error("Error al enviar los datos.");
                    },
                    dataType: "json",
                });
            },
        };

        var uiGrupoSocioeconmicoModal = {
            init: function () {
                var self = this;
                self.$modalForm = $('#modalGrupoSocioeconomico');
                $('.action-close', self.$modalForm).click(function () {
                    self.close();
                });
                $('.action-edit', self.$modalForm).click(function () {
                    self.setFormType('edit');
                });

                $('.action-save', self.$modalForm).click(function () {
                    self.actionSave();
                });
            },
            close: function (){
                var self = this;
                self.$modalForm.modal('hide');
            },
            processModalInit: function (){
                var self = this;
                $("#frmGrupoSocioeconomico", self.$modalForm).validationEngine({autoHidePrompt:true, autoHideDelay:1000 });
                //$("#id_fecha", self.$modalForm).datepicker({format:"yyyy-mm-dd"}).on('changeDate', function(ev){ $(this).datepicker('hide'); });
                $("#id_grupo_socioeconomico, #id_valor", self.$modalForm).css({'text-transform': 'none'}).addClass("validate[required]");
                $('#id_valor').blur(function(){
                    numerico($(this),0,100,2);
                });
                var eliminar_alertas = function(){
                    setInterval(function() {
                        $('.help-text', $("#frmGrupoSocioeconomico")).html("");
                    }, 8000);
                };

                eliminar_alertas();
                $("#id_grupo_socioeconomico",  $('#modalGrupoSocioeconomico')).select2({minimumResultsForSearch: 20, width: '100%', dropdownParent: $('#modalGrupoSocioeconomico') });


            },
            open: function(type, data){
                bloqueointerface();
                var self = this;
                self.setFormType(type);
                if (type == 'new'){
                    $("#id_grupo_socioeconomico", self.$modalForm).val(0);
                    $("#id_grupo_socioeconomico", self.$modalForm).trigger('change');
                    $("[name='id']", self.$modalForm).val(0);
                    $("[name='valor']", self.$modalForm).val(0.0);
                }else{
                    $("#id_grupo_socioeconomico", self.$modalForm).val(data.gruposocioeconomico_id);
                    $("#id_grupo_socioeconomico", self.$modalForm).trigger('change');
                    $("[name='id']", self.$modalForm).val(data.id);
                    $("[name='valor']", self.$modalForm).val(data.valor);
                    $('[name="grupo_socioeconomico"]', self.$modalForm).prop('disabled', true);
                    $('[name="grupo_socioeconomico"]', self.$modalForm).prop('readonly', true);
                }
                self.$modalForm.modal({backdrop:'static', width: '40%'}).modal('show');
                desbloqueointerface();
                self.processModalInit();

            },
            setFormType: function( type /* new, edit, view */ )
            {
                var self = this;

                if( type == 'new' )
                {
                    $('.modal-header span', self.$modalForm).html('Nuevo');

                    $('.action-save', self.$modalForm).show();
                    $('.action-edit', self.$modalForm).hide();
                    self.setFormReadOnly(false);
                }
                else if( type == 'edit' )
                {
                    $('.modal-header span', self.$modalForm).html('Editar');

                    $('.action-save', self.$modalForm).show();
                    $('.action-edit', self.$modalForm).hide();
                    self.setFormReadOnly(false);
                }
                else if( type == 'view' )
                {
                    $('.modal-header span', self.$modalForm).html('Ver');

                    $('.action-save', self.$modalForm).hide();
                    $('.action-edit', self.$modalForm).show();
                    self.setFormReadOnly(true);
                }
            },
            setFormReadOnly: function( isFormReadOnly )
            {
                var self = this;
                $('[name="grupo_socioeconomico"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="grupo_socioeconomico"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="valor"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="valor"]', self.$modalForm).prop('readonly', isFormReadOnly);
            },
            formGetData:function(){
                var self = this;
                var data = {}
                data['id'] = $('[name="id"]', self.$modalForm).val();
                data['gruposocioeconomico_id'] = $('[name="grupo_socioeconomico"]', self.$modalForm).val();
                data['gruposocioeconomico'] = $('[name="grupo_socioeconomico"]', self.$modalForm).find('option:selected').text();
                data['valor'] = $('[name="valor"]', self.$modalForm).val();
                return data;
            },
            actionSave: function (){
                var self = this;
                bloqueointerface();
                $("#frmGrupoSocioeconomico", self.$modalForm).validationEngine('attach',{ scroll: false });
                var valid = $("#frmGrupoSocioeconomico", self.$modalForm).validationEngine('validate', { scroll: false });
                if (!valid){
                    setTimeout(function() {
                        $('.help-text', self.$modalForm).each(function () {
                            var field = $(this);
                            if (field.attr('alert')) {
                                field.html(field.attr('alert'));
                            } else {
                                field.html('');
                            }
                        });
                    }, 8000);
                    desbloqueointerface();
                    return false;
                }
                $('.datepicker', self.$modalForm).css({"display": "none"});
                $('.bootstrap-timepicker-widget', self.$modalForm).css({"display": "none"});

                $('.controls input', self.$modalForm).each(function(){
                    if ($(this).attr('type')=='text'){
                        $(this).val($(this).val().trim());
                    }
                    if ($(this).attr('type')!='file'){
                        if ($(this).css('text-transform')=='uppercase'){
                            if ($(this).attr('type')!='password'){
                                $(this).val($(this).val().toUpperCase());
                            }
                        }
                    }
                });

                if ($('[name="grupo_socioeconomico"]', self.$modalForm).val() == 0){
                    smoke.alert('Seleccione un grupo socioeconomico');
                    desbloqueointerface();
                    return false;
                }
                if ($('[name="valor"]', self.$modalForm).val() <= 0){
                    smoke.alert('Ingrese un valor mayor a cero del grupo socioeconomico');
                    desbloqueointerface();
                    return false;
                }

                var aData = self.formGetData();
                let validData = true
                $('#dataGrupoSocioeconomico tbody tr').each(function(index, value){
                    var $_tr = $(this);
                    var data = $_tr.data();
                    //console.log(data);
                    if( parseInt(data.objGrupo.gruposocioeconomico_id) == parseInt(aData.gruposocioeconomico_id) && parseInt(aData.id) == 0) {
                        //$_tr.remove();
                        validData = false;
                    }
                });
                //console.log(validData);
                if (!validData){
                    NotificationJG.error("Grupo socioeconomico se eucuentra ingresado, seleccione otro");
                    desbloqueointerface();
                    return false;
                }
                //console.log(aData);
                uiFinancieroModal.addDataGrupoSocioeconomico(aData);
                uiFinancieroModal.orderData();
                self.close();
                desbloqueointerface();
            },

        };

        var uiAcademiaModal = {
            init: function () {
                var self = this;
                self.$modalForm = $('#modalAcademicPeriodAcademia');
                $('.action-close', self.$modalForm).click(function(){
                    self.close();
                });
                $('.action-edit', self.$modalForm).click(function(){
                    self.setFormType('edit');
                });
                $('.action-save', self.$modalForm).click(function (){
                    self.actionSave();
                });
            },
            processModalInit: function (){
                var self = this;
                $("#frmAcademicPeriodAcademia", self.$modalForm).validationEngine({autoHidePrompt:true, autoHideDelay:1000 });
                $('#id_version_cumplimiento_recurso, #id_num_dias_cambiar_asistencia_clase, #id_min_clases_apertura_antes_pro, #id_min_clases_apertura_despues_pro, #id_min_clases_apertura_antes_alu, #id_min_clases_apertura_despues_alu').keyup(function(){
                    numerico($(this),0,0,0);
                });
            },
            close: function (){
                var self = this;
                self.$modalForm.modal('hide');
            },
            open: function(type, id){
                bloqueointerface();
                var self = this;
                self.setFormType(type);
                var h = $(window).height()-450;
                $.ajax({
                    type: "GET",
                    url: "/adm_sistemas/academic_period",
                    data: {'action': 'loadFormAcademia', 'typeForm': type, 'id': id},
                    success: function(data) {
                        if (data.result == 'ok') {
                            desbloqueointerface();
                            $(".modal-body", self.$modalForm).html(data.html);
                            self.$modalForm.modal({backdrop:'static', width: '90%'}).modal('show');
                            self.processModalInit();
                        } else {
                            desbloqueointerface();
                            NotificationJG.error(data.mensaje);
                        }
                    },
                    error: function() {
                        desbloqueointerface();
                        NotificationJG.error("Error al enviar los datos.");
                    },
                    dataType: "json",
                });
            },
            setFormType: function( type /* new, edit, view */ )
            {
                var self = this;

                if( type == 'new' )
                {
                    $('.modal-header span', self.$modalForm).html('Nuevo');

                    $('.action-save', self.$modalForm).show();
                    $('.action-edit', self.$modalForm).hide();
                    self.setFormReadOnly(false);
                }
                else if( type == 'edit' )
                {
                    $('.modal-header span', self.$modalForm).html('Editar');

                    $('.action-save', self.$modalForm).show();
                    $('.action-edit', self.$modalForm).hide();
                    self.setFormReadOnly(false);
                }
                else if( type == 'view' )
                {
                    $('.modal-header span', self.$modalForm).html('Ver');

                    $('.action-save', self.$modalForm).hide();
                    $('.action-edit', self.$modalForm).show();
                    self.setFormReadOnly(true);
                }
            },
            setFormReadOnly: function( isFormReadOnly )
            {
                var self = this;
                $('[name="fecha_limite_horario_tutoria"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="fecha_limite_horario_tutoria"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="version_cumplimiento_recurso"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="version_cumplimiento_recurso"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="cierra_materia"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="cierra_materia"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="periodos_relacionados"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="periodos_relacionados"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="tipo_modalidad"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="tipo_modalidad"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="utiliza_asistencia_ws"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="utiliza_asistencia_ws"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="utiliza_asistencia_redis"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="utiliza_asistencia_redis"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="puede_cerrar_clase"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="puede_cerrar_clase"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="puede_eliminar_clase"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="puede_eliminar_clase"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="puede_editar_contenido_academico_clase"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="puede_editar_contenido_academico_clase"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="puede_cambiar_asistencia_clase"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="puede_cambiar_asistencia_clase"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="num_dias_cambiar_asistencia_clase"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="num_dias_cambiar_asistencia_clase"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="valida_asistencia_pago"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="valida_asistencia_pago"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="valida_clases_horario_estricto"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="valida_clases_horario_estricto"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="min_clases_apertura_antes_pro"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="min_clases_apertura_antes_pro"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="min_clases_apertura_despues_pro"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="min_clases_apertura_despues_pro"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="min_clases_apertura_antes_alu"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="min_clases_apertura_antes_alu"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="min_clases_apertura_despues_alu"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="min_clases_apertura_despues_alu"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="puede_solicitar_clase_diferido_pro"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="puede_solicitar_clase_diferido_pro"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="proceso_solicitud_clase_diferido_pro"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="proceso_solicitud_clase_diferido_pro"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="valida_asistencia_in_home"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="valida_asistencia_in_home"]', self.$modalForm).prop('readonly', isFormReadOnly);
            },
            formGetData:function(){
                var self = this;
                var data = {}
                data['id'] = $('[name="id"]', self.$modalForm).val();
                data['action'] = $('[name="action"]', self.$modalForm).val();
                data['fecha_limite_horario_tutoria'] = $('[name="fecha_limite_horario_tutoria"]', self.$modalForm).val();
                data['version_cumplimiento_recurso'] = $('[name="version_cumplimiento_recurso"]', self.$modalForm).val();
                data['cierra_materia'] = $('[name="cierra_materia"]', self.$modalForm).is(':checked');
                data['tipo_modalidad'] = $('[name="tipo_modalidad"]', self.$modalForm).val();
                data['utiliza_asistencia_ws'] = $('[name="utiliza_asistencia_ws"]', self.$modalForm).is(':checked');
                data['utiliza_asistencia_redis'] = $('[name="utiliza_asistencia_redis"]', self.$modalForm).is(':checked');
                data['puede_cerrar_clase'] = $('[name="puede_cerrar_clase"]', self.$modalForm).is(':checked');
                data['puede_eliminar_clase'] = $('[name="puede_eliminar_clase"]', self.$modalForm).is(':checked');
                data['puede_editar_contenido_academico_clase'] = $('[name="puede_editar_contenido_academico_clase"]', self.$modalForm).is(':checked');
                data['puede_cambiar_asistencia_clase'] = $('[name="puede_cambiar_asistencia_clase"]', self.$modalForm).is(':checked');
                data['valida_asistencia_in_home'] = $('[name="valida_asistencia_in_home"]', self.$modalForm).is(':checked');
                data['num_dias_cambiar_asistencia_clase'] = $('[name="num_dias_cambiar_asistencia_clase"]', self.$modalForm).val();
                data['valida_asistencia_pago'] = $('[name="valida_asistencia_pago"]', self.$modalForm).is(':checked');
                data['periodos_relacionadoss'] = JSON.stringify($('[name="periodos_relacionados"]', self.$modalForm).val());
                data['valida_clases_horario_estricto'] = $('[name="valida_clases_horario_estricto"]', self.$modalForm).is(':checked');
                data['min_clases_apertura_antes_pro'] = $('[name="min_clases_apertura_antes_pro"]', self.$modalForm).val();
                data['min_clases_apertura_despues_pro'] = $('[name="min_clases_apertura_despues_pro"]', self.$modalForm).val();
                data['min_clases_apertura_antes_alu'] = $('[name="min_clases_apertura_antes_alu"]', self.$modalForm).val();
                data['min_clases_apertura_despues_alu'] = $('[name="min_clases_apertura_despues_alu"]', self.$modalForm).val();
                data['puede_solicitar_clase_diferido_pro'] = $('[name="puede_solicitar_clase_diferido_pro"]', self.$modalForm).is(':checked');
                data['puede_gestionar_solicitud_asistencias_pro'] = $('[name="puede_gestionar_solicitud_asistencias_pro"]', self.$modalForm).is(':checked');
                data['proceso_solicitud_clase_diferido_pro'] = $('[name="proceso_solicitud_clase_diferido_pro"]', self.$modalForm).val();
                return data;
            },
            actionSave: function (){
                var self = this;
                $("#frmAcademicPeriodAcademia", self.$modalForm).validationEngine('attach',{ scroll: false });
                var valid = $("#frmAcademicPeriodAcademia", self.$modalForm).validationEngine('validate', { scroll: false });
                if (!valid){
                    setTimeout(function() {
                        $('.help-text', self.$modalForm).each(function () {
                            var field = $(this);
                            if (field.attr('alert')) {
                                field.html(field.attr('alert'));
                            } else {
                                field.html('');
                            }
                        });
                    }, 8000);
                    desbloqueointerface();
                    return false;
                }
                $('.datepicker', self.$modalForm).css({"display": "none"});
                $('.bootstrap-timepicker-widget', self.$modalForm).css({"display": "none"});

                $('.controls input', self.$modalForm).each(function(){
                    if ($(this).attr('type')=='text'){
                        $(this).val($(this).val().trim());
                    }
                    if ($(this).attr('type')!='file'){
                        if ($(this).css('text-transform')=='uppercase'){
                            if ($(this).attr('type')!='password'){
                                $(this).val($(this).val().toUpperCase());
                            }
                        }
                    }
                });

                var aData = self.formGetData();
                bloqueointerface();
                $.ajax({
                    type: "POST",
                    url: "/adm_sistemas/academic_period",
                    data: aData,
                    success: function(data) {
                        if (data.result == 'ok') {
                            ControllerAcademicPeriod.$table.dataTable().fnDraw(false);
                            desbloqueointerface();
                            NotificationJG.success(data.mensaje);
                            self.close();
                        }
                        else{
                            NotificationJG.error(data.mensaje);
                            desbloqueointerface();
                        }
                    },
                    error: function() {
                        desbloqueointerface();
                        NotificationJG.error("Error al enviar los datos.");
                    },
                    dataType: "json",
                });
            },
        };

        var uiCrontabModal = {
            init: function () {
                var self = this;
                self.$modalForm = $('#modalCrontabPeriod');

                $('.action-close', self.$modalForm).click(function(){
                    self.close();
                });
                $('.action-edit', self.$modalForm).click(function(){
                    self.setFormType('edit');
                });
                $('.action-save', self.$modalForm).click(function (){
                    self.actionSave();
                });
            },
            processModalInit: function (){
                var self = this;
                $("#frmCrontabPeriod", self.$modalForm).validationEngine({autoHidePrompt:true, autoHideDelay:1000 });
            },
            close: function (){
                var self = this;
                self.$modalForm.modal('hide');
            },
            open: function(type, id){
                bloqueointerface();
                var self = this;
                self.setFormType(type);
                var h = $(window).height()-450;
                $.ajax({
                    type: "GET",
                    url: "/adm_sistemas/academic_period",
                    data: {'action': 'loadFormCrontab', 'typeForm': type, 'id': id},
                    success: function(data) {
                        if (data.result == 'ok') {
                            desbloqueointerface();
                            $(".modal-body", self.$modalForm).html(data.html);
                            self.$modalForm.modal({backdrop:'static', width: '60%'}).modal('show');
                            self.processModalInit();

                        } else {
                            desbloqueointerface();
                            NotificationJG.error(data.mensaje);
                        }
                    },
                    error: function() {
                        desbloqueointerface();
                        NotificationJG.error("Error al enviar los datos.");
                    },
                    dataType: "json",
                });
            },
            setFormType: function( type /* new, edit, view */ )
            {
                var self = this;

                if( type == 'new' )
                {
                    $('.modal-header span', self.$modalForm).html('Nuevo');

                    $('.action-save', self.$modalForm).show();
                    $('.action-edit', self.$modalForm).hide();
                    self.setFormReadOnly(false);
                }
                else if( type == 'edit' )
                {
                    $('.modal-header span', self.$modalForm).html('Editar');

                    $('.action-save', self.$modalForm).show();
                    $('.action-edit', self.$modalForm).hide();
                    self.setFormReadOnly(false);
                }
                else if( type == 'view' )
                {
                    $('.modal-header span', self.$modalForm).html('Ver');

                    $('.action-save', self.$modalForm).hide();
                    $('.action-edit', self.$modalForm).show();
                    self.setFormReadOnly(true);
                }
            },
            setFormReadOnly: function( isFormReadOnly )
            {
                var self = this;
                $('[name="type"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="type"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="is_activo"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="is_activo"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="upgrade_level_inscription"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="upgrade_level_inscription"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="upgrade_state_enrollment"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="upgrade_state_enrollment"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="upgrade_level_enrollment"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="upgrade_level_enrollment"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="create_lesson_previa"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="create_lesson_previa"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="delete_lesson_previa"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="delete_lesson_previa"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="notify_student_activities"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="notify_student_activities"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="bloqueo_state_enrollment"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="bloqueo_state_enrollment"]', self.$modalForm).prop('readonly', isFormReadOnly);
            },
            formGetData:function(){
                var self = this;
                var data = {}
                data['id'] = $('[name="id"]', self.$modalForm).val();
                data['action'] = $('[name="action"]', self.$modalForm).val();
                data['type'] = $('[name="type"]', self.$modalForm).val();
                data['is_activo'] = $('[name="is_activo"]', self.$modalForm).is(':checked');
                data['upgrade_level_inscription'] = $('[name="upgrade_level_inscription"]', self.$modalForm).is(':checked');
                data['upgrade_state_enrollment'] = $('[name="upgrade_state_enrollment"]', self.$modalForm).is(':checked');
                data['upgrade_level_enrollment'] = $('[name="upgrade_level_enrollment"]', self.$modalForm).is(':checked');
                data['create_lesson_previa'] = $('[name="create_lesson_previa"]', self.$modalForm).is(':checked');
                data['delete_lesson_previa'] = $('[name="delete_lesson_previa"]', self.$modalForm).is(':checked');
                data['notify_student_activities'] = $('[name="notify_student_activities"]', self.$modalForm).is(':checked');
                data['bloqueo_state_enrollment'] = $('[name="bloqueo_state_enrollment"]', self.$modalForm).is(':checked');
                return data;
            },
            actionSave: function (){
                var self = this;
                $("#frmCrontabPeriod", self.$modalForm).validationEngine('attach',{ scroll: false });
                var valid = $("#frmCrontabPeriod", self.$modalForm).validationEngine('validate', { scroll: false });
                if (!valid){
                    setTimeout(function() {
                        $('.help-text', self.$modalForm).each(function () {
                            var field = $(this);
                            if (field.attr('alert')) {
                                field.html(field.attr('alert'));
                            } else {
                                field.html('');
                            }
                        });
                    }, 8000);
                    desbloqueointerface();
                    return false;
                }
                $('.datepicker', self.$modalForm).css({"display": "none"});
                $('.bootstrap-timepicker-widget', self.$modalForm).css({"display": "none"});

                $('.controls input', self.$modalForm).each(function(){
                    if ($(this).attr('type')=='text'){
                        $(this).val($(this).val().trim());
                    }
                    if ($(this).attr('type')!='file'){
                        if ($(this).css('text-transform')=='uppercase'){
                            if ($(this).attr('type')!='password'){
                                $(this).val($(this).val().toUpperCase());
                            }
                        }
                    }
                });

                var aData = self.formGetData();
                bloqueointerface();
                $.ajax({
                    type: "POST",
                    url: "/adm_sistemas/academic_period",
                    data: aData,
                    success: function(data) {
                        if (data.result == 'ok') {
                            ControllerAcademicPeriod.$table.dataTable().fnDraw(false);
                            desbloqueointerface();
                            NotificationJG.success(data.mensaje);
                            self.close();
                        }
                        else{
                            NotificationJG.error(data.mensaje);
                            desbloqueointerface();
                        }
                    },
                    error: function() {
                        desbloqueointerface();
                        NotificationJG.error("Error al enviar los datos.");
                    },
                    dataType: "json",
                });
            },
        };

        var uiCronogramaMatriculacionModal = {
            init: function () {
                var self = this;
                self.$modalForm = $('#modalAcademicPeriodCronogramaMatriculacion');
                $('.action-close', self.$modalForm).click(function () {
                    self.close();
                });
                $('.action-edit', self.$modalForm).click(function () {
                    self.setFormType('edit');
                });
            },
            processModalInit: function (){
                var self = this;
                $('.action-add-coordinacion', self.$modalForm).click(function (){
                    var idpm = $(this).attr('idpm');
                    var idcc = $(this).attr('idcc');
                    var typeForm = $(this).attr('typeForm');
                    uiCronogramaCoordinacionModal.open(typeForm, idpm, idcc);
                });
                $('.action-edit-coordinacion', self.$modalForm).click(function (){
                    var idpm = $(this).attr('idpm');
                    var idcc = $(this).attr('idcc');
                    var typeForm = $(this).attr('typeForm');
                    uiCronogramaCoordinacionModal.open(typeForm, idpm, idcc);
                });
                $('.action-delete-coordinacion', self.$modalForm).click(function (){
                    var idpm = $(this).attr('idpm');
                    var idcc = $(this).attr('idcc');
                    var description = $(this).attr('_description');
                    uiCronogramaCoordinacionModal.delete(idpm, idcc, description);

                });

                $('.action-add-carrera', self.$modalForm).click(function (){
                    var idc = $(this).attr('idc');
                    var idcc = $(this).attr('idcc');
                    var typeForm = $(this).attr('typeForm');
                    uiCronogramaCarreraModal.open(typeForm, idc, idcc);
                });
                $('.action-edit-carrera', self.$modalForm).click(function (){
                    var idc = $(this).attr('idc');
                    var idcc = $(this).attr('idcc');
                    var typeForm = $(this).attr('typeForm');
                    uiCronogramaCarreraModal.open(typeForm, idc, idcc);
                });
                $('.action-delete-carrera', self.$modalForm).click(function (){
                    var idc = $(this).attr('idc');
                    var idcc = $(this).attr('idcc');
                    var description = $(this).attr('_description');
                    uiCronogramaCarreraModal.delete(idc, idcc, description);
                });

            },
            close: function (){
                var self = this;
                self.$modalForm.modal('hide');
            },
            getTypeForm: function (){
                var self = this;
                return $("[name='typeForm_base']", self.$modalForm).val();
            },
            getPeriodoID: function (){
                var self = this;
                return $("[name='periodo_id']", self.$modalForm).val();
            },
            open: function(type, id){
                bloqueointerface();
                var self = this;
                self.setFormType(type);
                var h = $(window).height()-450;
                $.ajax({
                    type: "GET",
                    url: "/adm_sistemas/academic_period",
                    data: {'action': 'loadRegistrationSchedule', 'typeForm': type, 'id': id},
                    success: function(data) {
                        if (data.result == 'ok') {
                            desbloqueointerface();
                            $(".modal-body", self.$modalForm).html(data.html);
                            self.$modalForm.modal({backdrop:'static', width: '90%'}).modal('show');
                            self.processModalInit();
                        } else {
                            desbloqueointerface();
                            NotificationJG.error(data.mensaje);
                        }
                    },
                    error: function() {
                        desbloqueointerface();
                        NotificationJG.error("Error al enviar los datos.");
                    },
                    dataType: "json",
                });
            },
            setFormType: function( type /* new, edit, view */ )
            {
                var self = this;

                if( type == 'new' )
                {
                    $('.modal-header span', self.$modalForm).html('Nuevo');

                    //$('.action-save', self.$modalForm).show();
                    //$('.action-edit', self.$modalForm).hide();
                    self.setFormReadOnly(false);
                }
                else if( type == 'edit' )
                {
                    $('.modal-header span', self.$modalForm).html('Editar');

                    //$('.action-save', self.$modalForm).show();
                    //$('.action-edit', self.$modalForm).hide();
                    self.setFormReadOnly(false);
                }
                else if( type == 'view' )
                {
                    $('.modal-header span', self.$modalForm).html('Ver');

                    //$('.action-save', self.$modalForm).hide();
                    //$('.action-edit', self.$modalForm).show();
                    self.setFormReadOnly(true);
                }
            },
            setFormReadOnly: function( isFormReadOnly )
            {
                var self = this;
            },
        };

        var uiCronogramaCoordinacionModal = {
            init: function () {
                var self = this;
                //console.log(self);
                self.$modalForm = $('#modalCronogramaCoordinacion');
                $('.action-close', self.$modalForm).click(function () {
                    self.close();
                });
                $('.action-save', self.$modalForm).click(function (){
                    self.actionSave();
                });
            },
            processModalInit: function (){
                var self = this;
                $("#frmCronogramaCoordinacion", self.$modalForm).validationEngine({autoHidePrompt:true, autoHideDelay:1000 });
                $("#frmCronogramaCoordinacion", self.$modalForm).validationEngine({autoHidePrompt:true, autoHideDelay:1000 });
                $("#id_fechainicio, #id_fechafin", self.$modalForm).datepicker({format:"yyyy-mm-dd"}).on('changeDate', function(ev){ $(this).datepicker('hide'); });
                $("#id_horainicio, #id_horafin", self.$modalForm).timepicker({
                    minuteStep: 1,
                    appendWidgetTo: 'body',
                    showSeconds: false,
                    showMeridian: false,
                    defaultTime: true
                });
                $("#id_fechainicio, #id_fechafin, #id_horainicio, #id_horafin", self.$modalForm).css({'text-transform': 'none'}).addClass("validate[required]");
                var eliminar_alertas = function(){
                    setInterval(function() {
                        $('.help-text', $("#frmCronogramaCoordinacion")).html("");
                    }, 8000);
                };

                eliminar_alertas();
                $("#id_coordinacion", self.$modalForm).select2({minimumResultsForSearch: 20, width: '100%', dropdownParent: self.$modalForm});

            },
            formGetData:function(){
                var self = this;
                var data = {}
                data['idcc'] = $('[name="idcc"]', self.$modalForm).val();
                data['idpm'] = $('[name="idpm"]', self.$modalForm).val();
                data['action'] = $('[name="action"]', self.$modalForm).val();
                data['typeForm'] = $('[name="typeForm"]', self.$modalForm).val();
                data['coordinacion'] = $('[name="coordinacion"]', self.$modalForm).val();
                data['fechainicio'] = $('[name="fechainicio"]', self.$modalForm).val();
                data['horainicio'] = $('[name="horainicio"]', self.$modalForm).val();
                data['fechafin'] = $('[name="fechafin"]', self.$modalForm).val();
                data['horafin'] = $('[name="horafin"]', self.$modalForm).val();
                data['activo'] = $('[name="activo"]', self.$modalForm).is(':checked');
                return data;
            },
            actionSave: function (){
                console.log("entra a action-save");
                var self = this;
                $("#frmCronogramaCoordinacion", self.$modalForm).validationEngine('attach',{ scroll: false });
                var valid = $("#frmCronogramaCoordinacion", self.$modalForm).validationEngine('validate', { scroll: false });
                console.log("valid:", valid);
                if (!valid){
                    setTimeout(function() {
                        $('.help-text', self.$modalForm).each(function () {
                            var field = $(this);
                            if (field.attr('alert')) {
                                field.html(field.attr('alert'));
                            } else {
                                field.html('');
                            }
                        });
                    }, 8000);
                    desbloqueointerface();
                    return false;
                }
                //console.log($("#id_coordinacion", self.$modalForm).val());
                if (!$("#id_coordinacion", self.$modalForm).val()){
                    NotificationJG.error("Seleccione una coordinación");
                    desbloqueointerface();
                    return false;
                }
                $('.datepicker', self.$modalForm).css({"display": "none"});
                $('.bootstrap-timepicker-widget', self.$modalForm).css({"display": "none"});

                $('.controls input', self.$modalForm).each(function(){
                    if ($(this).attr('type')=='text'){
                        $(this).val($(this).val().trim());
                    }
                    if ($(this).attr('type')!='file'){
                        if ($(this).css('text-transform')=='uppercase'){
                            if ($(this).attr('type')!='password'){
                                $(this).val($(this).val().toUpperCase());
                            }
                        }
                    }
                });
                //console.log("antes del aData");
                var aData = self.formGetData();
                //console.log("aData:", aData);
                bloqueointerface();
                //uiCronogramaMatriculacionModal.close();
                $.ajax({
                    type: "POST",
                    url: "/adm_sistemas/academic_period",
                    data: aData,
                    success: function(data) {
                        //console.log(data);
                        if (data.result == 'ok') {

                            uiCronogramaMatriculacionModal.open(uiCronogramaMatriculacionModal.getTypeForm(), uiCronogramaMatriculacionModal.getPeriodoID())
                            desbloqueointerface();
                            NotificationJG.success(data.mensaje);
                            self.close();
                        }
                        else{
                            NotificationJG.error(data.mensaje);
                            desbloqueointerface();
                        }
                    },
                    error: function() {
                        desbloqueointerface();
                        NotificationJG.error("Error al enviar los datos.");
                    },
                    dataType: "json",
                });
            },
            close: function (){
                var self = this;
                self.$modalForm.modal('hide');
            },
            delete: function (idpm, idcc, description){
                var self = this;
                Swal.fire({
                    title: `NOTIFICACIÓN`,
                    text: `¿Está seguro de eliminar ${description}?`,
                    type: 'warning',
                    icon: 'warning',
                    showCancelButton: true,
                    allowOutsideClick: false,
                    confirmButtonColor: '#3085d6',
                    cancelButtonColor: '#d33',
                    confirmButtonText: 'SI',
                    cancelButtonText: 'NO'
                }).then((result) => {
                    if (result.value) {
                        //uiCronogramaMatriculacionModal.close();
                        bloqueointerface();
                        $.ajax({
                            type: "POST",
                            url: "/adm_sistemas/academic_period",
                            data: {'action': 'deleteCronogramaCoordinacion', 'idpm': idpm, 'idcc': idcc },
                            success: function(data) {
                                if (data.result == 'ok') {

                                    uiCronogramaMatriculacionModal.open(uiCronogramaMatriculacionModal.getTypeForm(), uiCronogramaMatriculacionModal.getPeriodoID());
                                    desbloqueointerface();
                                    NotificationJG.success(data.mensaje);
                                } else {
                                    desbloqueointerface();
                                    NotificationJG.error(data.mensaje);
                                }
                            },
                            error: function() {
                                desbloqueointerface();
                                NotificationJG.error("Error al enviar los datos.");
                            },
                            dataType: "json",
                        });
                    }else{
                        NotificationJG.info('Cancelo eliminación');
                    }
                }).catch(error => {
                    NotificationJG.error(error.message);
                });
            },
            open: function(type, idpm, idcc){
                bloqueointerface();
                var self = this;
                self.setFormType(type);
                var h = $(window).height()-450;
                //console.log(`type: ${type} - idpm:${idpm} - idcc:${idcc}`);
                $.ajax({
                    type: "GET",
                    url: "/adm_sistemas/academic_period",
                    data: {'action': 'loadFormCronogramaCoordinacion', 'typeForm': type, 'idpm': idpm, 'idcc': idcc },
                    success: function(data) {
                        if (data.result == 'ok') {
                            desbloqueointerface();
                            $(".modal-body", self.$modalForm).html(data.html);
                            self.$modalForm.modal({backdrop:'static', width: '50%'}).modal('show');
                            self.processModalInit();
                        } else {
                            desbloqueointerface();
                            NotificationJG.error(data.mensaje);
                        }
                    },
                    error: function() {
                        desbloqueointerface();
                        NotificationJG.error("Error al enviar los datos.");
                    },
                    dataType: "json",
                });
            },
            setFormType: function( type /* new, edit, view */ )
            {
                var self = this;

                if( type == 'new' )
                {
                    $('.modal-header span', self.$modalForm).html('Nuevo');

                    //$('.action-save', self.$modalForm).show();
                    //$('.action-edit', self.$modalForm).hide();
                    self.setFormReadOnly(false);
                }
                else if( type == 'edit' )
                {
                    $('.modal-header span', self.$modalForm).html('Editar');

                    //$('.action-save', self.$modalForm).show();
                    //$('.action-edit', self.$modalForm).hide();
                    self.setFormReadOnly(false);
                }
                else if( type == 'view' )
                {
                    $('.modal-header span', self.$modalForm).html('Ver');

                    //$('.action-save', self.$modalForm).hide();
                    //$('.action-edit', self.$modalForm).show();
                    self.setFormReadOnly(true);
                }
            },
            setFormReadOnly: function( isFormReadOnly )
            {
                var self = this;
            },
        };

        var uiCronogramaCarreraModal = {
            init: function () {
                var self = this;
                //console.log(self);
                self.$modalForm = $('#modalCronogramaCarrera');
                $('.action-close', self.$modalForm).click(function () {
                    self.close();
                });
                $('.action-save', self.$modalForm).click(function (){
                    self.actionSave();
                });
            },
            processModalInit: function (){
                var self = this;
                $("#frmCronogramaCarrera", self.$modalForm).validationEngine({autoHidePrompt:true, autoHideDelay:1000 });
                $("#frmCronogramaCarrera", self.$modalForm).validationEngine({autoHidePrompt:true, autoHideDelay:1000 });
                $("#id_fechainicio, #id_fechafin", self.$modalForm).datepicker({format:"yyyy-mm-dd"}).on('changeDate', function(ev){ $(this).datepicker('hide'); });
                $("#id_horainicio, #id_horafin", self.$modalForm).timepicker({
                    minuteStep: 1,
                    appendWidgetTo: 'body',
                    showSeconds: false,
                    showMeridian: false,
                    defaultTime: true
                });
                $("#id_fechainicio, #id_fechafin, #id_horainicio, #id_horafin", self.$modalForm).css({'text-transform': 'none'}).addClass("validate[required]");
                var eliminar_alertas = function(){
                    setInterval(function() {
                        $('.help-text', $("#frmCronogramaCarrera")).html("");
                    }, 8000);
                };

                eliminar_alertas();
                $("#id_carrera, #id_niveles, #id_sesiones", self.$modalForm).select2({minimumResultsForSearch: 20, width: '100%', dropdownParent: self.$modalForm});

            },
            formGetData:function(){
                var self = this;
                var data = {}
                data['idc'] = $('[name="idc"]', self.$modalForm).val();
                data['idcc'] = $('[name="idcc"]', self.$modalForm).val();
                data['action'] = $('[name="action"]', self.$modalForm).val();
                data['typeForm'] = $('[name="typeForm"]', self.$modalForm).val();
                data['carrera'] = $('[name="carrera"]', self.$modalForm).val();
                data['fechainicio'] = $('[name="fechainicio"]', self.$modalForm).val();
                data['horainicio'] = $('[name="horainicio"]', self.$modalForm).val();
                data['fechafin'] = $('[name="fechafin"]', self.$modalForm).val();
                data['horafin'] = $('[name="horafin"]', self.$modalForm).val();
                data['activo'] = $('[name="activo"]', self.$modalForm).is(':checked');
                data['niveless'] = JSON.stringify($('[name="niveles"]', self.$modalForm).val());
                data['sesioness'] = JSON.stringify($('[name="sesiones"]', self.$modalForm).val());
                return data;
            },
            actionSave: function (){
                console.log("entra a action-save");
                var self = this;
                $("#frmCronogramaCarrera", self.$modalForm).validationEngine('attach',{ scroll: false });
                var valid = $("#frmCronogramaCarrera", self.$modalForm).validationEngine('validate', { scroll: false });
                console.log("valid:", valid);
                if (!valid){
                    setTimeout(function() {
                        $('.help-text', self.$modalForm).each(function () {
                            var field = $(this);
                            if (field.attr('alert')) {
                                field.html(field.attr('alert'));
                            } else {
                                field.html('');
                            }
                        });
                    }, 8000);
                    desbloqueointerface();
                    return false;
                }
                //console.log($("#id_coordinacion", self.$modalForm).val());
                if (!$("#id_carrera", self.$modalForm).val()){
                    NotificationJG.error("Seleccione una carrera");
                    desbloqueointerface();
                    return false;
                }
                /*if (!$("#id_niveles", $('#modalCronogramaCarrera')).val()){
                    NotificationJG.error("Seleccione niveles");
                    desbloqueointerface();
                    return false;
                }
                if (!$("#id_sesiones", $('#modalCronogramaCarrera')).val()){
                    NotificationJG.error("Seleccione secciones");
                    desbloqueointerface();
                    return false;
                }*/
                $('.datepicker', self.$modalForm).css({"display": "none"});
                $('.bootstrap-timepicker-widget', self.$modalForm).css({"display": "none"});

                $('.controls input', self.$modalForm).each(function(){
                    if ($(this).attr('type')=='text'){
                        $(this).val($(this).val().trim());
                    }
                    if ($(this).attr('type')!='file'){
                        if ($(this).css('text-transform')=='uppercase'){
                            if ($(this).attr('type')!='password'){
                                $(this).val($(this).val().toUpperCase());
                            }
                        }
                    }
                });
                //console.log("antes del aData");
                var aData = self.formGetData();
                //console.log("aData:", aData);
                bloqueointerface();
                //uiCronogramaMatriculacionModal.close();
                $.ajax({
                    type: "POST",
                    url: "/adm_sistemas/academic_period",
                    data: aData,
                    success: function(data) {
                        //console.log(data);
                        if (data.result == 'ok') {

                            uiCronogramaMatriculacionModal.open(uiCronogramaMatriculacionModal.getTypeForm(), uiCronogramaMatriculacionModal.getPeriodoID())
                            desbloqueointerface();
                            NotificationJG.success(data.mensaje);
                            self.close();
                        }
                        else{
                            NotificationJG.error(data.mensaje);
                            desbloqueointerface();
                        }
                    },
                    error: function() {
                        desbloqueointerface();
                        NotificationJG.error("Error al enviar los datos.");
                    },
                    dataType: "json",
                });
            },
            close: function (){
                var self = this;
                self.$modalForm.modal('hide');
            },
            delete: function (idc, idcc, description){
                var self = this;
                Swal.fire({
                    title: `NOTIFICACIÓN`,
                    text: `¿Está seguro de eliminar ${description}?`,
                    type: 'warning',
                    icon: 'warning',
                    showCancelButton: true,
                    allowOutsideClick: false,
                    confirmButtonColor: '#3085d6',
                    cancelButtonColor: '#d33',
                    confirmButtonText: 'SI',
                    cancelButtonText: 'NO'
                }).then((result) => {
                    if (result.value) {
                        //uiCronogramaMatriculacionModal.close();
                        bloqueointerface();
                        $.ajax({
                            type: "POST",
                            url: "/adm_sistemas/academic_period",
                            data: {'action': 'deleteCronogramaCarrera', 'idc': idc, 'idcc': idcc },
                            success: function(data) {
                                if (data.result == 'ok') {
                                    uiCronogramaMatriculacionModal.open(uiCronogramaMatriculacionModal.getTypeForm(), uiCronogramaMatriculacionModal.getPeriodoID());
                                    desbloqueointerface();
                                    NotificationJG.success(data.mensaje);
                                } else {
                                    desbloqueointerface();
                                    NotificationJG.error(data.mensaje);
                                }
                            },
                            error: function() {
                                desbloqueointerface();
                                NotificationJG.error("Error al enviar los datos.");
                            },
                            dataType: "json",
                        });
                    }else{
                        NotificationJG.info('Cancelo eliminación');
                    }
                }).catch(error => {
                    NotificationJG.error(error.message);
                });
            },
            open: function(type, idc, idcc){
                bloqueointerface();
                var self = this;
                self.setFormType(type);
                var h = $(window).height()-450;
                $.ajax({
                    type: "GET",
                    url: "/adm_sistemas/academic_period",
                    data: {'action': 'loadFormCronogramaCarrera', 'typeForm': type, 'idc': idc, 'idcc': idcc },
                    success: function(data) {
                        if (data.result == 'ok') {
                            desbloqueointerface();
                            $(".modal-body", self.$modalForm).html(data.html);
                            self.$modalForm.modal({backdrop:'static', width: '50%'}).modal('show');
                            self.processModalInit();
                        } else {
                            desbloqueointerface();
                            NotificationJG.error(data.mensaje);
                        }
                    },
                    error: function() {
                        desbloqueointerface();
                        NotificationJG.error("Error al enviar los datos.");
                    },
                    dataType: "json",
                });
            },
            setFormType: function( type /* new, edit, view */ )
            {
                var self = this;

                if( type == 'new' )
                {
                    $('.modal-header span', self.$modalForm).html('Nuevo');

                    //$('.action-save', self.$modalForm).show();
                    //$('.action-edit', self.$modalForm).hide();
                    self.setFormReadOnly(false);
                }
                else if( type == 'edit' )
                {
                    $('.modal-header span', self.$modalForm).html('Editar');

                    //$('.action-save', self.$modalForm).show();
                    //$('.action-edit', self.$modalForm).hide();
                    self.setFormReadOnly(false);
                }
                else if( type == 'view' )
                {
                    $('.modal-header span', self.$modalForm).html('Ver');

                    //$('.action-save', self.$modalForm).hide();
                    //$('.action-edit', self.$modalForm).show();
                    self.setFormReadOnly(true);
                }
            },
            setFormReadOnly: function( isFormReadOnly )
            {
                var self = this;
            },
        };

        var uiPeriodoMallaModal = {
            init: function () {
                var self = this;
                self.$modalForm = $('#modalPeriodoMalla');
                $('.action-close', self.$modalForm).click(function () {
                    self.close();
                });
                $('.action-edit', self.$modalForm).click(function () {
                    self.setFormType('edit');
                });

                $('.action-save', self.$modalForm).click(function () {
                    self.actionSave();
                });
            },
            close: function (){
                var self = this;
                self.$modalForm.modal('hide');
            },
            processModalInit: function (){
                var self = this;
                $("#frmPeriodoMalla", self.$modalForm).validationEngine({autoHidePrompt:true, autoHideDelay:1000 });
                //$("#id_fecha", self.$modalForm).datepicker({format:"yyyy-mm-dd"}).on('changeDate', function(ev){ $(this).datepicker('hide'); });
                $("#id_periodo_malla, #id_valor", self.$modalForm).css({'text-transform': 'none'}).addClass("validate[required]");
                $('#id_valor').blur(function(){
                    numerico($(this),0,100,2);
                });
                var eliminar_alertas = function(){
                    setInterval(function() {
                        $('.help-text', $("#frmGrupoSocioeconomico")).html("");
                    }, 8000);
                };

                eliminar_alertas();
                $("#id_periodo_malla",  $('#modalPeriodoMalla')).select2({minimumResultsForSearch: 20, width: '100%', dropdownParent: $('#modalGrupoSocioeconomico') });

                $('.action_new_grupo_socioeconomico', self.$modalForm).click(function (){
                    uiGrupoSocioeconmicoModal.open('new', 0);
                });

            },
            open: function(type, id, idp){
                bloqueointerface();
                var self = this;
                //console.log(type);
                self.setFormType(type);
                var h = $(window).height()-450;
                //self.$modalForm.modal({backdrop:'static', width: '90%'}).modal('show');
                $.ajax({
                    type: "GET",
                    url: "/adm_sistemas/academic_period",
                    data: {'action': 'loadFormPeriodoMalla', 'typeForm': type, 'id': id, 'idp': idp},
                    success: function(data) {
                        if (data.result == 'ok') {
                            desbloqueointerface();
                            $(".modal-body", self.$modalForm).html(data.html);
                            $.each(data.grupos, function (index, value){
                                //console.log(value);
                                uiFinancieroModal.addDataGrupoSocioeconomico(value);

                            });
                            //$('.',uiFinancieroModal.$modalForm)
                            console.log(uiFinancieroModal.$modalForm)
                            $(".action_remove_grupo_socioeconomico", self.$modalForm).hide()
                            self.$modalForm.modal({backdrop:'static', width: '80%'}).modal('show');
                            self.processModalInit();
                        } else {
                            desbloqueointerface();
                            NotificationJG.error(data.mensaje);
                        }
                    },
                    error: function() {
                        desbloqueointerface();
                        NotificationJG.error("Error al enviar los datos.");
                    },
                    dataType: "json",
                });
            },
            setFormType: function( type /* new, edit, view */ )
            {
                var self = this;

                if( type == 'new' )
                {
                    $('.modal-header span', self.$modalForm).html('Nuevo');

                    $('.action-save', self.$modalForm).show();
                    $('.action-edit', self.$modalForm).hide();
                    self.setFormReadOnly(false);
                }
                else if( type == 'edit' )
                {
                    $('.modal-header span', self.$modalForm).html('Editar');

                    $('.action-save', self.$modalForm).show();
                    $('.action-edit', self.$modalForm).hide();
                    self.setFormReadOnly(false);
                }
                else if( type == 'view' )
                {
                    $('.modal-header span', self.$modalForm).html('Ver');

                    $('.action-save', self.$modalForm).hide();
                    $('.action-edit', self.$modalForm).show();
                    self.setFormReadOnly(true);
                }
            },
            setFormReadOnly: function( isFormReadOnly )
            {
                var self = this;
                $('[name="grupo_socioeconomico"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="grupo_socioeconomico"]', self.$modalForm).prop('readonly', isFormReadOnly);
                $('[name="valor"]', self.$modalForm).prop('disabled', isFormReadOnly);
                $('[name="valor"]', self.$modalForm).prop('readonly', isFormReadOnly);
            },
            formGetData:function(){
                var self = this;
                var data = {}
                data['id'] = $('[name="id"]', self.$modalForm).val();
                data['idp'] = $('[name="idp"]', self.$modalForm).val();
                data['action'] = $('[name="action"]', self.$modalForm).val();
                data['tipocalculo'] = $('[name="tipocalculo"]', self.$modalForm).val();
                data['malla'] = $('[name="malla"]', self.$modalForm).find('option:selected').val();
                data['malla_text'] = $('[name="malla"]', self.$modalForm).find('option:selected').text();
                data['configuracion'] = $('[name="configuracion"]', self.$modalForm).val();
                data['vct'] = $('[name="vct"]', self.$modalForm).val();
                data['detalle'] = []
                data['valida'] = true
                $('#dataGrupoSocioeconomico tbody tr').each(function(index, value){
                    var $_tr = $(this);
                    var edata = $_tr.data();
                    //console.log(data);
                    if( parseInt(edata.objGrupo.gruposocioeconomico_id) == parseInt(data['detalle'] .gruposocioeconomico_id) && parseInt(data['detalle'] .id) == 0) {
                        //$_tr.remove();
                        data['valida'] = false
                    }else{
                        data['detalle'].push(edata.objGrupo);
                    }
                });
                data['detalle'] = JSON.stringify(data['detalle'])
                return data;
            },
            actionSave: function (){
                var self = this;
                bloqueointerface();
                $("#frmPeriodoMalla", self.$modalForm).validationEngine('attach',{ scroll: false });
                var valid = $("#frmPeriodoMalla", self.$modalForm).validationEngine('validate', { scroll: false });
                if (!valid){
                    setTimeout(function() {
                        $('.help-text', self.$modalForm).each(function () {
                            var field = $(this);
                            if (field.attr('alert')) {
                                field.html(field.attr('alert'));
                            } else {
                                field.html('');
                            }
                        });
                    }, 8000);
                    desbloqueointerface();
                    return false;
                }
                $('.datepicker', self.$modalForm).css({"display": "none"});
                $('.bootstrap-timepicker-widget', self.$modalForm).css({"display": "none"});

                $('.controls input', self.$modalForm).each(function(){
                    if ($(this).attr('type')=='text'){
                        $(this).val($(this).val().trim());
                    }
                    if ($(this).attr('type')!='file'){
                        if ($(this).css('text-transform')=='uppercase'){
                            if ($(this).attr('type')!='password'){
                                $(this).val($(this).val().toUpperCase());
                            }
                        }
                    }
                });

                if ($('[name="malla"]', self.$modalForm).val() == 0){
                    smoke.alert('Seleccione una malla');
                    desbloqueointerface();
                    return false;
                }
                if ($('[name="valor"]', self.$modalForm).val() <= 0){
                    smoke.alert('Ingrese un valor mayor a cero del grupo socioeconomico');
                    desbloqueointerface();
                    return false;
                }
                var aData = self.formGetData();
                //console.log(validData);
                if (!aData['valida'] ){
                    NotificationJG.error("Grupo socioeconomico se encuentra ingresado, seleccione otro");
                    desbloqueointerface();
                    return false;
                }
                $.ajax({
                    type: "POST",
                    url: "/adm_sistemas/academic_period",
                    data: aData,
                    success: function(data) {
                        if (data.result == 'ok') {
                            uiFinancieroModal.open('edit', data.idp);
                            self.close();
                        } else {
                            desbloqueointerface();
                            NotificationJG.error(data.mensaje);
                        }
                    },
                    error: function() {
                        desbloqueointerface();
                        NotificationJG.error("Error al enviar los datos.");
                    },
                    dataType: "json",
                });
                desbloqueointerface();
            },

        };
        $(function() {
            ControllerAcademicPeriod.init();
            uiModal.init();
            uiGroupModal.init();
            uiMatriculacionModal.init();
            uiCronogramaModal.init();
            uiFechaRubroModal.init();
            uiNivelesModal.init();
            uiFinancieroModal.init();
            uiGrupoSocioeconmicoModal.init();
            uiAcademiaModal.init();
            uiCrontabModal.init();
            uiCronogramaMatriculacionModal.init();
            uiCronogramaCoordinacionModal.init();
            uiCronogramaCarreraModal.init();
            uiPeriodoMallaModal.init();
            $('.action-close', $("#modalVerDetalleCostosNivel")).click(function(){
                $("#modalVerDetalleCostosNivel").modal('hide');
            });


            //Sobreposiciona el select2 en el ultimo modal.
            $('body').on('shown.bs.modal', '.modal', function() {
              $(this).find('select').each(function() {
                var dropdownParent = $(document.body);
                if ($(this).parents('.modal.in:first').length !== 0)
                  dropdownParent = $(this).parents('.modal.in:first');
                $(this).select2({
                  dropdownParent: dropdownParent
                  // ...
                });
              });
            });

        });
    </script>
{% endblock %}
{% block atras %}/adm_sistemas{% endblock %}
{% block canvas %}
    <div class='row-fluid'>
        <div class='span8'>
            <div><h4>{{ title }}</h4></div>
            {% if perms.bd.puede_agregar_periodo_academico %}
                <br>
                <div><a href="javascript:;" class="btn btn-success action-add"><i class="fa fa-plus"></i> Agregar</a></div>
            {% endif %}
        </div>
        <div class="span4">
            <div class="panel panel-sga" id="panel_filter">
                <div class="panel-heading">
                    <h3 class="panel-title">Filtro</h3>
                    <div class="pull-right">
                        <a style="margin-right: 5px" href="javascript:;" class='btn btn-mini btn-info tu' id="action_min" title="Minimizar"><span class="fa fa-minus"></span></a>
                        <a style="margin-right: 5px" href="javascript:;" class='btn btn-mini btn-info tu' id="action_max" title="Maximizar"><span class="fa fa-plus"></span></a>
                    </div>
                </div>
                <div class="panel-body">
                    <div class="row-fluid">
                        <div class="span3"><b>Visible:</b></div>
                        <div class="span9">
                            <div class="radio">
                                <input type="radio" id="filter_visible_all" name="filter_visible" value="0" checked="checked">
                                <label class="" for="filter_visible_all">Ambos</label>
                                <input type="radio" id="filter_visible_si" name="filter_visible" value="1">
                                <label class="" for="filter_visible_si"><span class="label label-success">SI</span></label>
                                <input type="radio" id="filter_visible_no" name="filter_visible" value="2">
                                <label class="" for="filter_visible_no"><span class="label label-danger">NO</span></label>
                            </div>
                        </div>
                    </div>
                    <div class="row-fluid">
                        <div class="span3"><b>Activo:</b></div>
                        <div class="span9">
                            <div class="radio">
                                <input type="radio" id="filter_activo_all" name="filter_activo" value="0" checked="checked">
                                <label class="" for="filter_activo_all">Ambos</label>
                                <input type="radio" id="filter_activo_si" name="filter_activo" value="1">
                                <label class="" for="filter_activo_si"><span class="label label-success">SI</span></label>
                                <input type="radio" id="filter_activo_no" name="filter_activo" value="2">
                                <label class="" for="filter_activo_no"><span class="label label-danger">NO</span></label>
                            </div>
                        </div>
                    </div>
                    <div class="row-fluid">
                        <div class="span3"><b>Valido Asistencia:</b></div>
                        <div class="span9">
                            <div class="radio">
                                <input type="radio" id="filter_valida_asistencia_all" name="filter_valida_asistencia" value="0" checked="checked">
                                <label class="" for="filter_valida_asistencia_all">Ambos</label>
                                <input type="radio" id="filter_valida_asistencia_si" name="filter_valida_asistencia" value="1">
                                <label class="" for="filter_valida_asistencia_si"><span class="label label-success">SI</span></label>
                                <input type="radio" id="filter_valida_asistencia_no" name="filter_valida_asistencia" value="2">
                                <label class="" for="filter_valida_asistencia_no"><span class="label label-danger">NO</span></label>
                            </div>
                        </div>
                    </div>
                    <div class="row-fluid">
                        <div class="span3"><b>Visible Horario:</b></div>
                        <div class="span9">
                            <div class="radio">
                                <input type="radio" id="filter_visiblehorario_all" name="filter_visiblehorario" value="0" checked="checked">
                                <label class="" for="filter_visiblehorario_all">Ambos</label>
                                <input type="radio" id="filter_visiblehorario_si" name="filter_visiblehorario" value="1">
                                <label class="" for="filter_visiblehorario_si"><span class="label label-success">SI</span></label>
                                <input type="radio" id="filter_visiblehorario_no" name="filter_visiblehorario" value="2">
                                <label class="" for="filter_visiblehorario_no"><span class="label label-danger">NO</span></label>
                            </div>
                        </div>
                    </div>
                    <div class="row-fluid">
                        <div class="span3"><b>Matrícula Activa:</b></div>
                        <div class="span9">
                            <div class="radio">
                                <input type="radio" id="filter_matriculacionactiva_all" name="filter_matriculacionactiva" value="0" checked="checked">
                                <label class="" for="filter_matriculacionactiva_all">Ambos</label>
                                <input type="radio" id="filter_matriculacionactiva_si" name="filter_matriculacionactiva" value="1">
                                <label class="" for="filter_matriculacionactiva_si"><span class="label label-success">SI</span></label>
                                <input type="radio" id="filter_matriculacionactiva_no" name="filter_matriculacionactiva" value="2">
                                <label class="" for="filter_matriculacionactiva_no"><span class="label label-danger">NO</span></label>
                            </div>
                        </div>
                    </div>
                    <div class="row-fluid">
                        <div class="span3"><b>Crontab Activa:</b></div>
                        <div class="span9">
                            <div class="radio">
                                <input type="radio" id="filter_crontabactivo_all" name="filter_crontabactivo" value="0" checked="checked">
                                <label class="" for="filter_crontabactivo_all">Ambos</label>
                                <input type="radio" id="filter_crontabactivo_si" name="filter_crontabactivo" value="1">
                                <label class="" for="filter_crontabactivo_si"><span class="label label-success">SI</span></label>
                                <input type="radio" id="filter_crontabactivo_no" name="filter_crontabactivo" value="2">
                                <label class="" for="filter_crontabactivo_no"><span class="label label-danger">NO</span></label>
                            </div>
                        </div>
                    </div>
                    <div class="row-fluid">
                        <div class="span3"><b>Tipo de periodo:</b></div>
                        <div class="span9">
                            <select name="tipos_periodos" style="width: 100%;">
                                <option value="0" selected="selected">--TODOS--</option>
                                {% for t in tipos_periodos %}
                                    <option value="{{ t.id }}">{{ t.nombre }}</option>
                                {% endfor %}
                            </select>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="no-more-tables">
        <div class='row-fluid'>
            <div class='span12'>
                <div class="datatable" id="divDetailData">
                    <table id="dtViewAcademicPeriod" class='table table-bordered table-striped'>
                        <thead>
                        <tr>
                            <th style="text-align: center; vertical-align: middle; width: 4%">ID</th>
                            <th style="text-align: center; vertical-align: middle; width: 30%">Nombre</th>
                            <th style="text-align: center; vertical-align: middle; width: 24%">Fechas</th>
                            <th style="text-align: center; vertical-align: middle; width: 8%">Tipo</th>
                            <th style="text-align: center; vertical-align: middle; width: 24%">Estados</th>
                            <th style="text-align: center; vertical-align: middle; width: 10%"></th>
                        </tr>
                        </thead>
                        <tbody>

                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <div id="el-templates" style="display:none;">
        <div element="table-row-actions">
            <table>
                <tbody>
                <tr>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td>
                        <div class="table-controls">
                            <div class="btn-group">
                                <a class="btn btn-mini dropdown-toggle" data-toggle="dropdown" href="javascript:;">Acciones<span class="caret"></span>
                                </a>
                                <ul class="dropdown-menu pull-right" style="text-align: left">
                                    <li><a href="javascript:;" class="dt-action-view"><i class="fa fa-eye"></i> Ver</a></li>
                                    {% if perms.bd.puede_modificar_periodo_academico %}
                                        <li><a href="javascript:;" class="dt-action-edit"><i class="fa fa-edit"></i> Editar</a></li>
                                    {% endif %}
                                    {% if perms.bd.puede_eliminar_periodo_academico %}
                                        <li><a href="javascript:;" class="dt-action-delete"><i class="fa fa-trash"></i> Eliminar</a></li>
                                    {% endif %}
                                    {% if perms.bd.puede_modificar_periodo_academico_grupo %}
                                        <li><a href="javascript:;" class="dt-action-groups" typeform="edit"><i class="fa fa-edit"></i> Grupos</a></li>
                                    {% else %}
                                        <li><a href="javascript:;" class="dt-action-groups" typeform="view"><i class="fa fa-eye"></i> Grupos</a></li>
                                    {% endif %}
                                    {% if perms.bd.puede_modificar_periodo_academico_matriculacion %}
                                        <li><a href="javascript:;" class="dt-action-matriculacion" typeform="edit"><i class="fa fa-edit"></i> Matriculación</a></li>
                                        <li><a href="javascript:;" class="dt-action-matriculacion-cronograma" typeform="edit"><i class="fa fa-edit"></i> Cronograma Matriculación</a></li>
                                    {% else %}
                                        <li><a href="javascript:;" class="dt-action-matriculacion" typeform="view"><i class="fa fa-eye"></i> Matriculación</a></li>
                                        <li><a href="javascript:;" class="dt-action-matriculacion-cronograma" typeform="view"><i class="fa fa-eye"></i> Cronograma Matriculación</a></li>
                                    {% endif %}
                                    {% if perms.bd.puede_modificar_periodo_academico_niveles %}
                                        <li><a href="javascript:;" class="dt-action-niveles" typeform="edit"><i class="fa fa-edit"></i> Niveles</a></li>
                                    {% else %}
                                        <li><a href="javascript:;" class="dt-action-niveles" typeform="view"><i class="fa fa-eye"></i> Niveles</a></li>
                                    {% endif %}
                                    {% if perms.bd.puede_modificar_periodo_academico_finanzas %}
                                        <li><a href="javascript:;" class="dt-action-finanzas" typeform="edit"><i class="fa fa-edit"></i> Finanzas</a></li>
                                    {% else %}
                                        <li><a href="javascript:;" class="dt-action-finanzas" typeform="view"><i class="fa fa-eye"></i> Finanzas</a></li>
                                    {% endif %}
                                    {% if perms.bd.puede_modificar_periodo_academico_academia %}
                                        <li><a href="javascript:;" class="dt-action-academica" typeform="edit"><i class="fa fa-edit"></i> Academia</a></li>
                                    {% else %}
                                        <li><a href="javascript:;" class="dt-action-academica" typeform="view"><i class="fa fa-eye"></i> Academia</a></li>
                                    {% endif %}
                                    {% if perms.bd.puede_modificar_periodo_crontab %}
                                        <li><a href="javascript:;" class="dt-action-crontab" typeform="edit"><i class="fa fa-edit"></i> Crontab</a></li>
                                    {% else %}
                                        <li><a href="javascript:;" class="dt-action-crontab" typeform="view"><i class="fa fa-eye"></i> Crontab</a></li>
                                    {% endif %}
                                    {% if perms.bd.puede_ver_periodo_academico_estadistica_matricula %}
                                        <li><a href="javascript:;" class="dt-action-estadisticas" typeform="view" type_m="1"><i class="fa fa-bar-chart-o"></i> Estadísticas Matrícula Admisión</a></li>
                                        <li><a href="javascript:;" class="dt-action-estadisticas" typeform="view" type_m="2"><i class="fa fa-bar-chart-o"></i> Estadísticas Matrícula Pregrado</a></li>
                                    {% endif %}

                                </ul>
                            </div>
                        </div>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
        <div element="table-row-coordinacion">
            <table>
                <tbody>
                <tr>
                    <td style="text-align: left; vertical-align: middle"></td>
                    <td style="text-align: center; vertical-align: middle"></td>
                    <td style="text-align: center; vertical-align: middle"></td>
                    <td style="text-align: center; vertical-align: middle"></td>
                    <td style="text-align: center; vertical-align: middle">
                        <div class="btn-group">
                            <!--<a style="margin-right: 5px;" href="javascript:;" class='btn btn-mini btn-info tu action_edit_coordinacion' title="Editar coordinación"><span class="fa fa-edit"></span></a>-->
                            <a style="margin-right: 5px;" href="javascript:;" class='btn btn-mini btn-danger tu action_remove_coordinacion' title="Quitar coordinación"><span class="fa fa-remove"></span></a>
                        </div>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
        <div element="table-row-fecha-rubro">
            <table>
                <tbody>
                <tr>
                    <td style="text-align: center; vertical-align: middle"></td>
                    <td style="text-align: center; vertical-align: middle"></td>
                    <td style="text-align: center; vertical-align: middle">
                        <div class="btn-group">
                            <!--<a style="margin-right: 5px;" href="javascript:;" class='btn btn-mini btn-info tu action_edit_fecha_rurbo' title="Editar Fecha"><span class="fa fa-edit"></span></a>-->
                            <a style="margin-right: 5px;" href="javascript:;" class='btn btn-mini btn-danger tu action_remove_fecha_rurbo' title="Quitar fecha"><span class="fa fa-remove"></span></a>
                        </div>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
        <div element="table-row-grupo-socioeconomico">
            <table>
                <tbody>
                <tr>
                    <td style="text-align: center; vertical-align: middle"></td>
                    <td style="text-align: center; vertical-align: middle"></td>
                    <td style="text-align: center; vertical-align: middle">
                        <div class="btn-group">
                            <a style="margin-right: 5px;" href="javascript:;" class='btn btn-mini btn-info tu action_edit_grupo_socioeconomico' title="Editar Fecha"><span class="fa fa-edit"></span></a>
                            <a style="margin-right: 5px;" href="javascript:;" class='btn btn-mini btn-danger tu action_remove_grupo_socioeconomico' title="Quitar fecha"><span class="fa fa-remove"></span></a>
                        </div>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
        <div element="table-row-periodo-malla">
            <table>
                <tbody>
                <tr>
                    <td style="text-align: center; vertical-align: middle"></td>
                    <td style="text-align: center; vertical-align: middle"></td>
                    <td style="text-align: center; vertical-align: middle"></td>
                    <td style="text-align: center; vertical-align: middle"></td>
                    <td style="text-align: center; vertical-align: middle">
                        <div class="btn-group">
                            <a style="margin-right: 5px;" href="javascript:;" class='btn btn-mini btn-info tu action_edit_periodo_malla' title="Editar Fecha"><span class="fa fa-edit"></span></a>
                        </div>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>

    <div class="modal fade static" id="modalAcademicPeriod" style="display: none;">
        <div class="modal-header">
            <h4 class="paneltitle"><span></span> Periodo Académico</h4>
        </div>
        <div class="modal-body panelbody">

        </div>
        <div class="modal-footer">
            {% if perms.bd.puede_modificar_periodo_academico %}
                <a href="javascript:;" class="btn btn-success action-save">Guardar</a>
                <a href="javascript:;" class="btn btn-info action-edit">Editar</a>
            {% endif %}
            <a href="javascript:;" class="btn btn-danger action-close"> Cerrar</a>
        </div>
    </div>

    <div class="modal fade static" id="modalAcademicPeriodGroups" style="display: none;">
        <div class="modal-header">
            <h4 class="paneltitle"><span></span> Grupos del Periodo Académico</h4>
        </div>
        <div class="modal-body panelbody">

        </div>
        <div class="modal-footer">
            {% if perms.bd.puede_modificar_periodo_academico_grupo %}
                <a href="javascript:;" class="btn btn-success action-save">Guardar</a>
                <a href="javascript:;" class="btn btn-info action-edit">Editar</a>
            {% endif %}
            <a href="javascript:;" class="btn btn-danger action-close"> Cerrar</a>
        </div>
    </div>

    <div class="modal fade static" id="modalAcademicPeriodMatriculacion" style="display: none;">
        <div class="modal-header">
            <h4 class="paneltitle"><span></span> Matriculación del Periodo Académico</h4>
        </div>
        <div class="modal-body panelbody">

        </div>
        <div class="modal-footer">
            {% if perms.bd.puede_modificar_periodo_academico_matriculacion %}
                <a href="javascript:;" class="btn btn-success action-save">Guardar</a>
                <a href="javascript:;" class="btn btn-info action-edit">Editar</a>
            {% endif %}
            <a href="javascript:;" class="btn btn-danger action-close"> Cerrar</a>
        </div>
    </div>

    <div class="modal fade static" id="modalCronograma" style="display: none;">
        <div class="modal-header">
            <h4 class="paneltitle"><span></span> Cronograma</h4>
        </div>
        <div class="modal-body panelbody">
            <div class='well' style="display: flex;">
                <div class="row-fluid">
                    <div class="span12">
                        <form id="frmAcademicPeriodCronograma" class="form-horizontal" onsubmit="return false">
                            <input type='hidden' name='id' value='0'/>
                            <fieldset id="fieldset_coordinacion" class="control-group nomargins span12" style="padding: 5px; min-height:45px; margin-left: 0 !important;" >
                                <div class="control-label label-text" style="display: table;height: 30px;">
                                    <div style="display: table-cell; vertical-align: middle; line-height: 11px">
                                        <label for="id_coordinacion" style="padding-right: 20px">Coordinacion</label>
                                    </div>
                                </div>
                                <div class="control">
                                    <select name="coordinacion" id="id_coordinacion" style="width: 100%">
                                        <option value="0" selected="selected">-----------</option>
                                        {% for coordinacion in coordinaciones %}
                                            <option value="{{ coordinacion.id }}">{{ coordinacion.nombre }}</option>
                                        {% endfor %}
                                    </select>
                                    <p class="help-text" style="font-size: xx-small; margin-bottom: 0; height: 13px; line-height: 13px"></p>
                                </div>
                            </fieldset>
                            <fieldset id="fieldset_fechainicio" class="control-group nomargins span4" style="padding: 5px; min-height:45px; margin-left: 0 !important;" >
                                <div class="control-label label-text" style="display: table;height: 30px;">
                                    <div style="display: table-cell; vertical-align: middle; line-height: 11px">
                                        <label for="id_fechainicio" style="padding-right: 20px">Fecha inicio</label>
                                    </div>
                                </div>
                                <div class="control">
                                    <input type="text" name="fechainicio" id="id_fechainicio" class="" />
                                    <p class="help-text" style="font-size: xx-small; margin-bottom: 0; height: 13px; line-height: 13px"></p>
                                </div>
                            </fieldset>
                            <fieldset id="fieldset_fechafin" class="control-group nomargins span4" style="padding: 5px; min-height:45px; margin-left: 0 !important;" >
                                <div class="control-label label-text" style="display: table;height: 30px;">
                                    <div style="display: table-cell; vertical-align: middle; line-height: 11px">
                                        <label for="id_fechafin" style="padding-right: 20px">Fecha fin</label>
                                    </div>
                                </div>
                                <div class="control">
                                    <input type="text" name="fechafin" id="id_fechafin" class="" />
                                    <p class="help-text" style="font-size: xx-small; margin-bottom: 0; height: 13px; line-height: 13px"></p>
                                </div>
                            </fieldset>
                            <fieldset id="fieldset_activo" class="control-group nomargins span4" style="padding: 5px; min-height:45px; margin-left: 0 !important;" >
                                <div class="control-label label-text" style="display: table;height: 30px;">
                                    <div style="display: table-cell; vertical-align: middle; line-height: 11px">
                                        <label for="id_activo" style="padding-right: 20px">Activo</label>
                                    </div>
                                </div>
                                <div class="control">
                                    <input type="checkbox" name="activo" id="id_activo" class="" />
                                    <p class="help-text" style="font-size: xx-small; margin-bottom: 0; height: 13px; line-height: 13px"></p>
                                </div>
                            </fieldset>
                        </form>
                    </div>
                </div>
            </div>

        </div>
        <div class="modal-footer">
            <a href="javascript:;" class="btn btn-success action-save">Guardar</a>
            <a href="javascript:;" class="btn btn-info action-edit">Editar</a>
            <a href="javascript:;" class="btn btn-danger action-close"> Cerrar</a>
        </div>
    </div>

    <div class="modal fade static" id="modalFechaRubro" style="display: none;">
        <div class="modal-header">
            <h4 class="paneltitle"><span></span> Fechas de Diferir Rubro</h4>
        </div>
        <div class="modal-body panelbody">
            <div class='well' style="display: flex;">
                <div class="row-fluid">
                    <div class="span12">
                        <form id="frmFechaRubro" class="form-horizontal" onsubmit="return false">
                            <input type='hidden' name='id' value='0'/>
                            <fieldset id="fieldset_cuota" class="control-group nomargins span6" style="padding: 5px; min-height:45px; margin-left: 0 !important;" >
                                <div class="control-label label-text" style="display: table;height: 30px;">
                                    <div style="display: table-cell; vertical-align: middle; line-height: 11px">
                                        <label for="id_cuota" style="padding-right: 20px">Cuota</label>
                                    </div>
                                </div>
                                <div class="control">
                                    <input type="text" name="cuota" id="id_cuota" class="" />
                                    <p class="help-text" style="font-size: xx-small; margin-bottom: 0; height: 13px; line-height: 13px"></p>
                                </div>
                            </fieldset>
                            <fieldset id="fieldset_fecha" class="control-group nomargins span6" style="padding: 5px; min-height:45px; margin-left: 0 !important;" >
                                <div class="control-label label-text" style="display: table;height: 30px;">
                                    <div style="display: table-cell; vertical-align: middle; line-height: 11px">
                                        <label for="id_fecha" style="padding-right: 20px">Fecha</label>
                                    </div>
                                </div>
                                <div class="control">
                                    <input type="text" name="fecha" id="id_fecha" class="" />
                                    <p class="help-text" style="font-size: xx-small; margin-bottom: 0; height: 13px; line-height: 13px"></p>
                                </div>
                            </fieldset>
                        </form>
                    </div>
                </div>
            </div>

        </div>
        <div class="modal-footer">
            <a href="javascript:;" class="btn btn-success action-save">Guardar</a>
            <a href="javascript:;" class="btn btn-info action-edit">Editar</a>
            <a href="javascript:;" class="btn btn-danger action-close"> Cerrar</a>
        </div>
    </div>

    <div class="modal fade static" id="modalAcademicPeriodNiveles" style="display: none;">
        <div class="modal-header">
            <h4 class="paneltitle"><span></span> Niveles del Periodo Académico</h4>
        </div>
        <div class="modal-body panelbody">

        </div>
        <div class="modal-footer">
            {#            {% if perms.bd.puede_modificar_periodo_academico_matriculacion %}#}
            {#                <a href="javascript:;" class="btn btn-info action-edit">Editar</a>#}
            {#            {% endif %}#}
            <a href="javascript:;" class="btn btn-danger action-close"> Cerrar</a>
        </div>
    </div>

    <div class="modal fade static" id="modalAcademicPeriodFinanciero" style="display: none;">
        <div class="modal-header">
            <h4 class="paneltitle"><span></span> Financiero del Periodo Académico</h4>
        </div>
        <div class="modal-body panelbody">

        </div>
        <div class="modal-footer">
            {% if perms.bd.puede_modificar_periodo_academico_finanzas %}
                <a href="javascript:;" class="btn btn-info action-edit">Editar</a>
                <a href="javascript:;" class="btn btn-success action-save">Guardar</a>
            {% endif %}
            <a href="javascript:;" class="btn btn-danger action-close"> Cerrar</a>
        </div>
    </div>

    <div class="modal fade static" id="modalGrupoSocioeconomico" style="display: none;">
        <div class="modal-header">
            <h4 class="paneltitle"><span></span> Grupo Socioeconómico</h4>
        </div>
        <div class="modal-body panelbody">
            <div class="row-fluid">
                <div class="span12">
                    <form id="frmGrupoSocioeconomico" class="form-horizontal" onsubmit="return false">
                        <input type='hidden' name='id' value='0'/>
                        <fieldset id="fieldset_grupo_socioeconomico" class="control-group nomargins span12" style="padding: 5px; min-height:45px; margin-left: 0 !important;" >
                            <div class="control-label label-text" style="display: table;height: 30px;">
                                <div style="display: table-cell; vertical-align: middle; line-height: 11px">
                                    <label for="id_grupo_socioeconomico" style="padding-right: 20px">Grupo Socioeconómico</label>
                                </div>
                            </div>
                            <div class="control">
                                <select name="grupo_socioeconomico" id="id_grupo_socioeconomico" style="width: 100%">
                                    <option value="0">--------</option>
                                    {% for gse in grupos_socioeconomicos %}
                                        <option value="{{ gse.id }}">{{ gse }}</option>
                                    {% endfor %}
                                </select>
                                <p class="help-text" style="font-size: xx-small; margin-bottom: 0; height: 13px; line-height: 13px"></p>
                            </div>
                        </fieldset>
                        <fieldset id="fieldset_valor" class="control-group nomargins span12" style="padding: 5px; min-height:45px; margin-left: 0 !important;" >
                            <div class="control-label label-text" style="display: table;height: 30px;">
                                <div style="display: table-cell; vertical-align: middle; line-height: 11px">
                                    <label for="id_valor" style="padding-right: 20px">Valor</label>
                                </div>
                            </div>
                            <div class="control">
                                <input type="text" name="valor" id="id_valor" class="imp-numbersmall" />
                                <p class="help-text" style="font-size: xx-small; margin-bottom: 0; height: 13px; line-height: 13px"></p>
                            </div>
                        </fieldset>
                    </form>
                </div>
            </div>
        </div>
        <div class="modal-footer">
            <a href="javascript:;" class="btn btn-success action-save">Guardar</a>
            <a href="javascript:;" class="btn btn-info action-edit">Editar</a>
            <a href="javascript:;" class="btn btn-danger action-close"> Cerrar</a>
        </div>
    </div>

    <div class="modal fade static" id="modalAcademicPeriodAcademia" style="display: none;">
        <div class="modal-header">
            <h4 class="paneltitle"><span></span> Académica del Periodo</h4>
        </div>
        <div class="modal-body panelbody">

        </div>
        <div class="modal-footer">
            {% if perms.bd.puede_modificar_periodo_academico_academia %}
                <a href="javascript:;" class="btn btn-success action-save">Guardar</a>
                <a href="javascript:;" class="btn btn-info action-edit">Editar</a>
            {% endif %}
            <a href="javascript:;" class="btn btn-danger action-close"> Cerrar</a>
        </div>
    </div>

    <div class="modal fade static" id="modalCrontabPeriod" style="display: none;">
        <div class="modal-header">
            <h4 class="paneltitle"><span></span> Crontab del Periodo</h4>
        </div>
        <div class="modal-body panelbody">

        </div>
        <div class="modal-footer">
            {% if perms.bd.puede_modificar_periodo_crontab %}
                <a href="javascript:;" class="btn btn-success action-save">Guardar</a>
                <a href="javascript:;" class="btn btn-info action-edit">Editar</a>
            {% endif %}
            <a href="javascript:;" class="btn btn-danger action-close"> Cerrar</a>
        </div>
    </div>

    <div class="modal fade static" id="modalAcademicPeriodCronogramaMatriculacion" style="display: none;">
        <div class="modal-header">
            <h4 class="paneltitle"><span></span> Cronograma de matriculación</h4>
        </div>
        <div class="modal-body panelbody">

        </div>
        <div class="modal-footer">
            {#            {% if perms.bd.puede_modificar_periodo_academico_matriculacion %}#}
            {#                <a href="javascript:;" class="btn btn-info action-edit">Editar</a>#}
            {#            {% endif %}#}
            <a href="javascript:;" class="btn btn-danger action-close"> Cerrar</a>
        </div>
    </div>

    <div class="modal fade static" id="modalCronogramaCoordinacion" style="display: none;">
        <div class="modal-header">
            <h4 class="paneltitle"><span></span> Cronograma de coordinación</h4>
        </div>
        <div class="modal-body panelbody">

        </div>
        <div class="modal-footer">
            {% if perms.bd.puede_modificar_periodo_academico_matriculacion %}
                <a href="javascript:;" class="btn btn-success action-save">Guardar</a>
            {% endif %}
            <a href="javascript:;" class="btn btn-danger action-close"> Cerrar</a>
        </div>
    </div>

    <div class="modal fade static" id="modalCronogramaCarrera" style="display: none;">
        <div class="modal-header">
            <h4 class="paneltitle"><span></span> Cronograma de carrera</h4>
        </div>
        <div class="modal-body panelbody">

        </div>
        <div class="modal-footer">
            {% if perms.bd.puede_modificar_periodo_academico_matriculacion %}
                <a href="javascript:;" class="btn btn-success action-save">Guardar</a>
            {% endif %}
            <a href="javascript:;" class="btn btn-danger action-close"> Cerrar</a>
        </div>
    </div>

    <div class="modal fade static" id="modalPeriodoMalla" style="display: none;">
        <div class="modal-header">
            <h4 class="paneltitle"><span></span> Malla</h4>
        </div>
        <div class="modal-body panelbody">

        </div>
        <div class="modal-footer">
            {% if perms.bd.puede_modificar_periodo_academico_matriculacion %}
                <a href="javascript:;" class="btn btn-success action-save">Guardar</a>
            {% endif %}
            <a href="javascript:;" class="btn btn-danger action-close"> Cerrar</a>
        </div>
    </div>

    <div class="modal fade static" id="modalVerDetalleCostosNivel" style="display: none;">
        <div class="modal-header">
            <h4 class="paneltitle"><span></span> Detalle de costos</h4>
        </div>
        <div class="modal-body panelbody">

        </div>
        <div class="modal-footer">
            <a href="javascript:;" class="btn btn-danger action-close"> Cerrar</a>
        </div>
    </div>
{% endblock %}
