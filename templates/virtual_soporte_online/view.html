{% extends "basebs.html" %}
{% load sga_extras %}
{% block heading %}
    <script type="text/javascript">
        $(function() {
            busqueda = function(){
                var term = $("#searchinput").val().trim().toUpperCase();
                var c = $("#carrera_list").val();
                var nivel = $("#nivel").val();
                var modalidad = $("#modalidad").val();
                if(term.length>0){
                    bloqueointerface();
                    location.href = "/virtual_soporte_online?s="+term+"&carr="+c;
                }
                else{
                    bloqueointerface();
                    location.href = "/virtual_soporte_online?carr="+c+"&nivel="+nivel+"&modalidad="+modalidad;
                }
                return false;
            };

            $("#search").click(function() {
                busqueda();
            });
            $('#searchinput').keyup(function(e) {
                if(e.keyCode == 13) {
                    busqueda();
                }
            });

            $("#carrera_list").change(function () {
                busqueda();
            });

            $("#nivel").change(function () {
                busqueda();
            });
            $("#modalidad").change(function () {
                busqueda();
            });
            $("#id_fechaini, #id_fechafin").addClass("validate[required]").datepicker({format:"yyyy-mm-dd"}).on('changeDate', function(ev){ $(this).datepicker('hide'); })
            $("#cancel_ticketcancela").click(function(){
                $('#modalgenerarticket').modal('hide');
            });
            $("#boton_ticketgenerar").click(function(){
                bloqueointerface();
                var idticket = $('#idticke').val();
                location.href = '/virtual_soporte_online?action=virtual_incidente&idticket='+idticket;
            });

            $("#modal_autoregistro").click(function() {
                $("#id_fechaini").val('');
                $("#id_fechafin").val('');
                $("#idoperativoadd").val('');
                $("#idoperativoadd").val();
                $("#alertaingresoaddindicador").hide();
                $("#itemspaneladdaciones .incompletoaddindicador").hide();
                $("#itemspaneladdaciones .incompletovaloresaddindicador").hide();
                $("#generar_reporte").show();
                $("#guardar").hide();
                $("#modaladdindicadores").modal({backdrop:'static', width: '250px'}).modal('show');
            });

            $("#generar_reporte").click(function() {
                var id_fini = $("#id_fechaini").val();
                var id_ffin = $("#id_fechafin").val();
                if (id_fini=='' || id_ffin == ''){
                    smoke.alert('Ingresar fecha');
                    return false;
                }
                if (id_fini > id_ffin){
                    smoke.alert('La fecha desde no puede ser mayor a fecha hasta');
                    return false;
                }
                openwindow('GET' ,'/virtual_soporte_online', {action:'reporteincidentesexcell',fechainicio:id_fini,fechafin:id_ffin}, '_blank');
                $("#modaladdindicadores").modal("hide");
            });
            $("#cerrarindicadoresadd").click(function() {
                $("#modaladdindicadores .incompletoaddindicadores").hide();
                $("#modaladdindicadores .incompletovaloindicadores").hide();
                $("#modaladdindicadores").modal("hide");
            });
            $(".listaincidente").click(function () {
                var id = $(this).attr('userid');
                bloqueointerface();
                $.post("/virtual_soporte_online", {'action':'listaincidente', 'id': id}, function(data) {
                    if (data.result == 'ok') {
                        $.unblockUI();
                        bloqueointerface();
                        $(".panelbodyincidentes").html(data.data);
                        $(".itemspanelincidentes").modal({backdrop:'static', width: '1000px'}).modal('show');
                    }
                }, 'json');
            });
            $("#cerrarincidentes").click(function() {
                $(".itemspanelincidentes").modal("hide");
            });

            $('.ver_horario').click(function(){
                var id = $(this).attr('idi');
                bloqueointerface();
                $.ajax({
                    type: "POST",
                    url: "/virtual_soporte_online",
                    data: {'action': 'ver_horario', 'id': id},
                    success: function(data) {
                        if (data.result == 'ok') {
                            $.unblockUI();
                            $("#ver_horario_body").html(data.data);
                            $("#ver_horario_modal").modal({"backdrop":"static", "width": "1000px"}).modal("show");
                        } else {
                            $.unblockUI();
                            smoke.alert(data.mensaje);
                        }
                    },
                    error: function() {
                        $.unblockUI();
                        smoke.alert("Error al enviar los datos.");
                    },
                    dataType: "json"
                });
            });

            $('.enviar_horario_estudiante').click(function(){
                var id = $(this).attr('idi');
                bloqueointerface();
                $.ajax({
                    type: "POST",
                    url: "/virtual_soporte_online",
                    data: {'action': 'enviar_horario_estudiante', 'id': id},
                    success: function(data) {
                        if (data.result == 'ok') {
                            $.unblockUI();
                            location.reload(true);
                        } else {
                            $.unblockUI();
                            smoke.alert(data.mensaje);
                        }
                    },
                    error: function() {
                        $.unblockUI();
                        smoke.alert("Error al enviar los datos.");
                    },
                    dataType: "json"
                });
            });

            $('.enviar_horario').click(function(){
                bloqueointerface();
                $.ajax({
                    type: "POST",
                    url: "/virtual_soporte_online",
                    data: {'action': 'enviar_horario'},
                    success: function(data) {
                        if (data.result == 'ok') {
                            $.unblockUI();
                            location.reload(true);
                        } else {
                            $.unblockUI();
                            smoke.alert(data.mensaje);
                        }
                    },
                    error: function() {
                        $.unblockUI();
                        smoke.alert("Error al enviar los datos.");
                    },
                    dataType: "json"
                });
            });

            $(".estudiante_asignado").click(function () {
                openwindow('GET' ,'/virtual_soporte_online', {action: 'estudiante_asignado'},'_blank');
            });

            $("#actividades_pendientes").click(function () {
                var carrera = $('#carrera_list').val();
                var tipoactividad = $('#tipoactividad').val();
                $("#itemspanel_pdf_excel_tabla4").modal('hide');
                openwindow('POST' ,'/virtual_soporte_online', {action: 'informeactividades_pendientes','idcarrera':carrera, 'tipo':tipoactividad},'_blank');
            });
            $(".tabla4").click(function () {
                {#$("#itemspanel_pdf_excel_tabla4").modal({backdrop:'static', width: '300'}).modal('show');#}
                var carrera = $('#carrera_list').val();
                openwindow('POST' ,'/virtual_soporte_online', {action: 'informeactividades_pendientes','idcarrera':carrera},'_blank');
            });
            $("#itemspanel_cerrar_pdf_excel_tabla4").click(function () {
                $("#itemspanel_pdf_excel_tabla4").modal("hide");
            });
            $("#ver_horario_cerrar ").click(function () {
                $("#ver_horario_modal").modal("hide");
            });

            $(".generar_ticket_masivo").click(function(){
                var carrera = $('#carrera_list').val();
                var nivel = $('#nivel').val();
                if(carrera!=0){
                    bloqueointerface();
                    location.href = '/virtual_soporte_online?action=generar_ticket_masivo&idcarrera='+carrera+'&nivel='+nivel;
                }else{
                    smoke.alert("Seleccione carrera");
                }
            });

        });
        function generarticket(idticket) {
            $('#idticke').val(0);
            $('#paneltitle').html('');
            $('#idticke').val(idticket);
            $('#paneltitle').html($('#idnomuser'+idticket).val());
            bloqueointerface();
            $("#modalgenerarticket").modal({backdrop:'static', width: '600px'}).modal('show');
            $.unblockUI();
        }
        function imprimiractividadalumno(id){
            openwindow('GET' ,'/virtual_soporte_online', {action:'imprimiractividadalumno',idinscripcion:id}, '_blank');
        }
    </script>
{% endblock %}
<link href="//netdna.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
<script src="//netdna.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
<script src="//code.jquery.com/jquery-1.11.1.min.js"></script>
<!------ Include the above in your HEAD tag ---------->
<style type="text/css">

    .panel.with-nav-tabs .panel-heading{
        padding: 5px 5px 0 5px;
    }
    .panel.with-nav-tabs .nav-tabs{
        border-bottom: none;
    }
    .panel.with-nav-tabs .nav-justified{
        margin-bottom: -1px;
    }
    /********************************************************************/
    /*** PANEL DEFAULT ***/
    .with-nav-tabs.panel-default .nav-tabs > li > a,
    .with-nav-tabs.panel-default .nav-tabs > li > a:hover,
    .with-nav-tabs.panel-default .nav-tabs > li > a:focus {
        color: #777;
    }
    .with-nav-tabs.panel-default .nav-tabs > .open > a,
    .with-nav-tabs.panel-default .nav-tabs > .open > a:hover,
    .with-nav-tabs.panel-default .nav-tabs > .open > a:focus,
    .with-nav-tabs.panel-default .nav-tabs > li > a:hover,
    .with-nav-tabs.panel-default .nav-tabs > li > a:focus {
        color: #777;
        background-color: #ddd;
        border-color: transparent;
    }
    .with-nav-tabs.panel-default .nav-tabs > li.active > a,
    .with-nav-tabs.panel-default .nav-tabs > li.active > a:hover,
    .with-nav-tabs.panel-default .nav-tabs > li.active > a:focus {
        color: #555;
        background-color: #fff;
        border-color: #ddd;
        border-bottom-color: transparent;
    }
    .with-nav-tabs.panel-default .nav-tabs > li.dropdown .dropdown-menu {
        background-color: #f5f5f5;
        border-color: #ddd;
    }
    .with-nav-tabs.panel-default .nav-tabs > li.dropdown .dropdown-menu > li > a {
        color: #777;
    }
    .with-nav-tabs.panel-default .nav-tabs > li.dropdown .dropdown-menu > li > a:hover,
    .with-nav-tabs.panel-default .nav-tabs > li.dropdown .dropdown-menu > li > a:focus {
        background-color: #ddd;
    }
    .with-nav-tabs.panel-default .nav-tabs > li.dropdown .dropdown-menu > .active > a,
    .with-nav-tabs.panel-default .nav-tabs > li.dropdown .dropdown-menu > .active > a:hover,
    .with-nav-tabs.panel-default .nav-tabs > li.dropdown .dropdown-menu > .active > a:focus {
        color: #fff;
        background-color: #555;
    }
    /********************************************************************/
    /*** PANEL PRIMARY ***/
    .with-nav-tabs.panel-primary .nav-tabs > li > a,
    .with-nav-tabs.panel-primary .nav-tabs > li > a:hover,
    .with-nav-tabs.panel-primary .nav-tabs > li > a:focus {
        color: #fff;
    }
    .with-nav-tabs.panel-primary .nav-tabs > .open > a,
    .with-nav-tabs.panel-primary .nav-tabs > .open > a:hover,
    .with-nav-tabs.panel-primary .nav-tabs > .open > a:focus,
    .with-nav-tabs.panel-primary .nav-tabs > li > a:hover,
    .with-nav-tabs.panel-primary .nav-tabs > li > a:focus {
        color: #fff;
        background-color: #3071a9;
        border-color: transparent;
    }
    .with-nav-tabs.panel-primary .nav-tabs > li.active > a,
    .with-nav-tabs.panel-primary .nav-tabs > li.active > a:hover,
    .with-nav-tabs.panel-primary .nav-tabs > li.active > a:focus {
        color: #428bca;
        background-color: #fff;
        border-color: #428bca;
        border-bottom-color: transparent;
    }
    .with-nav-tabs.panel-primary .nav-tabs > li.dropdown .dropdown-menu {
        background-color: #428bca;
        border-color: #3071a9;
    }
    .with-nav-tabs.panel-primary .nav-tabs > li.dropdown .dropdown-menu > li > a {
        color: #fff;
    }
    .with-nav-tabs.panel-primary .nav-tabs > li.dropdown .dropdown-menu > li > a:hover,
    .with-nav-tabs.panel-primary .nav-tabs > li.dropdown .dropdown-menu > li > a:focus {
        background-color: #3071a9;
    }
    .with-nav-tabs.panel-primary .nav-tabs > li.dropdown .dropdown-menu > .active > a,
    .with-nav-tabs.panel-primary .nav-tabs > li.dropdown .dropdown-menu > .active > a:hover,
    .with-nav-tabs.panel-primary .nav-tabs > li.dropdown .dropdown-menu > .active > a:focus {
        background-color: #4a9fe9;
    }
    /********************************************************************/
    /*** PANEL SUCCESS ***/
    .with-nav-tabs.panel-success .nav-tabs > li > a,
    .with-nav-tabs.panel-success .nav-tabs > li > a:hover,
    .with-nav-tabs.panel-success .nav-tabs > li > a:focus {
        color: #3c763d;
    }
    .with-nav-tabs.panel-success .nav-tabs > .open > a,
    .with-nav-tabs.panel-success .nav-tabs > .open > a:hover,
    .with-nav-tabs.panel-success .nav-tabs > .open > a:focus,
    .with-nav-tabs.panel-success .nav-tabs > li > a:hover,
    .with-nav-tabs.panel-success .nav-tabs > li > a:focus {
        color: #3c763d;
        background-color: #d6e9c6;
        border-color: transparent;
    }
    .with-nav-tabs.panel-success .nav-tabs > li.active > a,
    .with-nav-tabs.panel-success .nav-tabs > li.active > a:hover,
    .with-nav-tabs.panel-success .nav-tabs > li.active > a:focus {
        color: #3c763d;
        background-color: #fff;
        border-color: #d6e9c6;
        border-bottom-color: transparent;
    }
    .with-nav-tabs.panel-success .nav-tabs > li.dropdown .dropdown-menu {
        background-color: #dff0d8;
        border-color: #d6e9c6;
    }
    .with-nav-tabs.panel-success .nav-tabs > li.dropdown .dropdown-menu > li > a {
        color: #3c763d;
    }
    .with-nav-tabs.panel-success .nav-tabs > li.dropdown .dropdown-menu > li > a:hover,
    .with-nav-tabs.panel-success .nav-tabs > li.dropdown .dropdown-menu > li > a:focus {
        background-color: #d6e9c6;
    }
    .with-nav-tabs.panel-success .nav-tabs > li.dropdown .dropdown-menu > .active > a,
    .with-nav-tabs.panel-success .nav-tabs > li.dropdown .dropdown-menu > .active > a:hover,
    .with-nav-tabs.panel-success .nav-tabs > li.dropdown .dropdown-menu > .active > a:focus {
        color: #fff;
        background-color: #3c763d;
    }
    /********************************************************************/
    /*** PANEL INFO ***/
    .with-nav-tabs.panel-info .nav-tabs > li > a,
    .with-nav-tabs.panel-info .nav-tabs > li > a:hover,
    .with-nav-tabs.panel-info .nav-tabs > li > a:focus {
        color: #31708f;
    }
    .with-nav-tabs.panel-info .nav-tabs > .open > a,
    .with-nav-tabs.panel-info .nav-tabs > .open > a:hover,
    .with-nav-tabs.panel-info .nav-tabs > .open > a:focus,
    .with-nav-tabs.panel-info .nav-tabs > li > a:hover,
    .with-nav-tabs.panel-info .nav-tabs > li > a:focus {
        color: #31708f;
        background-color: #bce8f1;
        border-color: transparent;
    }
    .with-nav-tabs.panel-info .nav-tabs > li.active > a,
    .with-nav-tabs.panel-info .nav-tabs > li.active > a:hover,
    .with-nav-tabs.panel-info .nav-tabs > li.active > a:focus {
        color: #31708f;
        background-color: #fff;
        border-color: #bce8f1;
        border-bottom-color: transparent;
    }
    .with-nav-tabs.panel-info .nav-tabs > li.dropdown .dropdown-menu {
        background-color: #d9edf7;
        border-color: #bce8f1;
    }
    .with-nav-tabs.panel-info .nav-tabs > li.dropdown .dropdown-menu > li > a {
        color: #31708f;
    }
    .with-nav-tabs.panel-info .nav-tabs > li.dropdown .dropdown-menu > li > a:hover,
    .with-nav-tabs.panel-info .nav-tabs > li.dropdown .dropdown-menu > li > a:focus {
        background-color: #bce8f1;
    }
    .with-nav-tabs.panel-info .nav-tabs > li.dropdown .dropdown-menu > .active > a,
    .with-nav-tabs.panel-info .nav-tabs > li.dropdown .dropdown-menu > .active > a:hover,
    .with-nav-tabs.panel-info .nav-tabs > li.dropdown .dropdown-menu > .active > a:focus {
        color: #fff;
        background-color: #31708f;
    }
    /********************************************************************/
    /*** PANEL WARNING ***/
    .with-nav-tabs.panel-warning .nav-tabs > li > a,
    .with-nav-tabs.panel-warning .nav-tabs > li > a:hover,
    .with-nav-tabs.panel-warning .nav-tabs > li > a:focus {
        color: #8a6d3b;
    }
    .with-nav-tabs.panel-warning .nav-tabs > .open > a,
    .with-nav-tabs.panel-warning .nav-tabs > .open > a:hover,
    .with-nav-tabs.panel-warning .nav-tabs > .open > a:focus,
    .with-nav-tabs.panel-warning .nav-tabs > li > a:hover,
    .with-nav-tabs.panel-warning .nav-tabs > li > a:focus {
        color: #8a6d3b;
        background-color: #faebcc;
        border-color: transparent;
    }
    .with-nav-tabs.panel-warning .nav-tabs > li.active > a,
    .with-nav-tabs.panel-warning .nav-tabs > li.active > a:hover,
    .with-nav-tabs.panel-warning .nav-tabs > li.active > a:focus {
        color: #8a6d3b;
        background-color: #fff;
        border-color: #faebcc;
        border-bottom-color: transparent;
    }
    .with-nav-tabs.panel-warning .nav-tabs > li.dropdown .dropdown-menu {
        background-color: #fcf8e3;
        border-color: #faebcc;
    }
    .with-nav-tabs.panel-warning .nav-tabs > li.dropdown .dropdown-menu > li > a {
        color: #8a6d3b;
    }
    .with-nav-tabs.panel-warning .nav-tabs > li.dropdown .dropdown-menu > li > a:hover,
    .with-nav-tabs.panel-warning .nav-tabs > li.dropdown .dropdown-menu > li > a:focus {
        background-color: #faebcc;
    }
    .with-nav-tabs.panel-warning .nav-tabs > li.dropdown .dropdown-menu > .active > a,
    .with-nav-tabs.panel-warning .nav-tabs > li.dropdown .dropdown-menu > .active > a:hover,
    .with-nav-tabs.panel-warning .nav-tabs > li.dropdown .dropdown-menu > .active > a:focus {
        color: #fff;
        background-color: #8a6d3b;
    }
    /********************************************************************/
    /*** PANEL DANGER ***/
    .with-nav-tabs.panel-danger .nav-tabs > li > a,
    .with-nav-tabs.panel-danger .nav-tabs > li > a:hover,
    .with-nav-tabs.panel-danger .nav-tabs > li > a:focus {
        color: #a94442;
    }
    .with-nav-tabs.panel-danger .nav-tabs > .open > a,
    .with-nav-tabs.panel-danger .nav-tabs > .open > a:hover,
    .with-nav-tabs.panel-danger .nav-tabs > .open > a:focus,
    .with-nav-tabs.panel-danger .nav-tabs > li > a:hover,
    .with-nav-tabs.panel-danger .nav-tabs > li > a:focus {
        color: #a94442;
        background-color: #ebccd1;
        border-color: transparent;
    }
    .with-nav-tabs.panel-danger .nav-tabs > li.active > a,
    .with-nav-tabs.panel-danger .nav-tabs > li.active > a:hover,
    .with-nav-tabs.panel-danger .nav-tabs > li.active > a:focus {
        color: #a94442;
        background-color: #fff;
        border-color: #ebccd1;
        border-bottom-color: transparent;
    }
    .with-nav-tabs.panel-danger .nav-tabs > li.dropdown .dropdown-menu {
        background-color: #f2dede; /* bg color */
        border-color: #ebccd1; /* border color */
    }
    .with-nav-tabs.panel-danger .nav-tabs > li.dropdown .dropdown-menu > li > a {
        color: #a94442; /* normal text color */
    }
    .with-nav-tabs.panel-danger .nav-tabs > li.dropdown .dropdown-menu > li > a:hover,
    .with-nav-tabs.panel-danger .nav-tabs > li.dropdown .dropdown-menu > li > a:focus {
        background-color: #ebccd1; /* hover bg color */
    }
    .with-nav-tabs.panel-danger .nav-tabs > li.dropdown .dropdown-menu > .active > a,
    .with-nav-tabs.panel-danger .nav-tabs > li.dropdown .dropdown-menu > .active > a:hover,
    .with-nav-tabs.panel-danger .nav-tabs > li.dropdown .dropdown-menu > .active > a:focus {
        color: #fff; /* active text color */
        background-color: #a94442; /* active bg color */
    }
    .panel-success {
        border-color: #d6e9c6;
    }
    .panel {
        margin-bottom: 20px;
        background-color: #fff;
        border: 1px solid transparent;
        border-radius: 4px;
        -webkit-box-shadow: 0 1px 1px rgba(0,0,0,.05);
        box-shadow: 0 1px 1px rgba(0,0,0,.05);
    }
    .container {
        padding-right: 15px;
        padding-left: 15px;
        margin-right: auto;
        margin-left: auto;
    }
    .panel.with-nav-tabs .panel-heading {
        padding: 5px 5px 0 5px;
    }
    .panel-success>.panel-heading {
        color: #3c763d;
        background-color: #dff0d8;
        border-color: #d6e9c6;
    }
    .panel-heading {
        padding: 10px 15px;
        border-bottom: 1px solid transparent;
        border-top-left-radius: 3px;
        border-top-right-radius: 3px;
    }
</style>
<script src="//code.jquery.com/jquery-1.11.1.min.js"></script>
<script src="//netdna.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
<script type="text/javascript">
    window.alert = function(){};
    var defaultCSS = document.getElementById('bootstrap-css');
    function changeCSS(css){
        if(css) $('head > link').filter(':first').replaceWith('<link rel="stylesheet" href="'+ css +'" type="text/css" />');
        else $('head > link').filter(':first').replaceWith(defaultCSS);
    }
    $( document ).ready(function() {
        var iframe_height = parseInt($('html').height());
        window.parent.postMessage( iframe_height, 'https://bootsnipp.com');
    });

</script>
{% block atras %}/{% endblock %}
{% block canvas %}
    <div class='row-fluid'>
        <div class='span12'>
            <h4>{{ title }} <br> {{ cant }}</h4>
        </div>
    </div>
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <div class="panel with-nav-tabs panel-success">
                    <div class="panel-heading">
                        <ul class="nav nav-tabs">
                            {#                            {% if usuariosonline %}#}
                            <li class="active"><a href="#tab1success" data-toggle="tab"><i class="fa fa-group"></i> Usuarios online</a></li>
                            {#                            {% endif %}#}
                            <li><a href="virtual_soporte_online?action=listatutores" ><i class="fa fa-user-circle-o"></i> Tutores</a></li>
                            <li><a href="#tab3success" data-toggle="tab"><i class="fa fa-file-excel-o"></i> Reporte</a></li>
                        </ul>
                    </div>
                    <div class="panel-body">
                        <div class="tab-content">
                            {% if usuariosonline %}
                                <div class="tab-pane fade in active" id="tab1success">
                                    <div class="row-fluid">
                                        <div {% if search or ids or carreraselect %}class='span2'{% else %}class='span2'{% endif %}>
                                            <div class="btn-group ">
                                                <a class="btn dropdown-toggle " data-toggle="dropdown" href="#"> Acciones <span class="caret"></span></a>
                                                <ul class="dropdown-menu">
                                                    <li><a href="/virtual_soporte_online?action=excellistado" target="_blank"><i class="fa fa-file-excel-o "></i> Descargar Incidentes</a></li>
                                                    <li><a class="estudiante_asignado" href="javascript:;" target="_blank" ><i class="fa fa-file-excel-o"></i> Descargar Estudiantes Asignados</a></li>
                                                    <li><a class="tabla4" href="javascript:;" target="_blank" ><i class="fa fa-file-excel-o"></i> Descargar Actividades Pendientes</a></li>
                                                    <li><a class="enviar_horario" href="javascript:;" target="_blank" ><i class="fa fa-send"></i> Enviar horario</a></li>
                                                    <li><a class="generar_ticket_masivo" href="javascript:;" target="_blank" ><i class="fa fa-send"></i> Generar Ticket masivo</a></li>
                                                </ul>
                                            </div>
                                        </div>
                                        <div class='span2'>
                                            <form class="form-search">
                                                <select id="carrera_list">
                                                    <option  value="0">TODOS</option>
                                                    {% for carrera in carreras %}
                                                        <option  {% if carreraselect == carrera.id %}selected{% endif %} value="{{ carrera.id }}">{{ carrera }}</option>
                                                    {% endfor %}
                                                </select>
                                            </form>
                                        </div>
                                        <div class='span2'>
                                            <form class="form-search">
                                                <select id="nivel">
                                                    <option  value="0">TODOS</option>
                                                    {% for niv in nivel %}
                                                        <option  {% if nivselect == niv.id %}selected{% endif %} value="{{ niv.id }}">{{ niv }}</option>
                                                    {% endfor %}
                                                </select>
                                            </form>
                                        </div>
                                        <div class='span2'>
                                            <form class="form-search">
                                                <select id="modalidad">
                                                    <option  value="0">TODAS MODALIDAD</option>
                                                        <option  {% if modalidadselect == 1 %}selected{% endif %} value="1">Presencial</option>
                                                        <option  {% if modalidadselect == 2 %}selected{% endif %} value="2">Semi Presencial</option>
                                                        <option  {% if modalidadselect == 3 %}selected{% endif %} value="3">En línea</option>
                                                </select>
                                            </form>
                                        </div>
                                        <div {% if search or ids or carreraselect %}class='span4'{% else %}class='span4'{% endif %}>
                                            <form class="form-search" onsubmit="return busqueda()">
                                                <input class='searchinput' type='text' id='searchinput' value='{{ search }}' autocomplete="off"/>
                                                <a href="javascript:;" id='search' class='btn btn-info'><i class="fa fa-search "></i> <t class="hidden-phone hidden-tablet ">Buscar</t></a>
                                                {% if search or ids or carreraselect %}
                                                    <a href="/virtual_soporte_online" class='btn btn-info bloqueo_pantalla'><i class="fa fa-refresh "></i> <t class="hidden-phone hidden-tablet ">Todos</t></a>
                                                {% endif %}
                                            </form>
                                        </div>
                                    </div>
                                    <div id="no-more-tables"><!-- inicio no more tables-->
                                        <div class="adv-table editable-table">
                                            <table class="table table-striped table-hover table-bordered" id="editable-sample">
                                                <thead>
                                                <tr>
                                                    <th style="width:100px;text-align: center">CEDULA</th>
                                                    <th >APELLIDOS Y NOMBRES</th>
                                                    <th style="width:400px;">DETALLES</th>
                                                    <th style="width:100px;">PROMEDIO GENERAL</th>
                                                    <th style="text-align: center;width:50px;">N. INCIDENTES</th>
                                                    <th style="text-align: center">TICKET</th>
                                                    <th style="text-align: center">ACTIVIDADES</th>
                                                </tr>
                                                </thead>
                                                <tbody>
                                                {% for usuarios in usuariosonline %}
                                                    <tr>
                                                        <td style="text-align: center">
                                                            {{ usuarios.matricula.inscripcion.persona.cedula }}
                                                            {% if usuarios.matricula.inscripcion.mi_nivel.nivel  %}
                                                                <span class="label label-info tu" title="Nivel academico">{{ usuarios.matricula.nivelmalla }}</span>
                                                            {% endif %}
                                                        </td>
                                                        <td >
                                                            {{ usuarios }}<br>
                                                            <span class="label label-info tu" data-original-title="{{ usuarios.matricula.inscripcion.persona.pais }}">{{ usuarios.matricula.inscripcion.persona.pais }}</span>
                                                            {% if usuarios.matricula.inscripcion.persona.ppl %}
                                                                <span class="label label-info tu" data-original-title="Privado de libertad">PPL</span>
                                                            {% endif %}
                                                            {% if usuarios.matricula.inscripcion.desertaonline %}
                                                                <br><span class="label label-warning tu" data-original-title="Desertó">DESERTÓ</span>
                                                                <br><span class="label label-warning tu" data-original-title="Obs">{{ usuarios.matricula.inscripcion.observaciondesertaonline }}</span>
                                                            {% endif %}
                                                            {% if usuarios.matricula.inscripcion.envioemail %}
                                                                <br>
                                                                <span class="label label-success tu" ><b>Se envió correo</b></span>
                                                            {% else %}
                                                                <br>
                                                                <span class="label label-warning tu" ><b>No se envió correo</b></span>
                                                            {% endif %}
                                                            <br>
                                                            {% with paralelo=usuarios.matricula|args:periodo|call:'paralelo_mas_comun' %}
                                                                <br><span class="label label-info tu" >Paralelo: {{ paralelo }}</span>
                                                            {% endwith %}
                                                            {% if usuarios.matricula.matriculagruposocioeconomico %}
                                                                <br><span class="label label-warning tu" title="Nivel Socio Económico">NSE: {{ usuarios.matricula.matriculagruposocioeconomico.nombre }}</span>
                                                            {% endif %}
                                                        </td>
                                                        <td >
                                                            <b>Email personal.:</b> {{ usuarios.matricula.inscripcion.persona.email }}<br>
                                                            <b>Email Institucional.:</b> {{ usuarios.matricula.inscripcion.persona.emailinst }}<br>
                                                            <b>Usuario:</b> {{ usuarios.matricula.inscripcion.persona.usuario }}<br>
                                                            <b>Año Nac:</b> {{ usuarios.matricula.inscripcion.persona.nacimiento|date:'Y-m-d'|default_if_none:""  }}<br>
                                                            {% if usuarios.matricula.inscripcion.persona.telefono %}<b>Tlfno.1.:</b> {{ usuarios.matricula.inscripcion.persona.telefono }}<br>{% endif %}
                                                            {% if usuarios.matricula.inscripcion.persona.telefono2 %}<b>Tlfno.2.:</b> {{ usuarios.matricula.inscripcion.persona.telefono2 }}<br>{% endif %}
                                                            {% if usuarios.matricula.inscripcion.persona.telefono_conv %}<b>Conv.:</b> {{ usuarios.matricula.inscripcion.persona.telefono_conv }}<br>{% endif %}
                                                            {% if usuarios.matricula.inscripcion.persona.pais %}<b>Pais.:</b> {{ usuarios.matricula.inscripcion.persona.pais }}<br>{% endif %}
                                                            {% if usuarios.matricula.inscripcion.persona.provincia %}<b>Prov.:</b> {{ usuarios.matricula.inscripcion.persona.provincia }}<br>{% endif %}
                                                            {% if usuarios.matricula.inscripcion.persona.canton %}<b>Canton.:</b> {{ usuarios.matricula.inscripcion.persona.canton }}<br>{% endif %}
                                                            {% if usuarios.matricula.inscripcion.persona.parroquia %}<b>Parroquia.:</b> {{ usuarios.matricula.inscripcion.persona.parroquia }}<br>{% endif %}
                                                            {% if usuarios.matricula.inscripcion.persona.sector %}<b>Sector.:</b> {{ usuarios.matricula.inscripcion.persona.sector }}<br>{% endif %}
                                                            {% if usuarios.matricula.inscripcion.persona.direccion %}<b>Calle principal.: </b>{{ usuarios.matricula.inscripcion.persona.direccion }}<br>{% endif %}
                                                            {% if usuarios.matricula.inscripcion.persona.direccion2 %}<b>Calle secundaria.: </b>{{ usuarios.matricula.inscripcion.persona.direccion2 }}<br>{% endif %}
                                                            {% if usuarios.matricula.inscripcion.persona.num_direccion %}<b>Número residencia.: </b>{{ usuarios.matricula.inscripcion.persona.num_direccion }}<br>{% endif %}
                                                        </td>
                                                        <td style="text-align: center" >
                                                            {#                                                            {% with numero=usuarios.inscripcion|call:'porcentaje_total_estudiante' %}#}
                                                            {#                                                                {{ numero }}%#}
                                                            {#                                                            {% endwith %}#}

                                                            {% with numero=usuarios.matricula.inscripcion|args:periodo|call:'porcentaje_total_estudiante_sobre_70_migrada' %}
                                                                {{ numero }}
                                                            {% endwith %}
                                                        </td>
                                                        <td style="text-align: center">
                                                            <a href="#" userid="{{ usuarios.id }}" title="Ver detalle" class="btn btn-warning listaincidente tu"><i class="fa fa-list"></i> {{ usuarios.totalincidentes }}</a>
                                                        </td>
                                                        <td style="text-align: center">
                                                            {% if usuarios.incidenteasignado %}
                                                                <a href='/virtual_soporte_online?action=virtual_incidente&idticket={{ usuarios.id }}' title="Ticket asignado" class="btn btn-danger bloqueo_pantalla tu"><i class="fa fa-ticket fa-lg"></i> Asignado</a>
                                                            {% else %}
                                                                {% if not usuarios.iniciado %}
                                                                    <a href="#" title="Generar ticket" onclick="generarticket({{ usuarios.id }})" class="btn btn-success tu"><i class="fa fa-ticket fa-lg"></i> Generar</a>
                                                                    <input type="hidden" id="idnomuser{{ usuarios.id }}" name="idnomuser{{ usuarios.id }}" value="{{ usuarios.matricula.inscripcion.persona }}">
                                                                {% else %}
                                                                    <a href='/virtual_soporte_online?action=virtual_incidente&idticket={{ usuarios.id }}' title="Ticket iniciado" class="btn btn-warning bloqueo_pantalla tu"><i class="fa fa-ticket fa-lg"></i> Iniciado</a>
                                                                {% endif %}
                                                            {% endif %}
                                                        </td>
                                                        <td style="text-align: center">
                                                            <div class="btn-group">
                                                                <a class="btn btn-mini dropdown-toggle" data-toggle="dropdown" href="javascript:;">Acciones<span class="caret"></span></a>
                                                                <ul class="dropdown-menu pull-right" style="text-align: left">
                                                                    <li>
                                                                        <a href='/virtual_soporte_online?action=editarsoporteinscripcion&id={{ usuarios.matricula.inscripcion.id }}'  ><i class="fa fa-edit"></i> Editar</a>
                                                                        {% if periodo.usa_sakai %}
                                                                            <a onclick="imprimiractividadalumno({{ usuarios.matricula.inscripcion.id }})" href="javascript:;"  ><i class="fa fa-download "></i> Descargar reporte actividades</a>
                                                                            {#                                                                            <a href="javascript:;" class="ver_horario" idi="{{ usuarios.matricula.inscripcion.id }}"  ><i class="fa fa-calendar"></i> Ver horario</a>#}

                                                                            <a href="javascript:;" class="enviar_horario_estudiante" idi="{{ usuarios.matricula.inscripcion.id }}"  ><i class="fa fa-send"></i> Enviar horario </a>
                                                                        {% endif %}
                                                                        {% if perms.sga.puede_resetear_clave_inscripcion_virtual %}
                                                                            <a class="confirmacionmodal " href="javascript:;" nhref="/virtual_soporte_online?action=resetear_clave_admision_virtual&id={{ usuarios.matricula.inscripcion.id }}"><i class="fa fa-key"></i> Resetear Clave Usuario</a>
                                                                        {% endif %}
                                                                    </li>
                                                                    <li><a href="/virtual_soporte_online?action=seguimiento_asignaturas_alumno&id={{ usuarios.matricula.inscripcion.id }}&idm={{  usuarios.matricula.id }}" target="_blank" ><span class="fa fa-list "></span> Asignaturas</a></li>
                                                                    {% if usuarios.matricula.inscripcion.carrera.modalidad == 3 and usuarios.matricula.inscripcion.carrera.mi_coordinacion2 != 9 %}
                                                                        <li>   <a href="/virtual_soporte_online?action=horarioexamen&id={{ usuarios.matricula.id }}" target="_blank"><span class="fa fa-calendar"></span> Ver horario exámen</a></li>
                                                                    {% endif %}
                                                                    <li><a href="/virtual_soporte_online?action=horario&id={{ usuarios.matricula.id }}"><i class="fa fa-calendar"></i> Horario </a></li>
                                                                    <li><a href="/virtual_soporte_online?action=rubros&id={{ usuarios.matricula.inscripcion.persona.id }}" ><i class="fa fa-money"></i> Rubros</a></li>
                                                                    <li><a href="/virtual_soporte_online?action=alumalla&id={{ usuarios.matricula.inscripcion.id }}" ><i class="fa fa-th"></i> Su malla</a></li>
                                                                    <li><a href="/virtual_soporte_online?action=record&id={{ usuarios.matricula.inscripcion.id }}" ><i class="fa fa-flag"></i> Su record</a></li>
                                                                    <li><a href="/virtual_soporte_online?action=asistencias&id={{ usuarios.matricula.id }}" ><i class="fa fa-check"></i> Asistencias</a></li>
                                                                </ul>
                                                            </div>


                                                        </td>
                                                    </tr>
                                                {% empty %}
                                                    <tr>
                                                        <td colspan="7">
                                                            no existen datos
                                                        </td>
                                                    </tr>
                                                {% endfor %}
                                                </tbody>
                                            </table>
                                        </div><!-- adv-table editable-table -->
                                    </div>
                                    <div class='row-fluid'>
                                        <div class="span12">
                                            {% if paging.num_pages > 20 %}
                                                <div class='pagination'>
                                                    <ul>
                                                        {% if paging.primera_pagina %}
                                                            <li><a class="bloqueo_pantalla" href="/virtual_soporte_online?{% if search %}s={{ search }}&{% endif %}{% if carreraselect %}carr={{ carreraselect }}&{% endif %}{% if nivselect %}nivel={{ nivselect }}&{% endif %}{% if modalidadselect %}modalidad={{ modalidadselect }}&{% endif %}page=1">1</a></li>
                                                            <li><a class="bloqueo_pantalla" href="/virtual_soporte_online?{% if search %}s={{ search }}&{% endif %}{% if carreraselect %}carr={{ carreraselect }}&{% endif %}{% if nivselect %}nivel={{ nivselect }}&{% endif %}{% if modalidadselect %}modalidad={{ modalidadselect }}&{% endif %}page={{ paging.ellipsis_izquierda }}" class="active">...</a></li>
                                                        {% endif %}
                                                        {% for pagenumber in paging.paginas %}
                                                            <li {%  if pagenumber == page.number %}class='active'{% endif %}><a class="bloqueo_pantalla" href="/virtual_soporte_online?{% if search %}s={{ search }}&{% endif %}{% if carreraselect %}carr={{ carreraselect }}&{% endif %}{% if nivselect %}nivel={{ nivselect }}&{% endif %}{% if modalidadselect %}modalidad={{ modalidadselect }}&{% endif %}page={{ pagenumber }}">{{ pagenumber }}</a></li>
                                                        {% endfor %}
                                                        {% if paging.ultima_pagina %}
                                                            <li><a class="bloqueo_pantalla" href="/virtual_soporte_online?{% if search %}s={{ search }}&{% endif %}{% if carreraselect %}carr={{ carreraselect }}&{% endif %}{% if nivselect %}nivel={{ nivselect }}&{% endif %}{% if modalidadselect %}modalidad={{ modalidadselect }}&{% endif %}page={{ paging.ellipsis_derecha }}" class="active">...</a></li>
                                                            <li><a class="bloqueo_pantalla" href="/virtual_soporte_online?{% if search %}s={{ search }}&{% endif %}{% if carreraselect %}carr={{ carreraselect }}&{% endif %}{% if nivselect %}nivel={{ nivselect }}&{% endif %}{% if modalidadselect %}modalidad={{ modalidadselect }}&{% endif %}page={{ paging.num_pages }}">{{ paging.num_pages }}</a></li>
                                                        {% endif %}
                                                    </ul>
                                                </div>
                                            {% else %}
                                                <div class='pagination'>
                                                    <ul>
                                                        {% for pagenumber in paging.page_range %}
                                                            <li {%  if pagenumber == page.number %}class='active'{% endif %}><a href="/virtual_soporte_online?{% if search %}s={{ search }}&{% endif %}{% if carreraselect %}carr={{ carreraselect }}&{% endif %}{% if nivselect %}nivel={{ nivselect }}&{% endif %}{% if modalidadselect %}modalidad={{ modalidadselect }}&{% endif %}page={{ pagenumber }}">{{ pagenumber }}</a></li>
                                                        {% endfor %}
                                                    </ul>
                                                </div>
                                            {% endif %}
                                        </div>
                                    </div>
                                </div>
                            {% endif %}
                            <div class="tab-pane fade" id="tab3success">
                                <div class="row-fluid">
                                    <ul class="span10" style="padding-top: 20px;">
                                        <div style="width:100px; text-align: center; float: left; margin: 15px 5px 5px 5px">
                                            <a class="bloqueo_pantalla" href="/virtual_soporte_online?action=lista_reportes_soporte" style="color: #3e5771;">
                                                <span style="font-size: 60px;" class="fa fa-edit"></span>
                                            </a><br>
                                            <span style="text-align: center;">Reportes Generados</span>
                                        </div>
                                        <div style="width:100px; text-align: center; float: left; margin: 15px 5px 5px 5px">
                                            <a href="#" id="modal_autoregistro">
                                                <span style="font-size: 60px;" class="fa fa-file-excel-o"></span>
                                            </a><br>
                                            <span style="text-align: center;"> Descargar incidentes</span>
                                        </div>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>
    <div class="modal fade static" id="modalgenerarticket" style="display: none;">
        <div class="modal-header">
            <h4 id="paneltitle">Generar ticke</h4>
        </div>
        <div class="modal-body notoficacionbody">
            <p style="margin-top: 16px;">Esta seguro(a) que desea generar ticket?</p>
            <input type="hidden" id="idticke" name="idticke">
        </div>
        <div class="modal-footer">
            <p style="text-align: right; margin-bottom: 0">
                <a href="javascript:;" id="boton_ticketgenerar" class='btn btn-success'> Generar ticket</a>
                <a href="javascript:;" id="cancel_ticketcancela" class='btn btn-default'> Cancelar</a>
            </p>
        </div>
    </div>
    <div class="modal fade static" id="modaladdindicadores" style="display: none;">
        <div class="modal-header">
            <h3 class="paneltitle">Reporte incidentes</h3>
        </div>
        <div class="modal-body panelbody">
            <div class="alert alert-info incompletoaddindicadores" style="display: none;">
                <i class="fa fa-info-sign"></i> Complete todos los campos para continuar
            </div>
            <div class="alert alert-danger" id="incompletovaloresaddindicadores" style="display: none;">
                <i class="fa fa-info-sign"></i> Revise los valores, la fecha/hora DESDE no debe ser mayor a la fecha/hora HASTA
            </div>
            <div class="alert alert-danger" id="alertaingresoaddindicadores" style="display: none;"> FECHAS YA FUERON INGRESADAS</div>
            <div class="row-fluid">
                <form id="formulario2" class='form-vertical' action="" method="POST" >
                    <b><span class="carreraindicador"> </span></b><br>
                    Fecha desde.:<br><input type="text" name="id_fechaini" id="id_fechaini" placeholder="Fecha desde">
                    <br>Fecha hasta.:<br><input type="text" name="id_fechafin" id="id_fechafin" placeholder="Fecha hasta">
                </form>
            </div>
        </div>
        <div class="modal-footer">
            <a href="javascript:;" class="btn btn-warning" id="generar_reporte"><i class="fa fa-file-excel-o"></i> Generar Reporte</a>
            <a href="javascript:;" class="btn btn-cerrar btn-info" id="cerrarindicadoresadd">Cerrar</a>
        </div>
    </div>
    <div class="modal fade static itemspanelincidentes" id="itemspanelincidentes" style="display: none;">
        <div class="modal-header">
            <h3 class="paneltitle">Incidentes </h3>
        </div>
        <div class="modal-body panelbodyincidentes">
        </div>
        <div class="modal-footer">
            <table class="pull-right">
                <tr>
                    <td><a href="javascript:;" id="cerrarincidentes" class="btn btn-info">Cerrar</a></td>
                </tr>
            </table>
        </div>
    </div>
    <div class="modal fade static itemspanelincidentesdetalle" id="itemspanelincidentesdetalle" style="display: none;">
        <div class="modal-header">
            <h3 class="paneltitle">Detalle Incidente</h3>
        </div>
        <div class="modal-body panelbodyincidentesdetalle">
        </div>
        <div class="modal-footer">
            <table class="pull-right">
                <tr>
                    <td><a href="javascript:;" id="cerrarincidentesdetalle" class="btn btn-info">Cerrar</a></td>
                </tr>
            </table>
        </div>
    </div>

    <div class="modal fade static" id="ver_horario_modal" style="display: none;">
        <div class="modal-header">
            <h3 class="paneltitle">HORARIO</h3>
        </div>
        <div class="modal-body" id="ver_horario_body">

        </div>
        <div class="modal-footer">
            <div style="float: right">
                <a href="javascript:;" id="ver_horario_cerrar" class="btn btn-info"> Cerrar</a>
            </div>
        </div>
    </div>


    <div class="modal fade static" id="itemspanel_pdf_excel_tabla4" style="display: none;">
        <div class="modal-header">
            <h5 class="paneltitle_pdf_excel_tabla4">Seleccione tipo actividad.</h5>
        </div>
        <div class="modal-body panelbody_pdf_excel_tabla4">
            <div class="alert alert-danger invalidofechas1" style="display: none">
                <i class="fa fa-info-sign"></i> Seleccione los campos para continuar...!!!
            </div>
            <div style="text-align: center;">
                <form class="form-search">
                    <select id="tipoactividad">
                        <option  value="1">Tareas</option>
                        <option  value="2">Foros</option>
                        <option  value="3">Test</option>
                    </select>
                </form>

            </div>
        </div>
        <div class="modal-footer" style="text-align: center">
            <a href="javascript:;" class="btn btn-danger" id="actividades_pendientes"><i class="fa fa-plus"></i> Procesar</a>
            <a href="javascript:;" class="btn btn-info" id="itemspanel_cerrar_pdf_excel_tabla4"> Cerrar</a>
        </div>
    </div>
{% endblock %}
