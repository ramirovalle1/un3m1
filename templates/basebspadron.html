{% load sga_extras %}
<!DOCTYPE html>
<!--suppress JSUnresolvedVariable -->
<html lang="es" data-location="UNEMI">
<head>
    <meta charset="utf-8">
    <title>{% block pagetitle %}{{ title }}{% endblock %}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="UNEMI">

    <link href="/static/sweet2/sweetalert2.css?1.0.0" rel="stylesheet"/>
    <script src="/static/sweet2/sweetalert2.js?1.0.0"></script>
    <script type='text/javascript' src="/static/js/jquery.min.js?4.0.0"></script>
    <script type='text/javascript' src="/static/js/jquery.blockUI.js?4.0.0"></script>
    <script type='text/javascript' src="/static/js/jquery.maskedinput.min.js?4.0.0"></script>
    <script type='text/javascript' src="/static/js/sysend.js?4.0.0"></script>
    <script type='text/javascript' src="/static/js/smoke.js?4.0.0"></script>
    <script type='text/javascript' src="/static/js/bs/bootstrap.min.js?4.0.0"></script>
    <script type='text/javascript' src="/static/js/bootstrap-datepicker.js?4.0.0"></script>
    <script type='text/javascript' src="/static/js/bootstrap-timepicker.js?4.0.0"></script>
    <script type='text/javascript' src="/static/js/bootstrap-modal.js?4.0.0"></script>
    <script type='text/javascript' src="/static/js/bootstrap-modalmanager.js?4.0.0"></script>
    <script type='text/javascript' src="/static/js/big.min.js?4.0.0"></script>
    <script type='text/javascript' src='/static/js/jquery.flexbox.js?4.0.0'></script>
    <script type='text/javascript' src='/static/js/dragdivscroll.js?4.0.0'></script>
    <script type='text/javascript' src='/static/js/jquery.dataTables.min.js?4.0.0'></script>
    <link href="/static/css/smoke.css?4.0.0" rel="stylesheet" type="text/css" media="screen"/>
    <link href="/static/css/bootstrap.min.css?4.0.0" rel="stylesheet"/>
    <link href="/static/css/bootstrap-responsive.css?4.0.0" rel="stylesheet"/>
    <link href='/static/css/font-awesome.css?4.0.0' rel='stylesheet'/>
    <link href='/static/css/font-awesome.min.css?4.0.0' rel='stylesheet'/>
    <link href="/static/css/stylesbs.css?4.0.0" rel='stylesheet'/>
    <link href="/static/css/datepicker.css?4.0.0" rel='stylesheet'/>
    <link href="/static/css/bootstrap-timepicker.css?4.0.0" rel='stylesheet'/>
    <link href="/static/css/bootstrap-modal.css?4.0.1" rel='stylesheet'/>
    <link href="/static/css/jquery.flexbox.css?4.0.0" type="text/css" rel="stylesheet"/>
    <link href="/static/css/jquery.dataTables.css?4.0.0" type="text/css" rel="stylesheet"/>
    <script type="text/javascript" src="/static/js/select2.js?v=4.0.0"></script>
    <link type="text/css" rel="stylesheet" href="/static/css/select2.css?v=4.0.0">
    <script type="text/javascript" src="/static/js/snow.js?4.0.0"></script>
    <script src="/static/js/offline/v0.7.13/offline.min.js"></script>
    <link rel="stylesheet" href="/static/js/offline/v0.7.13/offline-theme-default.css" />
    <link rel="stylesheet" href="/static/js/offline/v0.7.13/offline-language-spanish.css" />
    <style>
        @keyframes spinner-border {
            to {
                transform: rotate(360deg);
            }
        }

        .spinner-border {
            display: inline-block;
            width: 15rem;
            height: 15rem;
            vertical-align: text-bottom;
            border: 50% solid currentColor;
            border-right-color: transparent;
            border-radius: 50%;
            animation: spinner-border .75s linear infinite;
        }

        .spinner-border-sm {
            width: 15rem;
            height: 15rem;
            border-width: 50%;
        }


        @keyframes spinner-grow {
            0% {
                transform: scale(0);
            }
            50% {
                opacity: 1;
                transform: none;
            }
        }

        .spinner-grow {
            display: inline-block;
            width: 15rem;
            height: 15rem;
            vertical-align: text-bottom;
            border-radius: 50%;
            opacity: 66%;
            animation: spinner-grow .75s linear infinite;
        }

        .spinner-grow-sm {
            width: 15rem;
            height: 15rem;
        }

        div.online-indicator {
            display: inline-block;
            width: 15px;
            height: 15px;
            margin-right: 10px;
            background-color: #0fcc45;
            border-radius: 50%;
            position: relative;
        }
        span.blink-online {
            display: block;
            width: 15px;
            height: 15px;
            background-color: #0fcc45;
            opacity: 0.7;
            border-radius: 50%;

            animation: blink 1s linear infinite;
        }

        div.offline-indicator {
            display: inline-block;
            width: 15px;
            height: 15px;
            margin-right: 10px;
            background-color: #ba2121;
            border-radius: 50%;
            position: relative;
        }
        span.blink-offline {
            display: block;
            width: 15px;
            height: 15px;
            background-color: #ba2121;
            opacity: 0.7;
            border-radius: 50%;
            animation: blink 1s linear infinite;
        }

        /*Animations*/

        @keyframes blink {
            100% { transform: scale(2, 2);
                opacity: 0;
            }
        }
    </style>

    <!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <!-- Global site tag (gtag.js) - Google Analytics -->

    <script async src="https://www.googletagmanager.com/gtag/js?id=G-4ZBWFH9X5W"></script>
    <script>
        window.dataLayer = window.dataLayer || [];

        function gtag() {
            dataLayer.push(arguments);
        }

        gtag('js', new Date());

        gtag('config', 'G-4ZBWFH9X5W');
    </script>

    <link rel="shortcut icon" href="/static/images/aok/favicon32X32.ico?1.6.0">
    <script type="text/javascript">
        window.RTCPeerConnection = window.RTCPeerConnection || window.mozRTCPeerConnection || window.webkitRTCPeerConnection;   //compatibility for firefox and chrome
        var modalposition = 0;
        var mensaje = '';
        var capippriva = ''

        function converToAscii(str) {
            return str.normalize("NFD").replace(/[\u0300-\u036f]/g, "").toUpperCase();
        }

        $(function () {

            var
                $online = $('.online'),
                $offline = $('.offline');

            Offline.on('confirmed-down', function () {
                //console.log("down");
                $(".signal_line").html("<div class='offline-indicator'> <span class='blink-offline'></span></div>")
                $online.fadeOut(function () {
                    $offline.fadeIn();
                });
            });

            Offline.on('confirmed-up', function () {
                //console.log("up");
                $(".signal_line").html("<div class='online-indicator'> <span class='blink-online'></span></div>")
                $offline.fadeOut(function () {
                    $online.fadeIn();
                });
            });

            $('#periodoselectorall').select2();

            $('#accPeriodo').click(function () {
                $('#buscarPeriodo').val('');
                var listaPeriodos = $('#listaPeriodos').children('li').toArray();
                for (i = 1; i < listaPeriodos.length; i++) {
                    var li = listaPeriodos[i];
                    $(li).removeAttr('style');
                }
            });

            $('#buscarPeriodo').mouseenter(function () {
                $(this).focus();
            });

            $('#buscarPeriodo').keyup(function () {
                var listaPeriodos = $('#listaPeriodos').children('li').toArray();
                for (i = 1; i < listaPeriodos.length; i++) {
                    var li = listaPeriodos[i];
                    if (!converToAscii($(li).children('a:first').html()).includes(converToAscii($(this).val()))) {
                        $(li).attr('style', 'display:none');
                    } else {
                        $(li).removeAttr('style');
                    }
                }
            });

            if (!('contains' in String.prototype)) {
                String.prototype.contains = function (str, startIndex) {
                    return -1 !== String.prototype.indexOf.call(this, str, startIndex);
                };
            }

            $("*").focusin(function () {
                $('.datepicker').css({"display": "none"});
            });

            showWaiting = function (titulo, mensaje, close) {
                var panel = $("#waitpanel");
                $("#waitpaneltitle").html(titulo);
                $("#waitpanelbody").html(mensaje);
                if (!close) {
                    panel.modal({keyboard: false, backdrop: 'static'});
                }
                panel.modal("show");
            };

            hideWaiting = function () {
                $("#waitpanel").modal("hide");
            };

            sinurlatrasbutton = function () {
                if (location.pathname == '/') {
                    $("#urlatrasbutton").remove();
                } else {
                    $("#idbuscador").remove();
                }
            };

            deshabilitar = function (nombre) {
                $(nombre).attr({"disabled": "disabled"});
            };

            habilitar = function (nombre) {
                $(nombre).removeAttr("disabled").removeAttr("readonly");
            };

            // Funcion de redondeo que reemplaza a la funcion math.round() de javascript por fallos al redondear
            redondeo = function (numero, presicion) {
                var multiplicador = Math.pow(10, presicion + 1);
                var num_multi = Math.floor(numero * multiplicador);
                var num_redondeado = (Math.round(num_multi / 10)) * 10 / multiplicador;

                if (num_redondeado == 0) {
                    return 0;
                } else {
                    if (!isNaN(num_redondeado))
                        return num_redondeado;
                    else
                        return 0;
                }
            };


            openwindow_reporte = function (url, width, height) {
                newwindow = window.open(url, 'name', 'height=' + height + ' ,width=' + width);
            };

            openwindow = function (verb, url, data, target) {
                var form = document.createElement("form");
                form.action = url;
                form.method = verb;
                form.target = target || "_self";
                if (data) {
                    for (var key in data) {
                        var input = document.createElement("textarea");
                        input.name = key;
                        input.value = typeof data[key] === "object" ? JSON.stringify(data[key]) : data[key];
                        form.appendChild(input);
                    }
                }
                form.style.display = 'none';
                document.body.appendChild(form);
                console.log("pasa");
                form.submit();
            };

            fechavalida = function (elemento) {
                var valor = elemento.val().toString();
                //Validate dd/mm/yyyy or dd-mm-yyyy format
                var dateformat = /^(0?[1-9]|[12][0-9]|3[01])[\/\-](0?[1-9]|1[012])[\/\-]\d{4}$/;
                // Match the date format through regular expression
                if (valor.match(dateformat)) {
                    //Test which seperator is used '/' or '-'
                    var opera1 = valor.split('/');
                    var opera2 = valor.split('-');
                    lopera1 = opera1.length;
                    lopera2 = opera2.length;
                    // Extract the string into month, date and year
                    if (lopera1 > 1) {
                        var pdate = valor.split('/');
                    } else if (lopera2 > 1) {
                        var pdate = valor.split('-');
                    }
                    var dd = parseInt(pdate[0]);
                    var mm = parseInt(pdate[1]);
                    var yy = parseInt(pdate[2]);
                    // Create list of days of a month [assume there is no leap year by default]
                    var ListofDays = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];
                    if (mm == 1 || mm > 2) {
                        if (dd > ListofDays[mm - 1]) {
                            //alert('Invalid date format!');
                            elemento.val(fechaactual());
                            return;
                        }
                    }
                    if (mm == 2) {
                        var lyear = false;
                        if ((!(yy % 4) && yy % 100) || !(yy % 400)) {
                            lyear = true;
                        }
                        if ((lyear == false) && (dd >= 29)) {
                            //alert('Invalid date format!');
                            elemento.val(fechaactual());
                            return;
                        }
                        if ((lyear == true) && (dd > 29)) {
                            //alert('Invalid date format!');
                            elemento.val(fechaactual());
                            return;
                        }
                    }
                } else {
                    //alert("Invalid date format!");
                    elemento.val(fechaactual());
                    return;
                }
                //return;
            };

            fechaactual = function () {
                var d = new Date();
                var month = d.getMonth() + 1;
                var day = d.getDate();
                var fecha = (day < 10 ? '0' : '') + day + '-' + (month < 10 ? '0' : '') + month + '-' + d.getFullYear();
                return fecha;
            };

            numerico = function (elemento, min, max, decimales) {
                var nvalor;
                var valor = elemento.val();
                if (valor == "") {
                    valor = parseFloat(0).toFixed(decimales);
                    elemento.val(valor);
                    return;
                }
                if (isNaN(valor)) {
                    nvalor = parseFloat(min).toFixed(decimales);
                    elemento.val(nvalor);
                    return;
                }
                if (valor < min) {
                    nvalor = parseFloat(min).toFixed(decimales);
                    elemento.val(nvalor);
                    return;
                }
                if (max > 0 && valor > max) {
                    nvalor = parseFloat(max).toFixed(decimales);
                    elemento.val(nvalor);
                    return;
                }
                nvalor = parseFloat(valor).toFixed(decimales);
                elemento.val(nvalor);
            };

            digitos = function (elemento) {
                var valor = elemento.val();
                if (valor == "") {
                    elemento.val("");
                    return;
                }
                if (isNaN(valor)) {
                    elemento.val("");
                    return;
                } else if (valor.indexOf("-") != -1 || valor.indexOf(".") != -1 || valor.indexOf(",") != -1) {
                    elemento.val("");
                    return;
                } else {
                    elemento.val(valor.trim());
                }
            };

            validacionesnumericas = function () {
                $(".validarnumero").blur(function () {
                    numerico($(this), 0, 0, 0);
                });

                $(".validarmoneda").blur(function () {
                    numerico($(this), 0, 0, 2);
                });
            };

            sinurlatrasbutton();

            $(".listaperiodos").click(function () {
                $("#periodospanel").modal("show");
            });

            $("#cerrarperiodospanel").click(function () {
                $("#periodospanel").modal("hide");
            });

            cerrar_viewhtml = function () {
                $("#viewhtml").modal("hide");
            };

            $("#seleccionarperiodospanel").click(function () {
                var pid = $("#periodoselectorall").val();
                $("#periodospanel").modal("hide");
                bloqueointerface();
                $.ajax({
                    type: "POST",
                    url: "/",
                    data: {'action': 'periodo', 'id': pid},
                    success: function (data) {
                        if (data.result == 'ok') {
                            location.href = location.pathname;
                        } else {
                            $.unblockUI();
                            smoke.alert("Error al cambiar de periodo");
                        }
                    },
                    error: function () {
                        $.unblockUI();
                        smoke.alert("Error al cambiar de periodo");
                    },
                    dataType: "json"
                });
            });

            {% if chequear_correo %}
                chequearemial = function () {
                    $.ajax({
                        type: "POST",
                        url: "/api",
                        data: {'a': 'checkmail'},
                        success: function (data) {
                            if (data.result == 'ok') {
                                if (data.mensajes) {
                                    $("#checkmailicon").removeClass("hidden").show();
                                } else {
                                    $("#checkmailicon").addClass("hidden").hide();
                                }
                            }
                        },
                        dataType: "json"
                    });
                };

                setInterval(chequearemial, 60000);
            {% endif %}

            sleep = function (milliseconds) {
                var start = new Date().getTime();
                for (var i = 0; i < 1e7; i++) {
                    if ((new Date().getTime() - start) > milliseconds) {
                        break;
                    }
                }
            };

            {% if persona and check_session %}
                chequearsesion = function () {
                    $.ajax({
                        type: "POST",
                        url: "/api",
                        data: {'a': 'checksession'},
                        success: function (data) {
                            if (data.result == 'ok') {
                                if (data.nuevasesion) {
                                    bloqueointerface();
                                    location.href = '/logout';
                                }
                            }
                        },
                        dataType: "json"
                    });
                };

                setInterval(chequearsesion, 60000);
            {% endif %}


            bloqueointerface1 = function () {
                if (!$(".blockUI").length) {
                    $.blockUI({
                        message: '<span class="spinner-grow spinner-border-lg" role="status" aria-hidden="true" style="width: 10rem; height: 10rem; background-color: #1C3247 ; color: #1C3247 ; !important"</span>',
                        css: {
                            backgroundColor: 'transparent',
                            border: '0',
                            zIndex: 9999999
                        },
                        overlayCSS: {
                            backgroundColor: '#fff',
                            opacity: 0.8,
                            zIndex: 9999990
                        }
                    });
                }
            };

            bloqueointerface2 = function () {
                if (!$(".blockUI").length) {
                    $.blockUI({
                        message: $('#throbber'),
                        css: {
                            backgroundColor: 'transparent',
                            border: '0',
                            zIndex: 9999999
                        },
                        overlayCSS: {
                            backgroundColor: '#fff',
                            opacity: 0.8,
                            zIndex: 9999990
                        }
                    });
                }
            };



            bloqueointerface = function () {
                if (!$(".blockUI").length) {
                    $.blockUI({
                        message: '<span class="spinner-grow spinner-border-lg" role="status" aria-hidden="true" style="width: 10rem; height: 10rem; background-color: #F8C471 ; color: #F8C471 ; !important"</span>',
                        css: {
                            backgroundColor: 'transparent',
                            border: '0',
                            zIndex: 9999999
                        },
                        overlayCSS: {
                            backgroundColor: '#fff',
                            opacity: 0.8,
                            zIndex: 9999990
                        }
                    });
                }
            };

            {% if persona %}
                var check_logout;

                logout = function () {
                    bloqueointerface();
                    localStorage.clear();
                    $.ajax({
                        type: "POST",
                        url: "/api",
                        data: {'a': 'logout'},
                        success: function (data) {
                            if (data.result == 'ok') {
                                location.href = data.url;
                            } else {
                                logout();
                            }
                        },
                        error: function () {
                            logout();
                        },
                        dataType: "json"
                    });
                };

                $('.logoutuser').click(function () {
                    logout();
                });

                window.onload = function () {
                    sysend.on('sga', function (obj) {
                        if (obj.message == 'check') {
                            if (window.name.length > 0) {
                                localStorage.setItem('windowid', window.name);
                                sysend.broadcast('sga', {message: 'set'});
                            }
                        }
                        if (obj.message == 'set') {
                            if (window.name.length == 0) {
                                var windowid = localStorage.getItem('windowid');
                                localStorage.removeItem('windowid');
                                $.unblockUI();
                                if (windowid) {
                                    window.name = windowid;
                                    clearInterval(check_logout);
                                }
                            }
                        }
                    });

                    var sessionid = localStorage.getItem('sessionid');
                    if (sessionid) {
                        if (window.name != sessionid) {
                            $.blockUI({message: null});
                            sysend.broadcast('sga', {message: 'check'});
                            check_logout = setInterval(logout, 1000);
                        }
                    } else {
                        bloqueointerface();
                        logout();
                    }
                };
            {% endif %}

            serverdate = new Date({{ currenttime.year }}, {{ currenttime.month }}-1, {{ currenttime.day }}, {{ currenttime.hour }}, {{ currenttime.minute }}, {{ currenttime.second }}, 0);
            clientdate = new Date();

            showTime = function () {
                var m;
                var today = new Date();
                var timediff = today - clientdate;
                var renderdate = new Date(serverdate.getTime() + timediff);
                var h = renderdate.getHours();
                var mer = " AM";
                if (h > 12) {
                    mer = " PM";
                    h -= 12;
                }
                m = renderdate.getMinutes();
                m = checkTime(m);
                $("#clock").text(h + ":" + m + mer);
            };

            checkTime = function (i) {
                if (i < 10) {
                    i = "0" + i;
                }
                return i;
            };

            setInterval(showTime, 15000);

            showTime();

            $('.dropdown-toggle').dropdown();
            $(".collapse").collapse();
            $('.tips').tooltip({});

            $(".periodoselector").click(function () {
                var pid = $(this).attr('pid');
                bloqueointerface();
                $.ajax({
                    type: "POST",
                    url: "/",
                    data: {'action': 'periodo', 'id': pid},
                    success: function (data) {
                        if (data.result == 'ok') {
                            location.href = location.pathname;
                        } else {
                            $.unblockUI();
                            smoke.alert("Error al cambiar de periodo");
                        }
                    },
                    error: function () {
                        $.unblockUI();
                        smoke.alert("Error al cambiar de periodo");
                    },
                    dataType: "json"
                });
            });

            $("#id_email, #id_emailinst, #id_correoinstasoc, #id_correoinst").css({'text-transform': 'none'});

            $("table tbody tr").hover(function () {
                $(this).addClass("info");
            }, function () {
                $(this).removeClass("info");
            });

            $(".btn-form").click(function () {
                bloqueointerface();
            });

            $(".bloqueo_pantalla").click(function () {
                bloqueointerface();
            });

            if (typeof String.prototype.startsWith != 'function') {
                String.prototype.startsWith = function (str) {
                    return this.indexOf(str) == 0;
                };
            }

            if (typeof String.prototype.endsWith != 'function') {
                String.prototype.endsWith = function (str) {
                    return this.slice(-str.length) == str;
                };
            }

            abrir_reporte = function () {
                var href = $(this).attr('nhref');
                var tipos = $(this).attr('tipos');
                if (!tipos) {
                    tipos = "pdf, xls, csv, doc";
                }
                if (tipos.contains("pdf")) {
                    $("#formatopdf").removeAttr("hidden");
                } else {
                    $("#formatopdf").attr({"hidden": "hidden"});
                }
                if (tipos.contains("doc")) {
                    $("#formatodoc").removeAttr("hidden");
                } else {
                    $("#formatodoc").attr({"hidden": "hidden"});
                }
                if (tipos.contains("xls")) {
                    $("#formatoxls").removeAttr("hidden");
                } else {
                    $("#formatoxls").attr({"hidden": "hidden"});
                }
                if (tipos.contains("csv")) {
                    $("#formatocsv").removeAttr("hidden");
                } else {
                    $("#formatocsv").attr({"hidden": "hidden"});
                }
                if (tipos.length > 4) {
                    primero = $("#formatoreporte_formato").find("option:first").val();
                    $("#formatoreporte_formato").val(primero);
                    $('#formatoreporte').modal({'width': '400'}).modal('show');
                    $('#formatoreporte_run').attr('nhref', href);
                } else {
                    primero = $("#formatoreporte_formato").find("option:first").val();
                    $("#formatoreporte_formato").val(primero);
                    ejecutar_reporte_directo(href);

                }

            };

            cerrar_reporte = function () {
                $('#formatoreporte').modal('hide');
            };

            ejecutar_reporte_directo = function (ruta) {
                var href = ruta;
                $('#formatoreporte').modal('hide');
                var formato = $('#formatoreporte_formato').val();
                var formato_final = '';
                if (formato == 0) {
                    formato_final = '&rt=pdf';
                } else if (formato == 1) {
                    formato_final = '&rt=docx';
                } else if (formato == 2) {
                    formato_final = '&rt=xlsx';
                } else if (formato == 3) {
                    formato_final = '&rt=csv';
                }
                bloqueointerface();
                var report_url = href + formato_final;
                $.ajax({
                    type: "POST",
                    url: report_url,
                    success: function (data) {
                        $.unblockUI();
                        if (data.result == 'ok') {
                            if (formato == 0) {
                                openwindow_reporte(location.origin + data.reportfile, 800, 500);
                            } else {
                                location.href = location.origin + data.reportfile;
                            }
                        } else {
                            NotificationJG.error(data.mensaje, "Reporte")
                        }
                    },
                    error: function () {
                        $.unblockUI();
                        smoke.alert("Error al generar el reporte");
                    },
                    dataType: "json"
                });
            };

            ejecutar_reporte = function () {
                var href = $(this).attr('nhref');
                $('#formatoreporte').modal('hide');
                var formato = $('#formatoreporte_formato').val();
                var formato_final = '';
                if (formato == 0) {
                    formato_final = '&rt=pdf';
                } else if (formato == 1) {
                    formato_final = '&rt=docx';
                } else if (formato == 2) {
                    formato_final = '&rt=xlsx';
                } else if (formato == 3) {
                    formato_final = '&rt=csv';
                }
                bloqueointerface();
                var report_url = href + formato_final;
                {#alert(report_url);#}
                $.ajax({
                    type: "POST",
                    url: report_url,
                    success: function (data) {
                        $.unblockUI();
                        if (data.result == 'ok') {
                            if (formato == 0) {
                                openwindow_reporte(location.origin + data.reportfile, 800, 500);
                            } else {
                                location.href = location.origin + data.reportfile;
                            }
                        } else {
                            smoke.alert("Error al generar el reporte");
                        }
                    },
                    error: function () {
                        $.unblockUI();
                        smoke.alert("Error al generar el reporte");
                    },
                    dataType: "json"
                });
            };

            {% if messages %}
                {% for message in messages %}
                    {% if message.tags == 'success' %}
                        NotificationJG.success('{{ message }}', 'Aviso!', 10000);
                    {% elif message.tags == 'info' %}
                        NotificationJG.info('{{ message }}', 'Aviso!', 10000);
                    {% elif message.tags == 'warning' %}
                        NotificationJG.warning('{{ message }}', 'Advertencia!', 10000);
                    {% elif message.tags == 'error' %}
                        NotificationJG.error('{{ message }}', 'Advertencia!', 10000);
                    {% endif %}
                {% endfor %}
            {% endif %}

            {% if mensj or info %}
                //smoke.alert('{{ mensj }}{{ info }}');
                NotificationJG.warning('{{ mensj }}{{ info }}', 'Advertencia!', 10000);
            {% endif %}

            conectar_confirmacion = function () {
                var href = $(this).attr('nhref');
                bloqueointerface();
                $.ajax({
                    type: "GET",
                    url: href,
                    success: function (data) {
                        $.unblockUI();
                        if (data.search('"' + 'ajaxconfirmaciondinamicbs' + '"') >= 0) {
                            $("#confirmacionmodal").html(data);
                            $('#confirmacionmodal').modal({'width': '650'}).modal('show');
                        } else {
                            smoke.alert("Error de conexión.");
                        }
                    },
                    error: function () {
                        $.unblockUI();
                        smoke.alert("Error de conexión.");
                    },
                    dataType: "html"
                });
            };

            conectar_eliminacion = function () {
                var href = $(this).attr('nhref');
                bloqueointerface();
                $.ajax({
                    type: "GET",
                    url: href,
                    success: function (data) {
                        $.unblockUI();
                        if (data.search('"' + 'ajaxdeletedinamicbs' + '"') >= 0) {
                            $("#eliminacionmodal").html(data);
                            $('#eliminacionmodal').modal({'width': '650'}).modal('show');
                        } else {
                            smoke.alert("Error de conexión.");
                        }
                    },
                    error: function () {
                        $.unblockUI();
                        smoke.alert("Error de conexión.");
                    },
                    dataType: "html"
                });
            };

            conectar_viewhtml = function () {
                var href = $(this).attr('nhref');
                bloqueointerface();
                $.ajax({
                    type: "GET",
                    url: href,
                    success: function (data) {
                        $.unblockUI();
                        if (data.search('"' + 'ajaxconfirmaciondinamicbs' + '"') >= 0) {
                            $("#viewhtml").html(data);
                            $('#viewhtml').modal({'width': '650'}).modal('show');
                            $('.cerrarviewhtml').bind('click.cerrar_viewhtml', cerrar_viewhtml);
                        } else {
                            smoke.alert("Error de conexión.");
                        }
                    },
                    error: function () {
                        $.unblockUI();
                        smoke.alert("Error de conexión.");
                    },
                    dataType: "html"
                });
            };


            $('.confirmacionmodal').bind('click.conectar_confirmacion', conectar_confirmacion);
            $('.viewhtml').bind('click.conectar_viewhtml', conectar_viewhtml);
            $('.eliminacionmodal').bind('click.conectar_eliminacion', conectar_eliminacion);
            $(".reportedirecto").bind("click.conectar_reporte", abrir_reporte);
            $("#formatoreporte_run").bind("click.ejecutar_reporte", ejecutar_reporte);
            $("#formatoreporte_close").bind("click.cerrar_reporte", cerrar_reporte);

            conectar_reporte = function () {
                $(".reportedirecto").unbind("click.conectar_reporte");
                $(".reportedirecto").bind("click.conectar_reporte", abrir_reporte);
            };

            tooltips = function () {
                $(".tl").tooltip({placement: "left"});
                $(".tr").tooltip({placement: "right"});
                $(".tu").tooltip({placement: "top"});
                $(".tb").tooltip({placement: "bottom"});
            };

            tooltips();

            $('.selectorfecha').keypress(function () {
                return false;
            });

            history.pushState(null, null, location.href);
            window.addEventListener('popstate', function (event) {
                history.pushState(null, null, location.href);
            });

            actualizarnumerico = function () {
                $('.imp-number[decimal], .imp-moneda[decimal], .imp-numbersmall[decimal], .imp-numbermed-right[decimal], .imp-numbermed-center[decimal], .nota[decimal]').each(function () {
                    numerico($(this), 0, 0, $(this).attr('decimal'));
                })
            };

            escapeHTMLEncode = function (str) {
                var div = document.createElement('div');
                var text = document.createTextNode(str);
                div.appendChild(text);
                return div.innerHTML;
            };

            actualizarnumerico();

            $('.imp-number, .imp-moneda, .imp-numbersmall, .imp-numbermed-right, .imp-numbermed-center, .nota').focus(function () {
                if (!parseFloat($(this).val())) {
                    $(this).val("");
                }
            });

            $('.selectorfecha').keypress(function () {
                return false;
            });

            tipo_formulario = function (elemento) {
                if (elemento.attr('formtype') == 'form-vertical') {
                    elemento.find(".control-label").css({'float': 'none'});
                    elemento.find(".label-text").css({'text-align': 'left'});
                    elemento.find(".control-label").each(function () {
                        var contenedor = parseFloat($(this).parent().css('width')) - 5;
                        $(this).css({'width': contenedor.toString() + 'px'});
                    });
                    elemento.find(".control").each(function () {
                        var contenedor = parseFloat($(this).parent().css('width')) - 5;
                        $(this).css({'width': contenedor.toString() + 'px'});
                    });

                } else {
                    elemento.find(".control-label").css({'float': 'left'});
                    elemento.find(".label-text").css({'text-align': 'right'});
                    if (elemento.hasClass('form-modal')) {
                        elemento.find(".control-group").each(function () {
                            var contenedor = parseFloat($(this).parent().width());
                            var porciento = (parseFloat($(this).width()) / 100);
                            var tam = parseInt(contenedor * porciento);
                            $(this).css({'width': tam});
                        });
                    }
                    elemento.find(".control-label").each(function () {
                        if ($(this).attr('labelwidth')) {
                            $(this).css({'width': $(this).attr('labelwidth')});
                        } else {
                            $(this).css({'width': '160px'});
                        }
                    });
                    elemento.find(".control").each(function () {
                        var contenedor = $(this).parent().width();
                        var label = parseFloat($(this).parent().find('.control-label').width());
                        $(this).css({'width': ((contenedor - label) - 20).toString() + 'px'});
                    });
                }
                elemento.find(".select2").css({'width': '100%'});
            };
            pop_lista = function (arr, item) {
                for (var i = arr.length; i--;) {
                    if (arr[i] === item) {
                        arr.splice(i, 1);
                    }
                }
            };


            $('.viewNotification_b').click(function () {
                console.log("entra");
                var id = $(this).attr('id');
                var _href = $(this).attr('_href');
                bloqueointerface();
                $.ajax({
                    type: "POST",
                    url: "/notificacion",
                    data: {'action': 'ViewedNotification', 'id': id},
                    success: function (data) {
                        $.unblockUI();
                        if (data.result == 'ok') {
                            window.location.href = _href;
                        } else {
                            smoke.alert(data.mensaje);
                        }
                    },
                    error: function () {
                        $.unblockUI();
                        smoke.alert("Error de conexión.");
                    },
                    dataType: "json"
                });
            });


            /*$('.button').on('click', function() {
                $.ajax({
                    url: 'adm_tasks/',
                    data: { action: 'loadType', type: $(this).data('type') },
                    method: 'POST',
                })
                .done((res) => {
                    getStatus(res.task_id);
                })
                .fail((err) => {
                    console.log(err);
                });
            });*/

        });

        /*function getStatus(taskID) {
            $.ajax({
                url: 'adm_tasks/${taskID}/',
                method: 'GET'
                })
            .done((res) => {
                const html ='<tr><td>${res.task_id}</td><td>${res.task_status}</td> <td>${res.task_result}</td> </tr>'
                $('#tasks').prepend(html);

                const taskStatus = res.task_status;

                if (taskStatus === 'SUCCESS' || taskStatus === 'FAILURE') return false;
                setTimeout(function() {
                    getStatus(res.task_id);
                }, 1000);
            })
            .fail((err) => {
                console.log(err)
            });
        }*/


        //aqui entra
        function getCookie(name) {
            var cookieValue = null;
            if (document.cookie && document.cookie !== '') {
                var cookies = document.cookie.split(';');
                for (var i = 0; i < cookies.length; i++) {
                    var cookie = jQuery.trim(cookies[i]);
                    // Does this cookie string begin with the name we want?
                    if (cookie.substring(0, name.length + 1) === (name + '=')) {
                        cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                        break;
                    }
                }
            }
            return cookieValue;
        }

        var csrftoken = getCookie('csrftoken');

        function csrfSafeMethod(method) {
            return (/^(GET|HEAD|OPTIONS|TRACE)$/.test(method));
        }

        $.ajaxSetup({
            beforeSend: function (xhr, settings) {
                if (!csrfSafeMethod(settings.type) && !this.crossDomain) {
                    xhr.setRequestHeader("X-CSRFToken", csrftoken);
                }
            }
        });
    </script>

    {% if not request.path in "'/alu_practicaspreprofesionalesinscripcion', '/alu_finanzas', '/pro_cronograma', '/adm_solicitudbalcon', '/alu_solicitudbalcon', '/adm_balconservicios', '/adm_gedcevaluacion', '/adm_solicitudpermisossistemas'" or  request.path == '/' %}
        <link rel="stylesheet" href="/static/css/jquery.fancybox.css?v=2.1.4" type="text/css" media="screen"/>
        <script type="text/javascript" src="/static/js/jquery.fancybox.pack.js?v=2.1.4"></script>
    {% else %}
        <link rel="stylesheet" href="/static/fancybox/css/core.css"/>
        <script src="/static/fancybox/js/core.js"></script>
    {% endif %}

    <script type="text/javascript">
        $(function () {
            $(document).ready(function () {
                $(".fancybox").fancybox();
                $('[data-toggle="tooltip"]').tooltip();
            });

            $(".tl").tooltip({placement: "top"});
        });
    </script>
    <link rel="stylesheet" href="/static/jgrowl/jgrowl.css" type="text/css"/>
    <script type="text/javascript" src="/static/jgrowl/jgrowl.min.js"></script>
    <!--<script src="http://localhost:3000/socket.io/socket.io.js"></script>-->
    <script type="text/javascript">

        $.extend(true, $.jGrowl.defaults, {
            pool: 5,
            closerTemplate: '<div>[Cerrar todas]</div>',
            closer: function () {
                console.log("Closing everything!", this);
            },
            log: function (e, m, o) {
                //$('#logs').append("<div><strong>#" + $(e).attr('id') + "</strong> <em>" + (new Date()).getTime() + "</em>: " + m + " (" + o.theme + ")</div>")
            }

        });

        NotificationJG = {
            success: function (msg, header/*=undefined*/, ttime/*=5000*/) {
                $.jGrowl(msg, {
                    theme: 'growl-success',
                    header: (header == 'undefined') ? 'Mensaje!' : header,
                    life: ttime,
                    closeTemplate: ''
                });
            },
            error: function (msg, header/*=undefined*/, ttime/*=5000*/) {
                $.jGrowl(msg, {
                    theme: 'growl-error',
                    header: (header == 'undefined') ? 'Mensaje!' : header,
                    life: ttime,
                    closeTemplate: ''
                });
            },
            warning: function (msg, header/*=undefined*/, ttime/*=5000*/) {
                $.jGrowl(msg, {
                    theme: 'growl-warning',
                    header: (header == 'undefined') ? 'Mensaje!' : header,
                    life: ttime,
                    closeTemplate: ''
                });
            },
            info: function (msg, header/*=undefined*/, ttime/*=5000*/) {
                $.jGrowl(msg, {
                    theme: 'growl-info',
                    header: (header == 'undefined') ? 'Mensaje!' : header,
                    life: ttime,
                    closeTemplate: ''
                });
            }
        };

        //var socket = io('ws://localhost:3000');
        //var socket = null;


        /* Cualquier mensaje que se reciba en el canal "result" se agrega dentro del div "result" */
        /*socket.on('result_notification_redis', function (data) {
            //data = JSON.stringify(data); //para enviar string
            data = JSON.parse(data); //para recibir string y convertir a json
            console.log(data);
            if (data.type_message == 'success')
            {
                NotificationJG.success(data.message, data.title);
            }
            if (data.type_message == 'error')
            {
                NotificationJG.error(data.message, data.title);
            }

            if (data.type_message == 'info')
            {
                NotificationJG.info(data.message, data.title);
            }

            if (data.type_message == 'warning')
            {
                NotificationJG.warning(data.message, data.title);
            }
        });*/

        $(function () {
            $(document).ready(function () {
                {% if persona.tiene_notificaciones.sga and tipoentrada == 'SGA' %}
                    var num_notificaciones = {{ persona.num_notificaciones.sga }}
                    {% if persona.num_notificaciones.sga > 1 %}
                        var msg = `Tiene ${num_notificaciones} notificaciones`;
                    {% else %}
                        var msg = `Tiene ${num_notificaciones} notificación`;
                    {% endif %}
                    NotificationJG.info(msg, "SGA");
                {% endif %}
                {% if persona.tiene_notificaciones.sagest and tipoentrada == 'SAGEST'%}
                    var num_notificaciones = {{ persona.num_notificaciones.sagest }}
                    {% if persona.num_notificaciones.sagest > 1 %}
                        var msg = `Tiene ${num_notificaciones} notificaciones`;
                    {% else %}
                        var msg = `Tiene ${num_notificaciones} notificación`;
                    {% endif %}
                    NotificationJG.info(msg, "SAGEST");
                {% endif %}

                {% for notificacion in  notificaciones %}
                    {% if notificacion.type == 'error' %}
                        NotificationJG.error("{{ notificacion.body  }}", "{{ notificacion.title }}");
                    {% endif %}
                    {% if notificacion.type == 'succes' %}
                        NotificationJG.success("{{ notificacion.body  }}", "{{ notificacion.title }}");
                    {% endif %}
                    {% if notificacion.type == 'warning' %}
                        NotificationJG.warning("{{ notificacion.body  }}", "{{ notificacion.title }}");
                    {% endif %}
                    {% if notificacion.type == 'info' %}
                        NotificationJG.info("{{ notificacion.body  }}", "{{ notificacion.title }}");
                    {% endif %}
                {% endfor %}
                //99
                {% if periodo.id == 99 and persona.tiene_encuesta_pendiente_google and perfilprincipal.es_estudiante %}
                    //console.log(Date.now() >= Date.parse("2021/03/11") && Date.now() <= Date.parse("2021/03/23"));
                    if (Date.now() >= Date.parse("2021/03/11") && Date.now() <= Date.parse("2021/03/23")) {
                        var banderaForm = 0;
                        $('#encuestaGoogleModal')
                            .off('shown.bs.modal')
                            .on('shown.bs.modal', function () {
                                $('#formsGoogleDocs').on('load', function () {
                                    if (banderaForm == 1) {
                                        bloqueointerface();
                                        id_persona = {{ persona.id }}
                                            $.ajax({
                                                type: "POST",
                                                url: "/",
                                                data: {'action': 'RegisterPoll', 'id': id_persona},
                                                success: function (data) {
                                                    $.unblockUI();
                                                    if (data.result == 'ok') {
                                                        $('#encuestaGoogleModal').modal('hide');
                                                        banderaForm = 0;
                                                        NotificationJG.success("Realizo la encuesta, correctamente", "SGA");
                                                    } else {
                                                        smoke.alert(data.mensaje);
                                                    }
                                                },
                                                error: function () {
                                                    $.unblockUI();
                                                    smoke.alert("Error de conexión.");
                                                },
                                                dataType: "json"
                                            });

                                    } else {
                                        banderaForm = 1;
                                    }
                                });

                            })
                            .modal('show');
                    }
                {% endif %}

                $(".viewProfile").click(function () {
                    var panelProfile = $(".panelProfile");
                    if (panelProfile.css('display') == 'none') {
                        // Acción si el elemento no es visible
                        panelProfile.css('display', 'block');

                        //$( ".panelProfile >[img]" ).css('border', '5px #cb8a4f !important;')
                        //panelProfile.addClass('has_active');

                    } else {
                        // Acción si el elemento es visible
                        panelProfile.css('display', 'none');
                        //panelProfile.removeClass('has_active')
                    }
                });

                $(".viewPeriodosAcademicos").click(function () {
                    var panelPeriodosAcademicos = $(".panelPeriodosAcademicos");
                    if (panelPeriodosAcademicos.css('display') == 'none') {
                        // Acción si el elemento no es visible
                        panelPeriodosAcademicos.css('display', 'block');
                        //panelProfile.addClass('has_active');

                    } else {
                        // Acción si el elemento es visible
                        panelPeriodosAcademicos.css('display', 'none');
                    }
                });

                $(document).on("click", function (e) {
                    var panelProfile = $(".panelProfile");
                    var viewProfile = $(".viewProfile");
                    var viewPeriodosAcademicos = $(".viewPeriodosAcademicos");
                    var panelPeriodosAcademicos = $(".panelPeriodosAcademicos");
                    if (!panelProfile.is(e.target) && panelProfile.has(e.target).length === 0 && !viewProfile.is(e.target) && viewProfile.has(e.target).length === 0) {
                        //console.log("entro a super");
                        if (panelProfile.css('display') == 'block') {
                            //Acción si el elemento no es visible
                            panelProfile.css('display', 'none');
                            //panelProfile.removeClass('has_active');
                        }
                    }

                    if (!panelPeriodosAcademicos.is(e.target) && panelPeriodosAcademicos.has(e.target).length === 0 && !viewPeriodosAcademicos.is(e.target) && viewPeriodosAcademicos.has(e.target).length === 0) {
                        //console.log("entro a super");
                        if (panelPeriodosAcademicos.css('display') == 'block') {
                            //Acción si el elemento no es visible
                            panelPeriodosAcademicos.css('display', 'none');
                        }
                    }
                });

            });
        });
    </script>
    <style type="text/css">
        @media (max-width: 979px) {

            .navbar-fixed-top, .navbar-fixed-bottom {
                position: fixed;
                right: 0;
                left: 0;
                /*z-index: 1030;*/
                margin-bottom: 0
            }

            .container-fluid {
                padding-right: 20px;
                padding-left: 20px;
            }
        }

        #content {
            padding-top: 80px;
            padding-bottom: 80px;
            background: none;
        }

    </style>

    <style>
        .backgrounmarcaagua {
            min-height: 80vh;
            background: url('/static/images/coverbalcon.png') no-repeat fixed;
            background-size: 260px;
            background-position: 98% 90%;
        }
    </style>
    {% block heading %}
    {% endblock %}
</head>
<body data-spy="scroll" data-target=".subnav" data-offset="50" style="" {% if not persona %}class='{% block contentextraclass %}{% endblock %} {% else %} class='{% block marcaaguabackground %}{% endblock %}'{% endif %}'>
<div id="nav-header" class="navbar navbar-inverse navbar-fixed-top">
    <div class="navbar-inner">
        <div class="container-fluid">
            <ul class='nav'>
                <li>
                    <a style="font-size: 16px;" href="/" class="hidden-phone hidden-tablet visible-desktop">
                        <img src='/static/images/aok/logo_unemi.svg' style="height: 24px !important; width: 86px !important;"/>
                    </a>
                    <a href="/" class="visible-phone visible-tablet hidden-desktop">
                        <img style="height: 28px" src='/static/images/aok/logo_unemi.svg'
                             style="height: 24px !important; width: 86px !important;"/>
                    </a>
                </li>
            </ul>
        </div>
    </div>
</div>
<div id="content">
    <div class='container{% block containertype %}-fluid{% endblock %} table-responsive'>
        {% if ruta %}
            <div class="row-fluid">
                <div class="span12">
                    <ul class="breadcrumb">
                        {% for r in ruta %}
                            <li>
                                <span {% if not forloop.first %}class="hidden-phone hidden-tablet visible-desktop"{% endif %}>
                                <a href="{{ r.0 }}" class="bloqueo_pantalla">{{ r.1 }}</a> <span
                                        class="divider">/</span>
                                </span>
                            </li>
                        {% endfor %}
                        <input type="text"
                               style="width:20%; padding: 3px 15px; float: right; -webkit-border-radius: 20px; border-radius: 20px; margin-top: -4px;"
                               id="idbuscador" placeholder="Buscar...">
                        <a style="float: right;"
                           href="{% if ret %}{{ ret }}{% else %}{% block atras %}/{% endblock %}{% endif %}"
                           class='btn btn-mini urlatrasbutton bloqueo_pantalla' id="urlatrasbutton"><span
                                class="fa fa-arrow-left"></span> Atr&aacute;s</a>
                    </ul>
                </div>
            </div>
        {% endif %}

        {% block canvas %}
        {% endblock %}
    </div>
</div>
{% if not request.user.is_anonymous %}
    <div id="nav-footer" class='navbar navbar-fixed-bottom'>
        {#    <div id="nav-footer" class='navbar'>#}
        {% block footerextra %}
        {% endblock %}

    </div>
{% endif %}
<div class="modal fade static" id="waitpanel" style="display: none;">
    <div class="modal-header">
        <h4 id="waitpaneltitle"></h4>
    </div>
    <div class="modal-body">
        <p id="waitpanelbody"></p>
    </div>
</div>
<div class="modal fade static" id="periodospanel" style="display: none;">
    <div class="modal-header">
        <h4 id="paneltitle">Periodos</h4>
    </div>
    <div class="modal-body">
        <select class="select2" style="width: 100%;" id="periodoselectorall">
            {% for periodo2 in periodos %}
                <option value="{{ periodo2.id|encrypt }}"
                        {% if periodo2.id == periodo.id %}selected{% endif %}>{{ periodo2.nombre }}</option>
                {#                <li><a href='javascript:;' class='periodoselector' pid='{{ periodo2.id|encrypt }}'>{%  if periodo2.id == periodo.id  %}<i class="fa fa-check"></i>{% endif %} {{ periodo2 }}</a></li>#}
            {% endfor %}
            {#            {% for periodo in periodos_todos %}#}
            {#                <option value="{{ periodo.id|encrypt }}">{{ periodo }}</option>#}
            {#            {% endfor %}#}
        </select>
    </div>
    <div class="modal-footer">
        <a href="javascript:;" id="seleccionarperiodospanel" class="btn">Seleccionar</a>
        <a href="javascript:;" id="cerrarperiodospanel" class="btn">Cerrar</a>
    </div>
</div>
<div id="throbber" style="display:none; margin: 0 auto; width: 100px; height: 100px; background-color: #ffffff">
    <img src="/static/images/tigrillo_loader.gif"/>
</div>
<div class="modal fade static" id="formatoreporte" style="display: none;">
    <div class="modal-header">
        <h4 id="paneltitle">Formato de reporte</h4>
    </div>
    <div class="modal-body">
        <select style="width: 100%;" id="formatoreporte_formato">
            <option id="formatopdf" value="0">PORTABLE DOCUMENT FORMAT (PDF)</option>
            <option id="formatodoc" value="1">MICROSOFT WORD (DOCX)</option>
            <option id="formatoxls" value="2">MICROSOFT EXCEL (XLXS)</option>
            <option id="formatocsv" value="3">COMMA-SEPARATED VALUES (CSV)</option>
        </select>
    </div>
    <div class="modal-footer">
        <a href="javascript:;" id="formatoreporte_run" class="btn btn-success">Ejecutar</a>
        <a href="javascript:;" id="formatoreporte_close" class="btn">Cerrar</a>
    </div>
</div>
<div class="modal fade static" id="ficheromodal" style="display: none;">
    <div class="modal-header">
        <h4>Descargar fichero</h4>
    </div>
    <div class="modal-body">
        <a id='enlacefichero' href="javascript:;" target="_blank" class="btn btn-success btn-block"><i
                class="fa fa-arrow-down"></i> Descargar</a>
    </div>
    <div class="modal-footer">
        <a href="javascript:;" class="btn btn-cerrar btn-info">Cerrar</a>
    </div>
</div>
<div class="modal fade static" id="confirmacionmodal" style="display: none;"></div>
<div class="modal fade static" id="eliminacionmodal" style="display: none;"></div>
<div class="modal fade static" id="viewhtml" style="display: none;"></div>

<div class="modal fade static" id="encuestaGoogleModal" data-width="1200" data-keyboard="false" style="display: block;"
     data-backdrop="static" aria-hidden="false">
    <div class="modal-header">
        <h4>ENCUESTA EVALUACIÓN DEL CURSO DE NIVELACIÓN DE CARRERAS</h4>
    </div>
    <div class="modal-body" style="height: 500px">
        <iframe id="formsGoogleDocs" width="100%" height="100%" style="border:none;"
                src="https://docs.google.com/forms/d/e/1FAIpQLSeh7uV_9Jg3RWFma084T7U9qZku5vcOQ0anlIFeGcFoxffwyA/viewform"
                title="ENCUESTA EVALUACIÓN DEL CURSO DE NIVELACIÓN DE CARRERAS 2s-2020"></iframe>
        <!--<iframe id="formsGoogleDocs" width="100%" height="100%" style="border:none;" src="https://docs.google.com/forms/d/e/1FAIpQLSfcSG7B07Xz1N1hvHKjrgFvWOBKXIZGv6EDIZAb0fLV_oSzPg/viewform" title="ENCUESTA EVALUACIÓN DEL CURSO DE NIVELACIÓN DE CARRERAS 2s-2020"></iframe>-->
    </div>
    <div class="modal-footer">
        <!--<a href="javascript:;" class="btn btn-cerrar btn-info" data-dismiss="modal">Cerrar</a>-->
    </div>
</div>
{% if not request.user.is_anonymous %}
    <div class="panelProfile">
        <div class="panelProfile_pesonal_info">
            <div class="panelProfile_pesonal_info_image">
                <a class="fancybox" rel="group"
                   {% if persona.foto %}href="https://sga.unemi.edu.ec{{ persona.foto.foto.url }}"
                   title="{{ persona }}"{% endif %}>
                    {% if persona.foto %}
                        <img src="https://sga.unemi.edu.ec{{ persona.foto.foto.url }}"
                             class="img-circle profile_info_image">
                    {% else %}
                        <img src="https://sga.unemi.edu.ec/static/images/iconos/{% if persona.sexo.id == 2 %}hombre.png{% else %}mujer.png{% endif %}"
                             class="img-circle profile_info_image">
                    {% endif %}
                </a>
            </div>

            <div class="panelProfile_pesonal_manage_info">
                <div><span class="label label-success">{{ perfilprincipal.tipo }}</span></div>
                <strong>{{ persona.nombre_completo }}</strong>
            </div>
            <div class="panelProfile_pesonal_manage_email">
                {{ persona.emailinst }}
            </div>
            <div class="panelProfile_pesonal_manage_my_profile"><a class="btn btn-default btn-large"
                                                                   href="/th_hojavida">Gestionar mi perfil</a></div>
            <div class="panelProfile_pesonal_manage_my_pass"><a href="/pass" class="btn btn-default btn-large"><i
                    class="fa fa-lock"></i> Cambiar contraseña</a></div>

        </div>
        <div class="panelProfile_profiles">
            <div class="menu-profiles">
                <ul>
                    {% for perfil in perfiles_usuario %}
                        {% if perfil.activo %}
                            <li class="has-sub {%  if perfilprincipal.id == perfil.id %}active{% endif %}">
                                <a {%  if perfilprincipal.id == perfil.id %} href='javascript:;' {% else %}
                                                                              href='/cudu?id={{ perfil.id|encrypt }}'
                                                                              class="btn-form" {% endif %}>
                                    {%  if perfilprincipal.id == perfil.id %}
                                        <i class="fa fa-check-square-o"></i> &nbsp;
                                    {% endif %}
                                    {{ perfil.tipo }}
                                </a>
                            </li>
                        {% endif %}
                    {% endfor %}

                </ul>
            </div>
        </div>
        <div class="panelProfile_logout">
            <a href="javascript:;" class="logoutuser tb btn btn-default btn-large"><i class="fa fa-power-off"></i>
                Cerrar Sesión</a>

        </div>
    </div>

    <div class="panelPeriodosAcademicos">
        <p>ENTRA PERIODOS</p>
    </div>
{% endif %}
<div id="csrf_tokendiv" style="display: none;">{{ csrf_token }}</div>
{% block moreblock %}
{% endblock %}
<script>
    console.log('%cUNIVERSIDAD ESTATAL DE MILAGRO', 'color:red; font-size: 2em;')
    console.log('%cTodos los derechos reservados © 2012', 'color:red; font-size: 2em;')

</script>
</body>
<script type="text/javascript" src='/static/js/fontawesomev3.js?v=1.0.0'></script>
</html>

