{% extends "basebs.html" %}
{% load sga_extras %}
{% load humanize %}
{% block heading %}
    <script type="text/javascript" src="/static/js/jquery.fancybox.pack.js?v=1.0.0"></script>
    <link rel="stylesheet" href="/static/css/jquery.fancybox.css?v=1.0.0" type="text/css" media="screen" />
    <script type="text/javascript" src='/static/js/select2.js?v=1.0.0' ></script>
    <link type='text/css' rel='stylesheet' href="/static/css/select2.css?v=1.0.0"/>
    <style>
        .awesome-checkbox{
            display:none;
        }

        .awesome-checkbox-label{
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            -khtml-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }
        /*
                .content-input input,
                .content-select select{
                    appearance: none;
                    -webkit-appearance: none;
                    -moz-appearance: none;
                }

                .content-input input{
                    visibility: hidden;
                    position: absolute;
                    right: 0;
                }
                .content-input{
                    position: relative;
                    margin-bottom: 30px;
                    padding:5px 0 5px 60px;
                    display: block;
                }

                .content-input input + i{
                    background: #f0f0f0;
                    border:2px solid rgba(0,0,0,0.2);
                    position: absolute;
                    left: 0;
                    top: 0;
                }

                .content-input input[type=checkbox ] + i{
                    width: 52px;
                    height: 30px;
                    border-radius: 15px;
                }

                .content-input input[type=checkbox] + i:before{
                    content: '';
                    width: 26px;
                    height: 26px;
                    background: #fff;
                    border-radius: 50%;
                    position: absolute;
                    z-index: 1;
                    left: 0px;
                    top: 0px;
                    -webkit-box-shadow: 3px 0 3px 0 rgba(0,0,0,0.2);
                    box-shadow: 3px 0 3px 0 rgba(0,0,0,0.2);
                }
                .content-input input[type=checkbox]:checked + i:before{
                    left: 22px;
                    -webkit-box-shadow: -3px 0 3px 0 rgba(0,0,0,0.2);
                    box-shadow: 3px 0 -3px 0 rgba(0,0,0,0.2);
                }

                .content-input input[type=checkbox]:checked + i{
                    background: #2AC176;
                }
                .content-input input[type=checkbox] + i:after{
                    content: '';
                    position: absolute;
                    font-size: 10px;
                    color: rgba(255,255,255,0.6);
                    top: 8px;
                    left: 4px;
                    opacity: 0;
                    transition: all 0.25s ease 0.25s;
                }

                .content-input input[type=checkbox]:checked + i:after{
                    opacity: 1;
                }*/
    </style>
    <script type="text/javascript">
        $.extend(true, $.fn.dataTable.defaults, {
            oLanguage: {
                sSearch: "<span>Filtro:</span> _INPUT_",
                sLengthMenu: "<span>Mostrar Entradas:</span> _MENU_",
                sZeroRecords: "No se encontraron resultados",
                sProcessing: "<div style='margin: 0 auto; width: 60px; height: 60px; background-color: #0c6251; opacity: .6'><img src='/static/images/ajax-document-loader.gif'/></div>",
                sEmptyTable: "Ningún dato disponible para visualizar",
                sInfo: "Mostrando registros del _START_ al _END_ de un total de _TOTAL_ registros",
                sInfoEmpty: "Mostrando registros del 0 al 0 de un total de 0 registros",
                sLoadingRecords: "Cargando...",
                oPaginate: {
                    sFirst: "<i title='Inicio' class='fa fa-step-backward'></i>",
                    sLast: "<i title='Último' class='fa fa-step-forward'></i>",
                    sNext: "<i title='Siguiente' class='fa fa-fast-forward'></i>",
                    sPrevious: "<i title='Anterior' class='fa fa-fast-backward'></i>"
                },
            }
        });
        /*********http://apeniche.github.io/awesome-checkbox/********/
        var myController = {
            //************************************************
            // FUNCTION **************************************
            //************************************************
            init: function ()
            {
                var self = this;

                {% if not can_enroll %}
                    NotificationJG.warning("{{ can_enroll_msg }}", "Advertencía!")
                {% endif %}

                $("#periodos_list").select2({minimumResultsForSearch: 20 });
                {% if not coordinaciones %}
                    NotificationJG.info("No se encontraron coordinaciones para el periodo académico {{ periodoc.nombre }}", "Información")
                {% endif %}

                $("#periodos_list").change(function () {
                    self.search();
                });

                $(".enrollment_list").click(function (){
                    myEnrollmentLists.open(this);
                });

                $(".reloadEstadistica").click(function (){
                    var id = parseInt({{ config.id }})
                    bloqueointerface();
                    $.ajax({
                        type: "POST",
                        url: "/niveles",
                        data: {'action': 'load_statistics', 'id': id},
                        success: function(data) {
                            if (data.result == 'ok') {
                                var estadisticas = data.estadisticas
                                $.each(estadisticas, function( index, value ) {
                                    $("."+index).html(value);
                                });
                                NotificationJG.success(data.mensaje, "Exitoso")
                                $.unblockUI();
                            } else {
                                NotificationJG.error(data.mensaje, "Error")
                                $.unblockUI();
                            }
                        },
                        dataType: "json"
                    });
                });

                $(".configCareers").click(function (){
                    myConfigCareers.open(this);
                });
                $('input[type="checkbox"].awesome-checkbox').each(function(index){
                    if(!$(this).hasClass('initialized')){
                        $(this).before('<label class="awesome-checkbox-label" for="'+ $(this).attr('id') + '">' + self.getCheckboxIcon(this) + '</label>');
                        $(this).addClass('initialized');

                    }
                });

                $(document).on('change', '.awesome-checkbox', function(){
                    $('label[for="'+ $(this).attr('id') +'"]').html(self.getCheckboxIcon(this));
                });

                $('.checkbox_coordinacion').change(function(){
                    var idc = $(this).val();
                    var icon = $(this).is(':checked') ? $(this).data('icon-checked') : $(this).data('icon-unchecked')
                    //$(this).prop( "checked", $(this).is(':checked') ? false : true );
                    var checked =  $(this).is(':checked')
                    $('label[for="'+ $(this).attr('id') +'"]').html('<i class="' + icon + '"></i>');

                    $( '.checkbox_carrera').each(function( index ) {
                        var ckd_cc = $(this).attr('ckd_cc');
                        //console.log(ckd_cc)
                        //console.log(idc)
                        if (ckd_cc == idc){
                            $(this).prop( "checked", checked );
                            //var icon = checked ? $(this).data('icon-checked') : $(this).data('icon-unchecked')
                            $('label[for="'+ $(this).attr('id') +'"]').html('<i class="' + icon + '"></i>');
                        }

                    });
                });

                $('.enrollment_massively').click(function(){
                    var carreras = []
                    $('input[type="checkbox"]:checked.checkbox_carrera').each(function(index){
                        carreras.push({
                            'idca': $(this).attr('idca'),
                            'idcp': $(this).attr('idcp')
                        })
                    });
                    var dataFilter = {
                        'idpa': $(this).attr('idpa'),
                        'idpp': $(this).attr('idpp'),
                        'action': 'enrollment_massively',
                        'carreras': JSON.stringify(carreras)
                    }
                    if (carreras.length == 0){
                        NotificationJG.warning("Seleccione al menos una carrera para matricular", "Advertencía");
                        return;
                    }
                    smoke.confirm("¿Está seguro de matricular masivamente ?", function(e){
                        if (e){
                            bloqueointerface();
                            $.ajax({
                                type: "POST",
                                url: "/niveles",
                                data: dataFilter,
                                success: function(data) {
                                    if (data.result == 'ok') {
                                        //$("#contenedorConfigCareers").html(data.contenido);
                                        NotificationJG.success(data.mensaje, "Exitoso")
                                        $.unblockUI();
                                    } else {
                                        NotificationJG.error(data.mensaje, "Error")
                                        $.unblockUI();
                                    }
                                },
                                dataType: "json"
                            });
                        }
                    }, {
                        ok: "SI,SEGURO",
                        cancel: "NO,CANCELAR",
                        classname: "custom-class",
                        reverseButtons: true
                    });
                });

                $('.enrollment_by_career').click(function(){
                    var idca = $(this).attr('idca');
                    var idcp = $(this).attr('idcp');
                    var idpa = $(this).attr('idpa');
                    var idpp = $(this).attr('idpp');
                    var txtca = $(this).attr('txtca');
                    var txtcp = $(this).attr('txtcp');
                    var dataFilter = {'idca': idca, 'idcp': idcp, 'idpa': idpa, 'idpp': idpp, 'action': 'enrollment_by_career' }
                    smoke.confirm("¿Está seguro de matricular de la carrera de admisión: "+txtca+" a la carrera de pregrado: "+txtcp+" .?", function(e){
                        if (e){
                            bloqueointerface();
                            $.ajax({
                                type: "POST",
                                url: "/niveles",
                                data: dataFilter,
                                success: function(data) {
                                    if (data.result == 'ok') {
                                        //$("#contenedorConfigCareers").html(data.contenido);
                                        NotificationJG.success(data.mensaje, "Exitoso")
                                        $.unblockUI();
                                    } else {
                                        NotificationJG.error(data.mensaje, "Error")
                                        $.unblockUI();
                                    }
                                },
                                dataType: "json"
                            });
                        }
                    }, {
                        ok: "SI,SEGURO",
                        cancel: "NO,CANCELAR",
                        classname: "custom-class",
                        reverseButtons: true
                    });
                });
            },
            getCheckboxIcon: function (selector){
                var icon = $(selector).is(':checked') ? $(selector).data('icon-checked') : $(selector).data('icon-unchecked')
                return '<i class="' + icon + '"></i>';
            },
            search: function()
            {
                var idpc = $("#periodos_list").val();
                bloqueointerface();
                location.href = "/niveles?action=matriculacionprimernivel&idpc="+idpc;
            }
        };

        var myConfigCareers = {
            init: function () {
                var self = this;

                self.$popup = $('#modalConfigCareers');

                $(".action-close", self.$popup).click(function (){
                    self.closePopup();
                    bloqueointerface();
                    setTimeout(function(){ location.reload(); }, 3000);

                });

                self.$popup.on("show.bs.modal", function () {
                });

                self.$popup.on("hidden.bs.modal", function () {
                });


            },
            open: function (ele) {
                var h = $(window).height() - 150;
                var w = $(window).width() - 1;
                var self = this;
                bloqueointerface();
                var pcid = $(ele).attr('pcid');
                var ppid = $(ele).attr('ppid');
                var dataFilter = {'pcid': pcid, 'ppid': ppid, 'action': 'list_careers_first_level_by_period' }
                $.ajax({
                    type: "POST",
                    url: "/niveles",
                    data: dataFilter,
                    success: function(data) {
                        $.unblockUI();
                        if (data.result=='ok'){
                            $('.modal-title', self.$popup).html('Listado de carreras')
                            $("#contenedorConfigCareers").html(data.contenido);

                            self.$popup.modal({backdrop:'static', width: '90%', height: h}).modal('show');
                            $.unblockUI();
                        } else {
                            NotificationJG.error(data.mensaje, "Error");
                        }
                    },
                    error: function() {
                        $.unblockUI();
                        NotificationJG.error("Error de conexión.", "Error");
                    },
                    dataType: "json"
                });
            },
            closePopup: function () {
                var self = this
                self.$popup.modal('hide');
            },

        }

        var myEnrollmentLists = {
            init: function () {
                var self = this;

                self.$popup = $('#modalEnrollmentLists');
                self.$table = $('#dataTableEnrollmentLists table');

                /*$("[name='filter_estados']", self.$popup).select2({
                    dropdownParent: self.$popup
                });

                $("[name='filter_estados']", self.$popup).change(function () {
                    self.$table.dataTable().fnDraw();
                });*/

                $(".action-close", self.$popup).click(function (){
                    self.closePopup();
                });

                self.$popup.on("show.bs.modal", function () {
                });

                self.$popup.on("hidden.bs.modal", function () {
                    //self.setFormReadOnlyAsignacionClase(false);
                    //self.setDataAsignacionClase(null);
                });


            },
            open: function (ele) {
                var self = this;
                bloqueointerface();
                //self.resetForm();
                var idca = $(ele).attr('idca');
                var idcp = $(ele).attr('idcp');
                var idpa = $(ele).attr('idpa');
                var idpp = $(ele).attr('idpp');
                var txtca = $(ele).attr('txtca');
                var txtcp = $(ele).attr('txtcp');
                var dataFilter = {'idca': idca, 'idcp': idcp, 'idpa': idpa, 'idpp': idpp, 'action': 'enrollment_list_by_careers_and_period' }

                var fnOpen = function(){
                    var h = $(window).height() - 150;
                    $('.modal-title', self.$popup).html('Listado de alumnos de la carrera de admisión ' + txtca)
                    self.$popup.modal({backdrop:'static', width: '80%',  height: h}).modal('show');
                    $.unblockUI();
                }

                self.loadDataTable(dataFilter, fnOpen);



            },
            closePopup: function () {
                //this.resetForm();
                var self = this
                //self.$table.dataTable().fnClearTable();
                self.$table.dataTable().fnDestroy();
                self.$popup.modal('hide');
                //$('#registro_asignacion_clases_modal').modal('hide');
            },
            loadDataTable: function (dataFilter, fnOpen){
                var self = this;
                //console.log(dataFilter);
                //var dataFilter = {'idca': idca, 'idcp': idcp, 'idpa': idpa, 'idpp': idpp, 'action': 'enrollment_list_by_careers_and_period' }
                self.$table.dataTable({
                    responsive: true,
                    searchDelay: 1000,
                    bJQueryUI: false,
                    bAutoWidth: false,
                    //bProcessing: true,
                    bServerSide: true,
                    bSort: false,
                    sPaginationType: "full_numbers",
                    iDisplayLength: 25,
                    sDom: '<"datatable-header"fl><"datatable-scroll"tr><"datatable-footer"ip>',
                    sAjaxSource: "niveles",
                    sServerMethod: "POST",
                    initComplete: function(settings, json) {
                        //console.log( 'DataTables has finished its initialisation.' );
                        //console.log(settings);
                        //console.log(json);

                        if (fnOpen) {
                            fnOpen();
                        }
                    },
                    fnServerParams: function (aoData)
                    {
                        //$('#divDetailData table').block({message: $('#throbber'), css: { 'border': '1px solid', 'border-radius' : '10px', 'left': '46%', 'width':'120px',  'padding': '15px',  '-webkit-border-radius': '10px', '-moz-border-radius': '10px', opacity: .6, color: '#000' }});
                        bloqueointerface();
                        //$.blockUI({message: $('#throbber'), css: { 'border': '1px solid', 'border-radius' : '10px', 'left': '46%', 'width':'60px',  'padding': '15px',  '-webkit-border-radius': '10px', '-moz-border-radius': '10px', opacity: .6, color: '#000' }});
                        $.each( dataFilter, function( key, value ) {
                            aoData.push({"name": key, "value": value})
                        });
                        //aoData.push({'name': 'estados', 'value': $("[name='filter_estados']", self.$popup).val()});
                    },
                    aoColumnDefs:
                        [
                            {
                                /*DOCUMENTO*/
                                aTargets: [0],
                                width: "10%",
                                fnCreatedCell: function(nTd, sData, oData, iRow, iCol)
                                {
                                    if(sData != 'NULL') {
                                        $(nTd).css('text-align', 'center')
                                        $(nTd).css('vertical-align', 'middle')
                                        $(nTd).css('padding', '8px')
                                    }
                                }
                            },
                            {
                                /*ALUMNO*/
                                aTargets: [1],
                                width: "70%",
                                fnCreatedCell: function(nTd, sData, oData, iRow, iCol)
                                {
                                    if(sData != 'NULL') {
                                        $(nTd).css('text-align', 'left')
                                        $(nTd).css('vertical-align', 'middle')
                                        $(nTd).css('padding', '8px')
                                    }
                                }
                            },
                            {
                                /*ESTADO DE MATRICULA*/
                                aTargets: [2],
                                width: "10%",
                                mRender: function (data, type, row)
                                {
                                    return '<input type="hidden" class="dt-col-estado" value="' + (data) + '"/>';
                                },
                                fnCreatedCell: function(nTd, sData, oData, iRow, iCol)
                                {
                                    if(sData != 'NULL') {
                                        $(nTd).css('text-align', 'center')
                                        $(nTd).css('vertical-align', 'middle')
                                        $(nTd).css('padding', '8px')
                                    }
                                }
                            },
                            {
                                /*ACCIONES*/
                                aTargets: [3],
                                width: "10%",
                                mRender: function (data, type, row)
                                {
                                    return '<input type="hidden" class="dt-col-option" value="' + (data.id) + '"/>';
                                    /*+
                                        '<input type="hidden" class="dt-col-option-status" value="' + (data.status ? 1 : 0) + '"/>'+
                                        '<input type="hidden" class="dt-col-option-idm" value="' + (data.idm) + '"/>' +
                                        '<input type="hidden" class="dt-col-option-idi" value="' + (data.idi) + '"/>' +
                                        '<input type="hidden" class="dt-col-option-alumno" value="' + (data.alumno) + '" />';*/
                                },
                                fnCreatedCell: function(nTd, sData, oData, iRow, iCol)
                                {
                                    if(sData != 'NULL') {
                                        $(nTd).css('text-align', 'center')
                                        $(nTd).css('vertical-align', 'middle')
                                        $(nTd).css('padding', '8px')
                                    }
                                }
                            },
                        ]
                    ,
                    fnDrawCallback: function (oSettingst)
                    {
                        var count = 0;
                        $.unblockUI()
                        //$('#divDetailData table').unblock();

                        //aTargets: [2]
                        $('.dt-col-estado').each(function () {
                            var data = $(this).val();
                            var html = '';
                            /*
                            (1, u'MATRICULADO'),
                            (2, u'PENDIENTE'),
                            */
                            if(data==1){
                                html = '<span class="label label-success" >MATRICULADO</span>';
                            }
                            else if(data==2){
                                html = '<span class="label label-warning" >PENDIENTE</span>';
                            }

                            var $html = $(html);

                            $(this).after($html);
                        });


                        //aTargets: [3]
                        $('.dt-col-option').each(function () {
                            var id = $(this).val();
                            var html = '';
                            /*var idm = $('.dt-col-option-idm').eq(count).val();
                            var idi = $('.dt-col-option-idi').eq(count).val();
                            var status = $('.dt-col-option-status').eq(count).val();
                            var alumno = $('.dt-col-option-alumno').eq(count).val();

                            var html = ''+
                                '<div class="btn-group">'+
                                    '<a class="btn btn-mini dropdown-toggle" data-toggle="dropdown" href="javascript:;">Acciones<span class="caret"></span></a>'+
                                        '<ul class="dropdown-menu pull-right list-group" style="text-align: left;">'+
                                            '<li><a href="javascript:;" class="dt-action-validar" id="'+id+'"><i class="fa fa-bell" ></i> Requisitos de Titulación</a></li>'+
                                            '<li><a href="/inscripciones?id='+idi+'" target="_blank"><i class="fa fa-users"></i> Inscripción</a></li>'+
                                            '<li><a href="/inscripciones?action=record&id='+idi+'" target="_blank"><i class="fa fa-flag"></i> Record Académico</a></li>'+
                                            '<li><a href="/inscripciones?action=alumalla&id='+idi+'" target="_blank"><i class="fa fa-th"></i> Su Malla</a></li>'+
                                        '</ul>'+
                                    '</a>'+
                                '</div>';*/

                            /*var html = '' +
                                '<div class="table-controls">' +
                                '<a class="btn btn-warning btn-mini dt-action-edit tu" title="Editar" data-original-title="Editar"  href="javascript:;" id="' + id + '"><span class="fa fa-edit"></span> </a> ';

                            if( oPermissions.canView && status==1) {
                                if (oPermissions.canView){
                                    html += '<a class="btn btn-danger btn-mini dt-action-inactive tu" title="Inactivar" data-original-title="Inactivar"  href="javascript:;" id="'+id+'"><span class="fa fa-close"></span> </a>';
                                }
                            }else if(status==0){
                                html += '<a class="btn btn-info btn-mini dt-action-active tu" title="Activar" data-original-title="Activar"  href="javascript:;" id="'+id+'"><span class="fa fa-check"></span> </a>';
                            }*/

                            var $html = $(html);

                            /*$(".dt-action-validar", $html).click(function (){
                                //ModalActivityRegister.open(false, idc, idd, responsable);
                                var aData = {"id": id, "idm": idm, "idi": idi, "alumno": alumno, "action": "LoadRequirementsStudentInformation"}
                                ModalValidateRequirements.open(aData);
                                //console.log(id);
                            });*/

                            $(this).after($html);

                        });
                        count++;
                    }

                });
                $("#dtViewAlumnos_filter input").unbind();
                $("#dtViewAlumnos_filter input").bind('keyup', function (e) {
                    //console.log("eeee");
                    if (e.keyCode == 13) {
                        self.$table.dataTable().fnFilter(this.value);
                    }
                });

            }

        }

        $(document).ready(function() {
            myController.init();
            myConfigCareers.init();
            myEnrollmentLists.init();
        });

    </script>
{% endblock %}
{% block atras %}/niveles{% endblock %}
{% block canvas %}
    <div class='row-fluid'>
        <div class='span8'>
            <h4>{{ title }}</h4>
            <h5>Periodo Académico: {{ periodo.nombre }} - [{% if periodo.activo %} <span class="label label-success">Activo</span> {% else %} <span class="label label-important">Inactivo</span> {% endif %}] - [<span class="label label-info">{{ periodo.tipo.nombre }}</span>]</h5>
            <h5>Fecha Inicio: {{ periodo.inicio|date:"d-m-Y" }} - Fecha Fin: {{ periodo.fin|date:"d-m-Y" }}</h5>
            <h5>Inicio agregaciones: {{ periodo.inicio_agregacion|date:"d-m-Y" }} - Limite agregaciones: {{ periodo.limite_agregacion|date:"d-m-Y" }} - Limite retiro: {{ periodo.limite_retiro|date:"d-m-Y" }}</h5>
            <br>
            <br>
            <br>
            <br>
            <br>
            <br>
            <br>
            <br>

            <div class="row-fluid">
                <div class="span6">
                    <div class="btn-group">
                        <a href="javascript:;" class="btn btn-success tu enrollment_massively" idpa="{{ periodoc.id }}" idpp="{{ periodo.id }}" data-original-title="Matriculación Masiva"><i class="fa fa-gears"></i> Matriculación Masiva</a>
                    </div>
                    <div class="btn-group">
                        <a class="btn dropdown-toggle" data-toggle="dropdown" href="javascript:;">Acciones <span class="caret"></span></a>
                        <ul class="dropdown-menu pull-left" style="width: 400px;">
                            <li><a href="javascript:;" pcid="{{ periodo.id }}" ppid="{{ periodoc.id }}" class="configCareers"><i class="fa fa-table"></i> Configuración de carreras </a></li>
                        </ul>
                    </div>
                </div>
                <div class="span6">
                    <label><strong>Periodo Académico de Admisión</strong></label>
                    <select id="periodos_list" class="periodos_list" style="width: 100%">
                        {% for per in periodop %}
                            <option  {% if periodoc.id == per.id %}selected{% endif %} value="{{ per.id }}">{{ per }}</option>
                        {% endfor %}
                    </select>
                </div>

            </div>

        </div>
        <div class="span4">
            <table class='table table-hover personal-task'>
                {% if config %}
                    <thead>
                    <tr>
                        <th colspan="2" style="text-align: right"><a href="javascrip:;" class="btn btn-mini btn-send reloadEstadistica"><i class="fa fa-refresh"></i></a></th>
                    </tr>
                    </thead>
                {% endif %}
                <tbody style="font-weight: bold">
                <tr>
                    <td><i class="fa fa-bookmark-o"></i> Total Admitidos</td>
                    <td style="text-align: center;" class="total_admision">{% if config %}{{ estadisticas.total_admision }}{% else %}0{% endif %}</td>
                </tr>
                <tr>
                    <td><i class="fa fa-users"></i> Total inscritos</td>
                    <td style="text-align: center;" class="total_inscritos">{% if config %}{{ estadisticas.total_inscritos }}{% else %}0{% endif %}</td>
                </tr>
                <tr>
                    <td><i class="fa fa-book"></i> Total matriculados</td>
                    <td style="text-align: center;" class="total_matriculados">{% if config %}{{ estadisticas.total_matriculados }}{% else %}0{% endif %}</td>
                </tr>
                <tr>
                    <td> <i class="fa fa-list-ul"></i> Total no matriculados</td>
                    <td style="text-align: center;" class="total_x_matricular">{% if config %}{{ estadisticas.total_x_matricular }}{% else %}0{% endif %}</td>
                </tr>
                <tr>
                    <td> <i class="fa fa-list-ul"></i> Total que aceptaron la matricula</td>
                    <td style="text-align: center;" class="total_aceptado_matricula">{% if config %}{{ estadisticas.total_aceptado_matricula }}{% else %}0{% endif %}</td>
                </tr>
                <tr>
                    <td> <i class="fa fa-remove"></i> Total que rechazadon la matricula</td>
                    <td style="text-align: center;" class="total_rechazado_matricula">{% if config %}{{ estadisticas.total_rechazado_matricula }}{% else %}0{% endif %}</td>
                </tr>
                <tr>
                    <td> <i class="fa fa-list-ol"></i> Total por confirmar la matricula</td>
                    <td style="text-align: center;" class="total_x_confirmar_matricula">{% if config %}{{ estadisticas.total_x_confirmar_matricula }}{% else %}0{% endif %}</td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>
    {% if coordinaciones %}
        <div class='row-fluid'>
            <div class="span12">
                {% for coordinacion in coordinaciones %}
                    <div class="accordion" id="accordion{{ coordinacion.id }}">
                        <div class="accordion-group" >
                            <div class="accordion-heading" style="background: #d9edf7">
                                <span class="accordion-toggle">
                                    <a class="" data-toggle="collapse" data-parent="#accordion{{ coordinacion.id }}" href="#collapseOne{{ coordinacion.id }}"><i class="fa fa-tasks fa-fw"></i></a>
                                    <a data-toggle="collapse" data-parent="#accordion{{ coordinacion.id }}" href="#collapseOne{{ coordinacion.id }}">{{ coordinacion.nombre }}</a>
                                </span>
                            </div>
                            <div id="collapseOne{{ coordinacion.id }}" class="accordion-body collapse in" style="margin: 10px;">
                                <div class="accordion-heading">
                                    {% with carreras=coordinacion|args:periodoc|call:'list_careers_by_and_period' %}
                                        <table class='table table-striped table-bordered'>
                                            <tr>
                                                <th style="text-align: center; width: 6%">
                                                    <input checked="" class="awesome-checkbox checkbox_coordinacion" data-icon-checked="fa fa-check-circle-o fa-2x" data-icon-unchecked="fa fa-circle-o fa-2x" id="checkbox_idcc_{{ coordinacion.id }}" name="checkbox_idcc_{{ coordinacion.id }}" type="checkbox" value="{{ coordinacion.id }}">
                                                    <!--<label class="content-input">
                                                        <input type="checkbox" name="Vehiculo" id="autopista" value="autopista">
                                                        <i></i>
                                                    </label>-->

                                                </th>
                                                <th style="text-align: center; width: 6%">#</th>
                                                <th style="text-align: center; width: 30%">Carrera Admisión</th>
                                                <th style="text-align: center; width: 30%">Carrera Pregrado</th>
                                                <th style="text-align: center; width: 14%">Estado</th>
                                                <th style="text-align: center; width: 14%">Acciones</th>
                                            </tr>
                                            {% for carreraadmision in carreras %}
                                                {% with carrerapregrado=carreraadmision|args:periodoc|args:periodo|call:'load_my_career_pregrado' detalle_total_matriculados=carreraadmision|args:periodoc|args:periodo|call:'load_number_enrolled' canmatricular=carreraadmision|args:periodoc|args:periodo|call:'load_can_matricular' canrerun=carreraadmision|args:periodoc|args:periodo|call:'can_rerun' %}
                                                    <tr>
                                                        <td style="text-align: center; vertical-align: middle">
                                                            {% if canmatricular and detalle_total_matriculados.admision <= detalle_total_matriculados.cupos %}
                                                                {% if canrerun or persona.usuario.is_superuser %}
                                                                    <input checked="" class="awesome-checkbox checkbox_carrera tu" data-icon-checked="fa fa-check-circle-o fa-2x" data-icon-unchecked="fa fa-circle-o fa-2x" id="checkbox_idca_{{ carreraadmision.id }}" name="checkbox_idca_{{ carreraadmision.id }}" ckd_cc="{{ coordinacion.id }}" type="checkbox" txtca="{{ carreraadmision.nombre }}" txtcp="{{ carrerapregrado.nombre }}" idca="{{ carreraadmision.id }}" idcp="{{ carrerapregrado.id }}" idpa="{{ periodoc.id }}" idpp="{{ periodo.id }}" title="Marcar/Desmarcar">
                                                                {% endif %}
                                                            {% endif %}

                                                        </td>
                                                        <td style="text-align: center; vertical-align: middle">{{ forloop.counter }}</td>
                                                        <td style="text-align: left ; vertical-align: middle">{{ carreraadmision.nombre }} - {{ carreraadmision.id }}</td>
                                                        <td style="text-align: left ; vertical-align: middle">{% if carrerapregrado %}{{ carrerapregrado.nombre }} - {{ carrerapregrado.id }}{% endif %}</td>
                                                        <td style="text-align: left; vertical-align: middle">
                                                            <div>
                                                                <label>
                                                                    <strong>Total de Admisión:</strong>
                                                                    <span>{{ detalle_total_matriculados.admision }}</span>
                                                                </label>
                                                            </div>
                                                            <div>
                                                                <label>
                                                                    <strong>Total de Pregrado:</strong>
                                                                    <span>{{ detalle_total_matriculados.pregrado }}</span>
                                                                </label>
                                                            </div>
                                                            <div>
                                                                <label><strong>Por matricular:</strong>
                                                                    <span>{{ detalle_total_matriculados.por_matricular }}</span>
                                                                </label>
                                                            </div>
                                                            {% for paralelo in detalle_total_matriculados.paralelos %}
                                                                <div>
                                                                    <label>
                                                                        <span class="label label-success"><strong>Paralelo:</strong> {{ paralelo.nombre }}; <strong>Cupo:</strong> {{ paralelo.cupo }}</span>
                                                                    </label>
                                                                </div>
                                                            {% empty %}
                                                                <div>
                                                                    <span class="label label-warning">SIN PARALELO</span>
                                                                </div>
                                                            {% endfor %}
                                                            <div>
                                                                <label><strong>Total de Cupos:</strong>
                                                                    <span>{{ detalle_total_matriculados.cupos }}</span>
                                                                </label>
                                                            </div>
                                                        </td>
                                                        <td style="text-align: center; vertical-align: middle">
                                                            {% if canmatricular and detalle_total_matriculados.admision <= detalle_total_matriculados.cupos %}
                                                                {% if canrerun or persona.usuario.is_superuser %}
                                                                    <div class="btn-group">
                                                                        <a class="btn btn-info tu enrollment_by_career" txtca="{{ carreraadmision.nombre }}" txtcp="{{ carrerapregrado.nombre }}" idca="{{ carreraadmision.id }}" idcp="{{ carrerapregrado.id }}" idpa="{{ periodoc.id }}" idpp="{{ periodo.id }}" title="Matricular"><i class="fa fa-gear"></i> Matricular</a>
                                                                    </div>
                                                                {% endif %}
                                                            {% endif %}
                                                            <div class="btn-group">
                                                                <a class="btn btn-default tu enrollment_list" txtca="{{ carreraadmision.nombre }}" txtcp="{% if carrerapregrado %}{{ carrerapregrado.nombre }}{% else %}S/N{% endif %}" idca="{{ carreraadmision.id }}" idcp="{% if carrerapregrado %}{{ carrerapregrado.id }}{% else %}0{% endif %}" idpa="{{ periodoc.id }}" idpp="{{ periodo.id }}" title="Listado de Matriculado"><i class="fa fa-users"></i> Alumnos</a>
                                                            </div>
                                                        </td>
                                                    </tr>
                                                {% endwith %}
                                            {% endfor %}
                                        </table>
                                    {% endwith %}
                                </div>
                            </div>
                        </div>
                    </div>
                {% endfor %}
            </div>

            <!--<ul class="nav nav-tabs">
                <li><a class="tabs modeldetalle" href="#evento" data-toggle="tab">Evento</a></li>
                <li><a class="tabs modeldetalle" href="#horarioevento" data-toggle="tab">Horario del evento</a></li>
            </ul>
            <div class="tab-content">
                <div class="tab-pane" id="evento">
                    jkfkf
                </div>
            </div>-->
        </div>
    {% else %}
        <div class='row-fluid'>
            <div class="span12">
                <div class="alert alert-info">
                    <a  href="javascript:;" class="close" data-dismiss="alert">×</a>
                    <h5 class="alert-heading">No se encontraron coordinaciones para el periodo académico {{ periodoc.nombre }}<br></h5>
                </div>
            </div>
        </div>

    {% endif %}


    <div id="modalEnrollmentLists" data-width="" class="modal fade" aria-labelledby="" aria-hidden="true" tabindex="-1" role="dialog" style="display: block;"  data-keyboard="false" data-backdrop="static">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <!--<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>-->
                    <h3 class="modal-title"><span></span> Listado</h3>
                </div>
                <div class="modal-body">
                    <!--<div  style="text-align: right; padding: 5px; display: none">
                        <label>Estados:
                            <select name='filter_estados' multiple="multiple">
                                <option id="1" selected="selected">PENDIENTES</option>
                                <option id="2" selected="selected">MATRICULADOS</option>
                            </select>
                        </label>
                    </div>-->
                    <div class="datatable" id="dataTableEnrollmentLists">
                        <table id="dtViewAlumnos" class='table table-bordered table-striped'>
                            <thead>
                            <tr>
                                <th style="text-align: center; width: 10%">Documento</th>
                                <th style="text-align: center; width: 70%">Alumno</th>
                                <th style="text-align: center; width: 10%">Estado</th>
                                <th style="text-align: center; width: 10%"></th>
                            </tr>
                            </thead>
                            <tbody>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="modal-footer">
                    <a href="javascript:;" class="btn btn-info action-close" data-dismiss="modal"> Cerrar</a>
                </div>
            </div>
        </div>
    </div>


    <div id="modalConfigCareers" data-width="" class="modal fade" aria-labelledby="" aria-hidden="true" tabindex="-1" role="dialog" style="display: block;"  data-keyboard="false" data-backdrop="static">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <!--<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>-->
                    <h3 class="modal-title"><span></span> Listado de Carrera</h3>
                </div>
                <div class="modal-body">
                    <div id="contenedorConfigCareers">

                    </div>
                </div>
                <div class="modal-footer">
                    <a href="javascript:;" class="btn btn-info action-close" data-dismiss="modal"> Cerrar</a>
                </div>
            </div>
        </div>
    </div>

{% endblock %}
