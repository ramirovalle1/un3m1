{% load sga_extras %}
{% load tz %}
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<?python import sitetemplate ?>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:py="http://purl.org/kid/ns#" py:extends="sitetemplate">
<html lang="en">
<head>
    <meta charset=UTF-8">
    <style type="text/css">
        @page {
            size: a4;/*size: a4 landscape;*/
            @frame header_frame {
            -pdf-frame-content: header_content;
            left: 1.5cm; right: 1cm; top: 0.5cm; height: 4cm;
        }
        @frame content_frame {
        left: 1.5cm; right: 1cm; top: 4.5cm; bottom: 1.5cm;
        }
        @frame footer {
        -pdf-frame-content: footerContent;
        bottom: 0cm;
        margin-left: 1.5cm;
        margin-right: 1cm;
        text-align: right;
        height: 1cm;
        }
        }
    </style>
</head>
<body>
<div id="header_content">
    <div align="center"><img name='unemi' src="https://sga.unemi.edu.ec/media/reportes/encabezados_pies/cabecera_unemi.png" height="150px" ></div>
    <div align="center" style="font-size:16px; font-weight: bold">INFORME MENSUAL DE CUMPLIMIENTO DE ACTIVIDADES<br> Desde:{{ data.fini  }} Hasta: {{ data.ffin  }} </div>
</div>
<h2>INFORMACIÓN GENERAL</h2>
<table width="100%" align="center" style="border: 1px solid black; line-height:3px; vertical-align:top; padding:3px; font-family: Verdana, Arial, sans-serif">
    <thead style="width: auto" >
    <tr>
        <th>Nombre del docente</th>
        <th>Periodo académico</th>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td> {{ data.distributivo.profesor.persona.nombre_completo_inverso }} </td>
        <td> {{ data.periodo }} </td>
    </tr>
    </tbody>
</table><br>
<table width="100%" align="center" style="border: 1px solid black; line-height:3px; vertical-align:top; padding:3px; font-family: Verdana, Arial, sans-serif">
    <thead style="width: auto" >
    <tr>
        <th>Facultad</th>
        <th>Tipo de Docente / Dedicación</th>
    </tr>
    </thead>
    <tbody>
    <tr>
        {%  if data.coord == 9 %}
            <td> {{ data.coordinacion }} - GESTIÓN DE ADMISIÓN Y NIVELACIÓN. </td>
        {% else %}
            <td> {{ data.coordinacion }} </td>
        {% endif %}
        <td>
            {#            {% if data.distributivo.profesor.nivelcategoria %}{{ data.distributivo.profesor.nivelcategoria }}<br>{% endif %}{% if data.distributivo.profesor.categoria %}{{ data.distributivo.profesor.categoria.nombre }}{% endif %} {% if data.distributivo.profesor.nivelescalafon %}{{ data.distributivo.profesor.nivelescalafon }}{% endif %}<br>{{ data.distributivo.profesor.dedicacion.nombre }}#}
            {{ data.distributivo.nivelcategoria|default_if_none:"-" }}<br>
            {{ data.distributivo.categoria|default_if_none:"-" }} {{ data.distributivo.nivelescalafon|default_if_none:"" }} <br>
            {{ data.distributivo.dedicacion|default_if_none:"-" }}
        </td>
    </tr>
    </tbody>
</table><br>
<h2>ACTIVIDADES</h2>
<table width="100%" align="center" border="1" style=" font-size:9px; line-height:3px; vertical-align:top; padding:3px; font-family: Verdana, Arial, sans-serif">
    <thead>
    <tr>
        <th colspan="2">DOCENCIA ({{ data.suma|floatformat:0 }} horas)</th>
    </tr>
    <tr>
        <th style="width: 800px">Actividad</th>
        <th style="width: 100px">Horas</th>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td style="width: 800px; text-align: left;">
            HORAS CLASES
            <table width="95%" align="justify" style=" font-size:8px; line-height:2px; vertical-align:top; padding:2px; font-family: Verdana, Arial, sans-serif">
                <thead>
                <tr>
                    <th style="text-align: left">Sub Actividad</th>
                    <th style="width:100px;text-align: center">Horas</th>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <td style="text-align: justify">HORAS CLASES
                        <br><b>Vigente:.</b>
                        SI
                    </td>
                    <td style="text-align: center">{{ data.suma|floatformat:0 }}</td>
                    <td style="text-align: justify"> </td>
                </tr>
                </tbody>
            </table>

        </td>
        <td style="width: 100px; text-align: center">{{ data.suma|floatformat:0  }}</td>
    </tr>
    </tbody>
</table><br>
{% if data.distributivo.detalle_horas_gestion %}
    <table width="100%" align="center" border="1" style=" font-size:9px; line-height:3px; vertical-align:top; padding:3px; font-family: Verdana, Arial, sans-serif">
        <thead>
        <tr>
            <th colspan="2">GESTIÓN ({{ data.distributivo.calcula_horas_gestion|floatformat:0 }} horas)</th>
        </tr>
        <tr>
            <th style="width: 800px">Actividad</th>
            <th style="width:100px; text-align: center">Horas</th>
        </tr>
        </thead>
        <tbody>
        {% for actividad in data.distributivo.detalle_horas_gestion %}
            <tr>
                <td style="text-align: justify">
                    {{ actividad.criteriogestionperiodo.criterio }}
                    {% if actividad.criteriogestionperiodo.articulo %}
                        <br><span style="font-size: 7px"><i>{{ actividad.criteriogestionperiodo.articulo|title }}</i></span>
                    {% else %}
                        <br><span style="font-size: 7px"><i>Sin asignación de artículo</i></span>
                    {% endif %}<br>
                    {% with subactividades=actividad|args:data.finic|args:data.ffinc|call:"actividades_fecha" %}
                        {% if subactividades %}
                            <table width="95%" align="justify" style=" font-size:8px; line-height:2px; vertical-align:top; padding:2px; font-family: Verdana, Arial, sans-serif">
                                <thead>
                                <tr>
                                    <th style="text-align: left">Sub Actividad</th>
                                    <th style="width:100px;text-align: center">Horas</th>
                                    <th style="width:250px;text-align: center">Fechas</th>
                                </tr>
                                </thead>
                                <tbody>

                                {% for x in subactividades %}
                                    <tr>
                                        <td style="text-align: justify">{{ x.nombre }}
                                            <br><b>Vigente:.</b>
                                            {% if x.vigente %}
                                                SI
                                            {% else %}
                                                NO
                                            {% endif %}
                                        </td>
                                        <td style="text-align: center">{{ x.horas }}</td>
                                        <td style="text-align: justify">Desde: {{ x.desde|date:"d-m-Y" }} Hasta: {{ x.hasta|date:"d-m-Y" }} </td>
                                    </tr>
                                {% endfor %}

                                </tbody>
                            </table>
                        {% endif %}
                    {% endwith %}

                </td>
                <td style="text-align: center">{{ actividad.horas }}</td>
            </tr>
        {% endfor %}
        </tbody>
    </table><br>
{% endif %}
<table width="100%" align="center" border="1" style=" font-size:9px; line-height:3px; vertical-align:top; padding:3px; font-family: Verdana, Arial, sans-serif">
    <thead>
    <tr>
        <th >Total de horas:
            {%  if data.coord == 9 %}
                {% with cant=data.distributivo|args:data.suma|call:"total_horas_admision" %}
                    {{ cant|floatformat:0 }}
                {% endwith %}
            {% else %}
                {% if data.distributivo.dedicacion.id == 1 and data.distributivo.total_horas > 40  %}40
                {% elif data.distributivo.dedicacion.id == 2 and data.distributivo.total_horas > 20 %}20
                {%  else %}
                    {{ data.distributivo.total_horas|floatformat:0 }}
                {% endif %}
            {% endif %}
        </th>
    </tr>
    </thead>
</table><br>
{% if data.titulaciones %}
    <h2>FORMACIÓN ACADÉMICA</h2>
    <table width="100%" align="center" border="1" style=" font-size:9px; line-height:3px; vertical-align:top; padding:3px; font-family: Verdana, Arial, sans-serif">
        <thead>
        <tr>
            <th style="width: 70px; text-align: center">Fecha  de obtención</th>
            <th style="width: 300px; text-align: center">Título</th>
            <th style="width: 300px; text-align: center">Institución</th>
            <th style="width: 50px; text-align: center">Aprobado </th>
        </tr>
        </thead>
        <tbody>
        {% for titulacion in data.titulaciones %}
            <tr>
                <td style="text-align: justify"> {{ titulacion.fechaobtencion|date:"Y-m-d" }}</td>
                <td style="text-align: justify">
                    {{ titulacion.titulo }}
                    <br>Reg.: {% if titulacion.registro  %}{{ titulacion.registro }}{% else %}NO EXISTE REGISTRO{% endif %}
                </td>
                <td style="text-align: justify">{{ titulacion.institucion }}</td>
                <td style="text-align: center">{% if titulacion.verificado %}SI {% else %} NO{% endif %}</td>
            </tr>
        {% empty %}
            <tr style="text-align: center">
                <td colspan="5"> NO REGISTRA TITULACIONES </td>
            </tr>
        {% endfor %}
        </tbody>
    </table><br>
{% endif %}

<h1>
    IMPARTICIÓN CLASES PRESENCIALES, VIRTUALES O EN LÍNEA, DE CARÁCTER TEÓRICO O PRÁCTICO, EN LA INSTITUCIÓN O FUERA DE ESTA, BAJO RESPONSABILIDAD Y DIRECCIÓN DE LA MISMA;
</h1>

{%  for materia in data.materias %}
    <h2>
        <br>  ASIGNATURA: {{ materia.asignatura.nombre  }}
    </h2>
    <table width="100%" align="center" style="border: 1px solid black; line-height:3px; vertical-align:top; padding:3px; font-family: Verdana, Arial, sans-serif">
        <thead>
        <tr>
            <td width="400"><b>Carrera </b></td>
            <td width="400"><b>Modalidad </b></td>
            <td width="300"><b>Paralelo </b></td>
            <td width="300"><b>No. Estudiantes </b></td>
        </tr>
        </thead>
        <tbody>
        <tr>
            <td width="400">
                {{ materia.carrera|default_if_none:" " }}
            </td>
            <td width="400">
                {{ materia.carrera.get_modalidad_display|default_if_none:" " }}
            </td>
            <td width="300">
                {{ materia.paralelo|default_if_none:" " }}
            </td>
            <td width="300">
                {% with cant=materia|call:"cantidad_asignados_a_esta_materia_sinretirados" %}
                    {{ cant }}
                {% endwith %}
            </td>
        </tr>
        </tbody>
    </table><br><br>
{#        observaciones#}
    <table width="100%" align="center" style="border: 1px solid black; line-height:3px; vertical-align:top; padding:3px; font-family: Verdana, Arial, sans-serif">
        <thead>
        <tr>
            <td colspan="4"><b>Clases</b></td>
        </tr>
        <tr>
            <td width="555" style="text-align: center"><b>Sección</b></td>
            <td width="555" style="text-align: center"><b>Nombre</b></td>
            <td width="555" style="text-align: center"><b>Tipo </b></td>
            <td width="555" style="text-align: center"><b>Fecha Creación</b></td>
        </tr>
        </thead>
        <tbody>
        {% with recursos=materia|args:data.fini|args:data.ffin|call:"recursos_subidos_tutor_clases" %}
            {% for recurso in recursos %}
                <tr>
                    <td width="700" style="text-align: center" >
                        {{ recurso.4|default_if_none:""}}
                    </td>
                    <td width="700">
                        {% with nombre=materia|args:recurso.3|args:recurso.0|call:"nombre_recurso" %}
                            {{ nombre.0.0 }}
                        {% endwith %}
                    </td>
                    <td width="700" style="text-align: center" >
                        {{ recurso.1|default_if_none:""}}
                    </td>
                    <td width="700"  style="text-align: center">
                        {{ recurso.2|date:'Y-m-d'|default_if_none:"" }}
                    </td>
                </tr>
            {% empty %}
                <tr>
                    <td colspan="4" style="text-align: center">No exiten registros de recursos</td>
                </tr>
            {% endfor %}
        {% endwith %}
        </tbody>
    </table><br/>
{#    {% with recursos=materia|args:data.distributivo.profesor.persona|args:data.finic|args:data.ffinc|call:"recursos_subidos_tutor_sga" %}#}
{#        {%  if recursos %}#}
{#            <table width="100%" align="center" style="border: 1px solid black; line-height:3px; vertical-align:top; padding:3px; font-family: Verdana, Arial, sans-serif">#}
{#                <thead>#}
{#                <tr>#}
{#                    <td colspan="5"><b>Recursos SGA</b></td>#}
{#                </tr>#}
{#                <tr>#}
{#                    <td width="555" style="text-align: center"><b>Semana No.</b></td>#}
{#                    <td width="555" style="text-align: center"><b>Zoom url</b></td>#}
{#                    <td width="555" style="text-align: center"><b>Clase Virtual </b></td>#}
{#                    <td width="555" style="text-align: center"><b>Fecha Clase</b></td>#}
{#                    <td width="555" style="text-align: center"><b>Fecha Ingreso</b></td>#}
{#                </tr>#}
{#                </thead>#}
{#                <tbody>#}
{##}
{#                {% for recurso in recursos %}#}
{#                    <tr>#}
{#                        <td width="700" style="text-align: center" >#}
{#                            {{ recurso.silabosemanal.numsemana }}#}
{#                        </td>#}
{#                        <td width="700" style="text-align: center">#}
{#                            {% if recurso.zoomurltutor %}#}
{#                                <b>INGRESADO</b>#}
{#                            {% else %}#}
{#                                NO INGRESADO#}
{#                            {% endif %}#}
{#                                                            {{ recurso.zoomurltutor }}#}
{#                        </td>#}
{#                        <td width="700" style="text-align: center" >#}
{#                            {% if recurso.clasevirtualtutor %}#}
{#                                <b>INGRESADO</b>#}
{#                            {% else %}#}
{#                                NO INGRESADO#}
{#                            {% endif %}#}
{#                                                            {{ recurso.clasevirtualtutor }}#}
{#                        </td>#}
{#                        <td>{{ recurso.fechaclase|date:"Y-m-d" }} desde: {{ recurso.fechaclase|date:"H:i"}} - hasta: {{ recurso.fechafinclase|date:"H:i"}}</td>#}
{#                        <td>{{ recurso.fecharecursotutor|date:"Y-m-d" }} {{ recurso.fecharecursotutor|date:"H:i"}}</td>#}
{#                    </tr>#}
{#                {% empty %}#}
{#                    <tr>#}
{#                        <td colspan="5" style="text-align: center">No exiten registros de recursos</td>#}
{#                    </tr>#}
{#                {% endfor %}#}
{#                </tbody>#}
{#            </table><br/>#}
{#        {% endif %}#}
{#    {% endwith %}#}

    {% with silabosemanal=materia|args:data.finic|args:data.ffinc|call:"silabo_semanal" %}
        {%  if silabosemanal %}
            <table width="100%" align="center" style="border: 1px solid black; line-height:3px; vertical-align:top; padding:3px; font-family: Verdana, Arial, sans-serif">
                <thead>
                <tr>
                    <td colspan="5"><b>Observaciones</b></td>
                </tr>
                <tr>
                    <td width="100"><b>Semana</b></td>
                    <td width="100" style="text-align: center"><b>Fecha inicio</b></td>
                    <td width="100" style="text-align: center"><b>Fecha Fin</b></td>
                    <td width="300" style="text-align: center"><b>Observación</b></td>
                    <td width="200" style="text-align: center"><b>Observación ingresada por</b></td>
                    <td width="100" style="text-align: center"><b>Cumplimiento</b></td>
                </tr>
                </thead>
                <tbody>

                {% for semana in silabosemanal %}
                    <tr>
                        <td width="100">Semana {{ semana.0|default_if_none:""}} </td>
                        <td width="75" style="text-align: center">
                            {{ semana.1|date:'Y-m-d'|default_if_none:""}}
                        </td>
                        <td width="75" style="text-align: center">
                            {{ semana.2|date:'Y-m-d'|default_if_none:"" }}
                        </td>
                        <td width="300" style="text-align: justify">
                            {%  if semana.3 %}
                                {%  if data.coord == 9 %}
                                    <b>Observación técnica ingresada por el Área de Admisión y Nivelación:</b><br>
                                {% else %}
                                    <b>Obs. Técnica:</b>
                                {%  endif %}
                                {{ semana.3|default_if_none:"" }}
                            {% endif %}
                            {%  if semana.4 %}
                                <br><b>Obs. Acad:</b>
                                {{ semana.4|default_if_none:"" }}
                            {% endif %}
                        </td>
                        <td width="200" style="text-align: justify">
                            {%  if semana.6 or semana.7 %}
                                <b>Usuario:</b>{{ semana.6.usuario|default_if_none:"" }}<br>
                                <b>Fecha Ingreso:</b>{{ semana.7|date:"d-m-Y"|default_if_none:"" }}<br>
                            {% endif %}
                        </td>
                        <td width="100" style="text-align: center">
                            {%  if semana.3 or semana.4 %}
                                {{ semana.5|default_if_none:"" }}
                            {% endif %}
                        </td>
                    </tr>
                {% empty %}
                    <tr>
                        <td colspan="5" style="text-align: center">No existen registros de observaciones</td>
                    </tr>
                {% endfor %}
                </tbody>

            </table><br/>
        {% endif %}
    {% endwith %}
{% endfor %}


<h1>
    ORIENTAR Y ACOMPAÑAR A TRAVÉS DE TUTORÍAS PRESENCIALES O VIRTUALES, INDIVIDUALES O GRUPALES;
</h1>

{%  for materia in data.materias %}
    <h2>
        <br>  ASIGNATURA: {{ materia.asignatura.nombre  }}
    </h2>
    <table width="100%" align="center" style="border: 1px solid black; line-height:3px; vertical-align:top; padding:3px; font-family: Verdana, Arial, sans-serif">
        <thead>
        <tr>
            <td width="400"><b>Carrera </b></td>
            <td width="400"><b>Modalidad </b></td>
            <td width="300"><b>Paralelo </b></td>
            <td width="300"><b>No. Estudiantes </b></td>
        </tr>
        </thead>
        <tbody>
        <tr>
            <td width="400">
                {{ materia.carrera|default_if_none:" " }}
            </td>
            <td width="400">
                {{ materia.carrera.get_modalidad_display|default_if_none:" " }}
            </td>
            <td width="300">
                {{ materia.paralelo|default_if_none:" " }}
            </td>
            <td width="300">
                {% with cant=materia|call:"cantidad_asignados_a_esta_materia_sinretirados" %}
                    {{ cant }}
                {% endwith %}
            </td>
        </tr>
        </tbody>
    </table><br><br>
    {% with tutorias=materia|args:data.distributivo.profesor|args:data.finic|args:data.ffinc|call:"tutorias_grupales" %}
        {%  if tutorias %}
            <table width="100%" align="center" border="1" style=" font-size:9px; line-height:3px; vertical-align:top; padding:3px; font-family: Verdana, Arial, sans-serif">
                <thead>
                <tr>
                    <th colspan="3">
                        TUTORÍAS Y ACOMPAÑAMIENTO ACADÉMICO GRUPALES
                    </th>
                </tr>
                <tr>
                    <th>Tema</th>
                    <th style="width: 80px; text-align: center">Fecha</th>
                </tr>
                </thead>
                <tbody>
                {% for tutoria in tutorias %}
                    <tr>
                        <td style="text-align: justify">{{ tutoria.observacion|upper }}</td>
                        <td style="text-align: center">{{ tutoria.fecha|date:"Y-m-d" }}</td>
                    </tr>
                {% empty %}
                    <tr style="text-align: center">
                        <td colspan="3"> NO REGISTRA TUTORIAS Y ACOMPAÑAMIENTO ACADÉMICO</td>
                    </tr>
                {% endfor %}
                </tbody>
            </table><br>
        {% endif %}
    {%  endwith %}
    {% with tutoriasindividuales=materia|args:data.distributivo.profesor|args:data.finic|args:data.ffinc|call:"tutorias_individuales" %}
        {%  if tutoriasindividuales %}
            <table width="95%" align="center" border="1" style=" font-size:9px; line-height:3px; vertical-align:top; padding:3px; font-family: Verdana, Arial, sans-serif">
                <thead>
                <tr>
                    <th colspan="6">
                        TUTORÍAS Y ACOMPAÑAMIENTO ACADÉMICO INDIVIDUALES
                    </th>
                </tr>
                <tr>
                    <th style="width: 100px;">No.</th>
                    <th style="width: 800px;">NOMBRE Y APELLIDO DEL ESTUDIANTE</th>
                    <th style="width: 600px;">TEMA TRATADO</th>
                    <th style="width: 200px;">FECHA</th>
                    <th style="width: 200px;">HORA</th>
                    <th style="width: 600px;">OBSERVACIONES DEL ACOMPAÑAMIENTO</th>
                </tr>
                </thead>
                <tbody>
                {% for tutoria in tutoriasindividuales %}
                    <tr>
                        <td style="text-align: center"> {{ forloop.counter }}</td>
                        <td style="text-align: center"> {{ tutoria.avpreguntadocente.materiaasignada.matricula.inscripcion.persona }}</td>
                        <td style="text-align: justify"> TEMA:{{ tutoria.avpreguntadocente.tema }}<br><br>PREGUNTA: {{ tutoria.avpreguntadocente.pregunta }} </td>
                        <td style="text-align: center"> {{ tutoria.avpreguntadocente.fecha_creacion|date:"d-m-Y" }}</td>
                        <td style="text-align: center"> {{ tutoria.avpreguntadocente.fecha_creacion|time:'H:i:a' }}</td>
                        <td style="text-align: center"> {{ tutoria.respuesta }}</td>
                    </tr>
                {% empty %}
                    <tr style="text-align: center">
                        <td colspan="6"> NO REGISTRA TUTORIAS Y ACOMPAÑAMIENTO ACADÉMICO</td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
        {% endif %}
    {% endwith %}
{% endfor %}
{#mensajes#}
<br/>


<h1>
    PREPARACIÓN Y ACTUALIZACIÓN DE CLASES, SEMINARIOS, TALLERES, ENTRE OTROS;
</h1>

{%  for materia in data.materias %}
    <h2>
        <br>  ASIGNATURA: {{ materia.asignatura.nombre  }}
    </h2>
    <table width="100%" align="center" style="border: 1px solid black; line-height:3px; vertical-align:top; padding:3px; font-family: Verdana, Arial, sans-serif">
        <thead>
        <tr>
            <td width="500"><b>Carrera </b></td>
            <td width="400"><b>Modalidad </b></td>
            <td width="300"><b>Paralelo </b></td>
            <td width="300"><b>No. Estudiantes </b></td>
        </tr>
        </thead>
        <tbody>
        <tr>
            <td width="500">
                {{ materia.carrera|default_if_none:" " }}

            </td>
            <td width="400">
                {{ materia.carrera.get_modalidad_display|default_if_none:" " }}

            </td>
            <td width="300">
                {{ materia.paralelo|default_if_none:" " }}

            </td>
            <td width="300">
                {% with cant=materia|call:"cantidad_asignados_a_esta_materia_sinretirados" %}
                    {{ cant }}

                {% endwith %}
            </td>
        </tr>
        </tbody>
    </table><br><br>
    <table width="100%" align="center" style="border: 1px solid black; line-height:3px; vertical-align:top; padding:3px; font-family: Verdana, Arial, sans-serif">
        <thead>
        <tr>
            <td colspan="4"><b>Recursos</b></td>
        </tr>
        <tr>
            <td width="555" style="text-align: center"><b>Sección</b></td>
            <td width="555" style="text-align: center"><b>Nombre</b></td>
            <td width="555" style="text-align: center"><b>Tipo </b></td>
            <td width="555" style="text-align: center"><b>Fecha Creación</b></td>
        </tr>
        </thead>
        <tbody>
        {% with recursos=materia|args:data.fini|args:data.ffin|call:"recursos_subidos_tutor_archivos" %}
            {% for recurso in recursos %}
                <tr>
                    <td width="700" style="text-align: center" >
                        {{ recurso.4|default_if_none:""}}
                    </td>
                    <td width="700">
                        {% with nombre=materia|args:recurso.3|args:recurso.0|call:"nombre_recurso" %}
                            {{ nombre.0.0 }}
                        {% endwith %}
                    </td>
                    <td width="700" style="text-align: center" >
                        {{ recurso.1|default_if_none:""}}
                    </td>
                    <td width="700"  style="text-align: center">
                        {{ recurso.2|date:'Y-m-d'|default_if_none:"" }}
                    </td>
                </tr>
            {% empty %}
                <tr>
                    <td colspan="4" style="text-align: center">No exiten registros de recursos</td>
                </tr>
            {% endfor %}
        {% endwith %}
        </tbody>
    </table><br/>
{% endfor %}



<h1>
    PREPARACIÓN, ELABORACIÓN, APLICACIÓN Y CALIFICACIÓN DE EXÁMENES, TRABAJOS Y PRÁCTICAS;
</h1>

{%  for materia in data.materias %}
    <h2>
        <br>  ASIGNATURA: {{ materia.asignatura.nombre  }}
    </h2>
    <table width="100%" align="center" style="border: 1px solid black; line-height:3px; vertical-align:top; padding:3px; font-family: Verdana, Arial, sans-serif">
        <thead>
        <tr>
            <td width="400"><b>Carrera </b></td>
            <td width="400"><b>Modalidad </b></td>
            <td width="300"><b>Paralelo </b></td>
            <td width="300"><b>No. Estudiantes </b></td>
        </tr>
        </thead>
        <tbody>
        <tr>
            <td width="400">
                {{ materia.carrera|default_if_none:" " }}

            </td>
            <td width="400">
                {{ materia.carrera.get_modalidad_display|default_if_none:" " }}

            </td>
            <td width="300">
                {{ materia.paralelo|default_if_none:" " }}

            </td>
            <td width="300">
                {% with cant=materia|call:"cantidad_asignados_a_esta_materia_sinretirados" %}
                    {{ cant }}

                {% endwith %}
            </td>
        </tr>
        </tbody>
    </table><br><br>
    {#    tareas#}
    <table width="100%" align="center" style="border: 1px solid black; line-height:3px; vertical-align:top; padding:3px; font-family: Verdana, Arial, sans-serif">
        <thead>
        <tr>
            <td colspan="9" width="300"><b>Tareas</b></td>
        </tr>
        <tr>
            <td width="300"><b>Nombre</b></td>
            <td width="100" style="text-align: center"><b>Fecha inicio</b></td>
            <td width="100" style="text-align: center"><b>Fecha fin</b></td>
            <td width="100" style="text-align: center"><b>Fecha calificación</b></td>
            <td width="90" style="text-align: center"><b>Total enviados</b></td>
            <td width="90" style="text-align: center"><b>Total no enviados</b></td>
            <td width="100" style="text-align: center"><b>Total calificados</b></td>
            <td width="100" style="text-align: center"><b>Total no calificados</b></td>
            <td width="100" style="text-align: center"><b>Porcentaje</b></td>
        </tr>
        </thead>
        <tbody>
        {% with tareas=materia|args:data.fini|args:data.ffin|call:"tareas_asignatura_moodle" %}
            {% for tarea in tareas %}
                <tr>
                    <td width="300"> {{ tarea.1|default_if_none:""}}</td>
                    <td width="100" style="text-align: center">{{ tarea.2|date:"d-m-Y"|default_if_none:""}}</td>
                    <td width="100" style="text-align: center">{{ tarea.3|date:"d-m-Y"|default_if_none:""}}</td>
                    <td width="100" style="text-align: center">
                        {% with fecha=materia|args:tarea.0|call:"fecha_ultima_tarea_calificada" %}
                            {{ fecha|date:"d-m-Y H:i"|default_if_none:"" }}
                        {% endwith %}
                    </td>
                    <td width="90" style="text-align: center">
                        {% with cant=materia|args:tarea.0|call:"cant_tareas_enviadas_por_tarea_moodle" %}
                            {{ cant|default_if_none:"" }}
                        {% endwith %}
                    </td>
                    <td width="100" style="text-align: center">
                        {% with cant=materia|args:tarea.0|call:"cant_tareas_no_enviadas_por_tarea_moodle" %}
                            {{ cant|default_if_none:"" }}
                        {% endwith %}
                    </td>
                    <td width="100" style="text-align: center">
                        {% with cant=materia|args:tarea.0|call:"cant_tareas_calificadas_por_tarea_moodle" %}
                            {{ cant|default_if_none:"" }}
                        {% endwith %}
                    </td>
                    <td width="100" style="text-align: center">
                        {% with cant=materia|args:tarea.0|call:"cant_tareas_no_calificadas_por_tarea_moodle" %}
                            {{ cant|default_if_none:"" }}
                        {% endwith %}
                    </td>
                    <td width="100" style="text-align: center">
                        {% with porcentaje=materia|args:tarea.0|call:"porcentaje_tareas_calificadas_moodle" %}
                            {{ porcentaje|default_if_none:"" }} %
                        {% endwith %}
                    </td>
                </tr>
            {% empty %}
                <tr>
                    <td colspan="9" style="text-align: center">No exiten registros de tareas</td>
                </tr>
            {% endfor %}
            </tbody>
        {% endwith %}

        <tfoot>
        <tr>
            <td colspan="9" style="text-align: right">
                Total enviados
                {% with total=materia|args:data.fini|args:data.ffin|call:"total_tareas_enviadas_moodle" %}
                    <b> {{ total|default_if_none:"" }} </b> /
                {% endwith %}
                Total calificados
                {% with total=materia|args:data.fini|args:data.ffin|call:"total_tareas_calificadas_moodle" %}
                    <b>{{ total|default_if_none:"" }}</b>
                {% endwith %}

                {% with porc=materia|args:data.fini|args:data.ffin|call:"porcentaje_tareas_calificadas_docente" %}
                    {% if porc <= 100  %}
                        <b>  ({{ porc|default_if_none:"" }} %)</b>
                    {% else %}
                        <b>  (100.00 %)</b>
                    {% endif %}
                {% endwith %}

            </td>
        </tr>
        </tfoot>
    </table><br/>
    {#foros#}
    {% with foros=materia|args:data.fini|args:data.ffin|call:"foros_asignatura_moodle" %}
        {%  if foros %}
            <table width="100%" align="center" style="border: 1px solid black; line-height:3px; vertical-align:top; padding:3px; font-family: Verdana, Arial, sans-serif">
                <thead>
                <tr>
                    <td colspan="7"><b>Foros</b></td>
                </tr>
                <tr>
                    <td width="700"><b>Nombre</b></td>
                    <td width="130" style="text-align: center"><b>Fecha inicio</b></td>
                    <td width="130" style="text-align: center"><b>Fecha Fin</b></td>
                    <td width="130" style="text-align: center"><b>Total Aportación</b></td>
                    <td width="130" style="text-align: center"><b>Total Calificados</b></td>
                    <td width="100" style="text-align: center"><b>Por Calificar</b></td>
                    <td width="130" style="text-align: center"><b>Porcentaje</b></td>
                </tr>
                </thead>
                <tbody>
                {% for foro in foros %}
                    <tr>
                        <td width="300">{{ foro.1|default_if_none:""}}</td>
                        <td width="100" style="text-align: center">
                            {{ foro.2|date:'Y-m-d'|default_if_none:""}}
                        </td>
                        <td width="100" style="text-align: center">
                            {{ foro.3|date:'Y-m-d'|default_if_none:"" }}
                        </td>
                        <td width="100" style="text-align: center">
                            {% with cant=materia|args:foro.0|args:foro.2|args:foro.3|args:foro.4|call:"cant_aportaciones_foro_moodle" %}
                                {{ cant }}
                            {% endwith %}
                        </td>
                        <td width="90" style="text-align: center">
                            {% with cant=materia|args:foro.0|call:"cant_foro_calificado_moodle" %}
                                {{ cant }}
                            {% endwith %}
                        </td>
                        <td width="100" style="text-align: center">
                            {% with cant=materia|args:foro.0|args:foro.2|args:foro.3|args:foro.4|call:"cant_foros_no_calificados" %}
                                {{ cant }}
                            {% endwith %}
                        </td>
                        <td width="100" style="text-align: center">
                            {% with cant=materia|args:foro.0|args:foro.2|args:foro.3|args:foro.4|call:"porcentaje_foros_calificadas_moodle" %}
                                {{ cant }} %
                            {% endwith %}
                        </td>
                    </tr>
                {% empty %}
                    <tr>
                        <td colspan="7" style="text-align: center">No exiten registros de foros</td>
                    </tr>
                {% endfor %}
                </tbody>

                <tfoot>
                <tr>
                    <td colspan="7" style="text-align: right">
                        Total de aportaciones

                        {% with total=materia|args:data.fini|args:data.ffin|call:"total_aportaciones_foro_moodle" %}
                            <b> {{ total }} </b>
                        {% endwith %}

                        / Total calificados
                        {% with total=materia|args:data.fini|args:data.ffin|call:"total_calificaciones_foro_moodle" %}
                            <b> {{ total }} </b>
                        {% endwith %}
                        {%  if data.opcionreport == 1 %}
                            {% with total=materia|args:data.fini|args:data.ffin|call:"porcentaje_foros_calificadas_materia_moodle_pregrado" %}
                                {% if total <= 100  %}
                                    <b>  ({{ total|default_if_none:"" }} %)</b>
                                {% else %}
                                    <b>  (100.00 %)</b>
                                {% endif %}
                            {% endwith %}
                        {% else %}
                            {% with total=materia|args:data.fini|args:data.ffin|call:"porcentaje_foros_calificadas_materia_moodle" %}
                                {% if total <= 100  %}
                                    <b>  ({{ total|default_if_none:"" }} %)</b>
                                {% else %}
                                    <b>  (100.00 %)</b>
                                {% endif %}
                            {% endwith %}
                        {% endif %}


                    </td>
                </tr>
                </tfoot>
            </table><br/>
        {% endif %}
    {% endwith %}
    {#chats#}
    {% with chats=materia|args:data.fini|args:data.ffin|call:"chat_asignatura_moodle" %}
        {% if chats %}
            <table width="100%" align="center" style="border: 1px solid black; line-height:3px; vertical-align:top; padding:3px; font-family: Verdana, Arial, sans-serif">
                <thead>
                <tr>
                    <td colspan="3"><b>Chats</b></td>
                </tr>
                <tr>
                    <td width="300"><b>Nombre</b></td>
                    <td width="300" style="text-align: center"><b>Fecha apertura</b></td>
                    {#            <td width="100" style="text-align: center"><b>Fecha fin</b></td>#}
                    <td width="300" style="text-align: center"><b>Realizado</b></td>
                </tr>
                </thead>
                <tbody>

                {% for chat in chats %}
                    <tr>
                        <td width="300">{{ chat.1|default_if_none:"" }} </td>
                        <td width="300" style="text-align: center">{{ chat.2|date:"d-m-Y H:i" }} </td>
                        {#                    <td width="100" style="text-align: center">{{ chat.3|date:"d-m-Y H:i" }} </td>#}
                        <td width="300" style="text-align: center">
                            {% with cant=materia|args:chat.0|args:data.distributivo.profesor.persona.usuario.username|call:"chat_realizado_docente_moodle" %}
                                {%  if cant > 0 %}
                                    <b>SI</b>
                                {% else %}
                                    <b>NO</b>
                                {% endif %}
                            {% endwith %}
                        </td>
                    </tr>
                {% empty %}
                    <tr>
                        <td colspan="3" style="text-align: center">
                            No exiten registros de chats
                        </td>
                    </tr>
                {% endfor %}

                </tbody>
                <tfoot>
                <tr>
                    <td colspan="3" style="text-align: right">
                        Total de chats planificados
                        {% with total=materia|args:data.fini|args:data.ffin|call:"cant_chat_planificados" %}
                            <b> {{ total }} </b>
                        {% endwith %}
                        / Total chats ejecutados
                        {% with total=materia|args:data.fini|args:data.ffin|args:data.distributivo.profesor.persona.usuario.username|call:"cant_chat_ejecutados" %}
                            <b> {{ total }} </b>
                        {% endwith %}
                        {% with total=materia|args:data.fini|args:data.ffin|args:data.distributivo.profesor.persona.usuario.username|call:"porcentaje_cumpliento_chats" %}
                            {% if total <= 100  %}
                                <b>  ({{ total|default_if_none:"" }} %)</b>
                            {% else %}
                                <b>  (100.00 %)</b>
                            {% endif %}
                        {% endwith %}

                    </td>
                </tr>
                </tfoot>
            </table><br/>
        {%  endif %}
    {% endwith %}

{% endfor %}


<h1>
    OTRAS ACTIVIDADES DE GESTIÓN RELACIONADAS CON LOS PROCESOS ACADÉMICOS ORDINARIOS DE LA INSTITUCIÓN.
</h1>

<table width="100%" align="center" border="1" style=" font-size:9px; line-height:3px; vertical-align:top; padding:3px; font-family: Verdana, Arial, sans-serif">
    <thead>
    <tr>
        <th style="width: 310px; text-align: center">Actividad</th>
        <th style="width: 200px;text-align: center;">Desde</th>
        <th style="width: 200px;text-align: center;">Hasta</th>
    </tr>
    </thead>
    <tbody>
    {% for evidencia in data.evidencias %}
        <tr>
            <td style="text-align: justify">{{ evidencia.actividad }}</td>
            <td style="text-align: center">{{ evidencia.desde|date:"d-m-Y" }}</td>
            <td style="text-align: center">{{ evidencia.hasta|date:"d-m-Y" }} </td>
        </tr>
    {% empty %}
        <tr>
            <td colspan="3" style="text-align: center">NO REGISTRA EVIDENCIAS</td>
        </tr>
    {% endfor %}
    </tbody>
</table>


<br>
<table width="100%" align="center" style="border: 1px solid black; line-height:3px; vertical-align:top; padding:3px; font-family: Verdana, Arial, sans-serif">
    <thead>
    <tr>
        <td colspan="5"><b>Mensajes</b></td>
    </tr>
    <tr>
        <td width="300" style="text-align: center"><b> Enviados</b></td>
        <td width="300" style="text-align: center"><b>Recibidos sin leer</b></td>
        <td width="300" style="text-align: center"><b>Recibidos leidos</b></td>
        <td width="400" style="text-align: center"><b>Total recibidos </b></td>
        <td width="400" style="text-align: center"><b>Porcentaje de mensajes leídos</b></td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td width="700" style="text-align: center">
            {% with total=data.distributivo.profesor.persona|args:data.coord|args:data.finic|args:data.ffinc|call:"total_mensajes_enviados_con_fecha" %}
                {{ total }}
            {% endwith %}
        </td>
        <td width="700" style="text-align: center">
            {% with total=data.distributivo.profesor.persona|args:data.coord|args:data.finic|args:data.ffinc|call:"cant_mensaje_no_leidos_moodle_con_fecha" %}
                {{ total }}
            {% endwith %}
        </td>
        <td width="700" style="text-align: center">
            {% with total=data.distributivo.profesor.persona|args:data.coord|args:data.finic|args:data.ffinc|call:"cant_mensaje_leidos_moodle_con_fecha" %}
                {{ total }}
            {% endwith %}
        </td>
        <td width="700" style="text-align: center">
            {% with total=data.distributivo.profesor.persona|args:data.coord|args:data.finic|args:data.ffinc|call:"total_mensajes_recibidos_con_fecha" %}
                {{ total }}
            {% endwith %}
        </td>
        <td width="700" style="text-align: center">
            {% with total=data.distributivo.profesor.persona|args:data.coord|args:data.finic|args:data.ffinc|call:"porcentaje_mensajes_leidos_con_fecha" %}
                {% if total <= 100  %}
                    <b>  {{ total|default_if_none:"" }} %</b>
                {% else %}
                    <b>  (100.00 %)</b>
                {% endif %}
            {% endwith %}
        </td>
    </tr>
    </tbody>
</table>

<br>
<table width="100%" align="center" style="border: 1px solid black; line-height:3px; vertical-align:top; padding:3px; font-family: Verdana, Arial, sans-serif">
    <thead>
    <tr>
        <td colspan="3"><b>FIRMAS DE RESPONSABILIDAD</b></td>
    </tr>
    <tr>
        <td width="333"><b>Elaborado por:</b></td>
        <td colspan="2" width="667"><b>Revisado y Aprobado por:</b></td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td width="333" style="text-align: center">
            {{ data.distributivo.profesor.persona.nombre_completo_inverso|default_if_none:""  }}
            <br><b>DOCENTE TUTOR </b>
        </td>
        <td width="333" style="text-align: center">

            {%  for carreray in data.listacarreras %}
                {% with firma=carreray|args:data.periodo|args:1|call:"coordinador" %}
                    {% if firma %}
                        <br><br><br>{{ firma.persona.nombre_completo_inverso|upper }}<br><br>
                        {% if firma.persona.sexo.id == 1 %}
                            <b>DIRECTORA / ENCARGADA CARRERA {{ carreray }}</b><br><br>
                        {% else %}
                            <b>DIRECTOR / ENCARGADO CARRERA {{ carreray }}</b><br><br>
                        {% endif %}
                    {% else %}
                        <br><b>DIRECTOR(A) / ENCARGADO(A) CARRERA {{ carreray }}</b><br><br>
                    {% endif %}
                {% endwith %}
            {% endfor %}
        </td>
        <td width="337" style="text-align: center">
            {%  for carrerad in data.listacarreras %}
                {% ifchanged carrerad.coordinacionvalida %}
                    {% with firma=carrerad.coordinacionvalida|args:data.periodo|args:1|call:"responsable_periododos" %}
                        {% if firma %}
                            <br><br><br>{{ firma.persona.nombre_completo_inverso|upper }}<br><br>
                            {% if firma.persona.sexo.id == 1 %}
                                <b>DECANA {{ carrerad.coordinacionvalida.nombre }}</b><br><br>
                            {% else %}
                                <b>DECANO {{ carrerad.coordinacionvalida.nombre }}</b><br><br>
                            {% endif %}
                        {% else %}
                            <b>DECANO(A) {{ carrerad.coordinacionvalida.nombre }}</b><br><br>
                        {% endif %}
                    {% endwith %}
                {% endifchanged %}
            {% endfor %}
        </td>
    </tr>
    </tbody>
</table>

<div id="footerContent" align="right">
    {%block page_foot%}
        <hr color="black" />
        &nbsp;&nbsp;&nbsp; P&aacute;gina <pdf:pagenumber></pdf:pagenumber>/ <pdf:pagecount></pdf:pagecount>
    {%endblock%}
</div>
</body>
</html>