{% extends "base.html" %}
{% load humanize %}
{% load sga_extras %}
{% block heading %}

    <link href="/static/css/table-responsive.css?1.0.0" type="text/css" rel="stylesheet" />
    <script type="text/javascript" src="/static/js/bootstrap-filestyle.min.js?v=1.0.1"> </script>
    <script type="text/javascript" src='/static/js/jquery.validationEngine.js?v=1.0.0'></script>
    <script type="text/javascript" src='/static/js/jquery.validationEngine-es.js?v=1.0.0' ></script>
    <link type='text/css' rel='stylesheet' href="/static/css/validationEngine.jquery.css?v=1.0.0"/>

    <script type="text/javascript">
        $(function() {
            {#$("#id_fechaaut_de").datepicker({format:"dd-mm-yyyy"}).on('changeDate', function(ev){ $(this).datepicker('hide'); });#}
            {#$("#id_fechaaut_deloes").datepicker({format:"dd-mm-yyyy"}).on('changeDate', function(ev){ $(this).datepicker('hide'); });#}
            {#$("#id_fechaaut_hasta").datepicker({format:"dd-mm-yyyy"}).on('changeDate', function(ev){ $(this).datepicker('hide'); });#}
            {#$("#id_fechaaut_hastaloes").datepicker({format:"dd-mm-yyyy"}).on('changeDate', function(ev){ $(this).datepicker('hide'); });#}

            $("#id_fechaaut_de,#id_fechaaut_hasta,#id_fechaaut_deloes,#id_fechaaut_hastaloes").blur(function () {
                fechavalida($(this));
            });

            busqueda = function(){
                var term = $("#searchinput").val().trim().toUpperCase();
                if (term.length>0){
                    var estado = $("#selEstadoSol").val();
                    location.href = "/adm_capdocenteperiodo?action=participantes&id=" + {{ cronogramaid }} + "&s="+term+"&eSol="+estado;
                }
                return false;
            };

            $("#search").click(function() {
                busqueda();
            });

            $('#searchinput').keyup(function(e) {
                if(e.keyCode == 13) {
                    busqueda();
                }
            });

            clienteinfo = function(window) {
                {
                    var unknown = '-';

                    // screen
                    var screenSize = '';
                    if (screen.width) {
                        width = (screen.width) ? screen.width : '';
                        height = (screen.height) ? screen.height : '';
                        screenSize += '' + width + " x " + height;
                    }

                    // browser
                    var nVer = navigator.appVersion;
                    var nAgt = navigator.userAgent;
                    var browser = navigator.appName;
                    var version = '' + parseFloat(navigator.appVersion);
                    var majorVersion = parseInt(navigator.appVersion, 10);
                    var nameOffset, verOffset, ix;

                    // Opera
                    if ((verOffset = nAgt.indexOf('Opera')) != -1) {
                        browser = 'Opera';
                        version = nAgt.substring(verOffset + 6);
                        if ((verOffset = nAgt.indexOf('Version')) != -1) {
                            version = nAgt.substring(verOffset + 8);
                        }
                    }
                    // Opera Next
                    if ((verOffset = nAgt.indexOf('OPR')) != -1) {
                        browser = 'Opera';
                        version = nAgt.substring(verOffset + 4);
                    }
                    // MSIE
                    else if ((verOffset = nAgt.indexOf('MSIE')) != -1) {
                        browser = 'Microsoft Internet Explorer';
                        version = nAgt.substring(verOffset + 5);
                    }
                    // Chrome
                    else if ((verOffset = nAgt.indexOf('Chrome')) != -1) {
                        browser = 'Chrome';
                        version = nAgt.substring(verOffset + 7);
                    }
                    // Safari
                    else if ((verOffset = nAgt.indexOf('Safari')) != -1) {
                        browser = 'Safari';
                        version = nAgt.substring(verOffset + 7);
                        if ((verOffset = nAgt.indexOf('Version')) != -1) {
                            version = nAgt.substring(verOffset + 8);
                        }
                    }
                    // Firefox
                    else if ((verOffset = nAgt.indexOf('Firefox')) != -1) {
                        browser = 'Firefox';
                        version = nAgt.substring(verOffset + 8);
                    }
                    // MSIE 11+
                    else if (nAgt.indexOf('Trident/') != -1) {
                        browser = 'Microsoft Internet Explorer';
                        version = nAgt.substring(nAgt.indexOf('rv:') + 3);
                    }
                    // Other browsers
                    else if ((nameOffset = nAgt.lastIndexOf(' ') + 1) < (verOffset = nAgt.lastIndexOf('/'))) {
                        browser = nAgt.substring(nameOffset, verOffset);
                        version = nAgt.substring(verOffset + 1);
                        if (browser.toLowerCase() == browser.toUpperCase()) {
                            browser = navigator.appName;
                        }
                    }
                    // trim the version string
                    if ((ix = version.indexOf(';')) != -1) version = version.substring(0, ix);
                    if ((ix = version.indexOf(' ')) != -1) version = version.substring(0, ix);
                    if ((ix = version.indexOf(')')) != -1) version = version.substring(0, ix);

                    majorVersion = parseInt('' + version, 10);
                    if (isNaN(majorVersion)) {
                        version = '' + parseFloat(navigator.appVersion);
                        majorVersion = parseInt(navigator.appVersion, 10);
                    }

                    // mobile version
                    var mobile = /Mobile|mini|Fennec|Android|iP(ad|od|hone)/.test(nVer);

                    // cookie
                    var cookieEnabled = (navigator.cookieEnabled) ? true : false;

                    if (typeof navigator.cookieEnabled == 'undefined' && !cookieEnabled) {
                        document.cookie = 'testcookie';
                        cookieEnabled = (document.cookie.indexOf('testcookie') != -1) ? true : false;
                    }

                    // system
                    var os = unknown;
                    var clientStrings = [
                        {s:'Windows 10', r:/(Windows 10.0|Windows NT 10.0)/},
                        {s:'Windows 8.1', r:/(Windows 8.1|Windows NT 6.3)/},
                        {s:'Windows 8', r:/(Windows 8|Windows NT 6.2)/},
                        {s:'Windows 7', r:/(Windows 7|Windows NT 6.1)/},
                        {s:'Windows Vista', r:/Windows NT 6.0/},
                        {s:'Windows Server 2003', r:/Windows NT 5.2/},
                        {s:'Windows XP', r:/(Windows NT 5.1|Windows XP)/},
                        {s:'Windows 2000', r:/(Windows NT 5.0|Windows 2000)/},
                        {s:'Windows ME', r:/(Win 9x 4.90|Windows ME)/},
                        {s:'Windows 98', r:/(Windows 98|Win98)/},
                        {s:'Windows 95', r:/(Windows 95|Win95|Windows_95)/},
                        {s:'Windows NT 4.0', r:/(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/},
                        {s:'Windows CE', r:/Windows CE/},
                        {s:'Windows 3.11', r:/Win16/},
                        {s:'Android', r:/Android/},
                        {s:'Open BSD', r:/OpenBSD/},
                        {s:'Sun OS', r:/SunOS/},
                        {s:'Linux', r:/(Linux|X11)/},
                        {s:'iOS', r:/(iPhone|iPad|iPod)/},
                        {s:'Mac OS X', r:/Mac OS X/},
                        {s:'Mac OS', r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},
                        {s:'QNX', r:/QNX/},
                        {s:'UNIX', r:/UNIX/},
                        {s:'BeOS', r:/BeOS/},
                        {s:'OS/2', r:/OS\/2/},
                        {s:'Search Bot', r:/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver)/}
                    ];
                    for (var id in clientStrings) {
                        var cs = clientStrings[id];
                        if (cs.r.test(nAgt)) {
                            os = cs.s;
                            break;
                        }
                    }

                    var osVersion = unknown;

                    if (/Windows/.test(os)) {
                        osVersion = /Windows (.*)/.exec(os)[1];
                        os = 'Windows';
                    }

                    switch (os) {
                        case 'Mac OS X':
                            osVersion = /Mac OS X (10[\.\_\d]+)/.exec(nAgt)[1];
                            break;

                        case 'Android':
                            osVersion = /Android ([\.\_\d]+)/.exec(nAgt)[1];
                            break;

                        case 'iOS':
                            osVersion = /OS (\d+)_(\d+)_?(\d+)?/.exec(nVer);
                            osVersion = osVersion[1] + '.' + osVersion[2] + '.' + (osVersion[3] | 0);
                            break;
                    }

                    // flash (you'll need to include swfobject)
                    /* script src="//ajax.googleapis.com/ajax/libs/swfobject/2.2/swfobject.js" */
                    var flashVersion = 'no check';
                    if (typeof swfobject != 'undefined') {
                        var fv = swfobject.getFlashPlayerVersion();
                        if (fv.major > 0) {
                            flashVersion = fv.major + '.' + fv.minor + ' r' + fv.release;
                        }
                        else  {
                            flashVersion = unknown;
                        }
                    }
                }

                window.jscd = {
                    screen: screenSize,
                    browser: browser,
                    browserVersion: version,
                    browserMajorVersion: majorVersion,
                    mobile: mobile,
                    os: os,
                    osVersion: osVersion,
                    cookies: cookieEnabled,
                    flashVersion: flashVersion
                };
            };

            clienteinfo(window);

            var navegador = jscd.browser +' '+ jscd.browserMajorVersion;
            var os =  jscd.os +' '+ jscd.osVersion;
            var cookies = jscd.cookies;
            var screensize = jscd.screen;

            $("#id_archivodevolucion, #id_observaciondev, #id_devolucion, #id_observaciondes, #id_motivo").addClass("validate[required]");

            $("#id_devolucion").blur(function(){
                numerico($(this), 0, 1000000, 2);
            });

            $(".tl").tooltip({position:"center up"});
            $(".informacioncap").click(function(){
                var id = $(this).attr('idt');
                var estadoSol=$("#estado_solicitud_"+id).html();
                {#if(estadoSol != 'AUTORIZADO' && estadoSol != 'DENEG.TH')#}
                {#    $("#detallecap_guardar").hide();#}
                {#else#}
                    $("#detallecap_guardar").show();
                bloqueointerface();
                $.ajax({
                    type: "POST",
                    url: "/adm_capdocenteperiodo",
                    data: {'action':'detallecap', 'id': id, 'fase': '{{ fase }}' },
                    success: function(data) {
                        $.unblockUI();
                        if (data.result=='ok'){
                            $("#detallecap_body").html(data.html);
                            $("#detallecap").modal({"backdrop":"static", "width": "1000px"}).modal("show");
                        } else {
                            NotificationJG.error(data.mensaje);
                        }
                    },
                    error: function() {
                        $.unblockUI();
                        NotificationJG.error("Error de conexión.");
                    },
                    dataType: "json"
                });
                return false;
            });

            $("#detallecap_guardar").click(function(){
                var idcronograma = {{ cronogramaid }}
                var id = $("#id_capacitacion").val();
                var obse = $("#id_observacion").val();
                var esta = $("#id_estadosolicitud").val();
                var criterios = ""

                {#if(obse.length<1){#}
                {#    smoke.alert("Ingrese una observación.");#}
                {#    $("#id_observacion").focus();#}
                {#    return false;#}
                {# }#}
                {#if(esta == "0"){#}
                {#    smoke.alert("Selecione el estado de la solicitud");#}
                {#    $("#id_estadosolicitud").focus();#}
                {#    return false;#}
                {# }#}

                {#$(".criterio").each(function(){#}
                {#    if(criterios.length==0)#}
                {#        criterios = $(this).attr("idp")+","+ $(this).is(":checked");#}
                {#    else#}
                {#        criterios = criterios+"|"+ $(this).attr("idp")+","+ $(this).is(":checked");#}
                {# });#}

                bloqueointerface();

                $.ajax({
                    type: "POST",
                    url: "/adm_capdocenteperiodo",
                    data: {'id': id, 'obse': obse, 'esta': esta, 'criterios': criterios, 'action': 'addcaprecorrido','fase': '{{ fase }}', 'navegador': navegador, 'os': os, 'cookies': cookies, 'screensize': screensize},
                    success: function(data) {
                        if (data.result=='ok') {
                            $("#itemspanel").modal("hide");
                            location.reload();
                            //location.href = '/adm_capdocenteperiodo?action=participantes&id='+idcronograma;
                        } else {
                            $.unblockUI();
                            NotificationJG.error(data.mensaje);
                        }
                    },
                    error: function() {
                        $.unblockUI();
                        NotificationJG.error("Error al enviar los datos al servidor.");
                    },
                    dataType: "json"
                });

            });

            $("#detallecap_cerrar").click(function(){
                $("#detallecap").modal("hide");
            });

            $("#selEstadoSol").change(function () {
                var estado = $("#selEstadoSol").val();
                var term = $("#searchinput").val().trim().toUpperCase();
                bloqueointerface();
                location.href = "/adm_capdocenteperiodo?action=participantes&id=" + {{ cronogramaid }} + "&s="+term+"&eSol="+estado;
            });

            $(".visualizar_convenio").click(function() {
                var id = $(this).attr('id');
                var ts = $(this).attr('ts');
                var ide = $(this).attr('ide');
                if(ts==1)
                    openwindow('POST' ,'/adm_capdocenteperiodo', {action:'preview_conveniodevengacion_pdf',id: id}, '_blank');
                else
                    openwindow('POST' ,'/adm_capacitacion', {action:'conveniodevengacion_pdf',id: ide}, '_blank');
            });

            $(".reporteaut_pdf").click(function () {
                $(".panelbodyaut").html();
                tiporep=$(this).attr('tipopersonal');
                $("#tiporeporte").val(tiporep);
                $("#estadosolicitudrepaut").val(4);
                $("#departamento").val(0);
                $("#itemspanelreporteaut").modal({backdrop:'static', width: '470px'}).modal('show');
            });

            $(".reporteautloes_pdf").click(function () {
                $(".panelbodyautloes").html();
                tiporep=$(this).attr('tipopersonal');
                $("#tiporeporte").val(tiporep);
                $("#periodo").val(0);
                $("#facultad").val(0);
                $("#estadosolicitudrepautloes").val(4);
                $("#itemspanelreporteautloes").modal({backdrop:'static', width: '470px'}).modal('show');
            });


            $("#generaraut_pdf").click(function () {
                var fechade = $("#id_fechaaut_de").val();
                var fechahasta = $("#id_fechaaut_hasta").val();
                var estado = $("#estadosolicitudrepaut").val();
                var tipopersonal = $("#tiporeporte").val();
                var departamento = $("#departamento").val();
                if(fechade.length==0){
                    NotificationJG.error("Ingrese la fecha desde");
                    return  false;
                }

                if(fechahasta.length==0){
                    NotificationJG.error("Ingrese la fecha hasta");
                    return false;
                }

                if (parseInt(departamento) == 0) {
                    NotificationJG.error("Seleccione un departamento");
                    return false;
                }

                $.ajax({
                    type: "POST",
                    url: "/adm_capdocenteperiodo",
                    data: {'departamento': departamento, 'desde': fechade, 'hasta': fechahasta, estado: estado, 'action': 'verificalistadosolicitudaut_pdf'},
                    success: function(data) {
                        if (data.result=='ok') {
                            openwindow('POST' ,'/adm_capdocenteperiodo', {action:'listadosolicitudaut_pdf',departamento: departamento, desde: fechade, hasta: fechahasta, tiporeporte: tipopersonal, estado: estado}, '_blank');
                            $('#itemspanelreporteaut').modal('hide');
                        } else {
                            $.unblockUI();
                            NotificationJG.error(data.mensaje);
                        }
                    },
                    error: function() {
                        $.unblockUI();
                        NotificationJG.error("Error al enviar los datos al servidor.");
                    },
                    dataType: "json"
                });
            });

            $("#generarautloes_pdf").click(function () {
                var fechade = $("#id_fechaaut_deloes").val();
                var fechahasta = $("#id_fechaaut_hastaloes").val();
                var estado = $("#estadosolicitudrepautloes").val();
                var tipopersonal = $("#tiporeporte").val();
                var periodo = $("#periodo").val();
                var facultad = $("#facultad").val();
                if(fechade.length==0){
                    NotificationJG.error("Ingrese la fecha desde");
                    return  false;
                }

                if(fechahasta.length==0){
                    NotificationJG.error("Ingrese la fecha hasta");
                    return false;
                }

                if(parseInt(periodo) == 0){
                    NotificationJG.error("Seleccione el periodo");
                    return false;
                }

                if(parseInt(facultad) == 0){
                    NotificationJG.error("Seleccione una facultad");
                    return false;
                }

                bloqueointerface();

                $.ajax({
                    type: "POST",
                    url: "/adm_capdocenteperiodo",
                    data: {'periodo': periodo, 'facultad': facultad, 'desde': fechade, 'hasta': fechahasta,'estado': estado, 'action': 'verificalistadosolicitudloes_pdf'},
                    success: function(data) {
                        if (data.result=='ok') {
                            $.unblockUI();
                            openwindow('POST' ,'/adm_capdocenteperiodo', {action:'listadosolicitudloesaut_pdf',periodo: periodo, facultad: facultad, desde: fechade, hasta: fechahasta, estado: estado}, '_blank');
                            //$('#itemspanelreporte').modal('hide');
                        } else {
                            $.unblockUI();
                            NotificationJG.error(data.mensaje);
                        }
                    },
                    error: function() {
                        $.unblockUI();
                        NotificationJG.error("Error al enviar los datos al servidor.");
                    },
                    dataType: "json"
                });
            });



            $("#cerraraut_pdf").click(function () {
                $('#itemspanelreporteaut').modal('hide');
            });

            $("#cerrarautloes_pdf").click(function () {
                $('#itemspanelreporteautloes').modal('hide');
            });


            $(".devolucion").click(function() {
                var id = $(this).attr('idt');
                var costo = parseFloat($(this).attr('cnc'));
                $("#id").val(id);
                $("#costo").val(costo);
                $("#id_tipo").val(0);
                $("#id_devolucion").val(costo);

                $("#devolucion").modal({backdrop:'static', width: '450px', height: '150px'}).modal('show');
            });


            $("#id_tipo").change(function () {
                costo = $("#costo").val();

                if(parseInt($("#id_tipo").val()) == 12)
                    $("#id_devolucion").val(costo);
                else
                    $("#id_devolucion").val(0.00);
            });

            $(".cerrarmodal").click(function() {
                $("#devolucion").modal("hide");
                return false;
            });

            $(".btn-aprobarcerrar").click(function() {
                envioformulario("/adm_capdocenteperiodo", false, $("#devolucion"));
                return false;
            });

            envioformulario = function(action, destino, modal){
                var valid = $("form").validationEngine('validate');
                //alert("EnvioForm");
                if (valid){
                    $('.bootstrap-timepicker-widget').css({"display": "none"});
                    bloqueointerface();
                    $('.controls input').each(function(){
                        if ($(this).attr('type')=='text'){
                            $(this).val($(this).val().trim());
                        }
                        if ($(this).attr('type')!='file'){
                            if ($(this).css('text-transform')=='uppercase'){
                                if ($(this).attr('type')!='password'){
                                    $(this).val($(this).val().toUpperCase());
                                }
                            }
                        }
                    });

                    var formdata = new FormData($("#formulario2")[0]);
                    $.ajax({
                        type: "POST",
                        url: action,
                        data: formdata,
                        success: function(data) {
                            ////modal.modal("hide");
                            if (data.result === 'ok') {
                                if(destino){
                                    location.href = destino;
                                }
                                else {
                                    location.reload()
                                }
                            } else {
                                $.unblockUI();
                                NotificationJG.error(data.mensaje);
                            }
                        },
                        error: function() {
                            $.unblockUI();
                            NotificationJG.error("Error al enviar los datos.");
                        },
                        dataType: "json",
                        cache: false,
                        contentType: false,
                        processData: false
                    });
                } else {
                    setTimeout(function() {
                        $('.help-text').html("");
                    }, 8000);
                    $.unblockUI();
                }
            };

            $(".descuentorol").click(function() {
                var id = $(this).attr('idsol');
                $("#idsol").val(id);
                $("#descuento").modal({backdrop:'static', width: '450px', height: '150px'}).modal('show');
            });

            $(".cerrardescuento").click(function() {
                $("#descuento").modal("hide");
                return false;
            });

            $(".btn-guardardescuento").click(function() {
                envioformulariodescuento("/adm_capdocenteperiodo", false, $("#devolucion"));
                return false;
            });

            envioformulariodescuento = function(action, destino, modal){
                var valid = $("form").validationEngine('validate');
                //alert("EnvioForm");
                if (valid){
                    $('.bootstrap-timepicker-widget').css({"display": "none"});
                    bloqueointerface();
                    $('.controls input').each(function(){
                        if ($(this).attr('type')=='text'){
                            $(this).val($(this).val().trim());
                        }
                        if ($(this).attr('type')!='file'){
                            if ($(this).css('text-transform')=='uppercase'){
                                if ($(this).attr('type')!='password'){
                                    $(this).val($(this).val().toUpperCase());
                                }
                            }
                        }
                    });

                    var formdata = new FormData($("#formulario3")[0]);
                    $.ajax({
                        type: "POST",
                        url: action,
                        data: formdata,
                        success: function(data) {
                            ////modal.modal("hide");
                            if (data.result == 'ok') {
                                if(destino){
                                    location.href = destino;
                                }
                                else {
                                    location.reload()
                                }
                            } else {
                                $.unblockUI();
                               NotificationJG.error(data.mensaje);
                            }
                        },
                        error: function() {
                            $.unblockUI();
                            NotificationJG.error("Error al enviar los datos.");
                        },
                        dataType: "json",
                        cache: false,
                        contentType: false,
                        processData: false
                    });
                } else {
                    setTimeout(function() {
                        $('.help-text').html("");
                    }, 8000);
                    $.unblockUI();
                }
            };
            $(".nuevoconvenio").click(function(){
                var idsol = $(this).attr('idsol');
                var nombres = $(this).attr('nombres');

                Swal.fire({
                    title: "¿Está seguro de autorizar la generación de un nuevo convenio del docente "+ nombres +"? Recuerde que se eliminará el convenio ya legalizado",
                    type: 'warning', 
                    showCancelButton: true,
                    confirmButtonText: "Si, anular solicitud",
                    cancelButtonText: 'No, cancelar',
                    showLoaderOnConfirm: true,
                }).then((result) => {
                    console.log(result);
                    if (result.value) {
                        bloqueointerface();
                        let e = result.value
                        $.ajax({
                            type: "POST",
                            url: "/adm_capdocenteperiodo",
                            data: {'action': 'generarnuevoconvenio','id':idsol, 'observacion': e },
                            error: function () {
                                $.unblockUI();
                                NotificationJG.error("Error al anular solicitud.");
                            },
                            success: function (data) {
                                if (data.result === "ok") {
                                    location.reload();
                                } else {
                                    $.unblockUI();
                                    NotificationJG.error(data.mensaje);
                                }
                            }
                        });
                    }
                });
            });


            $(".anulasolicitud").click(function(){
                var idsol = $(this).attr('idsol');
                var nombres = $(this).attr('nombres');

                Swal.fire({
                    title: "¿Está seguro de ANULAR SOLICITUD de "+ nombres +".?",
                    input: "text",
                    showCancelButton: true,
                    confirmButtonText: "Si, anular solicitud",
                    cancelButtonText: 'No, cancelar',
                    showLoaderOnConfirm: true,
                }).then((result) => {
                    console.log(result);
                    if (result.value) {
                        bloqueointerface();
                        let e = result.value
                        $.ajax({
                            type: "POST",
                            url: "/adm_capdocenteperiodo",
                            data: {'action': 'anulasolicitud','id':idsol, 'observacion': e },
                            error: function () {
                                $.unblockUI();
                                NotificationJG.error("Error al anular solicitud.");
                            },
                            success: function (data) {
                                if (data.result === "ok") {
                                    location.reload();
                                } else {
                                    $.unblockUI();
                                    NotificationJG.error(data.mensaje);
                                }
                            }
                        });
                    }
                });
            });
            $(".finalizarsolicitud").click(function(){
                var idsol = $(this).attr('idsol');
                var nombres = $(this).attr('nombres');
                var nompregunta = $(this).attr('nompregunta');
                Swal.fire({
                    title: "¿Está seguro de " + nompregunta + " SOLICITUD de "+ nombres +".?",
                    text: "Esta acción es irreversible!",
                    type: "warning",
                    showCancelButton: true,
                    confirmButtonColor: "#3085d6",
                    cancelButtonColor: "#d33",
                    confirmButtonText: "Si,"+nompregunta,
                    cancelButtonText: 'NO, CANCELAR',
                }).then((result) => {
                    if (result.value) {
                         bloqueointerface();
                        $.ajax({
                            type: "POST",
                            url: "/adm_capdocenteperiodo",
                            data: {'action': 'finalizarsolicitud','id':idsol},
                            error: function () {
                                $.unblockUI();
                                NotificationJG.error("Error al anular solicitud.");
                            },
                            success: function (data) {
                                if (data.result == "ok") {
                                    location.reload();
                                } else {
                                    $.unblockUI();
                                    NotificationJG.error(data.mensaje);
                                }
                            }
                        });
                    }
                });
            });
            $(".archivoconveniofirmadovice").click(function() {
                var id = $(this).attr('idt');
                $("#idarchivofirmado").val(id);
                $("#subirarchivo").modal({backdrop:'static', width: '350px', height: '230px'}).modal('show');
            });
            $(".btn-subirarchivofirmavice").click(function() {
                envioformularioarchivo("/adm_capdocenteperiodo", false, $("#subirarchivo"));
                return false;
            });
            $(".cerrarfirmadovicemodal").click(function() {
                $("#subirarchivo").modal("hide");
                return false;
            });
            envioformularioarchivo = function(action, destino, modal){
                var valid = $("form").validationEngine('validate');
                //alert("EnvioForm");
                if (valid){
                    $('.bootstrap-timepicker-widget').css({"display": "none"});
                    bloqueointerface();
                    $('.controls input').each(function(){
                        if ($(this).attr('type')=='text'){
                            $(this).val($(this).val().trim());
                        }
                        if ($(this).attr('type')!='file'){
                            if ($(this).css('text-transform')=='uppercase'){
                                if ($(this).attr('type')!='password'){
                                    $(this).val($(this).val().toUpperCase());
                                }
                            }
                        }
                    });

                    var formdata = new FormData($("#formulario4")[0]);
                    $.ajax({
                        type: "POST",
                        url: action,
                        data: formdata,
                        success: function(data) {
                            ////modal.modal("hide");
                            if (data.result == 'ok') {
                                if(destino){
                                    location.href = destino;
                                }
                                else {
                                    location.reload()
                                }
                            } else {
                                $.unblockUI();
                                NotificationJG.error(data.mensaje);
                            }
                        },
                        error: function() {
                            $.unblockUI();
                            NotificationJG.error("Error al enviar los datos.");
                        },
                        dataType: "json",
                        cache: false,
                        contentType: false,
                        processData: false
                    });
                } else {
                    setTimeout(function() {
                        $('.help-text').html("");
                    }, 8000);
                    $.unblockUI();
                }
            };
            var coll = document.getElementsByClassName("collapsible");
            var i;

            for (i = 0; i < coll.length; i++) {
                coll[i].addEventListener("click", function () {
                    this.classList.toggle("active");
                    var content = this.nextElementSibling;
                    var summary = this.previousElementSibling;
                    var ico = document.getElementById("ico-sumary");
                    console.log(coll)
                    if (content.style.maxHeight) {
                        content.style.maxHeight = null;
                        summary.style.display = "block";
                        coll.innerText ='Ver menos';
                    } else {
                        content.style.maxHeight = content.scrollHeight + "px";
                        summary.style.display = "none";
                        coll.innerText = 'Ver más';
                    }
                });
            }
        });
    </script>
    <style>
        .collapsible {
            cursor: pointer;
            width: 100%;
            border: none;
            text-align: left;
            outline: none;
            font-size: 15px;
        }

        .active, .collapsible:hover {
            background-color: #ccc;
        }

        .content {
            padding: 0 18px;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.2s ease-out;
            background-color: #f1f1f1;
        }
    </style>

{% endblock %}
{% block atras %}/adm_capdocenteperiodo{% endblock %}
{% block canvas %}
    <div class='row'>
        <div class='col-lg-12'>
            <div class="headtitle">
                <h3 class="texto-blue">{{ title }}</h3>
                <h6>{{ tipopersonal|lower|capfirst }}</h6>
            </div>
        </div>
    </div>
    <div class="container-fluid">
        <div class='row mb-3'>
            <div class="col-sm-3">
{#                <div class="btn-group">#}
{#                    <a class="btn btn-default dropdown-toggle" data-bs-toggle="dropdown" href="javascript:;">Reportes <i class="fa fa-caret-down"></i></a>#}
{#                    <ul class="dropdown-menu">#}
{#                        <li class="dropdown-item">#}
{#                            {% if idtipo == 1 %}#}
{#                                <a href="javascript:;" class="reporteautloes_pdf" tipopersonal="{{ idtipo }}" ><i class="fa fa-table"></i> Reporte de Solicitudes autorizadas</a></li>#}
{#                            {% else %}#}
{#                                <a href="javascript:;" class="reporteaut_pdf" tipopersonal="{{ idtipo }}" ><i class="fa fa-table"></i> Reporte de Solicitudes autorizadas</a></li>#}
{#                            {% endif %}#}
{#                    </ul>#}
{#                </div>#}
                <label for="" style="color: white">.</label>
                <a class="btn btn-default tu" title="Exportar registros" href="/adm_capdocenteperiodo?action={% if idtipo == 1 %}listadosolicitud_excel{% else %}listadosolicitudlosep_excel{% endif %}&id={{ cronogramaid }}"><i class="fa fa-file-excel"></i> Exportar a excel</a>
                {% if idtipo == 1 %}
                    {% if cronogramacapacitacion.resolucionocas or cronogramacapacitacion.instructivo or cronogramacapacitacion.manualusuario or cronogramacapacitacion.conveniodevengacion %}
                        <div class="btn-group">
                            <a class="btn btn-default dropdown-toggle" data-toggle="dropdown" href="javascript:;">Documentación <i class=" fa fa-caret-down"></i></a>
                            <ul class="dropdown-menu">
                                {% if cronogramacapacitacion.resolucionocas %}
                                    <li class="dropdown-item"><a href="{{ cronogramacapacitacion.resolucionocas.url }}" target="_blank" ><i class="fa fa-file"></i> Resolución OCAS</a></li>
                                {% endif %}
                                {% if cronogramacapacitacion.instructivo %}
                                    <li class="dropdown-item"><a href="{{ cronogramacapacitacion.instructivo.url }}" target="_blank" ><i class="fa fa-file"></i> Instructivo de capacitación/actualización</a></li>
                                {% endif %}
                                {% if cronogramacapacitacion.manualusuario %}
                                    <li class="dropdown-item"><a href="{{ cronogramacapacitacion.manualusuario.url }}" target="_blank" ><i class="fa fa-file"></i> Manual de Registro de Solicitud</a></li>
                                {% endif %}
                                {% if cronogramacapacitacion.conveniodevengacion %}
                                    <li class="dropdown-item"><a href="{{ cronogramacapacitacion.conveniodevengacion.url }}" target="_blank" ><i class="fa fa-file"></i> Convenio de devengación</a></li>
                                {% endif %}
                                {% if cronogramacapacitacion.manualregistroevidencia %}
                                    <li class="dropdown-item"><a href="{{ cronogramacapacitacion.manualregistroevidencia.url }}" target="_blank" ><i class="fa fa-file"></i> Manual para el Registro de Evidencias</a></li>
                                {% endif %}
                            </ul>
                        </div>
                    {% endif %}
                {% endif %}
            </div>
            <div class='col-sm-2'>
                <b>Estado de Solicitud:</b>
                <select id="selEstadoSol" name="selEstadoSol">
                    <option value="0" {% if estadosol == 0 %} selected{% endif %}>TODOS</option>
                    {% for e in estados %}
                        <option value="{{ e.0 }}" {% if estadosol == e.0 %}selected{% endif %}>{{ e.1 }}</option>
                    {% endfor %}
                </select>
            </div>
            <div class='col-sm-7'>
                <form class="form-search" onsubmit="return busqueda()">
                    <label for="searchinput" style="color:#000;">.</label>
                    <input class='searchinput' type='text' id='searchinput' value='{{ search }}' autocomplete="off" style="width:  {% if not search %}94{% else %}82{% endif %}%"/>
                    <a href="javascript:;" id='search' class='btn btn-info'><i class="fa fa-search "></i></a>
                    {% if search %}
                        <a href="/adm_capdocenteperiodo?action=participantes&id={{ cronogramaid }}" id='allresults' class='btn btn-info'><i class="fa fa-refresh "></i> Todos</a>
                    {% endif %}
                </form>
            </div>
        </div>
        <div class="card mb-4">
                <div class="card-body border-6 rounded-3">
                    <div class='row'>
                        <div class='col-sm-12'>
                            <table class='table table_primary tabla_responsive'>
                                <thead>
                                <tr>
                                    <th style="width: 70px;text-align: center" title="Fecha y número de Solicitud">Fecha/Núm</th>
                                    <th style="width: 180px; text-align:center">Nombre</th>
                                    <th style="width: 250px; text-align:center">Tema / Institución</th>
                                    <th style="width:200px;text-align: center">Justificación</th>
                                    <th style="width:30px!important;text-align: center">Modalidad</th>
                                    <th style="width:80px;text-align: center">Fechas</th>
                                    <th style="width:100px;text-align: center">Costo</th>
                                    <th style="width:80px;text-align: center">Estado</th>
                                    <th style="width:30px;text-align: center">Link</th>
                                    <th style="text-align: center; width: 100px;">Archivos</th>
                                    <th style="width: 5px; text-align: center"><i class="fa fa-cogs"></i></th>
                                </tr>
                                </thead>
                                <tbody>
                                {% for par in participantes %}
                                    <tr>
                                        <td style="text-align: center">{{ par.fecha_creacion|date:"Y-m-d"}}<br>
                                            <b class="text-success" data-bs-toggle="tooltip" title="Número de solicitud">&nbsp;&nbsp;{{ par.id|stringformat:"06d" }}&nbsp;&nbsp;</b>
                                        </td>
                                        <td>
                                            {% if par.tipo == 1 %}{{ par.profesor.persona.nombre_completo_minus }}{% else %}{{ par.administrativo.persona.nombre_completo_minus }}{% endif %}<br>
                                        </td>
                                        <td>
                                            {{ par.tema }}<br>{{ par.institucion }}
                                            {% if par.pais %}
                                                <br><b class="text-info">{{ par.pais.nombre }}</b>
                                            {% endif %}
                                            {% if par.finalizarproceso %}
                                                <br><b class="text-success" data-bs-toggle="tooltip" title="Proceso de solicitud finalizado">Finalizado</b>
                                            {% endif %}
                                        </td>
                                        <td>
                                            <div class="summary">{{ par.justificacion|truncatewords:20 }}
                                            </div>
                                            <button id=btn-vermas" type="button" class="collapsible" style="background-color: transparent; font-size: 12px; color: #5c5776"> Ver más <i id="ico-sumary" class="fa fa-caret-down"></i></button>
                                            <div class="content">
                                                <p>{{ par.justificacion }}</p>
                                            </div>
                                        </td>
                                        <td style="text-align: center; width: 10%">{{ par.get_modalidad_display|lower|capfirst }}</td>
                                        <td style="text-align: center">
                                            {% if par.fechainicio and par.fechafin %}
                                                {{ par.fechainicio|date:"Y-m-d" }}<br> {{ par.fechafin|date:"Y-m-d" }}
                                            {% else %}
                                                <b class="text-warning" data-bs-toggle="tooltip" title="El solicitante debe completar la información"><i class="fa fa-warning"></i> Campo incompleto</b>
                                            {% endif %}
                                        </td>
                                        <td style="text-align: center">$
                                            {% if par.costoneto > 0 %}
                                                {{ par.costoneto }}
                                            {% else %}
                                                {{ par.costo }}
                                            {% endif %}
                                            {% if par.fechadesembolso %}
                                                <br><b class="text-info" data-bs-toggle="tooltip" title="Fecha de desembolso">&nbsp;&nbsp;{{ par.fechadesembolso|date:"Y-m-d" }}&nbsp;&nbsp;</b>
                                            {% endif %}
                                        </td>
                                        <td style="text-align: center">
                                            {% if par.estado == 1 %}
                                                <b id="estado_solicitud_{{ par.id }}" class="text-default">{{ par.get_estado_display|lower|capfirst }}</b>
                                            {% elif par.estado == 2 or par.estado == 4 %}
                                                <b id="estado_solicitud_{{ par.id }}" class="text-info">{{ par.get_estado_display|lower|capfirst }}</b>
                                            {% elif par.estado == 3 %}
                                                <b id="estado_solicitud_{{ par.id }}" class="text-primary">{{ par.get_estado_display|lower|capfirst }}</b>
                                            {% elif par.estado == 5 or par.estado == 14 %}
                                                <b id="estado_solicitud_{{ par.id }}" class="text-warning">{{ par.get_estado_display|lower|capfirst }}</b>
                                            {% elif par.estado == 6 or par.estado == 13 or par.estado == 15 %}
                                                <b id="estado_solicitud_{{ par.id }}" class="text-success">{{ par.get_estado_display|lower|capfirst }}</b>
                                            {% else %}
                                                <b id="estado_solicitud_{{ par.id }}" class="text-danger">{{ par.get_estado_display|lower|capfirst }}</b>
                                            {% endif %}
                                        </td>
                                        <td style="text-align: center"><a class="btn btn-warning btn-mini" target="_blank" href="{{ par.link }}"><i class="fa fa-link"></i></a></td>
                                        <td style="text-align: center;">
                                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Solicitud&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
                                            <table class='table table-bordered' cellpadding="0" cellspacing="0" style="margin: 0">
                                                <tr>
                                                    <td style="width: 25%; text-align: center">
                                                        {% if par.archivo %}
                                                            <a target="_blank" title="Archivo de referencia" href="{{ par.archivo.url }}" class="btn btn-success btn-mini tu"><i class="fa fa-download"></i> </a>
                                                        {% endif %}
                                                        {% if par.archivoconvenio %}
                                                            {% if par.archivoconveniofirmadovice %}
                                                                <a target="_blank" title="Convenio de devengación firmado por vicerrector" href="{{ par.archivoconveniofirmadovice.url }}" class="btn btn-info btn-mini tu"><i class="fa fa-download"></i><i class="fa fa-check"></i> </a>
                                                            {% else %}
                                                                <a target="_blank" title="Convenio de devengación" href="{{ par.archivoconvenio.url }}" class="btn btn-info btn-mini tu"><i class="fa fa-download"></i> </a>
                                                            {% endif %}
                                                        {% endif %}
                                                        {% if par.archivodesembolso %}
                                                            <a target="_blank" title="Desembolso" href="{{ par.archivodesembolso.url }}" class="btn btn-warning btn-mini tu"><i class="fa fa-download"></i> </a>
                                                        {% endif %}
                                                        {% if par.archivodevolucion %}
                                                            <a target="_blank" title="Devolución" href="{{ par.archivodevolucion.url }}" class="btn btn-danger btn-mini tu"><i class="fa fa-download"></i> </a>
                                                        {% endif %}
                                                        {% if par.archivodescuentorol %}
                                                            <a target="_blank" title="Descuento ROL" href="{{ par.archivodescuentorol.url }}" class="btn btn-danger btn-mini tu"><i class="fa fa-download"></i> </a>
                                                        {% endif %}
                                                    </td>
                                                </tr>
                                            </table>

                                            {% if par.archivoinforme or par.archivofactura or par.archivocertificado %}
                                                Evidencias<br>
                                                <table class='table table-bordered' cellpadding="0" cellspacing="0" style="margin: 0px">
                                                    <tr>
                                                        <td style="width: 25%; text-align: center">
                                                            {% if par.archivoinforme %}
                                                                <a target="_blank" title="Informe" href="{{ par.archivoinforme.url }}" class="btn btn-success btn-mini tu"><i class="fa fa-download"></i> </a>
                                                            {% endif %}
                                                            {% if par.archivofactura %}
                                                                <a target="_blank" title="Factura" href="{{ par.archivofactura.url }}" class="btn btn-info btn-mini tu"><i class="fa fa-download"></i> </a>
                                                            {% endif %}
                                                            {% if par.archivocertificado %}
                                                                <a target="_blank" title="Certificado" href="{{ par.archivocertificado.url }}" class="btn btn-warning btn-mini tu"><i class="fa fa-download"></i> </a>
                                                            {% endif %}
                                                        </td>
                                                    </tr>
                                                </table>
                                            {% endif %}
                                        </td>
                                        <td style="text-align: center">
                                            <div class="btn-group dropleft">
                                                <button class="btn-icon btn btn-ghost btn-sm rounded-circle dropdown-toggle"
                                                        type="button" data-bs-toggle="dropdown" aria-expanded="false">
                                                    <i class="fa fa-ellipsis-v" aria-hidden="true"></i>
                                                </button>
                                                <ul class="dropdown-menu" x-placement="right-start">
                                                    <li class="dropdown-item"><a class="informacioncap"  idt="{{par.id}}" href="javascript:;" ><i class="fa fa-check-square tu"></i> Legalizar solicitud</a></li>

                                                    {% if not par.finalizarproceso %}
                                                        <li class="dropdown-item"><a class="bloqueo_pantalla" href="/adm_capdocenteperiodo?action=editcapacitacion&id={{ par.id|encrypt }}&convocatoria={{ cronogramacapacitacion.id }}"><i class="fa fa-edit"></i> Editar</a></li>
                                                    {% endif %}
                                                    {% if par.numeroconvenio %}
                                                        {% if not par.finalizarproceso %}
                                                            <li class="dropdown-item"><a href="javascript:;" id="{{ par.id }}" ts="{{ par.tipo }}" ide="{{ par.id|encrypt }}" class="visualizar_convenio"  ><i class="fa fa-file-pdf-o tu"></i> Visualizar convenio de devengación</a></li>
                                                        {% endif %}
                                                    {% endif %}

                                                    {% if par.estado == 5 %}
                                                        <li class="dropdown-item"><a class="nuevoconvenio" nombres="{{ par.profesor }}" idsol="{{ par.id|encrypt }}" href="javascript:;"><i class="fa fa-check"></i> Autorizar generar nuevo convenio</a></li>
                                                    {% endif %}

                                                    {%  if par.estado == 4 or par.estado == 10 %}
                                                        {% if not par.finalizarproceso %}
                                                            <li class="dropdown-item"><a class="informacioncap"  idt="{{par.id}}" href="javascript:;" ><i class="fa fa-check-square tu"></i> Legalizar solicitud</a></li>
                                                        {% endif %}
                                                    {% else %}
                                                        <li class="dropdown-item"><a class="informacioncap" idt="{{par.id}}" href="javascript:;" ><i class="fa fa-list tu"></i> Ver Recorrido</a></li>
                                                    {% endif %}
                                                    {% if not par.finalizarproceso %}
                                                        <li class="dropdown-item"><a class="devolucion"  idt="{{par.id}}" cnc="{{ par.costoneto }}" href="javascript:;" ><i class="fa fa-money tu"></i> Devolución de valores</a></li>
                                                    {% endif %}
                                                    {%  if par.estado == 6 %}
                                                        {% if not par.finalizarproceso %}
                                                            <li class="dropdown-item"><a class="descuentorol"  idsol="{{par.id}}" href="javascript:;" ><i class="fa fa-dollar tu"></i> Descuento en ROL</a></li>
                                                        {% endif %}
                                                    {% endif %}
                                                    {% if par.estado == 14 %}
                                                        {% if par.infocompletacap %}
                                                            {% if not par.finalizarproceso %}
                                                                <li class="dropdown-item"><a class="bloqueo_pantalla" href="/adm_capdocenteperiodo?action=confirmarejecutadocap&idcap={{ par.id|encrypt }}&idcron={{ cronogramaid }}&eSol={{ estadosol }}" ><i class="fa fa-handshake-o"></i> Confirmar Ejecutado</a></li>
                                                                {#                                {% else %}#}
                                                                {#                                    <br><span class="label label-important tu" title="No ha completado información de capacitación">NCI</span>#}
                                                            {% endif %}
                                                        {% endif %}
                                                    {% endif %}
                                                    {% if par.estado != 20 and not par.finalizarproceso %}
                                                        <li class="dropdown-item"><a class="anulasolicitud" nombres="{{ par.profesor }}" idsol="{{ par.id|encrypt }}" href="javascript:;"><i class="fa fa-minus"></i> Anular solicitud</a></li>
                                                    {% endif %}
                                                    {% if not par.finalizarproceso %}
                                                        <li class="dropdown-item"><a class="archivoconveniofirmadovice" href="javascript:;" idt="{{par.id}}" idc="{{ cronogramaid }}"><i class="fa fa-upload"></i> Subir Convenio Devengación firmado por vicerrector </a></li>
                                                    {% endif %}
                                                    {% if par.estado == 6 or par.estado == 13 or par.estado == 14 or par.estado == 17 %}
                                                        {% if not par.finalizarproceso %}
                                                            <li class="dropdown-item"><a class="bloqueo_pantalla" href="/adm_capdocenteperiodo?action=subirevidenciaejecutadocap&idcap={{ par.id|encrypt }}&idcron={{ cronogramaid }}&eSol={{ estadosol }}" ><i class="fa fa-upload"></i> Subir Evidencias Ejecutado</a></li>
                                                        {% endif %}
                                                    {% endif %}
                                                    {% if par.capacitacion %}
                                                        {% if par.estado == 14 or par.estado == 17 %}
                                                            {% if not par.finalizarproceso %}
                                                                <li class="dropdown-item"><a class="bloqueo_pantalla" href="/adm_capdocenteperiodo?action=editcapacitacionth&id={{ par.id|encrypt }}&convocatoria={{ cronogramacapacitacion.id }}&idcth={{ par.capacitacion.id }}&idcron={{ cronogramaid }}&eSol={{ estadosol }}"><i class="fa fa-vcard"></i> Editar capacitación - Hoja de vida</a> </li>
                                                            {% endif %}
                                                          {% endif %}
                                                    {% endif %}
                                                            <li class="dropdown-item"><a class="finalizarsolicitud" nompregunta="{% if not par.finalizarproceso %}FINALIZAR{% else %}APERTURAR{% endif %}" nombres="{{ par.profesor}}" idsol="{{ par.id|encrypt }}" href="javascript:;"><i class="fa fa-{% if not par.finalizarproceso %}folder-open{% else %}folder{% endif %}"></i> {% if not par.finalizarproceso %}Finalizar{% else %}Aperturar{% endif %} proceso solicitud</a></li>

                                                </ul>
                                            </div>
                                        </td>
                                    </tr>
                                {% empty %}
                                    <tr>
                                        <td colspan="12">NO EXISTEN PARTICIPANTES</td>
                                    </tr>
                                {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="card-footer border-top-0">
                    {% include 'paginacionb4.html' %}
                </div>
            </div>
    </div>
    <div class="modal fade static" id="detallecap" style="display: none;">
    <div class="modal-dialog modal-dialog-centered modal-xl" role="document">
    <div class="modal-content">
        <div class="modal-header">
            <h3 class="paneltitle">
                Legalizar solicitud de capacitación
            </h3>
        </div>
        <div class="modal-body" id="detallecap_body"></div>
        <div class="modal-footer">
            <div style="float: right">
                <td><a href="javascript:;" id="detallecap_guardar" class="btn btn-success"> Guardar</a></td>
                <td><a href="javascript:;" id="detallecap_cerrar" class="btn btn-info"> Cerrar</a></td>
            </div>
        </div>
    </div>
    </div>
    </div>

    <div class="modal fade static" id="devolucion" style="display: none;">
    <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
        <div class="modal-header">
            <table border="0" width="100%" style="background-color: transparent;">
                <tr>
                    <td style="width: 80%"><h3 class="paneltitlearchivo">Registrar Devolución</h3></td>
                </tr>
            </table>
        </div>
        <form id="formulario2" style="width: 100%; margin-bottom: 0; padding: 10px 15px 0px;">
        <div class="container-fluid">
            <div class="row">
                <input type='hidden' name='action' value='devolucion' />
                <input type='hidden' name='id' id="id" value='0' />
                <input type='hidden' name='costo' id="costo" value='0' />
{#                {% for field in form2 %}#}
{#                    {% if field.field.widget.attrs.separator %}#}
{#                        <div style="width: 100%; height: 1px; float: left;"></div>#}
{#                    {% endif %}#}
{#                    <fieldset class="control-group nomargins" style="float: left; width: {% if field.field.widget.attrs.formwidth %}{{ field.field.widget.attrs.formwidth }}{% else %}100%{% endif %}">#}
{#                        <label class="control-label" for="id_{{ field.name }}">{{ field.label }}</label>#}
{#                        <div class="controls">#}
{#                            {{ field }}#}
{#                            <p class="help-text">{{ field.help_text }} </p>#}
{#                        </div>#}
{#                    </fieldset>#}
{#                {% endfor %}#}
                {{ form2.as_p }}
            </div>
        </div>
        </form>
        <div class="modal-footer">
            <td id="aprobarcerrar"><a href="javascript:;" class="btn btn-aprobarcerrar btn-success"> Guardar</a></td>
            <a href="javascript:;" class="btn btn-info cerrarmodal">Cerrar</a>
        </div>
    </div>
    </div>
    </div>

    <div class="modal fade static" id="descuento" style="display: none;">
    <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
    <div class="modal-content">
        <div class="modal-header">
            <table border="0" width="100%" style="background-color: transparent;">
                <tr>
                    <td style="width: 80%"><h3 class="paneltitlearchivo">Registrar Descuento en ROL</h3></td>
                </tr>
            </table>
        </div>
        <form id="formulario3" style="width: 100%; margin-bottom: 0;padding: 10px 15px 0px;">

            <div class="container-fluid">

            <div class="row">
                <input type='hidden' name='action' value='descuentorol' />
                <input type='hidden' name='idsol' id="idsol" value='0' />
{#                {% for field in form3 %}#}
{#                    {% if field.field.widget.attrs.separator %}#}
{#                        <div style="width: 100%; height: 1px; float: left;"></div>#}
{#                    {% endif %}#}
{#                    <fieldset class="control-group nomargins" style="float: left; width: {% if field.field.widget.attrs.formwidth %}{{ field.field.widget.attrs.formwidth }}{% else %}100%{% endif %}">#}
{#                        <label class="control-label" for="id_{{ field.name }}">{{ field.label }}</label>#}
{#                        <div class="controls">#}
{#                            {{ field }}#}
{#                            <p class="help-text">{{ field.help_text }} </p>#}
{#                        </div>#}
{#                    </fieldset>#}
                {{ form3.as_p }}
{#                {% endfor %}#}
            </div>
            </div>
        </form>
        <div class="modal-footer">
            <td id="aprobarcerrar"><a href="javascript:;" class="btn btn-guardardescuento btn-success"> Guardar</a></td>
            <a href="javascript:;" class="btn btn-info cerrardescuento">Cerrar</a>
        </div>
    </div>
    </div>
    </div>

    <div class="modal fade static" id="itemspanelreporteaut" style="width:100px;display: none;">
    <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
    <div class="modal-content">
        <div class="modal-header">
            <h4 class="paneltitle"><span class="fa fa-file-pdf-o"></span> Solicitudes de capacitaciones autorizadas</h4>
        </div>
        <div class="modal-body panelbodyaut">
            <div class="row-fluid">
                <div style="height: 35px"><input type="hidden" value="" id="tiporeporte" name="tiporeporte">
                    <div style="width: 100px; text-align: right; padding-right: 20px; float: left">Desde</div>
                    <div style="float: left"><input type="text" class="selectorfecha" value="{{ fecharep }}" id="id_fechaaut_de" style="width: 100px" ></div>
                    <div style="width: 100px; text-align: right; padding-right: 20px; float: left">Hasta</div>
                    <div style="float: left"><input type="text" class="selectorfecha" value="{{ fecharep }}" id="id_fechaaut_hasta" style="width: 100px" ></div>
                </div>

                <div style="height: 35px">
                    <div style="width: 100px; text-align: right; padding-right: 20px; float: left">Departamento:</div>
                    <div style="float: left">
                        <select id="departamento" name="departamento" style="width: 300px;">
                            <option value="0">--Seleccione--</option>
                            {% for e in departamentos %}
                                <option value="{{ e.0 }}">{{ e.1 }}</option>
                            {% endfor %}
                        </select>
                    </div>
                </div>

                <div style="height: 35px">
                    <div style="width: 100px; text-align: right; padding-right: 20px; float: left">Estado:</div>
                    <div style="float: left">
                        <select id="estadosolicitudrepaut" name="estadosolicitudrepaut" style="width: 300px;">
                            <option value="0">TODOS</option>
                            <option value="4">AUTORIZADO</option>
                            <option value="9">DENEGADO</option>
                            <option value="3">APROBADO(O POR AUTORIZAR)</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal-footer">
            <table class="pull-right">
                <tr>
                    <td><a href="javascript:;" class="btn btn-generar btn-success" id="generaraut_pdf"><i class="fa fa-file-pdf-o"></i> Generar</a></td>
                    <td><a href="javascript:;" class="btn btn-cerrar btn-info" id="cerraraut_pdf"><i class="fa fa-close"></i> Cerrar</a></td>
                </tr>
            </table>
        </div>
    </div>
    </div>
    </div>

    <div class="modal fade static" id="itemspanelreporteautloes" style="width:100px;display: none;">
    <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
    <div class="modal-content">
        <div class="modal-header">
            <h4 class="paneltitle"><span class="fa fa-file-pdf-o"></span> Solicitudes de capacitaciones autorizadas</h4>
        </div>
        <div class="modal-body panelbodyautloes">
            <div class="row-fluid">
                <div style="height: 35px"><input type="hidden" value="" id="tiporeporte" name="tiporeporte">
                    <div style="width: 100px; text-align: right; padding-right: 20px; float: left">Desde</div>
                    <div style="float: left"><input type="text" class="selectorfecha" value="{{ fecharep }}" id="id_fechaaut_deloes" style="width: 100px" ></div>
                    <div style="width: 100px; text-align: right; padding-right: 20px; float: left">Hasta</div>
                    <div style="float: left"><input type="text" class="selectorfecha" value="{{ fecharep }}" id="id_fechaaut_hastaloes" style="width: 100px" ></div>
                </div>

                <div style="height: 35px">
                    <div style="width: 100px; text-align: right; padding-right: 20px; float: left">Periodo:</div>
                    <div style="float: left">
                        <select id="periodo" name="periodo" style="width: 300px;">
                            <option value="0">--Seleccione--</option>
                            {% for p in periodos %}
                                <option value="{{ p.0 }}">{{ p.1 }}</option>
                            {% endfor %}
                        </select>
                    </div>
                </div>

                <div style="height: 35px">
                    <div style="width: 100px; text-align: right; padding-right: 20px; float: left">Facultad:</div>
                    <div style="float: left">
                        <select id="facultad" name="facultad" style="width: 300px;">
                            <option value="0">--Seleccione--</option>
                            {% for f in facultades %}
                                <option value="{{ f.0 }}">{{ f.1 }} ({{ f.2 }})</option>
                            {% endfor %}
                        </select>
                    </div>
                </div>

                <div style="height: 35px">
                    <div style="width: 100px; text-align: right; padding-right: 20px; float: left">Estado:</div>
                    <div style="float: left">
                        <select id="estadosolicitudrepautloes" name="estadosolicitudrepautloes" style="width: 300px;">
                            <option value="0">TODOS</option>
                            <option value="4">AUTORIZADO</option>
                            <option value="9">DENEGADO</option>
                            <option value="3">APROBADO(O POR AUTORIZAR)</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal-footer">
            <table class="pull-right">
                <tr>
                    <td><a href="javascript:;" class="btn btn-generar btn-success" id="generarautloes_pdf"><i class="fa fa-file-pdf-o"></i> Generar</a></td>
                    <td><a href="javascript:;" class="btn btn-cerrar btn-info" id="cerrarautloes_pdf"><i class="fa fa-close"></i> Cerrar</a></td>
                </tr>
            </table>
        </div>
    </div>
    </div>
    </div>
    <div class="modal fade static" id="subirarchivo" style="display: none;">
    <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
    <div class="modal-content">
        <div class="modal-header">
            <table border="0" width="100%" style="background-color: transparent;">
                <tr>
                    <td style="width: 80%"><h3 class="paneltitlearchivo">Subir archivo</h3></td>
                </tr>
            </table>
        </div>
        <form id="formulario4" style="width: 50%; margin-bottom: 0;padding-left: 15px;padding-top: 10px">
            <div class="container-fluid">
            <div class="row">
                <input type='hidden' name='action' value='addarchivoconvenio' />
                <input type='hidden' name='idarchivofirmado' id="idarchivofirmado" value='0' />
{#                {% for field in form4 %}#}
{#                    {% if field.field.widget.attrs.separator %}#}
{#                        <div style="width: 100%; height: 1px; float: left;"></div>#}
{#                    {% endif %}#}
{#                    <fieldset class="control-group nomargins" style="float: left; width: {% if field.field.widget.attrs.formwidth %}{{ field.field.widget.attrs.formwidth }}{% else %}100%{% endif %}">#}
{#                        <label class="control-label" for="id_{{ field.name }}">{{ field.label }}</label>#}
{#                        <div class="controls">#}
{#                            {{ field }}#}
{#                            <p class="help-text">{{ field.help_text }} </p>#}
{#                        </div>#}
{#                    </fieldset>#}
{#                {% endfor %}#}
                {{ form4.as_p }}
            </div>
            </div>
        </form>
        <div class="modal-footer">
            <td id="aprobarcerrar"><a href="javascript:;" class="btn btn-subirarchivofirmavice btn-success"> Guardar</a></td>
            <a href="javascript:;" class="btn btn-info cerrarfirmadovicemodal">Cerrar</a>
        </div>
    </div>
    </div>
    </div>

{% endblock %}