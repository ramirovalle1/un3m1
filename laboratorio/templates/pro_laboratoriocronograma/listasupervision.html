{% extends "base.html" %}
{% load sga_extras %}
{% block heading %}
    {#    <link href="//cdnjs.cloudflare.com/ajax/libs/x-editable/1.5.0/jquery-editable/css/jquery-editable.css" rel="stylesheet"/>#}
    {#    <script src="//cdnjs.cloudflare.com/ajax/libs/x-editable/1.5.0/jquery-editable/js/jquery-editable-poshytip.min.js"></script>#}

    <link href="/static/x-editable/bootstrap-editable.css?0.24" rel="stylesheet"/>
    <script src="/static/x-editable/bootstrap-editable.min.js?0.24"></script>

    <script type="text/javascript" src='/static/js/select2.js?v=1.0.0'></script>
    <link type='text/css' rel='stylesheet' href="/static/css/select2.css?v=1.0.0"/>
    <script type="text/javascript" src="/static/bootstrap4/plugins/moment/moment.min.js"></script>
    <link type='text/css' rel='stylesheet'
          href="/static/bootstrap4/plugins/daterangepicker/daterangepicker.css?v=1.0.0"/>
    <script type="text/javascript" src='/static/bootstrap4/plugins/daterangepicker/daterangepicker.js'></script>

    <style>
        .dropdown-item i {
            margin-right: 3px;
        }
    </style>

    <script type="text/javascript">

        tooltips = function () {
            $(".tl").tooltip({placement: "left"});
            $(".tr").tooltip({placement: "right"});
            $(".tu").tooltip({placement: "top"});
            $(".tb").tooltip({placement: "bottom"});
        };


        $(function () {

            tooltips();


            $('#buscador').on('keydown', function(event) {
                setTimeout(function(){
                    if (event.which === 8) {
                        if ($(this).val().trim().length === 0) {
                            $(this).parents('form').submit();
                        }
                    }
                }, 1000)
            });

            /*
            $('#buscador').on('keypress', function () {
               !($(this).val().trim()) && $(this).parents('form').submit();
            });
            */

            $('#tipo').on('select2:select', function(){
                bloqueointerface()
               $(this).parents('form').submit();
            });

            $.fn.editable.defaults.mode = 'inline';

            $(".detalletutoria").click(function () {
                var id = $(this).attr('idt');
                bloqueointerface();
                $.ajax({
                    type: "GET",
                    url: "/pro_laboratoriocronograma",
                    data: {'action': 'traertutorias', 'id': id},
                    success: function (data) {
                        $.unblockUI();
                        if (data.result == 'ok') {
                            $("#body-tutoria").html(data.data);
                            $("#vertutorias").modal({backdrop: 'static', width: '900px'}).modal('show');
                        } else {
                            smoke.alert(data.mensaje);
                        }
                    },
                    error: function () {
                        $.unblockUI();
                        smoke.alert("Error de conexión.");
                    },
                    dataType: "json"
                });
            });
            $("#cerrarvertutorias").click(function () {
                $("#vertutorias").modal("hide");
                return false;
            });

            $("select").select2({minimumResultsForSearch: 4});

            $('#searchinput').keyup(function (e) {
                if (e.keyCode == 13) {
                    busqueda();
                }
            });

            $(".generarinforme").click(function () {
                openwindow('POST', '/pro_laboratoriocronograma', {
                    action: 'informeseguimientopractica',
                    idp: $(this).attr('idp')
                }, '_blank');
            });

            $(".cargarobservacion").click(function () {
                var idsolicitud = $(this).attr('idsolicitud');
                var ancho = (parseInt($(this).attr('ancho')) == 0) ? $(window).width() - 100 : $(this).attr('ancho');
                var alto = (parseInt($(this).attr('alto')) == 0) ? '530px' : $(this).attr('alto');
                bloqueointerface();
                $.ajax({
                    type: "GET",
                    url: "/pro_laboratoriocronograma",
                    data: {'action': 'ver_observacion', 'idsolicitud': idsolicitud},
                    success: function (data) {
                        $.unblockUI();
                        if (data.result == 'ok') {
                            $(".panelbodyobs").html(data.data);
                            $("#itemspanelobs").modal({backdrop: 'static', width: ancho, height: alto}).modal('show');
                        } else {
                            smoke.alert(data.mensaje);
                        }
                    },
                    error: function () {
                        $.unblockUI();
                        smoke.alert("Error de conexión.");
                    },
                    dataType: "json"
                });
            });

            $("#cerrarpanelobs").click(function () {
                $("#itemspanelobs").modal("hide");
                return false;
            });

            $('.fechaeditable').editable({
                type: 'date',
                mode: 'inline',
                datepicker: {
                    language: 'es'
                },
                title: 'Modificar feha de Inicio',
                validate: function (value) {
                    var elem = $(this);
                    var anterior = elem.text();
                    if ($.trim(value) === '') {
                        alertaWarning('No se puede dejar el campo vacío');
                        return 'No se puede dejar el campo vacío';
                    } else {
                        var idregistro = $(this).attr('data-pk');
                        bloqueointerface();
                        var month = ("0" + (value.getMonth() + 1).toString()).slice(-2);
                        var day = ("0" + value.getDate().toString()).slice(-2);
                        var year = value.getFullYear().toString();
                        var date = year + "-" + month + "-" + day;
                        $.ajax({
                            type: 'POST',
                            url: '{{ request.path }}',
                            async: false,
                            data: {
                                csrfmiddlewaretoken: '{{ csrf_token }}',
                                action: 'editfecha',
                                id: idregistro,
                                valor: date
                            },
                            dataType: "json",
                        }).done(function (data) {
                            $.unblockUI();
                            console.log(data.result !== 'bad');
                            if (data.result !== 'bad') {
                                alertaSuccess('Información Actualizada')
                            } else {
                                elem.editable('toggle');
                                alertaWarning(data.mensaje);
                            }
                        }).fail(function (jqXHR, textStatus, errorThrown) {
                            $.unblockUI();
                            alertaWarning('Intentelo más tarde');
                        }).always(function () {
                            $.unblockUI();
                        });
                    }
                },
            });

            $('.fechaeditable2').editable({
                type: 'date',
                mode: 'inline',
                datepicker: {
                    language: 'es'
                },
                title: 'Modificar feha de Inicio',
                validate: function (value) {
                    var elem = $(this);
                    var anterior = elem.text();
                    if ($.trim(value) === '') {
                        alertaWarning('No se puede dejar el campo vacío');
                        return 'No se puede dejar el campo vacío';
                    } else {
                        var idregistro = $(this).attr('data-pk');
                        bloqueointerface();
                        [y, m, d, h, mi, _] = value._i
                        var date = y + "-" + (m+1).toString().padStart(2, '0') + "-" + d.toString().padStart(2, '0');
                        debugger;
                        $.ajax({
                            type: 'POST',
                            url: '{{ request.path }}',
                            async: false,
                            data: {
                                csrfmiddlewaretoken: '{{ csrf_token }}',
                                action: 'editfecha2',
                                id: idregistro,
                                valor: date
                            },
                            dataType: "json",
                        }).done(function (data) {
                            $.unblockUI();
                            if (data.result == 'bad') {
                                elem.editable('toggle');
                                alertaWarning(data.mensaje);
                            }else {
                                 $(elem).editable('setValue', date);
                            }
                        }).fail(function (jqXHR, textStatus, errorThrown) {
                            $.unblockUI();
                            alertaWarning('Intentelo más tarde');
                        }).always(function () {
                            $.unblockUI();
                        });
                    }
                },
            });

        });

    </script>
{% endblock %}
{% block atras %}/pro_laboratoriocronograma{% endblock %}
{% block canvas %}
    <div class='row'>
        <div class='col-sm-12'>
            <div class="headtitle ps-0 ms-0">
                <h3 class="texto-blue mt-0 pt-0">{{ title }}</h3>
                <h6>{{ persona|lower|title }}</h6>
            </div>
        </div>
    </div>
    <div class='row'>
        <div class="col-sm-6">
            <div class="btn-group">
                <button type="button" class="btn btn-default dropdown-toggle" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    Acciones <span class="caret"></span>
                </button>
                <div class="dropdown-menu">
                    <a class="dropdown-item" href="?action=configurarfechamasiva"><i class="fa fa-calendar-check-o"></i> Configurar fechas masiva de prácticas</a>
                    <a class="dropdown-item" href="?action=informemensual"><i class="fa fa-list"></i> Informe mensual (Supervisor)</a>
                    {% if detalledistributivo.distributivo.coordinacion.id == 1 %}
                    <a class="dropdown-item" href="pro_actividadestutorpracticas?action=viewsupervisiontutor&id={{ detalledistributivo.pk|encrypt }}"><i class="fa fa-calendar"></i> Vinculación y seguimiento de prácticas salud</a>
                    {% else %}
                    <a class="dropdown-item" href="?action=visitasupervisor"><i class="fa fa-calendar"></i> Vinculación y seguimiento de prácticas</a>
                    {% endif %}
                    <div class="dropdown-divider"></div>
                    <a class="dropdown-item" href="?action=listadobitacora&id={{ detalledistributivo.pk|encrypt }}"><i class="fa fa-edit"></i> Registrar bitacora</a>
{#                    <a class="dropdown-item" href="/pro_revisionactividadevidencia"><i class="fa fa-check-square-o"></i> Validar actividades del estudiante</a>#}
                    <a class="dropdown-item" href="?action=configuraciones"><i class="fa fa-cogs"></i> Configuración de informe mensual</a>
                </div>
            </div>
            <div class="btn-group">
                <button type="button" class="btn btn-default dropdown-toggle" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    Reportes <span class="caret"></span>
                </button>
                <div class="dropdown-menu">
                    <a class="dropdown-item" target="_blank" href="?action=excelsupervisor"><i class="fa fa-file-excel-o"></i> Descargar Excel</a>
                </div>
            </div>
            {% if formatospractica %}
                <div class="btn-group">
                    <a class="btn dropdown-toggle" data-toggle="dropdown" href="javascript:;">Formatos <span
                            class="caret"></span></a>
                    <ul class="dropdown-menu pull-left">
                        {% for formatopractica in formatospractica %}
                            <li class="dropdown-submenu">
                                <a href="javascript:;"><i class="fa fa-folder"></i> {{ formatopractica.nombre }}</a>
                                <ul class="dropdown-menu">
                                    {% for detalleformato in formatopractica.detalleformatos %}
                                        <li><a href="{{ detalleformato.download_link }}" target="_blank"><i
                                                class="fa fa-file"></i> {{ detalleformato.nombre }}</a></li>
                                        <li><a href="{{ detalleformato.download_link }}" target="_blank"><i
                                                class="fa fa-file"></i> {{ detalleformato.nombre }}</a></li>
                                    {% endfor %}
                                </ul>
                            </li>
                        {% endfor %}
                    </ul>
                </div>
            {% endif %}
        </div>
        <div class="col-sm-12">
            {#            <form class="form-search" onsubmit="return busqueda()">#}
            {#                <input class='searchinput' type='text' id='searchinput' value='{{ search }}' autocomplete="off"/>#}
            {#                <select id='tipo_solicitud' style="width: 140px">#}
            {#                    <option {% if tipo == 0  %} selected {% endif %} value='0'>Todos</option>#}
            {#                    <option {% if tipo == 12  %} selected {% endif %} value='12'>Evidencia configuradas</option>#}
            {#                    <option {% if tipo == 11  %} selected {% endif %} value='11'>Pendientes por configurar</option>#}
            {#                    <option {% if tipo == 13  %} selected {% endif %} value='13'>Evidencias negadas</option>#}
            {#                    <option {% if tipo == 10  %} selected {% endif %} value='10'>Prácticas culminadas</option>#}
            {#                </select>#}
            {#                <a href="javascript:;" id='search' class='btn btn-info'><span class="fa fa-search "></span> Buscar</a>#}
            {#                {% if search or ids or tipo %}#}
            {#                    <a href="/pro_laboratoriocronograma?action=listasupervision" id='allresults' class='btn btn-info'><span class="fa fa-refresh "></span> Todos</a>#}
            {#                {% endif %}#}
            {#            </form>#}
        </div>
    </div>
    <div class="row">
        <div class="col-sm-12">
            <form method="GET">
                <input type="hidden" name="action" value="{{ action }}">
                <div class="row">
                    <div class="col-sm-6 pe-1">
                        <b>Estados: {% if tipo %}<span class="text-danger">*</span>{% endif %}</b>
                        <select id='tipo' style="width: 100%" name="tipo">
                            <option {% if tipo == 0 %} selected {% endif %} value='0'>Todos</option>
                            <option {% if tipo == 12 %} selected {% endif %} value='12'>Evidencia configuradas</option>
                            <option {% if tipo == 11 %} selected {% endif %} value='11'>Pendientes por configurar
                            </option>
                            <option {% if tipo == 13 %} selected {% endif %} value='13'>Evidencias negadas</option>
                            <option {% if tipo == 10 %} selected {% endif %} value='10'>Prácticas culminadas</option>
                        </select>
                    </div>
                    <div class="col-sm-6 ps-1">
                        <b>Buscar: {% if s %}<span class="text-danger">*</span>{% endif %}</b>
                        <div class="input-group">
                            <input id="buscador" type="text" class="form-control" placeholder="Ingrese la cedula o apellidos del estudiante..." aria-label="Buscar" autocomplete="off" aria-describedby="button-addon2" name="s" value="{{ s }}">
                            <div class="input-group-append">
                                <button class="btn bg-sga bloqueo_pantalla" type="submit" id="button-addon2"><i class="fa fa-search text-light"></i></button>
                                {% if search or ids or tipo or s %}
                                    <a title="Ver todo" href="{{ request.path }}?action={{ action }}" class="btn btn-default tr bloqueo_pantalla"><i class="fas fa-sync-alt"></i></a>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>
            </form>
        </div>
    </div>
    <div class="row">
    <div class="col-sm-12">
        <table class="table table_primary table_striped">
            <thead>
            {#                <tr>#}
            {#                    <th colspan="8">SUPERVISIÓN PRÁCTICAS PRE PROFESIONALES</th>#}
            {#                </tr>#}
            <tr>
                <th style="width: 40px;text-align: center"></th>
                <th>Estudiante</th>
                <th style="width: 390px">Detalles</th>
                <th style="width: 70px;text-align: center;">Tipo</th>
                <th style="width: 70px;text-align: center;">Fechas</th>
                <th style="width: 50px; text-align: center;">Horas</th>
                <th style="width: 300px; text-align: center;">Institución</th>
                <th style="text-align: center;">Tutoría</th>
                <th style="width: 90px;text-align: center">Acciones</th>
            </tr>
            </thead>
            <tbody>
            {% for practicaspreprofesionale in supervisorpracticas %}
                <tr>
                    <td style="text-align: center">
                        {{ forloop.counter }}
                        <br> <br>
                        {% if practicaspreprofesionale.tiene_tutorias %}
                            <a class="btn btn-info btn-mini detalletutoria tu" title="Tutorias" href='javascript:;'
                               idt="{{ practicaspreprofesionale.id }}"> <i class='fa fa-list'></i> </a>
                        {% endif %}
                    </td>
                    <td>
                        {{ practicaspreprofesionale.inscripcion.persona }}
                        - {{ practicaspreprofesionale.inscripcion.carrera }} <br>
                        <strong>Ced.:</strong> <span
                            class="fw-normal">{{ practicaspreprofesionale.inscripcion.persona.cedula }}</span><br>
                        <strong>Telf.:</strong> <span
                            class="fw-normal">{{ practicaspreprofesionale.inscripcion.persona.telefono }}</span><br>
                        <strong>Email.:</strong> <span
                            class="fw-normal">{{ practicaspreprofesionale.inscripcion.persona.email }}</span><br>
                        <strong>Email Inst.:</strong> <span
                            class="fw-normal">{{ practicaspreprofesionale.inscripcion.persona.emailinst }}</span><br>
                        <strong>Dirección.:</strong>
                        <span style="font-size: 10px;font-weight: normal!important;">
                            {% if practicaspreprofesionale.inscripcion.persona.canton %}
                                {{ practicaspreprofesionale.inscripcion.persona.canton }} -
                            {% endif %}
                            {% if practicaspreprofesionale.inscripcion.persona.direccion %}
                                {{ practicaspreprofesionale.inscripcion.persona.direccion }}
                            {% endif %}
                            {% if practicaspreprofesionale.inscripcion.persona.direccion2 %}
                                {{ practicaspreprofesionale.inscripcion.persona.direccion2 }}
                            {% endif %}</span> <br>
                        {% if not practicaspreprofesionale.culminada or practicaspreprofesionale.archivo %}
                            {% if practicaspreprofesionale.periodoppp %}
                                <span class="text-success tu"
                                      title="Evidencias Aprobadas">{{ practicaspreprofesionale.evidenciasaprobadas }} / {{ practicaspreprofesionale.totalevidencias }}</span>
                                |
                                <span class="label label-warning tu"
                                      title="Evidencias Solicitadas">{{ practicaspreprofesionale.evidenciassolicitadas }}</span>
                                <span class="label label-important tu"
                                      title="Evidencias Rechazadas">{{ practicaspreprofesionale.evidenciasreprobadas }}</span>
                            {% endif %}
                        {% endif %}
                        {% if practicaspreprofesionale.culminada or practicaspreprofesionale.retirado %}
                            {% if practicaspreprofesionale.tiposolicitud == 3 %}
                                <span class="text-success"> PRACTICA HOMOLOGADA</span>
                            {% else %}
                                {% if practicaspreprofesionale.retirado %}
                                    <span class="text-important">RETIRADO POR VOLUNTAD PROPIA</span>
                                {% else %}
                                    <span class="text-success"> PRÁCTICA CULMINADA</span>
                                {% endif %}
                                {% if not practicaspreprofesionale.inscripcion.coordinacion.id == 1 %}
                                    {% if practicaspreprofesionale.estadosolicitud == 1 %}
                                        <span class="text-warning tu"
                                              title="Solicitado">{{ practicaspreprofesionale.get_estadosolicitud_display }}</span>
                                    {% endif %}
                                    {% if practicaspreprofesionale.estadosolicitud == 2 %}
                                        <span class="text-success tu"
                                              title="Aprobado">{{ practicaspreprofesionale.get_estadosolicitud_display }}</span>
                                    {% endif %}
                                    {% if practicaspreprofesionale.estadosolicitud == 3 %}
                                        <span class="text-important tu"
                                              title="Rechazado">{{ practicaspreprofesionale.get_estadosolicitud_display }}</span>
                                    {% endif %}
                                    {% if practicaspreprofesionale.estadosolicitud == 4 %}
                                        <span class="text-info tu"
                                              title="Pendiente">{{ practicaspreprofesionale.get_estadosolicitud_display }}</span>
                                    {% endif %}
                                    {% if practicaspreprofesionale.estadosolicitud == 5 %}
                                        <span class="text-info tu"
                                              title="Retirado">{{ practicaspreprofesionale.get_estadosolicitud_display }}</span>
                                    {% endif %}
                                    {% if practicaspreprofesionale.estadosolicitud == 6 %}
                                        <span class="text-important tu"
                                              title="Reprobado">{{ practicaspreprofesionale.get_estadosolicitud_display }}</span>
                                    {% endif %}
                                {% endif %}
                            {% endif %}
                        {% else %}
                            |
                            <span class="text-{% if practicaspreprofesionale.tiposolicitud == 3 or practicaspreprofesionale.tiposolicitud == 4 %}success{% else %}warning{% endif %}">{{ practicaspreprofesionale.get_tiposolicitud_display }}</span>
                            |
                            {% if practicaspreprofesionale.estadosolicitud == 1 %}
                                <span class="text-warning tu"
                                      title="Solicitado">{{ practicaspreprofesionale.get_estadosolicitud_display }}</span>
                            {% endif %}
                            {% if practicaspreprofesionale.estadosolicitud == 2 %}
                                <span class="text-success tu"
                                      title="Aprobado">{{ practicaspreprofesionale.get_estadosolicitud_display }}</span>
                            {% endif %}
                            {% if practicaspreprofesionale.estadosolicitud == 3 %}
                                <span class="text-important tu"
                                      title="Rechazado">{{ practicaspreprofesionale.get_estadosolicitud_display }}</span>
                            {% endif %}
                            {% if practicaspreprofesionale.estadosolicitud == 4 %}
                                <span class="text-info tu"
                                      title="Pendiente">{{ practicaspreprofesionale.get_estadosolicitud_display }}</span>
                            {% endif %}
                            {% if practicaspreprofesionale.estadosolicitud == 5 %}
                                <span class="text-important tu"
                                      title="Retirado">{{ practicaspreprofesionale.get_estadosolicitud_display }}</span>
                            {% endif %}
                            {% if practicaspreprofesionale.estadosolicitud == 6 %}
                                <span class="text-important tu"
                                      title="Reprobado">{{ practicaspreprofesionale.get_estadosolicitud_display }}</span>
                            {% endif %}
                            {% if practicaspreprofesionale.estadosolicitud == 5 %}
                                <strong>Archivo Retiro:</strong><a target="_blank" class="btn btn-success btn-mini"
                                                                   href="{{ practicaspreprofesionale.archivoretiro.url }}"><i
                                    class="fa fa-arrow-down"></i></a>
                            {% endif %}
                        {% endif %}
                        {% if practicaspreprofesionale.obseaprueba %}
                            <a class="btn btn-tini cargarobservacion tu"
                               title="Observación de Aprobación ó Negación"
                               idsolicitud="{{ practicaspreprofesionale.id }}"><i class="fa fa-eye"></i></a>
                        {% endif %}
                        {% if practicaspreprofesionale.archivo %}
                            <a href="/media/{{ practicaspreprofesionale.archivo }}" target="_blank"
                               class="btn btn-warning btn-mini tu"
                               title="Archivo Solicitud de Prácticas PreProfesionales"><i class="fa fa-file"></i></a>
                        {% endif %}
                    </td>
                    <td style="height: auto">
                        <b>F.Creación:</b> {{ practicaspreprofesionale.fecha_creacion|date:"d/m/Y h:i a" }}
                        {% if practicaspreprofesionale.tutorunemi %}
                            <br><strong>Tutor Acad:</strong>
                            {{ practicaspreprofesionale.tutorunemi|default_if_none:""|upper }}
                            <br><b>Tel.:</b> {{ practicaspreprofesionale.tutorunemi.persona.telefono }}
                            <br><b>Email.:</b> {{ practicaspreprofesionale.tutorunemi.persona.emailinst }}
                        {% endif %}
                        {% if practicaspreprofesionale.observacion %}
                            <br><b>Obs:</b> {{ practicaspreprofesionale.observacion }}
                        {% endif %}
                        {% if practicaspreprofesionale.itinerariomalla %}
                            <br><b>Itinerario:</b> {{ practicaspreprofesionale.itinerariomalla.nombreitinerario }}
                        {% endif %}
                        {% if practicaspreprofesionale.periodoppp %}
                            <br><b>Per. Evidencia:</b> {{ practicaspreprofesionale.periodoppp.nombre }}
                        {% endif %}
                        {% if practicaspreprofesionale.periodoppp %}
                            {% if practicaspreprofesionale.periodoppp.evaluarpromedio %}
                                <br/><b>Promedio de práctica:</b>
                                <span class="label label-info">{{ practicaspreprofesionale.total_promedio_nota_evidencia|floatformat:2 }}</span>
                            {% endif %}
                        {% endif %}
                        {% if practicaspreprofesionale.oferta %}
                            <br><b>Oferta:</b> <span class="label label-info">Si</span>
                        {% endif %}
                        {% if practicaspreprofesionale.retirado and practicaspreprofesionale.fechahastapenalizacionretiro %}
                            <br><b>Fecha fin de penalización de retiro: </b>
                            <span class="label label-info">{{ practicaspreprofesionale.fechahastapenalizacionretiro|date:"d-m-Y" }}</span>
                        {% endif %}
                    </td>
                    <td style="text-align: center">{{ practicaspreprofesionale.get_tipo_display }}</td>
                    <td style="text-align: justify">
                        {#                        <b>F.Desde:</b><br>{{ practicaspreprofesionale.fechadesde|date:"d-m-Y" }}<br>#}
                        <b>F.Desde:</b>
                        <a href="javascript:;" class="fechaeditable" data-format="dd-mm-yyyy"
                           data-pk="{{ practicaspreprofesionale.pk }}" data-url="/" data-name="fecha"
                           data-action="editfecha">{{ practicaspreprofesionale.fechadesde|date:"d/m/Y" }}</a>
                        <br>

                        <b>F.Hasta:</b>
                        <a href="javascript:;" class="fechaeditable2" data-format="dd-mm-yyyy"
                           data-pk="{{ practicaspreprofesionale.pk }}" data-url="/" data-name="fecha"
                           data-action="editfecha2">{{ practicaspreprofesionale.fechahasta|date:"d/m/Y" }}</a>
                        <br>


                        {#                        <b>F.Hasta:</b><br>{{ practicaspreprofesionale.fechahasta|date:"d-m-Y" }}<br>#}


                        {% if practicaspreprofesionale.fechaasigsupervisor %}<b>F.Asig Supervisor:</b><br>
                            {{ practicaspreprofesionale.fechaasigsupervisor|date:"d-m-Y" }}{% endif %}
                    </td>
                    <td style="text-align: center">
                        {{ practicaspreprofesionale.numerohora }}
                        {% if practicaspreprofesionale.tiposolicitud == 3 %}<br>
                            <span class="text-default tu"
                                  title="Horas Homologadas">{{ practicaspreprofesionale.horahomologacion|default_if_none:"" }}</span>
                        {% endif %}
                    </td>
                    <td>

                        {#                        {% if practicaspreprofesionale.institucion %}#}
                        {#                            {{ practicaspreprofesionale.institucion|upper }}#}
                        {#                        {% else %}#}
                        {#                            {% if not practicaspreprofesionale.empresaempleadora %}#}
                        {#                                <span class="label label-default" >{{ practicaspreprofesionale.otraempresaempleadora|upper }}</span>#}
                        {#                            {% else %}#}
                        {#                                {{ practicaspreprofesionale.empresaempleadora.nombre|upper }}#}
                        {#                            {% endif %}#}
                        {#                        {% endif %}<br>#}
                        {% if practicaspreprofesionale.institucion %}
                            {{ practicaspreprofesionale.institucion|upper }}
                        {% else %}
                            {% if not practicaspreprofesionale.convenio and not practicaspreprofesionale.acuerdo %}
                                {% if not practicaspreprofesionale.empresaempleadora %}
                                    {% if practicaspreprofesionale.otraempresaempleadora %}
                                        <span class="label label-default">{{ practicaspreprofesionale.otraempresaempleadora|upper }}</span>
                                    {% elif practicaspreprofesionale.inscripcion.coordinacion.id == 1 and practicaspreprofesionale.asignacionempresapractica %}
                                        <span class="label label-default">{{ practicaspreprofesionale.asignacionempresapractica|upper }}</span>
                                    {% else %}
                                        <span class="label label-important">NO SE ASIGNÓ UNA EMPRESA O CAMPO "OTRA EMPRESA" VACÍO</span>
                                    {% endif %}
                                {% else %}
                                    {{ practicaspreprofesionale.empresaempleadora.nombre|upper }}
                                {% endif %}
                            {% else %}
                                {#                                            POR CONVENIO#}
                                {% if practicaspreprofesionale.convenio %}
                                    {% if practicaspreprofesionale.convenio.empresaempleadora %}
                                        <span class="label label-default">{{ practicaspreprofesionale.convenio.empresaempleadora.nombre|upper }}</span>
                                    {% else %}
                                        <span class="label label-warning">EMPRESA DEL CONVENIO NO ASIGNADA</span>
                                    {% endif %}
                                {% elif practicaspreprofesionale.acuerdo.empresa %}
                                    {% if practicaspreprofesionale.acuerdo.empresa %}
                                        <span class="label label-default">{{ practicaspreprofesionale.acuerdo.empresa.nombre|upper }}</span>
                                    {% else %}
                                        <span class="label label-warning">EMPRESA DEL ACUERDO NO ASIGNADA</span>
                                    {% endif %}
                                {% else %}
                                    <span class="label label-important">DEBE SELECCIONAR UN ACUERDO O CONVENIO</span>
                                {% endif %}
                            {% endif %}
                        {% endif %}<br>
                        {% if practicaspreprofesionale.asignacionempresapractica %}<br>
                            <strong>Empresa Asignada:</strong>
                            {{ practicaspreprofesionale.asignacionempresapractica|default_if_none:""|upper }}<br>
                        {% endif %}
                        {% if practicaspreprofesionale.departamento %}
                            <strong>Dep:</strong> {{ practicaspreprofesionale.departamento|default_if_none:""|upper }}
                            <br>
                        {% endif %}
                        <strong>Tutor Emp:</strong> {{ practicaspreprofesionale.tutorempresa|default_if_none:""|upper }}<br>
                        <strong>Sector Ec:</strong> {{ practicaspreprofesionale.sectoreconomico_letra }} <br>
                        <strong>Tipo Ins:</strong> {{ practicaspreprofesionale.get_tipoinstitucion_display }}
                        {% if practicaspreprofesionale.rotacionmalla %}
                            <br><strong>Rotación:</strong> {{ practicaspreprofesionale.rotacionmalla }}
                        {% endif %}
                        {% if practicaspreprofesionale.itinerariomalla %}
                            <br><strong>Itinerario:</strong> {{ practicaspreprofesionale.itinerariomalla }}
                        {% endif %}
                    </td>
                    <td style="text-align: center;font-weight: bold;" data-title="Tutoría">
                        {% if practicaspreprofesionale.tipo == 1 or  practicaspreprofesionale.tipo == 2 %}
                            {% if practicaspreprofesionale.aplicatutoria %}
                                {% if practicaspreprofesionale.culminatutoria %}
                                    <span class="text-success">CULMINADA</span>
                                {% else %}
                                    <span class="text-warning">PENDIENTE</span>
                                {% endif %}
                            {% else %}
                                <span class="text-default">NO OBLIGATORIAS</span>
                            {% endif %}
                            <br>
                            <br>
                        {% endif %}
                    </td>
                    <td style="text-align: center">
{#                        {% if practicaspreprofesionale.formatoevidenciaalumno == 2 %}#}
{#                            <a class="btn " href='/pro_laboratoriocronograma?action=subirarchivos&id={{ practicaspreprofesionale.id }}&opc=2{% if tipo %}&tipo={{ tipo }}{% endif %}'><span class="fa fa-cogs"></span> Configurar Fecha</a>#}
{#                        {% endif %}#}
                        <span class="dropdown" title="ACCIONES">
                            <a class="btn-icon btn btn-ghost btn-sm rounded-circle dropdown-toggle" href="#" role="button" id="courseDropdown7" data-bs-toggle="dropdown" data-bs-offset="-20,20" aria-expanded="false">
                                <i class="fa fa-ellipsis-v fs-6"></i>
                            </a>
                            <span class="dropdown-menu dropdown-menu-end" aria-labelledby="courseDropdown7">
                                <span class="dropdown-header">ACCIONES</span>
                                {% if practicaspreprofesionale.inscripcion.coordinacion.id != 1 %}
                                <a class="dropdown-item" iid="{{ practicaspreprofesionale.id }}" href="/pro_laboratoriocronograma?action=editpractica&id={{ practicaspreprofesionale.id|encrypt }}"><i class="fa fa-edit"></i> Editar</a>
                                {% endif %}
                                {% if practicaspreprofesionale.estadosolicitud != 5 %}
                                    {% if practicaspreprofesionale.formatoevidenciaalumno == 2 %}
                                        <a class="dropdown-item" href='/pro_laboratoriocronograma?action=subirarchivos&id={{ practicaspreprofesionale.id }}&opc=2{% if tipo %}&tipo={{ tipo }}{% endif %}'><span class="fa fa-cogs"></span> Evidencias</a>
                                    {% endif %}
                                {% endif %}
                                {% if practicaspreprofesionale.estadosolicitud == 2 and  practicaspreprofesionale.tutorunemi and practicaspreprofesionale.supervisor %}
                                    <div class="dropdown-divider"></div>
                                    <a class="dropdown-item" href="javascript:void(0)" class="generarinforme" style="margin-top: 5px" idp="{{ practicaspreprofesionale.id|encrypt }}"><span class="fa fa-file-pdf-o"></span> Seguimiento P.</a>
                                {% endif %}
{#                                {% if practicaspreprofesionale.estadosolicitud == 2 %}#}
{#                                    <li><a href='/pro_laboratoriocronograma?action=retiro&id={{ practicaspreprofesionale.id }}'><span class="fa fa-close"></span> Retiro Practica</a></li>#}
{#                                {% endif %}#}
{#                                <li><a iid="{{ practicaspreprofesionale.id }}" href="#" onclick="addfechainicio('{{ practicaspreprofesionale.id|encrypt }}', '{{ practicaspreprofesionale.fechadesde.year }}', '{{ practicaspreprofesionale.fechadesde.month }}',  '{{ practicaspreprofesionale.fechadesde.day }}')" data-toggle="tooltip" title="Modificar Fecha de Inicio de practicas"><i class="fa fa-calendar"></i> Fecha de Inicio prácticas</a></li>#}
                            </span>
                        </span>
                    </td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="14">NO HAY REGITROS DE PRACTICAS PREPROFESIONALES</td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
    </div>
    <div class="card-footer border-top-0">
        {% include 'paginacionb4.html' %}
    </div>
    </div>

    {% if archivosgenerales %}
        <div class='row-fluid'>
            <div class='span12'>
                <h4>Archivos Generales de Prácticas Pre Profesionales</h4>
            </div>
        </div>
        <div class='row'>
            {% for archivo in archivosgenerales %}
                <a class='icon col-1' href='{{ archivo.download_link }}' target="_blank">
                    <div class='iconimage'>
                        <div class='pd'>
                            {% if archivo.tipo_archivo == "pdf" %}
                                <img src='/static/images/iconos/pdf.png' border="0"/>
                            {% endif %}
                            {% if archivo.tipo_archivo == "doc" or archivo.tipo_archivo == 'docx' %}
                                <img src='/static/images/iconos/word.png' border="0"/>
                            {% endif %}
                            {% if archivo.tipo_archivo == 'other' %}
                                <img src='/static/images/iconos/other.png' border="0"/>
                            {% endif %}
                        </div>
                    </div>
                    <div class='iconname'>
                        <div class='pd'>
                            <span class='icondesc fs-6 text-black'>{{ archivo.nombre|lower|title }}</span>
                        </div>
                    </div>
                </a>
            {% endfor %}
        </div>
    {% endif %}
    <div class="modal fade static" id="itemspanelobs" style="display: none;">
        <div class="modal-dialog modal-dialog-centered modal-xl" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <table border="0" width="100%" style="background-color: transparent">
                        <tr>
                            <td style="width: 80%"><h3 class="paneltitleobs">Observación</h3></td>
                            <td><a href="javascript:;" id="cerrarpanelobs" class="btn btn-danger btn-mini pull-right"><i
                                    class="fa fa-remove"></i></a></td>
                        </tr>
                    </table>
                </div>
                <div class="modal-body panelbodyobs" align="justify"></div>
            </div>
        </div>
    </div>
    <div class="modal fade static" id="vertutorias" style="display: none;">
        <div class="modal-dialog modal-dialog-centered modal-xl" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 id="paneltitle">TUTORÍAS</h4>
                </div>
                <div class="modal-body" id="body-tutoria"></div>
                <div class="modal-footer">
                    <a href="javascript:;" id="cerrarvertutorias" class="btn btn-success">Cerrar</a>
                </div>
            </div>
        </div>
    </div>
{% endblock %}