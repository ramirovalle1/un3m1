{% extends "basebs.html" %}
{% load sga_extras %}
{% block heading %}
    <link href="/static/widget_ppp.css" rel="stylesheet"/>
    <link href="/static/css/table-responsive.css?1.0.0" type="text/css" rel="stylesheet"/>
    <script type="text/javascript" src='/static/js/fontawesomev3.js?v=1.0.0'></script>
    <style type="text/css">
        .searchinput {
        {% if search %}
            max-width: 280px !important;
        {% else %}
            max-width: 320px !important;
        {% endif %}
            min-width: 100px !important;
        }

        .radio label,
        .checkbox label {
            display: inline-block;
            cursor: pointer;
            color: #0074D9;
            position: relative;
            padding: 5px 15px 5px 51px;
            font-size: 1em;
            border-radius: 5px;
            -webkit-transition: all 0.3s ease;
            -o-transition: all 0.3s ease;
            transition: all 0.3s ease;
        }

        .radio label:hover,
        .checkbox label:hover {
            background: rgba(255, 65, 54, 0.1);
        }

        .radio label:before,
        .checkbox label:before {
            content: "";
            display: inline-block;
            width: 17px;
            height: 17px;
            position: absolute;
            left: 15px;
            border-radius: 50%;
            background: none;
            border: 3px solid #0074D9;
        }

        input[type="radio"] {
            display: none;
        }

        input[type="radio"]:checked + label:before {
            display: none;
        }

        input[type="radio"]:checked + label {
            padding: 5px 15px;
            background: #0074D9;
            border-radius: 2px;
            color: #fff;
        }

        .checkbox label:before {
            border-radius: 3px;
        }

        .checkbox input[type="checkbox"] {
            display: none;
        }

        .checkbox input[type="checkbox"]:checked + label:before {
            display: none;
        }

        .checkbox input[type="checkbox"]:checked + label {
            background: #0074D9;
            color: #fff;
            padding: 5px 15px;
        }

        .dataTables_filter {
            padding-bottom: 15px;
        }

        .table.dataTable tfoot th, table.dataTable tfoot td {
            border-top: 1px solid #E5E8E8 !important;
        }


    </style>
    <script>
        var busqueda = function (page/*=undefined*/) {
            bloqueointerface();
            var term = $("#searchinput").val().toUpperCase();
            var estado = $('[name="filter_estado"]').val();
            var tipo = $('[name="filter_tipo"]').val();
            page = typeof page == 'undefined' ? 1 : page;
            if (term.length > 0) {
                bloqueointerface();
                location.href = `/adm_asesoramientosee?s=${term}&est=${estado}&t=${tipo}&page=${page}`;
            } else {
                bloqueointerface();
                location.href = `/adm_asesoramientosee?est=${estado}&t=${tipo}&page=${page}`;
            }
        };
        $(function () {
            $("#id_archivoanexo").addClass("validate[required]");
            $("select").select2({minimumResultsForSearch: 5});
            $("#search").click(function () {
                var term = $("#searchinput").val().toUpperCase();
                location.href = "/adm_asesoramientosee?s=" + term;
            });

            $('#searchinput').keyup(function (e) {
                if (e.keyCode == 13) {
                    $("#search").trigger("click");
                }
            });

            $('[name="filter_estado"],  [name="filter_tipo"]').change(function () {
                busqueda();
            });
            $(".action-close", $("#modalClone")).click(function () {
                $("#modalClone").modal('hide');
            });


            $("#action_min").click(function () {
                $("#panel_filter .panel-body").hide();
                $("#action_min").hide();
                $("#action_max").show();
            });
            $("#action_max").click(function () {
                $("#panel_filter .panel-body").show();
                $("#action_min").show();
                $("#action_max").hide();
            });

            {% if not search and not ids and estado == 0 and tipo == 0 %}
                $("#action_min").trigger("click");
            {% else %}
                $("#action_max").trigger("click");
            {% endif %}

            $(".action_page").click(function () {
                var page = $(this).attr('page');
                busqueda(page);
            });

            $(".action_clean").click(function () {
                $('#searchinput').val("");
                busqueda();
            });


            $(document).on('change', '#id_estado', function () {
                let valor = $(this).val()
                $("#id_observacion").addClass("validate[required]");
                $("#id_observacion").attr("disabled", false);

                if (valor == 2) {
                    $("#id_observacion").removeClass("validate[required]");
                    $("#id_observacion").val('');
                    $("#id_observacion").attr("disabled", true);
                }
                if (valor == 3){
                    $("#id_horaculminacion").parent().parent().prop('hidden',false);
                }else{
                    $("#id_horaculminacion").parent().parent().prop('hidden',true);
                }
            });

            $(".btn-cerrarasesoramientosee").click(function () {
                $("#modalasesoramientosee").modal("hide");
                return false;
            });

            $(".btn-guardarasesoramientosee").click(function () {
                bloqueointerface();
                let form = $('#modalasesoramientosee #modal_contenido').find('form');
                let dataform = form.serializeArray()
                console.log(dataform)
                $.post(`{{ request.path }}`, dataform).then(function (data) {
                    if (data.result) {
                        console.log(data)
                        $("#modalasesoramientosee").modal('hide');
                        $.unblockUI()
                        location.href = '{{request.path}}'
                    } else {
                        NotificationJG.error(data.mensaje)
                        $.unblockUI()
                    }
                }).fail(function (error) {
                    NotificationJG.error(error)
                });
                return false;
            });

            $(".cambiarestado").click(function () {
                idv = $(this).attr('idv')
                $("#idb").val(idv);
                bloqueointerface();
                $.ajax({
                    type: "GET",
                    url: "{{request.path}}",
                    data: {
                        'action': 'datos',
                        'id': idv
                    },
                    success: function (data) {
                        $.unblockUI();
                        if (data.result) {
                            $("#modal_contenido").html(data.datos);
                            $("#modalasesoramientosee").modal({backdrop: 'static', width: '950px', height: $(window).height() - 100}).modal('show');
                            $("#id_estado").trigger("click");
                            $("#id_estado").focus();
                        } else {
                            smoke.alert(data.mensaje);
                        }
                    },
                    error: function () {
                        $.unblockUI();
                        smoke.alert("Error de conexión.");
                    },
                    dataType: "json"
                });
                return false;
            });

            /*$('.btn-fancybox').on('click', function() {
                $.fancybox($(this).find('url'));
            });*/
            $(".btn-fancybox").fancybox({
                openEffect: 'elastic',
                closeEffect: 'elastic',
                //modal: true,
                showCloseButton: true,
                hideOnOverlayClick: false,
                hideOnContentClick: false,
                autoSize: true,
                type: 'iframe',
                iframe: {
                    preload: false // fixes issue with iframe and IE
                }
            });
            $("#id_fecha_desde,#id_fecha_hasta").datepicker({format: "dd-mm-yyyy"}).on('changeDate', function (ev) {
                $(this).datepicker('hide');
            });
            $(".reporte_rango_fecha").click(function () {
                $("#id_fecha_desde").val('');
                $("#id_fecha_hasta").val('');
                $("#modal_reporte_asesoramiento").modal({backdrop: 'static', width: '400px'}).modal('show');
            });

            $("#modal_reporte_ejecutar").click(function () {
                bloqueointerface();
                let form = $('#modal_reporte_asesoramiento .modal-body .row-fluid').find('form');
                let dataform = form.serialize()
                console.log(dataform)
                if ($('#id_fecha_desde').val() && $('#id_fecha_hasta').val()) {
                    window.open(`{{ request.path }}?${dataform}`, '_blank');
                    $("#modal_reporte_asesoramiento").modal('hide');
                } else if ($('#id_fecha_desde').val() == '') {
                    NotificationJG.error('Seleccione Fecha Desde')
                } else if ($('#id_fecha_hasta').val() == '') {
                    NotificationJG.error('Seleccione Fecha Hasta')
                } else {
                    NotificationJG.error('Debe Seleccionar 2 Fechas')
                }
                $.unblockUI()

            });

            $("#modal_reporte_close").click(function () {
                $("#modal_reporte_asesoramiento").modal('hide');
            });

            $('.downloadactaasesoramiento').click(function () {
                let asesoramiento = $(this).data('asesoramiento');
                asesoramiento.action = 'downloadactaasesoramiento'
                openwindow('GET', '{{ request.path }}', asesoramiento, '_blank');
            });
            $("#modalsubiranexo_close").click(function () {
                $("#modalsubiranexo").modal("hide");
            });
            $("#modalsubiranexo_guardar").click(function () {
                   bloqueointerface();
                console.log($('#modalsubiranexo_guardar .modal-body').find('form'))
                let formdata = new FormData($("#formsubiranexo")[0]);
                $.ajax({
                        type: "POST",
                        url: "{{ request.path }}",
                        data: formdata,
                        success: function(data) {
                            if (data.result === 'ok' || data.result === true) {
                                location.reload();
                            } else {
                                $.unblockUI();
                                NotificationJG.error(data.mensaje);
                            }
                        },
                        error: function() {
                            $.unblockUI();
                            NotificationJG.error('Error de conexión  con el servidor');
                        },
                        dataType: "json",
                        cache: false,
                        contentType: false,
                        processData: false
                    });
            });
            $('.subiranexoasesoramiento').click(function () {
                let asesoramiento = $(this).data('asesoramiento');
                $('#id_uploadanexo').val(asesoramiento.id);
                $('#modalsubiranexo').modal({backdrop: 'static', width: '400px'}).modal('show');
                {#asesoramiento.action = 'downloadactaasesoramiento'#}
                {#openwindow('GET', '{{ request.path }}', asesoramiento, '_blank');#}
            });

            $(".deleteasesoramientosee").click(function () {
                let asesoramiento = $(this).data('asesoramiento');
                asesoramiento.action = 'delete'
                let question = `Al eliminar el registro no podra volver a recuperar los datos. <br>¿Está seguro de eliminar <span class="label label-warning">${asesoramiento.titulo}</span> - <span class="label label-info"> ${asesoramiento.persona}</span>?`;
                Confirm.question(question, function () {
                    bloqueointerface();
                    $.ajax({
                        type: "POST",
                        url: "/adm_asesoramientosee",
                        data: asesoramiento,
                        success: function (data) {
                            if (data.result == 'ok') {
                                Swal.fire({
                                    title: `NOTIFICACIÓN`,
                                    text: data.mensaje,
                                    type: 'success',
                                    icon: 'success',
                                    showCancelButton: false,
                                    allowOutsideClick: false,
                                    confirmButtonColor: '#3085d6',
                                    cancelButtonColor: '#d33',
                                    confirmButtonText: 'Aceptar',
                                    cancelButtonText: 'Cancelar'
                                }).then((result) => {
                                    if (result.value) {
                                        bloqueointerface();
                                        location.reload();
                                    }
                                }).catch(error => {
                                    Swal.fire({
                                        toast: true,
                                        position: 'top-end',
                                        type: 'error',
                                        title: 'Ocurrio un error inesperado',
                                        showConfirmButton: false,
                                        timer: 6000
                                    });
                                });
                            } else {

                                NotificationJG.error(data.mensaje);
                            }
                            $.unblockUI();
                        },
                        error: function () {
                            $.unblockUI();
                            NotificationJG.error("Error al enviar los datos.");
                        },
                        dataType: "json",
                    });
                }, function () {
                    NotificationJG.info("Enhorabuena el registro esta salvado.!");

                });
            });
        });
        $(document).ready(function () {
            const tabla_paginada = $('.tabla_paginada').DataTable({
                responsive: true,
                ordering: false,
                paging: true,
                searching: true,
                bInfo: true,
                dom: "<<'col-sm-12 col-md-3'f><'col-sm-12 col-md-3'l><'col-sm-12 col-md-12'B>>" +
                    "<<'col-sm-12'tr>>" +
                    "<<'col-md-6 col-sm-12'i><'col-md-4 col-sm-12'p>>",
                buttons: []
            });
            $('.tabla_paginada tbody').on('click', 'tr', function () {
                var data = tabla_paginada.row(this).data();
            });
        });
    </script>
{% endblock %}
{% block canvas %}

    <div class='row-fluid'>
        <div class='span7'>
            <div class='row-fluid'>
                <div class="span12">
                    <h3>{{ title }}</h3>
                </div>
            </div>
            {% if user.username in 'atorrese' %}
            <div class='row-fluid'>
                <div class="span12">
                    <b>IP PRIVADA:</b> {{ ip_privada }} <br>
                    <b>OBJETO IP:</b> {{ objeto_ip }}
                </div>
            </div>
            {% endif %} 
            <div class='row-fluid'>
                <div class='span12'>
                    <div class="btn-group">
                        <a class="btn btn-primary dropdown-toggle" data-toggle="dropdown" href="javascript:;"><i class="fa fa-download" aria-hidden="true"></i>
                            Reportes <span class="caret"></span></a>
                        <ul class="dropdown-menu pull-left" style="width: 300px;">
                            <li>
                                <a href="?export_to_excel=0{% if tipo %}&t={{ tipo }}{% endif %}{% if estado %}&est={{ estado }}{% endif %}{% if search %}&s={{ search }}{% endif %}"><i class="fa fa-file-excel-o" aria-hidden="true"></i> Exportar a Excel
                                    <b>(Listado {{ asesoramientos.count }} Reg.)</b></a>
                                <a href="javascript:;" class="reporte_rango_fecha"><i class="fa fa-file-excel-o" aria-hidden="true"></i> Exportar a Excel Rangos fechas</a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div class='span5'>
            <div class="panel panel-sga" id="panel_filter">
                <div class="panel-heading">
                    <h3 class="panel-title">Filtro</h3>
                    <div class="pull-right btn-group">
                        <a style="margin-right: 5px" href="javascript:;" class='btn btn-mini btn-info tu' id="action_min" title="Minimizar"><span class="fa fa-minus"></span></a>
                        <a style="margin-right: 5px" href="javascript:;" class='btn btn-mini btn-info tu' id="action_max" title="Maximizar"><span class="fa fa-plus"></span></a>
                        {% if search or ids or estado != 0 or tipo != 0 %}
                            <a href="/adm_asesoramientosee?page=1" id='allresults' class='btn btn-mini btn-success tu' title="Todos"><span class="fa fa-refresh"></span></a>
                        {% endif %}
                    </div>
                </div>
                <div class="panel-body">
                    <div class="row-fluid">
                        <div class="span3"><b>Tipos:</b></div>
                        <div class="span9">
                            <select name="filter_tipo" style="width: 100%">
                                <option value="0" selected="selected">----TODOS----</option>
                                {% for t in tipos %}
                                    <option value="{{ t.id }}" {% if tipo == t.id %}selected="selected"{% endif %}>{{ t }}</option>
                                {% endfor %}
                            </select>
                        </div>
                    </div>
                    <div class="row-fluid">
                        <div class="span3"><b>Estado:</b></div>
                        <div class="span9">
                            <select name="filter_estado" style="width: 100%">
                                <option value="0" selected="selected">----TODOS----</option>
                                {% for est in estados %}
                                    <option value="{{ est.0 }}" {% if estado == est.0 %}selected="selected"{% endif %}>{{ est.1 }}</option>
                                {% endfor %}
                            </select>
                        </div>
                    </div>
                    <div class="row-fluid">
                        <div class="span3"><b>Buscar:</b></div>
                        <div class="span9">
                            <form class="form-search" onsubmit="return busqueda()">
                                <div class="row">
                                    <div class="input-group">
                                        <input class='searchinput form-control' type='text' id='searchinput' value='{{ search }}' autocomplete="off" placeholder="POR TITULO O PERSONA"/>
                                        <a href="javascript:;" id='search' class='btn btn-info'><span class="fa fa-search "></span></a>
                                        {% if search %}
                                            <a href="javascript:;" class='btn btn-mini btn-inverse tu action_clean' title="Limpiar"><span class="fa fa-remove"></span></a>
                                        {% endif %}
                                    </div>
                                </div>

                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="row-fluid">
        <div class='span12'>

            <ul class="nav nav-tabs">
                <li class='active'>
                    <a class="tabs " href="#1" data-toggle="tab">
                        <img src="/static/images/iconosmini/categorias.png" width="15px"> Listado
                    </a>
                </li>
                <li>
                    <a class="tabs " href="#2" data-toggle="tab">
                        <img src="/static/images/iconosmini/planpractica.png" width="15px"> Resumen
                    </a>
                </li>
            </ul>
            <div class="tab-content">
                <div class="tab-pane active" id="1">
                    <table class='table table-bordered' cellpadding="0" cellspacing="0">
                        <thead>
                        <tr>
                            <th style="width: 25%; text-align: center">Persona</th>
                            <th style="width: 20%">Titúlo</th>
                            <th style="width: 10%; text-align: center">Tipo Trabajo</th>
                            <th style="width: 30%; text-align: center">Descripción</th>
                            <th style="width: 5%; text-align: center">Estado</th>
                            <th style="width: 10%; text-align: center"></th>
                        </tr>
                        </thead>
                        <tbody>
                        {% for asesoramiento in asesoramientos %}
                            <tr>
                                <td class="text-center">
                                    <i class="fa fa-tag"></i> {{ asesoramiento.persona.nombre_completo }}<br>
                                    <i class="fa fa-address-card"></i> {{ asesoramiento.persona.cedula|default_if_none:" " }}<br>
                                    {{ asesoramiento.persona.emailinst|default_if_none:" " }}
                                    {% if asesoramiento.persona.tiene_discapasidad %}
                                        <a href="javascript:void(0);" class="btn btn-primary btn-mini tr"
                                           title="Discapacidad: {% for dis in asesoramiento.persona.tiene_discapasidad %}{{ dis.tipodiscapacidad.nombre }}{% endfor %}"><i
                                                class="fa fa-wheelchair"></i></a>
                                    {% endif %}
                                    {% if asesoramiento.persona.misvacunascovid %}
                                        <a href="javascript:void(0);" class="btn btn-warning btn-mini tr"
                                           title="Vacunación Covid 19: {% for dis in asesoramiento.persona.misvacunascovid %}{{ dis.tipovacuna.nombre }} DOSIS COMPLETA:{% if dis.recibiovacuna %}SI{% else %}NO{% endif %}{% endfor %}"><i
                                                class="fa fa-syringe"></i></a>
                                    {% endif %}<br>
                                    <i class="fa fa-phone"></i> {{ asesoramiento.persona.telefono }}
                                    {% if asesoramiento.persona.telefono and asesoramiento.persona.telefono %}
                                        <a href='https://web.whatsapp.com/send?l=en&phone=+593{{ asesoramiento.persona.telefono }}&text=Hola {{ asesoramiento.persona }}'
                                           target="_blank" class="btn btn-mini btn-success tu"
                                           title="Enviar mensaje por whatsapp"><i class="fa fa-whatsapp"></i></a>
                                    {% endif %}<br>
                                    {% if asesoramiento.carrera %}
                                        <span class="label label-info"> {{ asesoramiento.carrera }}</span>
                                    {% endif %}

                                    <br>
                                </td>
                                <td>{{ asesoramiento.titulo }}</td>
                                <td style="text-align: center">{{ asesoramiento.tipotrabajo }}</td>
                                <td style="text-align: center">{{ asesoramiento.descripcion }}</td>

                                <td style="text-align: center; vertical-align: middle; padding: 8px;">
                                    <span class="label label-{% if asesoramiento.estado ==  1 %}warning{% elif asesoramiento.estado ==  2 %}success{% elif asesoramiento.estado ==  3 %}info{% else %}important{% endif %}  ">{{ asesoramiento.get_estado_display }}</span>
                                    <br>
                                    {% if asesoramiento.archivoanexo %}
                                        <a class="btn btn-warning btn-mini tu btn-fancybox" style="margin-top: 10px;"
                                           data-fancybox-type="iframe" href="{{ asesoramiento.archivoanexo.url }}"
                                           title="Anexo de Asesoramiento">
                                                            <i class="fa fa-file-pdf-o"></i>
                                        </a>
                                    {% endif %}
                                </td>
                                <td style="text-align: center; vertical-align: middle; padding: 8px;">
                                    {% if asesoramiento.tipotrabajo.tipo == 1 %}
                                        <div class="table-controls">
                                            <div class="btn-group">
                                                <a class="btn btn-mini dropdown-toggle" data-toggle="dropdown" href="javascript:;">Acciones<span class="caret"></span>
                                                </a>
                                                <ul class="dropdown-menu pull-right" style="text-align: left">
                                                    <li>
                                                        <a href="javascript:;" class="cambiarestado" idv="{{ asesoramiento.id }}">
                                                            <i class="fa fa-eject"></i> Cambiar Estado
                                                        </a>
                                                        {% if asesoramiento.estado ==  3 %}
                                                            <a href="javascript:;" class="downloadactaasesoramiento" data-asesoramiento='{"id":"{{ asesoramiento.id }}","persona":"{{ asesoramiento.persona }}","titulo":"{{ asesoramiento.titulo }}"}'>
                                                                <i class="fa fa-file-pdf-o"></i> Acta de Asesoramiento
                                                            </a>
                                                            <a href="javascript:;" class="subiranexoasesoramiento" data-asesoramiento='{"id":"{{ asesoramiento.id }}","persona":"{{ asesoramiento.persona }}","titulo":"{{ asesoramiento.titulo }}"}'>
                                                                <i class="fa fa-upload"></i> Subir Anexo
                                                            </a>
                                                        {% endif %}
                                                        <a href="javascript:;" class="dt-action-delete deleteasesoramientosee" data-asesoramiento='{"id":"{{ asesoramiento.id }}","persona":"{{ asesoramiento.persona }}","titulo":"{{ asesoramiento.titulo }}"}'>
                                                            <i class="fa fa-close"></i> Eliminar
                                                        </a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    {% endif %}
                                </td>
                            </tr>
                        {% empty %}
                            <tr>
                                <td colspan="7">
                                    NO EXISTEN REGISTROS
                                </td>
                            </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                    <div class='row-fluid'>
                        <div class="span12">
                            {% if paging.num_pages > 25 %}
                                <div class='pagination'>
                                    <ul>
                                        {% if paging.primera_pagina %}
                                            <li><a href="javascript:;" class="action_page" page="1">1</a></li>
                                            <li><a href="javascript:;" class="action_page" page="{{ paging.ellipsis_izquierda }}">...</a></li>
                                        {% endif %}
                                        {% for pagenumber in paging.paginas %}
                                            <li {% if pagenumber == page.number %}class="active"{% endif %}><a href="javascript:;" class="action_page" page="{{ pagenumber }}">{{ pagenumber }}</a></li>
                                        {% endfor %}
                                        {% if paging.ultima_pagina %}
                                            <li><a href="javascript:;" page="{{ paging.ellipsis_derecha }}" class="action_page">...</a></li>
                                            <li><a href="javascript:;" page="{{ paging.num_pages }}" class="action_page">{{ paging.num_pages }}</a></li>
                                        {% endif %}
                                    </ul>
                                </div>
                            {% else %}
                                <div class='pagination'>
                                    <ul>
                                        {% for pagenumber in paging.page_range %}
                                            <li {% if pagenumber == page.number %}class="active"{% endif %}><a href="javascript:;" page="{{ pagenumber }}" class="action_page">{{ pagenumber }}</a></li>
                                        {% endfor %}
                                    </ul>
                                </div>
                            {% endif %}
                        </div>
                    </div>
                </div>
                <div class="tab-pane" id="2">
                    <div class="row-fluid">
                        <div class='span6'>
                            <table class="table table-striped table-bordered">
                                <thead>
                                <tr>
                                    <th style="text-align: center"><i class="fa fa-briefcase"></i> Tipos Trabajos</th>
                                    <th style="text-align: center"><i class="fa fa-users"></i> Total</th>
                                </tr>
                                </thead>
                                <tbody>
                                {% for tipo in tipos %}
                                    <tr>
                                        <td style="text-align: center">{{ tipo }}</td>
                                        <td style="text-align: center">{{ tipo |args:periodo|call:"total_general_solicitudes" }}</td>
                                    </tr>
                                {% empty %}
                                    <tr>
                                        <td colspan="2" style="text-align: center">
                                            <i class="fa fa-info-circle"></i> SIN REGISTROS
                                        </td>
                                    </tr>
                                {% endfor %}
                                </tbody>
                            </table>
                        </div>
                        <div class='span6'>
                            <table class="table table-striped table-bordered">
                                <thead>
                                <tr>
                                    <th style="text-align: center"><i class="fa fa-tag"></i> Estado</th>
                                    <th style="text-align: center"><i class="fa fa-users"></i> Total</th>
                                </tr>
                                </thead>
                                <tbody>
                                <tr>
                                    <td style="text-align: center"><i class="fa fa-circle" style="color: #F4D03F; font-size: 18px"></i> Solicitados</td>
                                    <td style="text-align: center">{{ totalsolicitados }}</td>
                                </tr>
                                <tr>
                                    <td style="text-align: center"><i class="fa fa-circle" style="color: #2ECC71; font-size: 18px"></i> Aprobados</td>
                                    <td style="text-align: center">{{ totalaprobados }}</td>
                                </tr>

                                <tr>
                                    <td style="text-align: center"><i class="fa fa-circle" style="color: #E74C3C; font-size: 18px"></i> Rechazados</td>
                                    <td style="text-align: center">{{ totalrechazados }}</td>
                                </tr>
                                <tr>
                                    <td style="text-align: center"><i class="fa fa-circle" style="color: #3a87ad; font-size: 18px"></i> Finalizados</td>
                                    <td style="text-align: center">{{ totalanulados }}</td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div class="row-fluid">
                        <div class="span12">
                            <table class="table table-bordered table-striped tabla_paginada">
                                <thead>
                                <tr>
                                    <th style="text-align: center"><i class="fa fa-book"></i> Carrera</th>
                                    <th style="text-align: center"><i class="fa fa-users"></i> Total General</th>
                                    <th style="text-align: center"><i class="fa fa-circle" style="color: #F4D03F; font-size: 18px"></i>Total Solicitados</th>
                                    <th style="text-align: center"><i class="fa fa-circle" style="color: #2ECC71; font-size: 18px"></i> Total Aprobados</th>
                                    <th style="text-align: center"><i class="fa fa-circle" style="color: #E74C3C; font-size: 18px"></i> Total Rechazados</th>
                                    <th style="text-align: center"><i class="fa fa-circle" style="color: #3a87ad; font-size: 18px"></i> Total Finalizados</th>
                                </tr>
                                </thead>
                                <tbody>
                                {% for car in asesocarreras %}
                                    <tr>
                                        <td style="text-align: center">{{ car }}</td>
                                        <td style="text-align: center">{{ car |args:periodo|call:"total_asesoramientosee__general" }}</td>
                                        <td style="text-align: center">{{ car |args:1|args:periodo|call:"total_asesoramientosee__estado" }}</td>
                                        <td style="text-align: center">{{ car |args:2|args:periodo|call:"total_asesoramientosee__estado" }}</td>
                                        <td style="text-align: center">{{ car |args:4|args:periodo|call:"total_asesoramientosee__estado" }}</td>
                                        <td style="text-align: center">{{ car |args:3|args:periodo|call:"total_asesoramientosee__estado" }}</td>
                                    </tr>
                                {% empty %}
                                    <tr>
                                        <td colspan="10" style="text-align: center">
                                            <i class="fa fa-info-circle"></i> SIN REGISTROS
                                        </td>
                                    </tr>
                                {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <div class="modal fade static" id="modalasesoramientosee" style="display: none;">
        <div class="modal-header">
            <table border="0" width="100%" style="background-color: transparent;">
                <tr>
                    <td style="width: 80%"><h4 class="paneltitlearchivo">Solicitud Asesoramiento de Servicios de Estudios Estadísticos</h4></td>
                </tr>
            </table>
        </div>
        <div class="modal-body" id="modal_contenido">
        </div>
        <div class="modal-footer">
            <td id="asesoramientoseeguardar"><a href="javascript:;" class="btn btn-guardarasesoramientosee btn-success"> Guardar</a></td>
            <a href="javascript:;" class="btn btn-cerrarasesoramientosee btn-danger">Cerrar</a>
        </div>
    </div>
    <div class="modal fade static modal-sm" id="modal_reporte_asesoramiento" style="display: none; width: 400px!important;" role="dialog">
        <div class="modal-header">
            <h4>Reporte de Asesoramientos.</h4>
        </div>
        <div class="modal-body">
            <div class="row-fluid">
                <form>
                    <input type="hidden" name="action" value="excel_rango_fecha">
                    <fieldset id="fieldset_id_fecha_desde" class="control-group nomargins" style="float: left; padding-right: 10px; width:50%">
                        <label class="control-label" for="id_fecha_desde">Fecha desde:</label>
                        <div class="controls">
                            <input class="selectorfecha" name="fechainicio" formwidth="50%" id="id_fecha_desde" style="width:100%" type="text" value="">
                            <p class="help-text"></p>
                        </div>
                    </fieldset>
                    <fieldset id="fieldset_id_fecha_hasta" class="control-group nomargins" style="float: left; padding-right: 10px; width:50%">
                        <label class="control-label" for="id_fecha_hasta">Fecha hasta:</label>
                        <div class="controls">
                            <input class="selectorfecha" name="fechafin" formwidth="50%" id="id_fecha_hasta" style="width:100%" type="text" value="">
                            <p class="help-text"></p>
                        </div>
                    </fieldset>
                </form>
            </div>
        </div>
        <div class="modal-footer">
            <a id="modal_reporte_ejecutar" class="btn btn-success">Ejecutar</a>
            <a id="modal_reporte_close" class="btn btn-danger">Cerrar</a>
        </div>
    </div>
    <div class="modal fade static modal-sm" id="modalsubiranexo" style="display: none; width: 400px!important;" role="dialog">
        <div class="modal-header">
            <h4>Subir anexo</h4>
        </div>
        <div class="modal-body">
            <form action="javascript:;" id="formsubiranexo" enctype="multipart/form-data">
                <input type="hidden" name="action" value="uploadanexo">
                <input type="hidden" name="id"  id="id_uploadanexo" >
                <div class="row-fluid">
                    {% for field in formanexo %}
                        {% if field.field.widget.attrs.separator %}
                            <div style="width: 100%; height: 1px; float: left;"></div>
                        {% endif %}
                        <fieldset class="control-group nomargins" style="float: left;padding-right: 10px; width: {% if field.field.widget.attrs.formwidth %}{{ field.field.widget.attrs.formwidth }}{% else %}100%{% endif %}">
                            <label class="control-label" for="id_{{ field.name }}">{{ field.label }}</label>
                            <div class="controls">
                                {% if field.field.widget.attrs.select2search %}
                                    <select id="id_{{ field.name }}_select2" {% if field.field.widget.attrs.disabled %}disabled=""{% endif %}>
                                        <option value="0" selected="selected">---------</option>
                                    </select>
                                    <input name="{{ field.name }}" id="id_{{ field.name }}" value="{{ field.value }}" hidden="hidden" {% if field.field.widget.attrs.descripcion %}descripcion="{{ field.field.widget.attrs.descripcion }}"{% endif %} class="select2hidden">
                                {% else %}
                                    {{ field }}
                                {% endif %}
                                <p class="help-text">{{ field.help_text }} </p>
                            </div>
                        </fieldset>
                    {% endfor %}
                </div>
            </form>
        </div>
        <div class="modal-footer">
            <a id="modalsubiranexo_guardar" class="btn btn-success">Guardar</a>
            <a id="modalsubiranexo_close" class="btn btn-danger">Cerrar</a>
        </div>
    </div>

{% endblock %}
