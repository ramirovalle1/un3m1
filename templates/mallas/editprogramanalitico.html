{% extends "ajaxformbs.html" %}
{% load sga_extras %}
{% block form-type %}form-vertical{% endblock %}
{% block extraheading %}
    <script type="text/javascript">
        $(function () {
            $("#id_descripcion").css({'text-transform': 'none'});
            $("#id_compromisos").css({'text-transform': 'none'});
            $("#id_caracterinvestigacion").css({'text-transform': 'none'});
            $("#id_detallerai").css({'text-transform': 'none'});
            $("#id_detallerac").css({'text-transform': 'none'});
            $("#id_objetivos").css({'text-transform': 'none'});
            $("#id_metodologia").css({'text-transform': 'none'});
            $("#id_resultado").css({'text-transform': 'none'});
            $("#id_unidades").css({'text-transform': 'none'});
            $("#id_temas").css({'text-transform': 'none'});
            $("#id_subtemas").css({'text-transform': 'none'});
            $("#id_unidadesedit").css({'text-transform': 'none'});
            $("#id_resultadoedit").css({'text-transform': 'none'});
            $("#id_temasedit").css({'text-transform': 'none'});
            $("#id_subtemasedit").css({'text-transform': 'none'});
            $("#id_ordenresultado").change(function(){
                numerico($(this), 0, 100, 0);
            });
            $("#id_ordenresultadoedit").change(function(){
                numerico($(this), 0, 100, 0);
            });
            $("#adicionarresultado").click(function() {
                $("#id_resultado").val('');
                $("#id_ordenresultado").val(0);
                $("#alertaingresresultado").hide();
                $("#itemspanelresultado .incompletoresultado").hide();
                $("#itemspanelresultado .incompletovaloresresultado").hide();
                $("#adicionarycerrarresultado").show();
                $("#guardar").hide();
                $("#itemspanelresultado").modal({backdrop:'static', width: '400px'}).modal('show');
                return false;
            });

            editresultados = function(codigoresultado) {
                var numorden=0
                $.ajax({
                    type: "POST",
                    url: "/mallas",
                    data: {'action': 'conresultadoprogramanalitico', 'id': codigoresultado},
                    error: function () {
                        $.unblockUI();
                        smoke.alert("Error al obtener los datos.");
                    },
                    success: function (data) {
                        $.unblockUI();
                        if (data.result == "ok") {
                            $("#id_ordenresultadoedit").val(data.orden)
                            $("#id_resultadoedit").val(data.nombre);
                            tooltips();
                            {#                            conectar_controleslib();#}
                        } else {
                            smoke.alert(data.mensaje);
                            $("#id_ordenresultadoedit").val(0)
                            $("#id_resultadoedit").val('');
                        }
                    }
                });
                $("#idresuledit").val('');
                $("#idresuledit").val(codigoresultado);
                $("#alertaingresresultadoedit").hide();
                $("#itemspanelresultadoedit .incompletoresultadoedit").hide();
                $("#itemspanelresultadoedit .incompletovaloresresultadoedit").hide();
                $("#adicionarycerrarresultadoedit").show();
                $("#guardar").hide();
                $("#itemspanelresultadoedit").modal({backdrop:'static', width: '400px'}).modal('show');
                return false;
            }

            $("#adicionarycerrarresultado").click(function() {
                adicionar_resultado()
            });
            $("#adicionarycerrarresultadoedit").click(function() {
                editar_resultado()
            });
            $("#cerrarresultado").click(function() {
                $("#itemspanelresultado .incompletoresultado").hide();
                $("#itemspanelresultado .incompletovaloresresultado").hide();
                $("#itemspanelresultado").modal("hide");
            });
            $("#cerrarresultadoedit").click(function() {
                $("#itemspanelresultadoedit .incompletoresultadoedit").hide();
                $("#itemspanelresultadoedit .incompletovaloresresultadoedit").hide();
                $("#itemspanelresultadoedit").modal("hide");
            });
            adicionar_resultado = function(ocultar) {
                var descripcion = $("#id_resultado").val();
                var ordenresultado = $("#id_ordenresultado").val();
                if (descripcion == '' || ordenresultado == ''){$("#itemspanelresultado .incompletoresultado").show();return false;}
                $("#itemspanelresultado").modal("hide");
                bloqueointerface();
                $.ajax({
                    type: "POST",
                    url: "/mallas",
                    data: {'action': 'addresultadoprogramanalitico', 'descripcion': descripcion, 'ordenresultado': ordenresultado, 'programanalitico': {{ programanalitico.id }}},
                    error: function () {
                        $.unblockUI();
                        smoke.alert("Error al obtener los datos.");
                    },
                    success: function (data) {
                        $.unblockUI();
                        if (data.result == "ok") {
                            $("#idcabecera").append('<li id="codresultado'+ data.idresultado +'" class="parent_li">' +
                                '<a href="javascript:;" class="btn btn-tini btn-info edittema tu" id="edittemasedit'+ data.idresultado +'" onclick="editresultados('+ data.idresultado +')"  title="Editar Resultado"><i class="fa fa-edit"></i></a>&nbsp;' +
                                '<a href="javascript:;" id="adicionarunidades'+ data.idresultado +'" onclick="unidades('+ data.idresultado +')" class="btn btn-success btn-tini tu" title="Adicionar Unidad"><i class="fa fa-plus"></i></a> ' +
                                '<a href="javascript:;" class="btn btn-tini btn-danger delresultado tu" iddelresultado="'+ data.idresultado +'"  title="Eliminar Resultado Aprendizaje"><i class="fa fa-remove"></i></a>' +
                                '<span><i class="fa fa-folder-open fa fa-minus-sign"></i> <a id="nomresultado'+ data.idresultado +'">RESULTADO DE APRENDIZAJE '+ordenresultado + ': '+descripcion+' </a></span> </li>');
                            tooltips();
                            conectar_controlesresultado();
                        } else {
                            smoke.alert(data.mensaje);
                        }
                    }
                });
            };
            editar_resultado = function(ocultar) {
                var idresuledit = $("#idresuledit").val();
                var descripcion = $("#id_resultadoedit").val();
                var ordenresultadoedit = $("#id_ordenresultadoedit").val();
                if (descripcion == '' || ordenresultadoedit == ''){$("#itemspanelresultadoedit .incompletoresultadoedit").show();return false;}
                $("#itemspanelresultadoedit").modal("hide");
                bloqueointerface();
                $.ajax({
                    type: "POST",
                    url: "/mallas",
                    data: {'action': 'editresultadoprogramanalitico', 'descripcion': descripcion, 'ordenresultadoedit': ordenresultadoedit, 'idresuledit': idresuledit},
                    error: function () {
                        $.unblockUI();
                        smoke.alert("Error al obtener los datos.");
                    },
                    success: function (data) {
                        $.unblockUI();
                        if (data.result == "ok") {
                            $("#nomresultado"+idresuledit).html('RESULTADO DE APRENDIZAJE '+ordenresultadoedit+': '+descripcion)
                        } else {
                            smoke.alert(data.mensaje);
                        }
                    }
                });
            };
            conectar_controlesresultado = function () {
                $(".delresultado").unbind();
                $(".delresultado").click(function () {
                    $('#selectdeleteresultado').modal({'width': 800}).modal('show');
                    bloqueointerface();
                    $.ajax({
                        type: "POST",
                        url: "/mallas",
                        data: {'action': 'listadelprogramanaliticoresultado', 'id': $(this).attr('iddelresultado') },
                        error: function () {
                            $.unblockUI();
                            smoke.alert("Error al obtener los datos.");
                        },
                        success: function (data) {
                            $.unblockUI();
                            if (data.result == "ok") {
                                $('#leyendaresultado').html(data.descripcion);
                                $('#codigoresultado').val(data.codigoresultado);
                                $('#selectdeleteresultado').modal({'width': 800}).modal('show');
                            } else {
                                smoke.alert(data.mensaje);
                            }
                        }
                    });
                });
            };
            $(".delresultado").click(function () {
                $('#selectdeleteresultado').modal({'width': 800}).modal('show');
                bloqueointerface();
                $.ajax({
                    type: "POST",
                    url: "/mallas",
                    data: {'action': 'listadelprogramanaliticoresultado', 'id': $(this).attr('iddelresultado') },
                    error: function () {
                        $.unblockUI();
                        smoke.alert("Error al obtener los datos.");
                    },
                    success: function (data) {
                        $.unblockUI();
                        if (data.result == "ok") {
                            $('#leyendaresultado').html(data.descripcion)
                            $('#codigoresultado').val(data.codigoresultado)
                            $('#selectdeleteresultado').modal({'width': 800}).modal('show');
                        } else {
                            smoke.alert(data.mensaje);
                        }
                    }
                });
            });
            $("#eliminacionmodal_cancelresultado").click(function(){
                $('#selectdeleteresultado').modal('hide');
            });
            $("#eliminacionmodal_formbuttonresultado").click(function(){
                $('#selectdeleteresultado').modal('hide');
                var filaresultado = ''
                filaresultado = 'codresultado'+ $('#codigoresultado').val()
                $.ajax({
                    type: "POST",
                    url: "/mallas",
                    data: {'action': 'eliminarprogramanaliticoresultado', 'codigoresultado': $('#codigoresultado').val()},
                    error: function () {
                        $.unblockUI();
                        smoke.alert("Error al obtener los datos.");
                    },
                    success: function (data) {
                        $.unblockUI();
                        if (data.result == "ok") {
                            $('#'+filaresultado).remove();
                        } else {
                            smoke.alert(data.mensaje);
                        }
                    }
                });
            });
            /**********************UNIDADES*/
            $("#id_ordenunidades").change(function(){
                numerico($(this), 0, 100, 0);
            });
            $("#id_ordenunidadesedit").change(function(){
                numerico($(this), 0, 100, 0);
            });
            unidades = function(codigoresultado) {
                $("#id_unidades").val('');
                $("#id_ordenunidades").val(0);
                $("#iduni").val('');
                $("#iduni").val(codigoresultado);
                $("#alertaingresunidades").hide();
                $("#itemspanelunidades .incompletounidades").hide();
                $("#itemspanelunidades .incompletovaloresunidades").hide();
                $("#adicionarycerrarunidades").show();
                $("#guardar").hide();
                $("#itemspanelunidades").modal({backdrop:'static', width: '400px'}).modal('show');
                console.log(codigoresultado)
                // Realizar una solicitud AJAX para obtener los contenidos mínimos actualizados
                $.ajax({
                    type: 'GET',
                    url: '/mallas',
                    data: {'action': 'cargarselectcontenidosminimos', 'id': codigoresultado},// Ajusta esta URL a la ruta correcta de tu vista
                    success: function(data) {
                        if (data.contenidos_minimos) {
                            // Actualizar el select múltiple con todos los contenidos
                            var select = $('#id_contminimo');
                            select.empty();  // Vaciar el select existente para evitar duplicados

                            // Añadir las opciones al select
                            data.contenidos_minimos.forEach(function(contenido) {
                                var option = new Option(contenido.descripcioncontenido, contenido.id);
                                select.append(option);
                            });

                            // Si estás usando una biblioteca como Select2, asegúrate de actualizarla
                            select.trigger('change');

                            // Mostrar el modal para adicionar unidades después de actualizar el select
                            $("#itemspanelunidades").modal({backdrop:'static', width: '400px'}).modal('show');
                        } else {
                            smoke.alert('No se pudieron cargar los contenidos mínimos.');
                        }
                    },
                    error: function(xhr, status, error) {
                        smoke.alert('Hubo un error al obtener los contenidos mínimos: ' + error);
                    }
                });
                return false;
            }
            editunidades = function(codigoresultado) {
                $.ajax({
                    type: "POST",
                    url: "/mallas",  // Asegúrate de ajustar esta URL a la ruta correcta de tu vista
                    data: {'action': 'conunidadesprogramanalitico', 'id': codigoresultado},
                    error: function () {
                        $.unblockUI();
                        smoke.alert("Error al obtener los datos.");
                    },
                    success: function (data) {
                        $.unblockUI();
                        if (data.result === "ok") {
                            // Actualizar campos de la unidad
                            $("#id_ordenunidadesedit").val(data.orden);
                            $("#id_unidadesedit").val(data.nombre);
                            $("#id_resultadoaprendizaje").val(data.id_resultadoaprendizaje);

                            // Actualizar el select múltiple con todos los contenidos
                            var select = $("#id_contminimoedit");
                            select.empty();  // Vaciar el select existente para evitar duplicados

                            data.todos_contenidos.forEach(function(contenido) {
                                var option = new Option(contenido.descripcioncontenido, contenido.id);
                                select.append(option);
                            });

                            // Seleccionar los contenidos mínimos que están seleccionados
                            select.val(data.contenidos_minimos);

                            // Si estás usando una biblioteca como Select2, asegúrate de actualizarla
                            $("#id_resultadoaprendizaje").trigger("change");
                            select.trigger("change");

                            tooltips();  // Re-aplicar tooltips si es necesario
                        } else {
                            // Manejar el caso de error
                            $("#id_ordenunidadesedit").val(0);
                            $("#id_unidadesedit").val('');
                            $("#id_contminimoedit").val(null);
                            smoke.alert(data.mensaje);
                        }
                    }
                });

                $("#iduniedit").val('');
                $("#iduniedit").val(codigoresultado);
                $("#alertaingresunidadesedit").hide();
                $("#itemspanelunidadesedit .incompletounidadesedit").hide();
                $("#itemspanelunidadesedit .incompletovaloresunidadesedit").hide();
                $("#adicionarycerrarunidadesedit").show();
                $("#guardar").hide();
                $("#itemspanelunidadesedit").modal({backdrop:'static', width: '600px'}).modal('show');
                return false;
            };

            $("#adicionarycerrarunidades").click(function() {
                adicionar_unidades()
            });
            $("#adicionarycerrarunidadesedit").click(function() {
                editar_unidades()
            });
            $("#cerrarunidades").click(function() {
                $("#itemspanelunidades .incompletounidades").hide();
                $("#itemspanelunidades .incompletovalounidades").hide();
                $("#id_contminimo").find('option').prop("selected", false);
                $("#id_contminimo").trigger('change');
                $("#itemspanelunidades").modal("hide");
            });
            $("#cerrarunidadesedit").click(function() {
                $("#itemspanelunidadesedit .incompletounidadesedit").hide();
                $("#itemspanelunidadesedit .incompletovalounidadesedit").hide();
                $("#id_contminimoedit").find('option').prop("selected", false);
                $("#id_contminimoedit").trigger('change');
                $("#itemspanelunidadesedit").modal("hide");
            });
            adicionar_unidades = function(ocultar) {
                var idunid = $("#iduni").val();
                var descripcion = $("#id_unidades").val();
                var ordenunidades = $("#id_ordenunidades").val();
                var contmin = JSON.stringify($('[name="contminimo"]').val());
                if (descripcion == '' || ordenunidades == 0 || contmin == 'null'){$("#itemspanelunidades .incompletounidades").show();return false;}
                {#if (descripcion == '' || ordenunidades == 0){$("#itemspanelunidades .incompletounidades").show();return false;}#}
                $("#itemspanelunidades").modal("hide");
                bloqueointerface();
                $.ajax({
                    type: "POST",
                    url: "/mallas",
                    {#data: {'action': 'addunidadesprogramanalitico', 'descripcion': descripcion, 'ordenunidades': ordenunidades, 'idunid': idunid},#}
                    data: {'action': 'addunidadesprogramanalitico', 'descripcion': descripcion, 'ordenunidades': ordenunidades, 'idunid': idunid, 'contmin':contmin},
                    error: function () {
                        $.unblockUI();
                        smoke.alert("Error al obtener los datos.");
                    },
                    success: function (data) {
                        $.unblockUI();
                        if (data.result == "ok") {
                            {#                            <ul id="idunidades{{ conte.id }}">#}
                            if (($("#idunidades"+idunid).length)> 0) {
                                $("#idunidades"+idunid).append('<li class="parent_li" id="eliminarunidad'+data.idunidades+'"><a href="javascript:;" class="btn btn-tini btn-info edittema tu" id="adicionartemasedit'+data.idunidades+'" onclick="editunidades('+data.idunidades+')"  title="Editar Unidad"><i class="fa fa-edit"></i></a> ' +
                                    '<a href="javascript:;" id="adicionartemas'+data.idunidades+'" onclick="temas('+data.idunidades+')" class="btn btn-success btn-tini tu" title="Adicionar Tema"><i class="fa fa-plus"></i></a> ' +
                                    '<a href="javascript:;" class="btn btn-tini btn-danger delunidad tu" iddeluni="'+data.idunidades+'" title="Eliminar Unidad"><i class="fa fa-remove"></i></a>' +
                                    '<span title="Contraer"><i class="fa fa-minus-sign"></i> <a id="nomunidad'+data.idunidades+'">UNIDAD '+ordenunidades+': '+descripcion+'</a> </span> <ul id="idtemas'+data.idunidades+'"></ul></li>');
                            }else
                            {
                                $("#codresultado"+idunid).append('<ul id="idunidades'+idunid+'"><li class="parent_li" id="eliminarunidad'+data.idunidades+'"><a href="javascript:;" class="btn btn-tini btn-info edittema tu" id="adicionartemasedit'+data.idunidades+'" onclick="editunidades('+data.idunidades+')"  title="Editar Unidad"><i class="fa fa-edit"></i></a> ' +
                                    '<a href="javascript:;" id="adicionartemas'+data.idunidades+'" onclick="temas('+data.idunidades+')" class="btn btn-success btn-tini tu" title="Adicionar Tema"><i class="fa fa-plus"></i></a> ' +
                                    '<a href="javascript:;" class="btn btn-tini btn-danger delunidad tu" iddeluni="'+data.idunidades+'" title="Eliminar Unidad"><i class="fa fa-remove"></i></a>' +
                                    '<span title="Contraer"><i class="fa fa-minus-sign"></i> <a id="nomunidad'+data.idunidades+'">UNIDAD '+ordenunidades+': '+descripcion+'</a></span><ul id="idtemas'+data.idunidades+'"></ul></li></ul>');

                            }
                            tooltips();
                            conectar_controlesunidad();
                            location.reload();
                        } else {
                            smoke.alert(data.mensaje);
                        }
                    }
                });
            };
            conectar_controlesunidad = function () {
                $(".delunidad").unbind();
                $(".delunidad").click(function () {
                    $('#selectdeleteunidad').modal({'width': 800}).modal('show');
                    bloqueointerface();
                    $.ajax({
                        type: "POST",
                        url: "/mallas",
                        data: {'action': 'listadelprogramanaliticounidad', 'id': $(this).attr('iddeluni') },
                        error: function () {
                            $.unblockUI();
                            smoke.alert("Error al obtener los datos.");
                        },
                        success: function (data) {
                            $.unblockUI();
                            if (data.result == "ok") {
                                $('#leyendaunidad').html(data.descripcion)
                                $('#codigounidad').val(data.codigounidad)
                                $('#selectdeleteunidad').modal({'width': 800}).modal('show');
                            } else {
                                smoke.alert(data.mensaje);
                            }
                        }
                    });
                });
            };

            editar_unidades = function(ocultar) {
                var idunid = $("#iduniedit").val();
                var descripcion = $("#id_unidadesedit").val();
                var ordenunidadesedit = $("#id_ordenunidadesedit").val();
                var id_resultadoaprendizaje = $("#id_resultadoaprendizaje").val();
                var contminedit = JSON.stringify($('[name="contminimoedit"]').val());
                if (descripcion == '' || ordenunidadesedit == 0 || contminedit == 'null'){$("#itemspanelunidadesedit .incompletounidadesedit").show();return false;}
                {#if (descripcion == '' || ordenunidadesedit == ''){$("#itemspanelunidadesedit .incompletounidadesedit").show();return false;}#}
                $("#itemspanelunidadesedit").modal("hide");
                bloqueointerface();
                $.ajax({
                    type: "POST",
                    url: "/mallas",
                    {#data: {'action': 'editunidadesprogramanalitico', 'descripcion': descripcion,'ordenunidadesedit': ordenunidadesedit, 'idunid': idunid, 'id_resultadoaprendizaje':id_resultadoaprendizaje},#}
                    data: {'action': 'editunidadesprogramanalitico', 'descripcion': descripcion,'ordenunidadesedit': ordenunidadesedit, 'idunid': idunid, 'id_resultadoaprendizaje':id_resultadoaprendizaje, 'contmin':contminedit},
                    error: function () {
                        $.unblockUI();
                        smoke.alert("Error al obtener los datos.");
                    },
                    success: function (data) {
                        $.unblockUI();
                        if (data.result == "ok") {
                            $("#nomunidad"+idunid).html('UNIDAD '+ordenunidadesedit+': '+descripcion);
                            location.reload();
                            tooltips();
                            {#                            conectar_controleslib();#}
                        } else {
                            smoke.alert(data.mensaje);
                        }
                    }
                });
            };

            /**********************TEMAS*/
            $("#id_ordentemas").change(function(){
                numerico($(this), 0, 100, 0);
            });
            $("#id_ordentemasedit").change(function(){
                numerico($(this), 0, 100, 0);
            });
            temas = function(codigotema) {
                $("#id_temas").val('');
                $("#id_ordentemas").val(0);
                $("#idtem").val('');
                $("#idtem").val(codigotema);
                $("#alertaingrestemas").hide();
                $("#itemspaneltemas .incompletotemas").hide();
                $("#itemspaneltemas .incompletovalorestemas").hide();
                $("#adicionarycerrartemas").show();
                $("#guardar").hide();
                $("#itemspaneltemas").modal({backdrop:'static', width: '400px'}).modal('show');
                return false;
            }
            edittemas = function(codigotema) {
                var unidadselec = '';
                $('#codigounidades').empty().append('<option value="">---------</option>').val(0).trigger("change");
                $.ajax({
                    type: "POST",
                    url: "/mallas",
                    data: {'action': 'contemasprogramanalitico', 'id': codigotema},
                    error: function () {
                        $.unblockUI();
                        smoke.alert("Error al obtener los datos.");
                    },
                    success: function (data) {
                        $.unblockUI();
                        if (data.result == "ok") {
                            $("#id_temasedit").val(data.nombre);
                            $("#id_ordentemasedit").val(data.orden)
                            unidadselec = data.unidadselec
                            for (elemento in data.lista) {
                                $('#codigounidades').append('<option value="' + data.lista[elemento][0] + '">' + data.lista[elemento][1] + '</option>');
                            }
                            $("#codigounidades").val(unidadselec).change();


                            tooltips();
                            {#                            conectar_controleslib();#}
                        } else {
                            $("#id_temasedit").val('');
                            $("#id_ordentemasedit").val(0)
                            smoke.alert(data.mensaje);
                        }
                    }
                });
                $("#idtemedit").val('');
                $("#idtemedit").val(codigotema);
                $("#alertaingrestemasedit").hide();
                $("#itemspaneltemasedit .incompletotemasedit").hide();
                $("#itemspaneltemasedit .incompletovalorestemasedit").hide();
                $("#adicionarycerrartemasedit").show();
                $("#guardar").hide();
                $("#itemspaneltemasedit").modal({backdrop:'static', width: '400px'}).modal('show');
                return false;
            }
            $("#adicionarycerrartemas").click(function() {
                adicionar_temas()
            });
            $("#adicionarycerrartemasedit").click(function() {
                editar_temas()
            });
            $("#cerrartemas").click(function() {
                $("#itemspaneltemas .incompletotemas").hide();
                $("#itemspaneltemas .incompletovalotemas").hide();
                $("#itemspaneltemas").modal("hide");
            });
            $("#cerrartemasedit").click(function() {
                $("#itemspaneltemasedit .incompletotemasedit").hide();
                $("#itemspaneltemasedit .incompletovalotemasedit").hide();
                $("#itemspaneltemasedit").modal("hide");
            });
            adicionar_temas = function(ocultar) {
                var idtem = $("#idtem").val();
                var descripcion = $("#id_temas").val();
                var ordentemas = $("#id_ordentemas").val();
                if (descripcion == ''  || ordentemas == ''){$("#itemspaneltemas .incompletotemas").show();return false;}
                $("#itemspaneltemas").modal("hide");
                bloqueointerface();
                $.ajax({
                    type: "POST",
                    url: "/mallas",
                    data: {'action': 'addtemasprogramanalitico', 'descripcion': descripcion, 'ordentemas':ordentemas, 'idtem': idtem},
                    error: function () {
                        $.unblockUI();
                        smoke.alert("Error al obtener los datos.");
                    },
                    success: function (data) {
                        $.unblockUI();
                        if (data.result == "ok") {
                            if (($("#idtemas"+idtem).length)> 0) {
                                $("#idtemas"+idtem).append('<li id="eliminartema'+data.idtemas+'" class="parent_li"><a href="javascript:;" id="adicionarsubtemas'+data.idtemas+'" onclick="subtemas('+data.idtemas+')" class="btn btn-success btn-tini tu" title="Adicionar SubTema"><i class="fa fa-plus"></i></a> ' +
                                    '<a href="javascript:;" class="btn btn-tini btn-info edittema tu" id="adicionartemasedit'+data.idtemas+'" onclick="edittemas('+data.idtemas+')"  title="Editar Tema"><i class="fa fa-edit"></i></a> ' +
                                    '<a href="javascript:;" class="btn btn-tini btn-danger deltema tu" idt="'+data.idtemas+'" title="Eliminar Tema"><i class="fa fa-remove"></i></a> ' +
                                    '<span title="Contraer"><i class="fa fa-minus-sign"></i><a id="nomtema'+data.idtemas+'">TEMA '+ordentemas+': '+ descripcion +'</a></span><ul id="idsubtemas'+data.idtemas+'"></ul></li>');
                            }
                            tooltips();
                            conectar_controlestemas();
                        } else {
                            smoke.alert(data.mensaje);
                        }
                    }
                });
            };
            editar_temas = function(ocultar) {
                var idtemedit = $("#idtemedit").val();
                var codigounidades = $("#codigounidades").val();
                var descripcion = $("#id_temasedit").val();
                var ordentemasedit = $("#id_ordentemasedit").val();
                if (descripcion == '' || ordentemasedit == ''|| codigounidades == ''){$("#itemspaneltemasedit .incompletotemasedit").show();return false;}
                $("#itemspaneltemasedit").modal("hide");
                bloqueointerface();
                $.ajax({
                    type: "POST",
                    url: "/mallas",
                    data: {'action': 'edittemasprogramanalitico', 'descripcion': descripcion, 'ordentemasedit': ordentemasedit,'idtemedit': idtemedit,'codigounidades': codigounidades},
                    error: function () {
                        $.unblockUI();
                        smoke.alert("Error al obtener los datos.");
                    },
                    success: function (data) {
                        //$.unblockUI();
                        if (data.result == "ok") {
                            //bloqueointerface();
                            location.reload();
                            $("#nomtema"+idtemedit).html('TEMA '+ordentemasedit+': '+descripcion)
                            tooltips();
                            {#                            conectar_controlestemas();#}
                        } else {
                            smoke.alert(data.mensaje);
                        }
                    }
                });
            };
            conectar_controlestemas = function () {
                $(".deltema").unbind();
                $(".deltema").click(function () {
                    $('#selectdeletetema').modal({'width': 800}).modal('show');
                    bloqueointerface();
                    $.ajax({
                        type: "POST",
                        url: "/mallas",
                        data: {'action': 'listadelprogramanaliticotemas', 'id': $(this).attr('idt') },
                        error: function () {
                            $.unblockUI();
                            smoke.alert("Error al obtener los datos.");
                        },
                        success: function (data) {
                            $.unblockUI();
                            if (data.result == "ok") {
                                $('#leyendatema').html(data.descripcion)
                                $('#codigotema').val(data.codigotema)
                                $('#selectdeletetema').modal({'width': 800}).modal('show');
                            } else {
                                smoke.alert(data.mensaje);
                            }
                        }
                    });
                });
            };

            /**********************SUBTEMAS*/
            $("#id_ordensubtemas").change(function(){
                numerico($(this), 0, 100, 0);
            });
            $("#id_ordensubtemasedit").change(function(){
                numerico($(this), 0, 100, 0);
            });
            subtemas = function(codigotema) {
                $("#id_subtemas").val('');
                $("#id_ordensubtemas").val(0);
                $("#idsubtem").val('');
                $("#idsubtem").val(codigotema);
                $("#alertaingressubtemas").hide();
                $("#itemspanelsubtemas .incompletosubtemas").hide();
                $("#itemspanelsubtemas .incompletovaloressubtemas").hide();
                $("#adicionarycerrarsubtemas").show();
                $("#guardar").hide();
                $("#itemspanelsubtemas").modal({backdrop:'static', width: '400px'}).modal('show');
                return false;
            }
            editsubtemas = function(codigosubtema) {
                $.ajax({
                    type: "POST",
                    url: "/mallas",
                    data: {'action': 'consubtemasprogramanalitico', 'id': codigosubtema},
                    error: function () {
                        $.unblockUI();
                        smoke.alert("Error al obtener los datos.");
                    },
                    success: function (data) {
                        $.unblockUI();
                        if (data.result == "ok") {
                            $("#id_subtemasedit").val(data.nombre);
                            $("#id_ordensubtemasedit").val(data.orden)
                            tooltips();
                            {#                            conectar_controleslib();#}
                        } else {
                            $("#id_subtemasedit").val('');
                            $("#id_ordensubtemasedit").val(0)
                            smoke.alert(data.mensaje);
                        }
                    }
                });
                $("#idsubtemedit").val('');
                $("#idsubtemedit").val(codigosubtema);
                $("#alertaingressubtemasedit").hide();
                $("#itemspanelsubtemasedit .incompletosubtemasedit").hide();
                $("#itemspanelsubtemasedit .incompletovaloressubtemasedit").hide();
                $("#adicionarycerrarsubtemasedit").show();
                $("#guardar").hide();
                $("#itemspanelsubtemasedit").modal({backdrop:'static', width: '400px'}).modal('show');
                return false;
            }
            $("#adicionarycerrarsubtemas").click(function() {
                adicionar_subtemas()
            });
            $("#adicionarycerrarsubtemasedit").click(function() {
                editar_subtemas()
            });
            $("#cerrarsubtemas").click(function() {
                $("#itemspanelsubtemas .incompletosubtemas").hide();
                $("#itemspanelsubtemas .incompletovalosubtemas").hide();
                $("#itemspanelsubtemas").modal("hide");
            });
            $("#cerrarsubtemasedit").click(function() {
                $("#itemspanelsubtemasedit .incompletosubtemasedit").hide();
                $("#itemspanelsubtemasedit .incompletovalosubtemasedit").hide();
                $("#itemspanelsubtemasedit").modal("hide");
            });
            adicionar_subtemas = function(ocultar) {
                var idsubtem = $("#idsubtem").val();
                var descripcion = $("#id_subtemas").val();
                var ordensubtemas = $("#id_ordensubtemas").val();
                if (descripcion == '' || ordensubtemas == ''){$("#itemspanelsubtemas .incompletosubtemas").show();return false;}
                $("#itemspanelsubtemas").modal("hide");
                bloqueointerface();
                $.ajax({
                    type: "POST",
                    url: "/mallas",
                    data: {'action': 'addsubtemasprogramanalitico', 'descripcion': descripcion, 'ordensubtemas': ordensubtemas, 'idsubtem': idsubtem},
                    error: function () {
                        $.unblockUI();
                        smoke.alert("Error al obtener los datos.");
                    },
                    success: function (data) {
                        $.unblockUI();
                        if (data.result == "ok") {
                            $("#idsubtemas"+idsubtem).append('<li id="eliminarsubtema'+data.idsubtemas+'"><a href="javascript:;" class="btn btn-tini btn-info editsubtema tu" id="adicionarsubtemasedit'+data.idsubtemas+'" onclick="editsubtemas('+data.idsubtemas+')"  title="Editar SubTema"><i class="fa fa-edit"></i></a> ' +
                                '<a href="javascript:;" class="btn btn-tini btn-danger delsubtema tu" idst="'+data.idsubtemas+'" title="Eliminar SubTema"><i class="fa fa-remove"></i></a> ' +
                                '<span><i class="fa fa-leaf"></i><i id="nomsubtema'+data.idsubtemas+'">SUBTEMA '+ordensubtemas+': '+ descripcion +'</li></span> </li>');
                            tooltips();
                            conectar_controlessubtemas();
                        } else {
                            smoke.alert(data.mensaje);
                        }
                    }
                });
            };
            editar_subtemas = function(ocultar) {
                var idsubtemedit = $("#idsubtemedit").val();
                var descripcion = $("#id_subtemasedit").val();
                var ordensubtemasedit = $("#id_ordensubtemasedit").val();
                if (descripcion == '' || ordensubtemasedit == ''){$("#itemspanelsubtemasedit .incompletosubtemasedit").show();return false;}
                $("#itemspanelsubtemasedit").modal("hide");
                bloqueointerface();
                $.ajax({
                    type: "POST",
                    url: "/mallas",
                    data: {'action': 'editsubtemasprogramanalitico', 'descripcion': descripcion, 'ordensubtemasedit': ordensubtemasedit, 'idsubtemedit': idsubtemedit},
                    error: function () {
                        $.unblockUI();
                        smoke.alert("Error al obtener los datos.");
                    },
                    success: function (data) {
                        $.unblockUI();
                        if (data.result == "ok") {
                            $("#nomsubtema"+idsubtemedit).html('SUBTEMA '+ordensubtemasedit+': '+descripcion)
                            tooltips();
                            {#                            conectar_controlestemas();#}
                        } else {
                            smoke.alert(data.mensaje);
                        }
                    }
                });
            };
            conectar_controlessubtemas = function () {
                $(".delsubtema").unbind();
                $(".delsubtema").click(function () {
                    $('#selectdeletesubtema').modal({'width': 800}).modal('show');
                    bloqueointerface();
                    $.ajax({
                        type: "POST",
                        url: "/mallas",
                        data: {'action': 'listadelprogramanaliticosubtemas', 'id': $(this).attr('idst') },
                        error: function () {
                            $.unblockUI();
                            smoke.alert("Error al obtener los datos.");
                        },
                        success: function (data) {
                            $.unblockUI();
                            if (data.result == "ok") {
                                $('#leyendasubtema').html(data.descripcion)
                                $('#codigosubtema').val(data.codigosubtema)
                                $('#selectdeletesubtema').modal({'width': 800}).modal('show');
                            } else {
                                smoke.alert(data.mensaje);
                            }
                        }
                    });
                });
            };


            $('.tree li:has(ul)').addClass('parent_li').find(' > span').attr('title', 'Contraer');
            $('.tree li.parent_li > span').on('click', function (e) {
                var children = $(this).parent('li.parent_li').find(' > ul > li');
                if (children.is(":visible")) {
                    children.hide('fast');
                    $(this).attr('title', 'Ampliar').find(' > i').addClass('fa fa-plus-sign').removeClass('fa fa-minus-sign');
                } else {
                    children.show('fast');
                    $(this).attr('title', 'Contraer').find(' > i').addClass('fa fa-minus-sign').removeClass('fa fa-plus-sign');
                }
                e.stopPropagation();
            });
        });
        function verContenidosMinimos(unidadId, unidadOrden, unidadNombre) {
            // Actualizar el título del modal con el nombre de la unidad
            $('#unidadNombre').text(unidadOrden+':'+ ' ' +unidadNombre);

            // Hacer una solicitud AJAX para obtener los contenidos mínimos de la unidad seleccionada
            $.ajax({
                url: "/mallas",  // Asegúrate de ajustar esta URL a tu configuración
                type: 'GET',
                data: {
                    action: 'obtener_contenidos_minimos',
                    id: unidadId
                },
                success: function(response) {
                    if (response.result === "bad") {
                        // Mostrar el mensaje de error devuelto por el backend
                        smoke.alert(response.mensaje);
                    } else {
                        // Limpiar la lista existente
                        $('#contenidosMinimosList').empty();

                        // Verificar si hay contenidos mínimos y agregarlos a la lista con numeración
                        if (response.contenidos_minimos && response.contenidos_minimos.length > 0) {
                            response.contenidos_minimos.forEach(function(contenido, index) {
                                $('#contenidosMinimosList').append('<li class="list-group-item">' + (index + 1) + '. ' + contenido.descripcion + '</li>');
                            });
                        } else {
                            $('#contenidosMinimosList').append('<li class="list-group-item">No hay contenidos mínimos registrados</li>');
                        }

                        // Mostrar el modal
                        $('#contenidosMinimosModal').modal('show');
                    }
                },
                error: function(xhr, status, error) {
                    // Manejar cualquier error no manejado del servidor
                    smoke.alert('Hubo un error al procesar la solicitud: ' + error);
                }
            });
        }
        $(function(){
            var itemstime = 1;
            var itemstimemet = 1;
            var itemstimelib = 1;
            $("#id_descripcion,#id_compromisos, #id_integranteuno, #id_caracterinvestigacion").addClass("validate[required]");
            $("#itemsadicionarobj").click(function() {
                $("#id_objetivos").val('');
                $("#alertaingreso").hide();
                $("#itemspanelobj .incompletoobj").hide();
                $("#itemspanelobj .incompletovaloresobj").hide();
                $("#adicionarycerrarobj").show();
                $("#guardar").hide();
                $("#id_horainicio, #id_horafin").timepicker({minuteStep: 1,appendWidgetTo: 'body', showSeconds: false, showMeridian: false, defaultTime: true});
                $("#itemspanelobj").modal({backdrop:'static', width: '400px'}).modal('show');
                return false;
            });
            $("#itemsadicionarrai").click(function() {
                $("#id_detallerai").val('');
                $("#alertaingreso").hide();
                $("#itemspanelrai .incompletorai").hide();
                $("#itemspanelrai .incompletovaloresrai").hide();
                $("#adicionarycerrarrai").show();
                $("#guardar").hide();
                $("#itemspanelrai").modal({backdrop:'static', width: '400px'}).modal('show');
                return false;
            });
            $("#itemsadicionarrac").click(function() {
                $("#id_detallerac").val('');
                $("#alertaingreso").hide();
                $("#itemspanelrac .incompletorac").hide();
                $("#itemspanelrac .incompletovaloresrac").hide();
                $("#adicionarycerrarrac").show();
                $("#guardar").hide();
                $("#itemspanelrac").modal({backdrop:'static', width: '400px'}).modal('show');
                return false;
            });

            $("#itemsadicionarmet").click(function() {
                $("#id_metodologia").val('');
                $("#alertaingreso").hide();
                $("#itemspanelmet .incompleto").hide();
                $("#itemspanelmet .incompletovalores").hide();
                $("#adicionarycerrarmet").show();
                $("#guardar").hide();
                $("#id_horainicio, #id_horafin").timepicker({minuteStep: 1,appendWidgetTo: 'body', showSeconds: false, showMeridian: false, defaultTime: true});
                $("#itemspanelmet").modal({backdrop:'static', width: '400px'}).modal('show');
                return false;
            });


            editrai = function(codigorai) {
                $("#itemspanelraiedit").modal("show");
                $("#id_raiedit").val($("#columnrai"+codigorai).html())
                $("#ocultoid_raiedit").val(codigorai)
            };
            editrac = function(codigorac) {
                $("#itemspanelracedit").modal("show");
                $("#id_racedit").val($("#columnrac"+codigorac).html())
                $("#ocultoid_racedit").val(codigorac)
            };
            $("#cerrarobj").click(function() {
                $("#itemspanelobj .incompletoobj").hide();
                $("#itemspanelobj .incompletovaloresobj").hide();
                $("#itemspanelobj").modal("hide");
            });
            $("#cerrarrai").click(function() {
                $("#itemspanelrai .incompletorai").hide();
                $("#itemspanelrai .incompletovaloresrai").hide();
                $("#itemspanelrai").modal("hide");
            });
            $("#cerrarrac").click(function() {
                $("#itemspanelrac .incompletorac").hide();
                $("#itemspanelrac .incompletovaloresrac").hide();
                $("#itemspanelrac").modal("hide");
            });
            $("#cerrarmet").click(function() {
                $("#itemspanelmet .incompletomet").hide();
                $("#itemspanelmet .incompletovaloresmet").hide();
                $("#itemspanelmet").modal("hide");
            });
            $("#cerrarmetedit").click(function() {
                $("#itemspanelmetedit .incompletometedit").hide();
                $("#itemspanelmetedit .incompletovaloresmetedit").hide();
                $("#itemspanelmetedit").modal("hide");
            });
            $("#cerrarobjedit").click(function() {
                $("#itemspanelobjedit .incompletoobjedit").hide();
                $("#itemspanelobjedit .incompletovaloresobjedit").hide();
                $("#itemspanelobjedit").modal("hide");
            });
            $("#cerrarracedit").click(function() {
                $("#itemspanelracedit .incompletoracedit").hide();
                $("#itemspanelracedit .incompletovaloresracedit").hide();
                $("#itemspanelracedit").modal("hide");
            });
            $("#cerrarraiedit").click(function() {
                $("#itemspanelraiedit .incompletoraiedit").hide();
                $("#itemspanelraiedit .incompletovaloresraiedit").hide();
                $("#itemspanelraiedit").modal("hide");
            });

            $("#adicionarycerrarobj").click(function() {
                adicionar_objetivos()
            });
            $("#adicionarycerrarrai").click(function() {
                adicionar_rai()
            });
            $("#adicionarycerrarrac").click(function() {
                adicionar_rac()
            });
            $("#adicionarycerrarmet").click(function() {
                adicionar_metodologias()
            });
            $("#adicionarycerrarmetedit").click(function() {
                adicionar_metodologiasedit()
            });
            $("#adicionarycerrarobjedit").click(function() {
                adicionar_objetivoedit()
            });
            $("#adicionarycerrarracedit").click(function() {
                adicionar_racedit()
            });
            $("#adicionarycerrarraiedit").click(function() {
                adicionar_raiedit()
            });
            adicionar_racedit = function(ocultar) {
                var descripcion = $("#id_racedit").val();
                var codirac = $("#ocultoid_racedit").val();
                if (descripcion == ''){$("#itemspanelracedit .incompletoracedit").show();return false;}
                $("#itemspanelracedit").modal("hide");
                $.ajax({
                    type: "POST",
                    url: "/mallas",
                    data: {'action': 'editprogramanaliticorac', 'descripcion': descripcion, 'codirac': codirac},
                    error: function () {
                        $.unblockUI();
                        smoke.alert("Error al obtener los datos.");
                    },
                    success: function (data) {
                        $.unblockUI();
                        if (data.result == "ok") {
                            $("#columnrac"+codirac).html(data.descripcion)
                            tooltips();
                            conectar_controlesrac();
                        } else {
                            smoke.alert(data.mensaje);
                        }
                    }
                });
            };
            adicionar_raiedit = function(ocultar) {
                var descripcion = $("#id_raiedit").val();
                var codirai = $("#ocultoid_raiedit").val();
                if (descripcion == ''){$("#itemspanelraiedit .incompletoraiedit").show();return false;}
                $("#itemspanelraiedit").modal("hide");
                $.ajax({
                    type: "POST",
                    url: "/mallas",
                    data: {'action': 'editprogramanaliticorai', 'descripcion': descripcion, 'codirai': codirai},
                    error: function () {
                        $.unblockUI();
                        smoke.alert("Error al obtener los datos.");
                    },
                    success: function (data) {
                        $.unblockUI();
                        if (data.result == "ok") {
                            $("#columnrai"+codirai).html(data.descripcion)
                            tooltips();
                            conectar_controlesrai();
                        } else {
                            smoke.alert(data.mensaje);
                        }
                    }
                });
            };

            adicionar_objetivos = function(ocultar) {
                var descripcion = $("#id_objetivos").val();
                if (descripcion == ''){$("#itemspanelobj .incompletoobj").show();return false;}
                $("#itemspanelobj").modal("hide");
                $.ajax({
                    type: "POST",
                    url: "/mallas",
                    data: {'action': 'addprogramanaliticoobj', 'descripcion': descripcion, 'programanalitico': {{ programanalitico.id }}},
                    error: function () {
                        $.unblockUI();
                        smoke.alert("Error al obtener los datos.");
                    },
                    success: function (data) {
                        $.unblockUI();
                        if (data.result == "ok") {
                            $("#itemsbodyobj").append('<tr id="filaobj_'+data.idobjetivo+'">' +
                                '<td style="text-align: justify" class="objetivos"><div id="columnobj'+data.idobjetivo+'">'+descripcion+'</div></td>' +
                                '<td style="text-align: center">' +
                                '<a href="javascript:;" class="btn btn-tini btn-info editobjetivo tu" id="adicionarobjetivoedit'+data.idobjetivo+'" onclick="editobjetivo('+data.idobjetivo+')"  title="Editar"><i class="fa fa-edit"></i></a>' +
                                '<a href="javascript:;" class="btn btn-tini btn-danger eliminarobj tu" idobj='+data.idobjetivo+' title="Eliminar"><i class="fa fa-remove"></i></a>' +
                                '</td>' +
                                '</tr>');
                            tooltips();
                            conectar_controlesobj();
                        } else {
                            smoke.alert(data.mensaje);
                        }
                    }
                });
            };
            adicionar_objetivoedit = function(ocultar) {
                var descripcion = $("#id_objetivoedit").val();
                var codiobjetivo = $("#ocultoid_objetivoedit").val();
                if (descripcion == ''){$("#itemspanelobjedit .incompletoobjedit").show();return false;}
                $("#itemspanelobjedit").modal("hide");
                $.ajax({
                    type: "POST",
                    url: "/mallas",
                    data: {'action': 'editprogramanaliticoobj', 'descripcion': descripcion, 'codiobjetivo': codiobjetivo},
                    error: function () {
                        $.unblockUI();
                        smoke.alert("Error al obtener los datos.");
                    },
                    success: function (data) {
                        $.unblockUI();
                        if (data.result == "ok") {
                            $("#columnobj"+codiobjetivo).html(data.descripcion)
                            tooltips();
                            conectar_controlesobj();
                        } else {
                            smoke.alert(data.mensaje);
                        }
                    }
                });
            };
            editobjetivo = function(codigoobjetivo) {
                $("#itemspanelobjedit").modal("show");
                $("#id_objetivoedit").val($("#columnobj"+codigoobjetivo).html())
                $("#ocultoid_objetivoedit").val(codigoobjetivo)
            };
            conectar_controlesmet = function () {
                $(".eliminarmet").unbind();
                $(".eliminarmet").click(function () {
                    bloqueointerface();
                    $.ajax({
                        type: "POST",
                        url: "/mallas",
                        data: {'action': 'listadelprogramanaliticomet', 'id': $(this).attr('idmet') },
                        error: function () {
                            $.unblockUI();
                            smoke.alert("Error al obtener los datos.");
                        },
                        success: function (data) {
                            $.unblockUI();
                            if (data.result == "ok") {
                                $('#leyendamet').html(data.descripcion)
                                $('#idmetodologia').val(data.idmetodologia)
                                $('#selectdeletemet').modal({'width': 800}).modal('show');
                            } else {
                                smoke.alert(data.mensaje);
                            }
                        }
                    });
                });
            };

            conectar_controlesobj = function () {
                $(".eliminarobj").unbind();
                $(".eliminarobj").click(function () {
                    bloqueointerface();
                    $.ajax({
                        type: "POST",
                        url: "/mallas",
                        data: {'action': 'listadelprogramanaliticoobj', 'id': $(this).attr('idobj') },
                        error: function () {
                            $.unblockUI();
                            smoke.alert("Error al obtener los datos.");
                        },
                        success: function (data) {
                            $.unblockUI();
                            if (data.result == "ok") {
                                $('#leyenda').html(data.descripcion)
                                $('#idobjetivo').val(data.idobjetivo)
                                $('#selectdelete').modal({'width': 800}).modal('show');
                            } else {
                                smoke.alert(data.mensaje);
                            }
                        }
                    });
                });
            };
            $("#eliminacionmodal_formbutton").click(function(){
                $('#selectdelete').modal('hide');
                var filaobj = ''
                filaobj = 'filaobj_'+ $('#idobjetivo').val()
                $.ajax({
                    type: "POST",
                    url: "/mallas",
                    data: {'action': 'eliminarprogramanaliticoobj', 'idobjetivo': $('#idobjetivo').val()},
                    error: function () {
                        $.unblockUI();
                        smoke.alert("Error al obtener los datos.");
                    },
                    success: function (data) {
                        $.unblockUI();
                        if (data.result == "ok") {
                            $('#'+filaobj).remove();
                        } else {
                            smoke.alert(data.mensaje);
                        }
                    }
                });
            });
            $(".eliminarobj").click(function () {
                bloqueointerface();
                $.ajax({
                    type: "POST",
                    url: "/mallas",
                    data: {'action': 'listadelprogramanaliticoobj', 'id': $(this).attr('idobj') },
                    error: function () {
                        $.unblockUI();
                        smoke.alert("Error al obtener los datos.");
                    },
                    success: function (data) {
                        $.unblockUI();
                        if (data.result == "ok") {
                            $('#leyenda').html(data.descripcion)
                            $('#idobjetivo').val(data.idobjetivo)
                            $('#selectdelete').modal({'width': 800}).modal('show');
                        } else {
                            smoke.alert(data.mensaje);
                        }
                    }
                });
            });
            $("#eliminacionmodal_cancel").click(function(){
                $('#selectdelete').modal('hide');
            });

            adicionar_rai = function(ocultar) {
                var descripcion = $("#id_detallerai").val();
                if (descripcion == ''){$("#itemspanelrai .incompletorai").show();return false;}
                $("#itemspanelrai").modal("hide");
                $.ajax({
                    type: "POST",
                    url: "/mallas",
                    data: {'action': 'addprogramanaliticorai', 'descripcion': descripcion, 'programanalitico': {{ programanalitico.id }}},
                    error: function () {
                        $.unblockUI();
                        smoke.alert("Error al obtener los datos.");
                    },
                    success: function (data) {
                        $.unblockUI();
                        if (data.result == "ok") {
                            $("#itemsbodyrai").append('<tr id="filarai_'+data.codigorai+'">' +
                                '<td style="text-align: justify" class="objetivos"><div id="columnrai'+data.codigorai+'">'+descripcion+'</div></td>' +
                                '<td style="text-align: center">' +
                                '<a href="javascript:;" class="btn btn-tini btn-info editrai tu" id="adicionarraiedit'+data.codigorai+'" onclick="editrai('+data.codigorai+')"  title="Editar"><i class="fa fa-edit"></i></a>' +
                                '<a href="javascript:;" class="btn btn-tini btn-danger eliminarrai tu" idrai='+data.codigorai+' title="Eliminar"><i class="fa fa-remove"></i></a>' +
                                '</td>' +
                                '</tr>');
                            tooltips();
                            conectar_controlesrai();
                        } else {
                            smoke.alert(data.mensaje);
                        }
                    }
                });
            };

            conectar_controlesrai = function () {
                $(".eliminarrai").unbind();
                $(".eliminarrai").click(function () {
                    bloqueointerface();
                    $.ajax({
                        type: "POST",
                        url: "/mallas",
                        data: {'action': 'listadelprogramanaliticorai', 'id': $(this).attr('idrai') },
                        error: function () {
                            $.unblockUI();
                            smoke.alert("Error al obtener los datos.");
                        },
                        success: function (data) {
                            $.unblockUI();
                            if (data.result == "ok") {
                                $('#leyendarai').html(data.descripcion)
                                $('#idcodigorai').val(data.codigorai)
                                $('#selectdeleterai').modal({'width': 800}).modal('show');
                            } else {
                                smoke.alert(data.mensaje);
                            }
                        }
                    });
                });
            };
            $("#eliminacionmodalrai_formbutton").click(function(){
                $('#selectdeleterai').modal('hide');
                var filarai = ''
                filarai = 'filarai_'+ $('#idcodigorai').val()
                $.ajax({
                    type: "POST",
                    url: "/mallas",
                    data: {'action': 'eliminarprogramanaliticorai', 'idcodigorai': $('#idcodigorai').val()},
                    error: function () {
                        $.unblockUI();
                        smoke.alert("Error al obtener los datos.");
                    },
                    success: function (data) {
                        $.unblockUI();
                        if (data.result == "ok") {
                            $('#'+filarai).remove();
                        } else {
                            smoke.alert(data.mensaje);
                        }
                    }
                });
            });
            $(".eliminarrai").click(function () {
                bloqueointerface();
                $.ajax({
                    type: "POST",
                    url: "/mallas",
                    data: {'action': 'listadelprogramanaliticorai', 'id': $(this).attr('idrai') },
                    error: function () {
                        $.unblockUI();
                        smoke.alert("Error al obtener los datos.");
                    },
                    success: function (data) {
                        $.unblockUI();
                        if (data.result == "ok") {
                            $('#leyendarai').html(data.descripcion)
                            $('#idcodigorai').val(data.codigorai)
                            $('#selectdeleterai').modal({'width': 800}).modal('show');
                        } else {
                            smoke.alert(data.mensaje);
                        }
                    }
                });
            });
            $("#eliminacionmodalrai_cancel").click(function(){
                $('#selectdeleterai').modal('hide');
            });

            adicionar_rac = function(ocultar) {
                var descripcion = $("#id_detallerac").val();
                if (descripcion == ''){$("#itemspanelrac .incompletorac").show();return false;}
                $("#itemspanelrac").modal("hide");
                $.ajax({
                    type: "POST",
                    url: "/mallas",
                    data: {'action': 'addprogramanaliticorac', 'descripcion': descripcion, 'programanalitico': {{ programanalitico.id }}},
                    error: function () {
                        $.unblockUI();
                        smoke.alert("Error al obtener los datos.");
                    },
                    success: function (data) {
                        $.unblockUI();
                        if (data.result == "ok") {
                            $("#itemsbodyrac").append('<tr id="filarac_'+data.codigorac+'">' +
                                '<td style="text-align: justify" class="objetivos"><div id="columnrac'+data.codigorac+'">'+descripcion+'</div></td>' +
                                '<td style="text-align: center">' +
                                '<a href="javascript:;" class="btn btn-tini btn-info editrac tu" id="adicionarracedit'+data.codigorac+'" onclick="editrac('+data.codigorac+')"  title="Editar"><i class="fa fa-edit"></i></a>' +
                                '<a href="javascript:;" class="btn btn-tini btn-danger eliminarrac tu" idrac='+data.codigorac+' title="Eliminar"><i class="fa fa-remove"></i></a>' +
                                '</td>' +
                                '</tr>');
                            tooltips();
                            conectar_controlesrac();
                        } else {
                            smoke.alert(data.mensaje);
                        }
                    }
                });
            };

            conectar_controlesrac = function () {
                $(".eliminarrac").unbind();
                $(".eliminarrac").click(function () {
                    bloqueointerface();
                    $.ajax({
                        type: "POST",
                        url: "/mallas",
                        data: {'action': 'listadelprogramanaliticorac', 'id': $(this).attr('idrac') },
                        error: function () {
                            $.unblockUI();
                            smoke.alert("Error al obtener los datos.");
                        },
                        success: function (data) {
                            $.unblockUI();
                            if (data.result == "ok") {
                                $('#leyendarac').html(data.descripcion)
                                $('#idcodigorac').val(data.codigorac)
                                $('#selectdeleterac').modal({'width': 800}).modal('show');
                            } else {
                                smoke.alert(data.mensaje);
                            }
                        }
                    });
                });
            };
            $("#eliminacionmodalrac_formbutton").click(function(){
                $('#selectdeleterac').modal('hide');
                var filarac = ''
                filarac = 'filarac_'+ $('#idcodigorac').val()
                $.ajax({
                    type: "POST",
                    url: "/mallas",
                    data: {'action': 'eliminarprogramanaliticorac', 'idcodigorac': $('#idcodigorac').val()},
                    error: function () {
                        $.unblockUI();
                        smoke.alert("Error al obtener los datos.");
                    },
                    success: function (data) {
                        $.unblockUI();
                        if (data.result == "ok") {
                            $('#'+filarac).remove();
                        } else {
                            smoke.alert(data.mensaje);
                        }
                    }
                });
            });
            $(".eliminarrac").click(function () {
                bloqueointerface();
                $.ajax({
                    type: "POST",
                    url: "/mallas",
                    data: {'action': 'listadelprogramanaliticorac', 'id': $(this).attr('idrac') },
                    error: function () {
                        $.unblockUI();
                        smoke.alert("Error al obtener los datos.");
                    },
                    success: function (data) {
                        $.unblockUI();
                        if (data.result == "ok") {
                            $('#leyendarac').html(data.descripcion)
                            $('#idcodigorac').val(data.codigorac)
                            $('#selectdeleterac').modal({'width': 800}).modal('show');
                        } else {
                            smoke.alert(data.mensaje);
                        }
                    }
                });
            });
            $("#eliminacionmodalrac_cancel").click(function(){
                $('#selectdeleterac').modal('hide');
            });

            adicionar_metodologias = function(ocultar) {
                var descripcion = $("#id_metodologia").val();
                if (descripcion == ''){$("#itemspanelmet .incompletomet").show();return false;}
                $("#itemspanelmet").modal("hide");
                $.ajax({
                    type: "POST",
                    url: "/mallas",
                    data: {'action': 'addprogramanaliticomet', 'descripcion': descripcion, 'programanalitico': {{ programanalitico.id }}},
                    error: function () {
                        $.unblockUI();
                        smoke.alert("Error al obtener los datos.");
                    },
                    success: function (data) {
                        $.unblockUI();
                        if (data.result == "ok") {
                            $("#itemsbodymet").append('<tr id="filamet_'+data.idmetodologia+'">' +
                                '<td style="text-align: justify" class="metodologias"><div id="columnmet'+data.idmetodologia+'">'+descripcion+'</div></td>' +
                                '<td style="text-align: center">' +
                                '<a href="javascript:;" class="btn btn-tini btn-info editmetodologia tu" id="adicionarmetodologiaedit'+data.idmetodologia+'" onclick="editmetodologia('+data.idmetodologia+')"  title="Editar"><i class="fa fa-edit"></i></a>' +
                                '<a href="javascript:;" class="btn btn-tini btn-danger eliminarmet tu" idmet='+data.idmetodologia+' title="Eliminar"><i class="fa fa-remove"></i></a>' +
                                '</td>' +
                                '</tr>');
                            tooltips();
                            conectar_controlesmet();
                        } else {
                            smoke.alert(data.mensaje);
                        }
                    }
                });
            };
            adicionar_metodologiasedit = function(ocultar) {
                var descripcion = $("#id_metodologiaedit").val();
                var codimetodologia = $("#ocultoid_metodologiaedit").val();
                if (descripcion == ''){$("#itemspanelmetedit .incompletometedit").show();return false;}
                $("#itemspanelmetedit").modal("hide");
                $.ajax({
                    type: "POST",
                    url: "/mallas",
                    data: {'action': 'editprogramanaliticomet', 'descripcion': descripcion, 'codimetodologia': codimetodologia},
                    error: function () {
                        $.unblockUI();
                        smoke.alert("Error al obtener los datos.");
                    },
                    success: function (data) {
                        $.unblockUI();
                        if (data.result == "ok") {
                            $("#columnmet"+codimetodologia).html(data.descripcion)
                            tooltips();
                            conectar_controlesmet();
                        } else {
                            smoke.alert(data.mensaje);
                        }
                    }
                });
            };
            editmetodologia = function(codigometodologia) {
                $("#itemspanelmetedit").modal("show");
                $("#id_metodologiaedit").val($("#columnmet"+codigometodologia).html())
                $("#ocultoid_metodologiaedit").val(codigometodologia)
            };
            conectar_controlesmet = function () {
                $(".eliminarmet").unbind();
                $(".eliminarmet").click(function () {
                    bloqueointerface();
                    $.ajax({
                        type: "POST",
                        url: "/mallas",
                        data: {'action': 'listadelprogramanaliticomet', 'id': $(this).attr('idmet') },
                        error: function () {
                            $.unblockUI();
                            smoke.alert("Error al obtener los datos.");
                        },
                        success: function (data) {
                            $.unblockUI();
                            if (data.result == "ok") {
                                $('#leyendamet').html(data.descripcion)
                                $('#idmetodologia').val(data.idmetodologia)
                                $('#selectdeletemet').modal({'width': 800}).modal('show');
                            } else {
                                smoke.alert(data.mensaje);
                            }
                        }
                    });
                });
            };
            actualizar_listamet = function () {
                lista_items2 = [];
                $(".elementosmet").each(function () {
                    var item2 = {
                        metodologia: $(this).find(".metodologia").html()
                    };
                    lista_items2.push(item2);
                });
            };
            $("#eliminacionmodal_formbuttonmet").click(function(){
                $('#selectdeletemet').modal('hide');
                var filamet = ''
                filamet = 'filamet_'+ $('#idmetodologia').val()
                $.ajax({
                    type: "POST",
                    url: "/mallas",
                    data: {'action': 'eliminarprogramanaliticomet', 'idmetodologia': $('#idmetodologia').val()},
                    error: function () {
                        $.unblockUI();
                        smoke.alert("Error al obtener los datos.");
                    },
                    success: function (data) {
                        $.unblockUI();
                        if (data.result == "ok") {
                            $('#'+filamet).remove();
                        } else {
                            smoke.alert(data.mensaje);
                        }
                    }
                });
            });
            $(".eliminarmet").click(function () {
                bloqueointerface();
                $.ajax({
                    type: "POST",
                    url: "/mallas",
                    data: {'action': 'listadelprogramanaliticomet', 'id': $(this).attr('idmet') },
                    error: function () {
                        $.unblockUI();
                        smoke.alert("Error al obtener los datos.");
                    },
                    success: function (data) {
                        $.unblockUI();
                        if (data.result == "ok") {
                            $('#leyendamet').html(data.descripcion)
                            $('#idmetodologia').val(data.idmetodologia)
                            $('#selectdeletemet').modal({'width': 800}).modal('show');
                        } else {
                            smoke.alert(data.mensaje);
                        }
                    }
                });
            });
            $("#eliminacionmodal_cancelmet").click(function(){
                $('#selectdeletemet').modal('hide');
            });

            $("#eliminacionmodal_formbuttontema").click(function(){
                $('#selectdeletetema').modal('hide');
                var filatema = ''
                filatema = 'eliminartema'+ $('#codigotema').val()
                $.ajax({
                    type: "POST",
                    url: "/mallas",
                    data: {'action': 'eliminarprogramanaliticotema', 'codigotema': $('#codigotema').val()},
                    error: function () {
                        $.unblockUI();
                        smoke.alert("Error al obtener los datos.");
                    },
                    success: function (data) {
                        $.unblockUI();
                        if (data.result == "ok") {
                            $('#'+filatema).remove();
                        } else {
                            smoke.alert(data.mensaje);
                        }
                    }
                });
            });
            $(".delunidad").click(function () {
                $('#selectdeleteunidad').modal({'width': 800}).modal('show');
                bloqueointerface();
                $.ajax({
                    type: "POST",
                    url: "/mallas",
                    data: {'action': 'listadelprogramanaliticounidad', 'id': $(this).attr('iddeluni') },
                    error: function () {
                        $.unblockUI();
                        smoke.alert("Error al obtener los datos.");
                    },
                    success: function (data) {
                        $.unblockUI();
                        if (data.result == "ok") {
                            $('#leyendaunidad').html(data.descripcion)
                            $('#codigounidad').val(data.codigounidad)
                            $('#selectdeleteunidad').modal({'width': 800}).modal('show');
                        } else {
                            smoke.alert(data.mensaje);
                        }
                    }
                });
            });
            $("#eliminacionmodal_cancelunidad").click(function(){
                $('#selectdeleteunidad').modal('hide');
            });
            $("#eliminacionmodal_formbuttonunidad").click(function(){
                $('#selectdeleteunidad').modal('hide');
                var filaunidad = ''
                filaunidad = 'eliminarunidad'+ $('#codigounidad').val();
                $.ajax({
                    type: "POST",
                    url: "/mallas",
                    data: {'action': 'eliminarprogramanaliticounidad', 'codigounidad': $('#codigounidad').val()},
                    error: function () {
                        $.unblockUI();
                        smoke.alert("Error al obtener los datos.");
                    },
                    success: function (data) {
                        $.unblockUI();
                        if (data.result == "ok") {
                            $('#'+filaunidad).remove();
                        } else {
                            smoke.alert(data.mensaje);
                        }
                    }
                });
            });
            $(".deltema").click(function () {
                $('#selectdeletetema').modal({'width': 800}).modal('show');
                bloqueointerface();
                $.ajax({
                    type: "POST",
                    url: "/mallas",
                    data: {'action': 'listadelprogramanaliticotemas', 'id': $(this).attr('idt') },
                    error: function () {
                        $.unblockUI();
                        smoke.alert("Error al obtener los datos.");
                    },
                    success: function (data) {
                        $.unblockUI();
                        if (data.result == "ok") {
                            $('#leyendatema').html(data.descripcion);
                            $('#codigotema').val(data.codigotema);
                            $('#selectdeletetema').modal({'width': 800}).modal('show');
                        } else {
                            smoke.alert(data.mensaje);
                        }
                    }
                });
            });
            $("#eliminacionmodal_canceltema").click(function(){
                $('#selectdeletetema').modal('hide');
            });
            $("#eliminacionmodal_formbuttonsubtema").click(function(){
                $('#selectdeletesubtema').modal('hide');
                var filasubtema = '';
                filasubtema = 'eliminarsubtema'+ $('#codigosubtema').val();
                $.ajax({
                    type: "POST",
                    url: "/mallas",
                    data: {'action': 'eliminarprogramanaliticosubtema', 'codigosubtema': $('#codigosubtema').val()},
                    error: function () {
                        $.unblockUI();
                        smoke.alert("Error al obtener los datos.");
                    },
                    success: function (data) {
                        $.unblockUI();
                        if (data.result == "ok") {
                            $('#'+filasubtema).remove();
                        } else {
                            smoke.alert(data.mensaje);
                        }
                    }
                });
            });
            $(".delsubtema").click(function () {
                $('#selectdeletesubtema').modal({'width': 800}).modal('show');
                bloqueointerface();
                $.ajax({
                    type: "POST",
                    url: "/mallas",
                    data: {'action': 'listadelprogramanaliticosubtemas', 'id': $(this).attr('idst') },
                    error: function () {
                        $.unblockUI();
                        smoke.alert("Error al obtener los datos.");
                    },
                    success: function (data) {
                        $.unblockUI();
                        if (data.result == "ok") {
                            $('#leyendasubtema').html(data.descripcion)
                            $('#codigosubtema').val(data.codigosubtema)
                            $('#selectdeletesubtema').modal({'width': 800}).modal('show');
                        } else {
                            smoke.alert(data.mensaje);
                        }
                    }
                });
            });
            $("#eliminacionmodal_cancelsubtema").click(function(){
                $('#selectdeletesubtema').modal('hide');
            });


            $("#id_integranteuno_select2").change(function () {
                $("#id_integranteuno").val(0)
                $("#id_integranteuno").val(0).trigger('change');
            });
            $("#id_integrantedos_select2").change(function () {
                $("#id_integrantedos").val(0)
                $("#id_integrantedos").val(0).trigger('change');
            });
            $("#id_integrantetres_select2").change(function () {
                $("#id_integrantetres").val(0)
                $("#id_integrantetres").val(0).trigger('change');
            });

            $("#id_integranteuno").attr({"value":({{ intuno }})});
            ItemsDisplay = function (item) {
                if (item.name){
                    return $('<span>' + item.name+ '</span>');
                }else{
                    if ($("#id_integranteuno").val()==0){
                        return '---------';
                    }else{
                        return '<span>{{ programanalitico.integranteuno }}</span>';
                    }
                }
            };
            $("#id_integranteuno_select2").select2({
                placeholder: "---------",
                allowClear: true,
                ajax: {
                    url: function (params) {
                        return "/reportes?action=data&model=Profesor&p=1&s=10&q=" + params.term;
                    },
                    dataType: 'json',
                    delay: 250,
                    data: function (params) {
                        return {
                            q: params.term,
                            page: params.page
                        };
                    },
                    processResults: function (data, params) {
                        params.page = params.page || 1;
                        return {
                            results: data.results,
                            pagination: {
                                more: (params.page * 30) < data.total_count
                            }
                        };
                    },
                    cache: true
                },
                escapeMarkup: function (markup) { return markup; }, // let our custom formatter work
                minimumInputLength: 1,
                templateResult: ItemsDisplay, // omitted for brevity, see the source of this page
                templateSelection: ItemsDisplay // omitted for brevity, see the source of this page
            }).on("select2:select", function (evt) {
                $("#id_integranteuno").attr({"value":(evt.params.data.id)});
            }).on("select2:span", function (evt) {
                alert('bbb')
            });

            $("#id_integrantedos").attr({"value":({{ intdos }})});
            ItemsDisplay2 = function (item2) {
                {#                var item2 = {"name":"{{ graduado.integrantetribunal }}"};#}
                if (item2.name){
                    return $('<span>' + item2.name+ '</span>');
                }else{
                    if ($("#id_integrantedos").val()==0){
                        return '---------';
                    }else{
                        return '{{ programanalitico.integrantedos }}';
                    }
                }
            };
            $("#id_integrantedos_select2").select2({
                placeholder: "---------",
                allowClear: true,
                ajax: {
                    url: function (params) {
                        return "/reportes?action=data&model=Profesor&p=1&s=10&q=" + params.term;
                    },
                    dataType: 'json',
                    delay: 250,
                    data: function (params) {
                        return {
                            q: params.term,
                            page: params.page
                        };
                    },
                    processResults: function (data, params) {
                        params.page = params.page || 1;
                        return {
                            results: data.results,
                            pagination: {
                                more: (params.page * 30) < data.total_count
                            }
                        };
                    },
                    cache: true
                },
                escapeMarkup: function (markup) { return markup; }, // let our custom formatter work
                minimumInputLength: 1,
                templateResult: ItemsDisplay2, // omitted for brevity, see the source of this page
                templateSelection: ItemsDisplay2 // omitted for brevity, see the source of this page
            }).on("select2:select", function (evt) {
                $("#id_integrantedos").attr({"value":(evt.params.data.id)});
            });
            $("#id_integrantetres").attr({"value":({{ inttres }})});
            ItemsDisplay2 = function (item2) {
                if (item2.name){
                    return $('<span>' + item2.name+ '</span>');
                }else{
                    if ($("#id_integrantetres").val()==0){
                        return '---------';
                    }else{
                        return '{{ programanalitico.integrantetres }}';
                    }
                }
            };
            $("#id_integrantetres_select2").select2({
                placeholder: "---------",
                allowClear: true,
                ajax: {
                    url: function (params) {
                        return "/reportes?action=data&model=Profesor&p=1&s=10&q=" + params.term;
                    },
                    dataType: 'json',
                    delay: 250,
                    data: function (params) {
                        return {
                            q: params.term,
                            page: params.page
                        };
                    },
                    processResults: function (data, params) {
                        params.page = params.page || 1;
                        return {
                            results: data.results,
                            pagination: {
                                more: (params.page * 30) < data.total_count
                            }
                        };
                    },
                    cache: true
                },
                escapeMarkup: function (markup) { return markup; }, // let our custom formatter work
                minimumInputLength: 1,
                templateResult: ItemsDisplay2, // omitted for brevity, see the source of this page
                templateSelection: ItemsDisplay2 // omitted for brevity, see the source of this page
            }).on("select2:select", function (evt) {
                $("#id_integrantetres").attr({"value":(evt.params.data.id)});
            });

            {% if not programanalitico.en_uso or persona.usuario.is_superuser or perms.sga.puede_modificar_programa_analitico or perms.sga.puede_editar_contenido_plananalitico %}
                var correcto = 0
            {% else %}
                $('.edittema').each(function (){
                    $(this).css('display', 'none');
                });
                $('.classunidades').each(function (){
                    $(this).css('display', 'none');
                });
                $('.classaddtemas').each(function (){
                    $(this).css('display', 'none');
                });
                $('.classsubtemas').each(function (){
                    $(this).css('display', 'none');
                });
                $('.editsubtema').each(function (){
                    $(this).css('display', 'none');
                });
                $('.classlistaarchivos').each(function (){
                    $(this).css('display', 'none');
                });
                $("#adicionarresultado").css('display', 'none');
            {% endif %}
        });
    </script>
    <style>
        .fa fa-folder-open{background-position:-408px -120px;width:16px;}
        .well{min-height:20px;padding:19px;margin-bottom:20px;background-color:#f5f5f5;border:1px solid #e3e3e3;-webkit-border-radius:4px;-moz-border-radius:4px;border-radius:4px;-webkit-box-shadow:inset 0 1px 1px rgba(0, 0, 0, 0.05);-moz-box-shadow:inset 0 1px 1px rgba(0, 0, 0, 0.05);box-shadow:inset 0 1px 1px rgba(0, 0, 0, 0.05);}.well blockquote{border-color:#ddd;border-color:rgba(0, 0, 0, 0.15);}
        .well-large{padding:24px;-webkit-border-radius:6px;-moz-border-radius:6px;border-radius:6px;}
        .well-small{padding:9px;-webkit-border-radius:3px;-moz-border-radius:3px;border-radius:3px;}
        .close{float:right;font-size:20px;font-weight:bold;line-height:20px;color:#000000;text-shadow:0 1px 0 #ffffff;opacity:0.2;filter:alpha(opacity=20);}.close:hover,.close:focus{color:#000000;text-decoration:none;cursor:pointer;opacity:0.4;filter:alpha(opacity=40);}
        button.close{padding:0;cursor:pointer;background:transparent;border:0;-webkit-appearance:none;}
        .tree {
            min-height:20px;
            padding:19px;
            margin-bottom:20px;
            background-color:#fbfbfb;
            border:1px solid #999;
            -webkit-border-radius:4px;
            -moz-border-radius:4px;
            border-radius:4px;
            -webkit-box-shadow:inset 0 1px 1px rgba(0, 0, 0, 0.05);
            -moz-box-shadow:inset 0 1px 1px rgba(0, 0, 0, 0.05);
            box-shadow:inset 0 1px 1px rgba(0, 0, 0, 0.05)
        }
        .tree li {
            list-style-type:none;
            margin: 0;
            padding:10px 5px 0 5px;
            position:relative
        }
        .tree li::before, .tree li::after {
            content:'';
            left:-20px;
            position:absolute;
            right:auto
        }
        .tree li::before {
            border-left:1px solid #999;
            bottom:50px;
            height:100%;
            top:0;
            width:1px
        }
        .tree li::after {
            border-top:1px solid #999;
            height:20px;
            top:25px;
            width:25px
        }
        .tree li span {
            -moz-border-radius:5px;
            -webkit-border-radius:5px;
            border:1px solid #999;
            border-radius:5px;
            display:inline-block;
            padding:3px 8px;
            text-decoration:none
        }
        .tree li.parent_li>span {
            cursor:pointer
        }
        .tree>ul>li::before, .tree>ul>li::after {
            border:0
        }
        .tree li:last-child::before {
            height:30px
        }
        .tree li.parent_li>span:hover, .tree li.parent_li>span:hover+ul li span {
            background:#eee;
            border:1px solid #94a0b4;
            color:#000
        }
    </style>
{% endblock %}
{% block atras %}/mallas?action=programanalitico&id={{ programanalitico.asignaturamalla.id|encrypt }}{% endblock %}
{% block titulo %}{{ title }} - {{ programanalitico.asignaturamalla }}{% endblock %}
{% block formaction %}/mallas?action=programanalitico&id={{ programanalitico.asignaturamalla.id|encrypt }}{% endblock %}
{% block formdestination %}/mallas?action=programanalitico&id={{ programanalitico.asignaturamalla.id|encrypt }}{% endblock %}
{% block formextra %}
    <input type='hidden' name='action' value='editprogramanalitico'/>
    <input type='hidden' name='id' value="{{ programanalitico.id|encrypt }}"/>
{% endblock %}
{% block formback %}/mallas?action=programanalitico&id={{ programanalitico.asignaturamalla.id|encrypt }}{% endblock %}
{% block buttonname %}Guardar{% endblock %}
{% block formsuffix %}
    <div>
        <fieldset class="control-group nomargins" style="float: left; width: 100%">
            <div class="controls">
                <table class='table table-bordered' cellpadding="0" cellspacing="0">
                    <thead>
                    <tr>
                        <th style="text-align: center" width="90%">Resultado de aprendizaje institucional RAI</th>
                        <th style="text-align: center" width="10%"> <a href="javascript:;" id="itemsadicionarrai" class="btn btn-success btn-mini"><span class="fa fa-plus"></span></a></th>
                    </tr>
                    </thead>
                    <tbody id="itemsbodyrai" class="datatable">
                    {% for lisrai in listarai %}
                        <tr id="filarai_{{ lisrai.id }}">
                            <td style='text-align: justify'><div id="columnrai{{ lisrai.id }}">{{ lisrai.descripcion }}</div></td>
                            <td style='text-align: center'>
                                <a href='javascript:;' class='btn btn-tini btn-info editrai tu' id="adicionarraiedit{{ lisrai.id }}" onclick="editrai({{ lisrai.id }})"  title='Editar'><i class='fa fa-edit'></i></a>
                                <a href='javascript:;' class='btn btn-tini btn-danger eliminarrai tu' idrai="{{ lisrai.id }}" title='Eliminar'><i class='fa fa-remove'></i></a>
                            </td>
                        </tr>
                    {% endfor %}
                    </tbody>
                    <tfoot>
                    </tfoot>
                </table>
            </div>
        </fieldset>
        <fieldset class="control-group nomargins" style="float: left; width: 100%">
            <div class="controls">
                <table class='table table-bordered' cellpadding="0" cellspacing="0">
                    <thead>
                    <tr>
                        <th style="text-align: center" width="90%">Resultado de aprendizaje carrera RAC</th>
                        <th style="text-align: center" width="10%"> <a href="javascript:;" id="itemsadicionarrac" class="btn btn-success btn-mini"><span class="fa fa-plus"></span></a></th>
                    </tr>
                    </thead>
                    <tbody id="itemsbodyrac" class="datatable">
                    {% for lisrac in listarac %}
                        <tr id="filarac_{{ lisrac.id }}">
                            <td style='text-align: justify'><div id="columnrac{{ lisrac.id }}">{{ lisrac.descripcion }}</div></td>
                            <td style='text-align: center'>
                                <a href='javascript:;' class='btn btn-tini btn-info editrac tu' id="adicionarracedit{{ lisrac.id }}" onclick="editrac({{ lisrac.id }})"  title='Editar'><i class='fa fa-edit'></i></a>
                                <a href='javascript:;' class='btn btn-tini btn-danger eliminarrac tu' idrac="{{ lisrac.id }}" title='Eliminar'><i class='fa fa-remove'></i></a>
                            </td>
                        </tr>
                    {% endfor %}
                    </tbody>
                    <tfoot>
                    </tfoot>
                </table>
            </div>
        </fieldset>
        <fieldset class="control-group nomargins" style="float: left; width: 100%">
            <div class="controls">
                <table class='table table-bordered' cellpadding="0" cellspacing="0">
                    <thead>
                    <tr>
                        <th style="text-align: center" width="90%">Objetivos</th>
                        <th style="text-align: center" width="10%"> <a href="javascript:;" id="itemsadicionarobj" class="btn btn-success btn-mini"><span class="fa fa-plus"></span></a></th>
                    </tr>
                    </thead>
                    <tbody id="itemsbodyobj" class="datatable">
                    {% for lisobj in listaobjetivos %}
                        <tr id="filaobj_{{ lisobj.id }}">
                            <td style='text-align: justify'><div id="columnobj{{ lisobj.id }}">{{ lisobj.descripcion }}</div></td>
                            <td style='text-align: center'>
                                <a href='javascript:;' class='btn btn-tini btn-info editobjetivo tu' id="adicionarobjetivoedit{{ lisobj.id }}" onclick="editobjetivo({{ lisobj.id }})"  title='Editar'><i class='fa fa-edit'></i></a>
                                <a href='javascript:;' class='btn btn-tini btn-danger eliminarobj tu' idobj="{{ lisobj.id }}" title='Eliminar'><i class='fa fa-remove'></i></a>
                            </td>
                        </tr>
                    {% endfor %}
                    </tbody>
                    <tfoot>
                    </tfoot>
                </table>
            </div>
        </fieldset>
        <fieldset class="control-group nomargins" style="float: left; width: 100%">
            <div class="controls">
                <table class='table table-bordered' cellpadding="0" cellspacing="0">
                    <thead>
                    <tr>
                        <th style="text-align: center" width="90%">Metodologías</th>
                        <th style="text-align: center" width="10%"> <a href="javascript:;" id="itemsadicionarmet" class="btn btn-success btn-mini"><span class="fa fa-plus"></span></a></th>
                    </tr>
                    </thead>
                    <tbody id="itemsbodymet" class="datatable">
                    {% for lismet in listametodologia %}
                        <tr id="filamet_{{ lismet.id }}">
                            <td style='text-align: justify' ><div id="columnmet{{ lismet.id }}">{{ lismet.descripcion }}</div></td>
                            <td style='text-align: center'>
                                <a href='javascript:;' class='btn btn-tini btn-info editmetodologia tu' id="adicionarmetodologiaedit{{ lismet.id }}" onclick="editmetodologia({{ lismet.id }})"  title='Editar'><i class='fa fa-edit'></i></a>
                                <a href='javascript:;' class='btn btn-tini btn-danger eliminarmet tu' idmet="{{ lismet.id }}" title='Eliminar'><i class='fa fa-remove'></i></a>
                            </td>
                        </tr>
                    {% endfor %}
                    </tbody>
                    <tfoot>
                    </tfoot>
                </table>
            </div>
        </fieldset>
    </div>&nbsp;
    <div class="tree well">
        <div align="center"><strong>CONTENIDOS PROGRAMÁTICOS CON RESULTADOS DE APRENDIZAJE</strong></div>
        <ul id="idcabecera">
            <a href="javascript:;" class="btn btn-success btn-mini tu" id="adicionarresultado" title='Adicionar Resultado de Aprendizaje'> + Adicionar</a>
            {% for conte in contenido %}
                <li id="codresultado{{ conte.id }}">
                    <a href='javascript:;' class='btn btn-tini btn-info edittema tu' id="edittemasedit{{ conte.id }}" onclick="editresultados({{ conte.id }})"  title='Editar Resultado'><i class='fa fa-edit'></i></a>-<a href="javascript:;" class="btn btn-success classunidades btn-tini tu" id="adicionarunidades{{ conte.id }}" onclick="unidades({{ conte.id }})" title='Adicionar Unidades'><i class="fa fa-plus"></i></a>-
                    {% if not programanalitico.en_uso and perms.sga.puede_eliminar_contenido_plananalitico %}
                        <a href='javascript:;' class='btn btn-tini btn-danger delresultado tu' iddelresultado="{{ conte.id }}"  title='Eliminar Resultado Aprendizaje'><i class='fa fa-remove'></i></a>-
                    {% endif %}
                    <span><i class="fa fa-folder-open"></i> <a id="nomresultado{{ conte.id }}">RESULTADO DE APRENDIZAJE {{ conte.orden }}: {{ conte.descripcion }}</a></span>
                    {#                        {% if not programanalitico.en_uso or perms.sga.puede_eliminar_contenido_plananalitico %}#}
                    {#                            <a href='javascript:;' class='btn btn-tini btn-danger delresultado tu' iddelresultado="{{ conte.id }}"  title='Eliminar Resultado Aprendizaje'><i class='fa fa-remove'></i></a>-<span><i class="fa fa-folder-open"></i> <a id="nomresultado{{ conte.id }}">RESULTADO DE APRENDIZAJE {{ conte.orden }}: {{ conte.descripcion }}</a></span>#}
                    {#                        {% endif %}#}
                    <ul id="idunidades{{ conte.id }}">
                        {% with unidadesseleccionadas=conte|call:'unidades_seleccionadas' %}
                            {% if unidadesseleccionadas %}
                                {% for unidades in unidadesseleccionadas %}
                                    <li id="eliminarunidad{{ unidades.id }}">
                                        <a href='javascript:;' class='btn btn-tini btn-info edittema tu' id="adicionartemasedit{{ temas.id }}" onclick="editunidades({{ unidades.id }})"  title='Editar Unidad'><i class='fa fa-edit'></i></a>-<a href="javascript:;" id="adicionartemas{{ unidades.id }}" onclick="temas({{ unidades.id }})" class="btn btn-success classaddtemas btn-tini tu" title='Adicionar Tema'><i class="fa fa-plus"></i></a>-
                                        {% if not programanalitico.en_uso and perms.sga.puede_eliminar_contenido_plananalitico %}
                                            <a href='javascript:;' class='btn btn-tini btn-danger delunidad tu' iddeluni="{{ unidades.id }}"  title='Eliminar Unidad'><i class='fa fa-remove'></i></a>
                                        {% endif %}
                                        -<span><i class="fa fa-minus-sign"></i><a id="nomunidad{{ unidades.id }}">UNIDAD {{ unidades.orden }}: {{ unidades.descripcion }}</a></span>

                                        {% if unidades.tiene_contenidos_minimos %}
                                            <a href='javascript:;' class='btn btn-primary btn-lg' iddeluni="{{ unidades.id }}" title='Ver contenidos mínimos' onclick="verContenidosMinimos('{{ unidades.id }}', '{{ unidades.orden }}', '{{ unidades.descripcion }}')">
                                                <i class='fa fa-eye'></i> Ver contenidos mínimos
                                            </a>
                                        {% else %}
                                            <a href='javascript:;' class='btn btn-danger btn-lg'>
                                                <i class='fa fa-eye-slash'></i> No tiene contenidos mínimos asociados
                                            </a>
                                        {% endif %}
                                        <ul id="idtemas{{ unidades.id }}">
                                            {% with temasseleccionadas=unidades|call:'temas_seleccionadas' %}
                                                {% if temasseleccionadas %}
                                                    {% for temas in temasseleccionadas %}
                                                        <li id="eliminartema{{ temas.id }}">
                                                            <a href="javascript:;" id="adicionarsubtemas{{ temas.id }}" onclick="subtemas({{ temas.id }})" class="btn btn-success classsubtemas btn-tini tu" title='Adicionar SubTema'><i class="fa fa-plus"></i></a>
                                                            <a href='javascript:;' class='btn btn-tini btn-info edittema tu' id="adicionartemasedit{{ temas.id }}" onclick="edittemas({{ temas.id }})"  title='Editar Tema'><i class='fa fa-edit'></i></a>
                                                            {% if not programanalitico.en_uso and perms.sga.puede_eliminar_contenido_plananalitico %}
                                                                <a href='javascript:;' class='btn btn-tini btn-danger deltema tu' idt="{{ temas.id }}"  title='Eliminar Tema'><i class='fa fa-remove'></i></a>
                                                            {% endif %}
                                                            {#                                                                {% if programanalitico.asignaturamalla.malla.modalidad.id == 3 %}#}
                                                            <a href="/mallas?action=editarchivosilabotema&temaid={{ temas.id }}&idprogramanalitico={{ programanalitico.id }}" class='btn btn-tini classlistaarchivos btn-{% if temas.archivo %}info{% else %}warning{% endif %} bloqueo_pantalla tu' idst="{{ temas.id }}"  title='Ingreso archivo'><i class='fa fa-file-pdf-o'></i></a>
                                                            {#                                                                {% endif %}#}
                                                            <span><i class="fa fa-minus-sign"></i> <a id="nomtema{{ temas.id }}">TEMA {{ temas.orden }}: {{ temas.descripcion }}</a></span>
                                                            <ul id="idsubtemas{{ temas.id }}">
                                                                {% with subtemasseleccionadas=temas|call:'subtemas_seleccionadas' %}
                                                                    {% if subtemasseleccionadas %}
                                                                        {% for subtemas in subtemasseleccionadas %}
                                                                            <li id="eliminarsubtema{{ subtemas.id }}">
                                                                                <a href='javascript:;' class='btn btn-tini btn-info editsubtema tu' id="adicionartemasedit{{ subtemas.id }}" onclick="editsubtemas({{ subtemas.id }})"  title='Editar SubTema'><i class='fa fa-edit'></i></a>
                                                                                {% if not programanalitico.en_uso and perms.sga.puede_eliminar_contenido_plananalitico %}
                                                                                    <a href='javascript:;' class='btn btn-tini btn-danger delsubtema tu' idst="{{ subtemas.id }}"  title='Eliminar SubTema'><i class='fa fa-remove'></i></a>
                                                                                    {#                                                                                        {% if programanalitico.asignaturamalla.malla.modalidad.id == 3 %}#}
                                                                                    <a href="/mallas?action=editcontenidosilabosubtema&subtemaid={{ subtemas.id }}&idprogramanalitico={{ programanalitico.id }}" class='btn btn-tini btn-{% if subtemas.contenido %}info{% else %}warning{% endif %} bloqueo_pantalla tu' idst="{{ subtemas.id }}"  title='Ingreso contenido'><i class='fa fa-comment'></i></a>
                                                                                    {#                                                                                        {% endif %}#}
                                                                                {% endif %}
                                                                                <span><i class="fa fa-leaf"></i> <i id="nomsubtema{{ subtemas.id }}">SUBTEMA {{ subtemas.orden }}: {{ subtemas.descripcion }}</i></span>
                                                                            </li>
                                                                        {% endfor %}
                                                                    {% endif %}
                                                                {% endwith %}
                                                            </ul>
                                                        </li>
                                                    {% endfor %}
                                                {% endif %}
                                            {% endwith %}
                                        </ul>
                                    </li>
                                {% endfor %}
                            {% endif %}
                        {% endwith %}
                    </ul>
                </li>
            {% endfor %}
        </ul>
    </div>
{% endblock %}

{% block extraalerts %}

    <div class="modal fade static" id="itemspanelobj" style="display: none;">
        <div class="modal-header">
            <h3 class="paneltitle">Adicionar Objetivos</h3>
        </div>
        <div class="modal-body panelbody">
            <div class="alert alert-info incompletoobj" style="display: none;">
                <i class="fa fa-info-sign"></i> Complete todos los campos para continuar
            </div>
            <div class="alert alert-danger" id="incompletovaloresobj" style="display: none;">
                <i class="fa fa-info-sign"></i> Revise los valores, la fecha/hora DESDE no debe ser mayor a la fecha/hora HASTA
            </div>
            <div class="alert alert-danger" id="alertaingresoobj" style="display: none;"> FECHAS YA FUERON INGRESADAS</div>
            <div class="row-fluid">
                <form id="formulario2" class='form-vertical' action="" method="POST" >
                    {{ formobjetivo }}
                </form>
            </div>
        </div>
        <div class="modal-footer">
            <a href="javascript:;" class="btn btn-success" id="adicionarycerrarobj"><i class="fa fa-plus"></i> Adicionar</a>
            <a href="javascript:;" class="btn btn-success" id="guardar"><i class="fa fa-save"></i> Guardar</a>
            <a href="javascript:;" class="btn btn-cerrar btn-info" id="cerrarobj">Cerrar</a>
        </div>
    </div>
    <div class="modal fade static" id="itemspanelrai" style="display: none;">
        <div class="modal-header">
            <h3 class="paneltitle">Adicionar resultado aprendizaje RAI</h3>
        </div>
        <div class="modal-body panelbody">
            <div class="alert alert-info incompletorai" style="display: none;">
                <i class="fa fa-info-sign"></i> Complete todos los campos para continuar
            </div>
            <div class="alert alert-danger" id="incompletovaloresrai" style="display: none;">
                <i class="fa fa-info-sign"></i> Revise los valores, la fecha/hora DESDE no debe ser mayor a la fecha/hora HASTA
            </div>
            <div class="alert alert-danger" id="alertaingresorai" style="display: none;"> FECHAS YA FUERON INGRESADAS</div>
            <div class="row-fluid">
                <form id="formulario2" class='form-vertical' action="" method="POST" >
                    {{ formrai }}
                </form>
            </div>
        </div>
        <div class="modal-footer">
            <a href="javascript:;" class="btn btn-success" id="adicionarycerrarrai"><i class="fa fa-plus"></i> Adicionar</a>
            <a href="javascript:;" class="btn btn-cerrar btn-info" id="cerrarrai">Cerrar</a>
        </div>
    </div>
    <div class="modal fade static" id="itemspanelrac" style="display: none;">
        <div class="modal-header">
            <h3 class="paneltitle">Adicionar resultado aprendizaje carrera RAC</h3>
        </div>
        <div class="modal-body panelbody">
            <div class="alert alert-info incompletorac" style="display: none;">
                <i class="fa fa-info-sign"></i> Complete todos los campos para continuar
            </div>
            <div class="alert alert-danger" id="incompletovaloresrac" style="display: none;">
                <i class="fa fa-info-sign"></i> Revise los valores, la fecha/hora DESDE no debe ser mayor a la fecha/hora HASTA
            </div>
            <div class="alert alert-danger" id="alertaingresorac" style="display: none;"> FECHAS YA FUERON INGRESADAS</div>
            <div class="row-fluid">
                <form id="formulario2" class='form-vertical' action="" method="POST" >
                    {{ formrac }}
                </form>
            </div>
        </div>
        <div class="modal-footer">
            <a href="javascript:;" class="btn btn-success" id="adicionarycerrarrac"><i class="fa fa-plus"></i> Adicionar</a>
            <a href="javascript:;" class="btn btn-cerrar btn-info" id="cerrarrac">Cerrar</a>
        </div>
    </div>
    <div class="modal fade static" id="itemspanelmet" style="display: none;">
        <div class="modal-header">
            <h3 class="paneltitle">Adicionar Metodologías</h3>
        </div>
        <div class="modal-body panelbody">
            <div class="alert alert-info incompletomet" style="display: none;">
                <i class="fa fa-info-sign"></i> Complete todos los campos para continuar
            </div>
            <div class="alert alert-danger" id="incompletovaloresmet" style="display: none;">
                <i class="fa fa-info-sign"></i> Revise los valores, la fecha/hora DESDE no debe ser mayor a la fecha/hora HASTA
            </div>
            <div class="alert alert-danger" id="alertaingresomet" style="display: none;"> FECHAS YA FUERON INGRESADAS</div>
            <div class="row-fluid">
                <form id="formulario2" class='form-vertical' action="" method="POST" >
                    {{ formmetodologia }}
                </form>
            </div>
        </div>
        <div class="modal-footer">
            <a href="javascript:;" class="btn btn-success" id="adicionarycerrarmet"><i class="fa fa-plus"></i> Adicionar</a>
            <a href="javascript:;" class="btn btn-cerrar btn-info" id="cerrarmet">Cerrar</a>
        </div>
    </div>

    <div class="modal fade static" id="itemspanelmetedit" style="display: none;">
        <div class="modal-header">
            <h3 class="paneltitle">Editar Metodologías</h3>
        </div>
        <div class="modal-body panelbody">
            <div class="alert alert-info incompletometedit" style="display: none;">
                <i class="fa fa-info-sign"></i> Complete todos los campos para continuar
            </div>
            <div class="alert alert-danger" id="incompletovaloresmetedit" style="display: none;">
                <i class="fa fa-info-sign"></i> Revise los valores, la fecha/hora DESDE no debe ser mayor a la fecha/hora HASTA
            </div>
            <div class="alert alert-danger" id="alertaingresometedit" style="display: none;"> FECHAS YA FUERON INGRESADAS</div>
            <div class="row-fluid">
                <form id="formulario2" class='form-vertical' action="" method="POST" >
                    <textarea id="id_metodologiaedit" rows="3" cols="40" name="metodologiaedit" style="text-transform: none; margin: 0px; height: 90px;"></textarea>
                    <input type="hidden" name="ocultometodologiaedit" id="ocultoid_metodologiaedit">
                </form>
            </div>
        </div>
        <div class="modal-footer">
            <a href="javascript:;" class="btn btn-success" id="adicionarycerrarmetedit"><i class="fa fa-plus"></i> Adicionar</a>
            <a href="javascript:;" class="btn btn-cerrar btn-info" id="cerrarmetedit">Cerrar</a>
        </div>
    </div>
    <div class="modal fade static" id="itemspanelraiedit" style="display: none;">
        <div class="modal-header">
            <h3 class="paneltitle">Editar RAI</h3>
        </div>
        <div class="modal-body panelbody">
            <div class="alert alert-info incompletoraiedit" style="display: none;">
                <i class="fa fa-info-sign"></i> Complete todos los campos para continuar
            </div>
            <div class="alert alert-danger" id="incompletovaloresraiedit" style="display: none;">
                <i class="fa fa-info-sign"></i> Revise los valores, la fecha/hora DESDE no debe ser mayor a la fecha/hora HASTA
            </div>
            <div class="alert alert-danger" id="alertaingresoraiedit" style="display: none;"> FECHAS YA FUERON INGRESADAS</div>
            <div class="row-fluid">
                <textarea id="id_raiedit" rows="3" cols="40" name="raiedit" style="text-transform: none; margin: 0px; height: 90px; width: 500px"></textarea>
                <input type="hidden" name="ocultoraiedit" id="ocultoid_raiedit">
            </div>
        </div>
        <div class="modal-footer">
            <a href="javascript:;" class="btn btn-success" id="adicionarycerrarraiedit"><i class="fa fa-plus"></i> Guardar</a>
            <a href="javascript:;" class="btn btn-cerrar btn-info" id="cerrarraiedit">Cerrar</a>
        </div>
    </div>
    <div class="modal fade static" id="itemspanelracedit" style="display: none;">
        <div class="modal-header">
            <h3 class="paneltitle">Editar RAC</h3>
        </div>
        <div class="modal-body panelbody">
            <div class="alert alert-info incompletoracedit" style="display: none;">
                <i class="fa fa-info-sign"></i> Complete todos los campos para continuar
            </div>
            <div class="alert alert-danger" id="incompletovaloresracedit" style="display: none;">
                <i class="fa fa-info-sign"></i> Revise los valores, la fecha/hora DESDE no debe ser mayor a la fecha/hora HASTA
            </div>
            <div class="alert alert-danger" id="alertaingresoracedit" style="display: none;"> FECHAS YA FUERON INGRESADAS</div>
            <div class="row-fluid">
                <form id="formulario2" class='form-vertical' action="" method="POST" >
                    <textarea id="id_racedit" rows="3" cols="40" name="racedit" style="text-transform: none; margin: 0px; height: 90px;"></textarea>
                    <input type="hidden" name="ocultoracedit" id="ocultoid_racedit">
                </form>
            </div>
        </div>
        <div class="modal-footer">
            <a href="javascript:;" class="btn btn-success" id="adicionarycerrarracedit"><i class="fa fa-plus"></i> Guardar</a>
            <a href="javascript:;" class="btn btn-cerrar btn-info" id="cerrarracedit">Cerrar</a>
        </div>
    </div>

    <div class="modal fade static" id="itemspanelobjedit" style="display: none;">
        <div class="modal-header">
            <h3 class="paneltitle">Editar Objetivo</h3>
        </div>
        <div class="modal-body panelbody">
            <div class="alert alert-info incompletoobjedit" style="display: none;">
                <i class="fa fa-info-sign"></i> Complete todos los campos para continuar
            </div>
            <div class="alert alert-danger" id="incompletovaloresobjedit" style="display: none;">
                <i class="fa fa-info-sign"></i> Revise los valores, la fecha/hora DESDE no debe ser mayor a la fecha/hora HASTA
            </div>
            <div class="alert alert-danger" id="alertaingresoobjedit" style="display: none;"> FECHAS YA FUERON INGRESADAS</div>
            <div class="row-fluid">
                <form id="formulario2" class='form-vertical' action="" method="POST" >
                    <textarea id="id_objetivoedit" rows="3" cols="40" name="objetivoedit" style="text-transform: none; margin: 0px; height: 90px;"></textarea>
                    <input type="hidden" name="ocultoobjetivoedit" id="ocultoid_objetivoedit">
                </form>
            </div>
        </div>
        <div class="modal-footer">
            <a href="javascript:;" class="btn btn-success" id="adicionarycerrarobjedit"><i class="fa fa-plus"></i> Guardar</a>
            <a href="javascript:;" class="btn btn-cerrar btn-info" id="cerrarobjedit">Cerrar</a>
        </div>
    </div>

    <div class="modal fade static" id="selectdelete" style="min-height: 60px">
        <div class="modal-header">
            <h4 id="paneltitle">Eliminar Objetivos</h4>
        </div>
        <div class="modal-body" id="selectdeletepar-body">
            <input type='hidden' id="idobjetivo" name="idobjetivo" value=""/>
            <p style="margin-top: 10px;">Esta seguro(a) que desea eliminar: <b id="leyenda"></b></p>
        </div>
        <div class="modal-footer">
            <p style="text-align: right; margin-bottom: 0">
                <a href="javascript:;" id="eliminacionmodal_formbutton" class='btn btn-danger btn-form'> {% block botonlabel %}Eliminar{% endblock %}</a>
                <a href="javascript:;" id="eliminacionmodal_cancel" class="btn btn-info"> Cerrar</a>
            </p>
        </div>
    </div>
    <div class="modal fade static" id="selectdeleterai" style="min-height: 60px">
        <div class="modal-header">
            <h4 id="paneltitle">Eliminar resultado RAI</h4>
        </div>
        <div class="modal-body" id="selectdeletepar-body">
            <input type='hidden' id="idcodigorai" name="idcodigorai" value=""/>
            <p style="margin-top: 10px;">Esta seguro(a) que desea eliminar: <b id="leyendarai"></b></p>
        </div>
        <div class="modal-footer">
            <p style="text-align: right; margin-bottom: 0">
                <a href="javascript:;" id="eliminacionmodalrai_formbutton" class='btn btn-danger btn-form'>Eliminar</a>
                <a href="javascript:;" id="eliminacionmodalrai_cancel" class="btn btn-info"> Cerrar</a>
            </p>
        </div>
    </div>
    <div class="modal fade static" id="selectdeleterac" style="min-height: 60px">
        <div class="modal-header">
            <h4 id="paneltitle">Eliminar resultado RAC</h4>
        </div>
        <div class="modal-body" id="selectdeletepar-body">
            <input type='hidden' id="idcodigorac" name="idcodigorac" value=""/>
            <p style="margin-top: 10px;">Esta seguro(a) que desea eliminar: <b id="leyendarac"></b></p>
        </div>
        <div class="modal-footer">
            <p style="text-align: right; margin-bottom: 0">
                <a href="javascript:;" id="eliminacionmodalrac_formbutton" class='btn btn-danger btn-form'>Eliminar</a>
                <a href="javascript:;" id="eliminacionmodalrac_cancel" class="btn btn-info"> Cerrar</a>
            </p>
        </div>
    </div>
    <div class="modal fade static" id="selectdeletemet" style="min-height: 60px">
        <div class="modal-header">
            <h4 id="paneltitle">Eliminar Metodologías</h4>
        </div>
        <div class="modal-body" id="selectdeletepar-body">
            <input type='hidden' id="idmetodologia" name="idmetodologia" value=""/>
            <p style="margin-top: 10px;">Esta seguro(a) que desea eliminar: <b id="leyendamet"></b></p>
        </div>
        <div class="modal-footer">
            <p style="text-align: right; margin-bottom: 0">
                <a href="javascript:;" id="eliminacionmodal_formbuttonmet" class='btn btn-danger btn-form'> Eliminar</a>
                <a href="javascript:;" id="eliminacionmodal_cancelmet" class="btn btn-info"> Cerrar</a>
            </p>
        </div>
    </div>
    <div class="modal fade static" id="selectdeletetema" style="min-height: 60px">
        <div class="modal-header">
            <h4 id="paneltitle">Eliminar Tema</h4>
        </div>
        <div class="modal-body" id="selectdeletepar-body">
            <input type='hidden' id="codigotema" name="codigotema" value=""/>
            <p style="margin-top: 10px;">Esta seguro(a) que desea eliminar: <b id="leyendatema"></b></p>
        </div>
        <div class="modal-footer">
            <p style="text-align: right; margin-bottom: 0">
                <a href="javascript:;" id="eliminacionmodal_formbuttontema" class='btn btn-danger btn-form'> Eliminar</a>
                <a href="javascript:;" id="eliminacionmodal_canceltema" class="btn btn-info"> Cerrar</a>
            </p>
        </div>
    </div>

    <div class="modal fade static" id="selectdeleteunidad" style="min-height: 60px">
        <div class="modal-header">
            <h4 id="paneltitle">Eliminar Unidad</h4>
        </div>
        <div class="modal-body" id="selectdeletepar-body">
            <input type='hidden' id="codigounidad" name="codigounidad" value=""/>
            <p style="margin-top: 10px;">Esta seguro(a) que desea eliminar: <b id="leyendaunidad"></b></p>
        </div>
        <div class="modal-footer">
            <p style="text-align: right; margin-bottom: 0">
                <a href="javascript:;" id="eliminacionmodal_formbuttonunidad" class='btn btn-danger btn-form'> Eliminar</a>
                <a href="javascript:;" id="eliminacionmodal_cancelunidad" class="btn btn-info"> Cerrar</a>
            </p>
        </div>
    </div>

    <div class="modal fade static" id="selectdeleteresultado" style="min-height: 60px">
        <div class="modal-header">
            <h4 id="paneltitle">Eliminar Resultado Aprendizaje</h4>
        </div>
        <div class="modal-body" id="selectdeletepar-body">
            <input type='hidden' id="codigoresultado" name="codigoresultado" value=""/>
            <p style="margin-top: 10px;">Esta seguro(a) que desea eliminar: <b id="leyendaresultado"></b></p>
        </div>
        <div class="modal-footer">
            <p style="text-align: right; margin-bottom: 0">
                <a href="javascript:;" id="eliminacionmodal_formbuttonresultado" class='btn btn-danger btn-form'> Eliminar</a>
                <a href="javascript:;" id="eliminacionmodal_cancelresultado" class="btn btn-info"> Cerrar</a>
            </p>
        </div>
    </div>

    <div class="modal fade static" id="selectdeletesubtema" style="min-height: 60px">
        <div class="modal-header">
            <h4 id="paneltitle">Eliminar SubTema</h4>
        </div>
        <div class="modal-body" id="selectdeletepar-body">
            <input type='hidden' id="codigosubtema" name="codigosubtema" value=""/>
            <p style="margin-top: 10px;">Esta seguro(a) que desea eliminar: <b id="leyendasubtema"></b></p>
        </div>
        <div class="modal-footer">
            <p style="text-align: right; margin-bottom: 0">
                <a href="javascript:;" id="eliminacionmodal_formbuttonsubtema" class='btn btn-danger btn-form'> Eliminar</a>
                <a href="javascript:;" id="eliminacionmodal_cancelsubtema" class="btn btn-info"> Cerrar</a>
            </p>
        </div>
    </div>

    {#    PANTALLAS MODAL PARA LE MENU TREE#}
    <div class="modal fade static" id="itemspanelresultado" style="display: none;">
        <div class="modal-header">
            <h3 class="paneltitle">Adicionar Resultados de Aprendizajes</h3>
        </div>
        <div class="modal-body panelbody">
            <div class="alert alert-info incompletoresultado" style="display: none;">
                <i class="fa fa-info-sign"></i> Complete todos los campos para continuar
            </div>
            <div class="alert alert-danger" id="incompletovaloresresultado" style="display: none;">
                <i class="fa fa-info-sign"></i> Revise los valores, la fecha/hora DESDE no debe ser mayor a la fecha/hora HASTA
            </div>
            <div class="alert alert-danger" id="alertaingresoresultado" style="display: none;"> FECHAS YA FUERON INGRESADAS</div>
            <div class="row-fluid">
                <form id="formulario2" class='form-vertical' action="" method="POST" >
                    Descripción:<input type="text" name="resultado" id="id_resultado">
                    N.:<br><input type="text" name="ordenresultado" id="id_ordenresultado" class="imp-numbermed-right">
                </form>
            </div>
        </div>
        <div class="modal-footer">
            <a href="javascript:;" class="btn btn-success" id="adicionarycerrarresultado"><i class="fa fa-plus"></i> Guardar</a>
            <a href="javascript:;" class="btn btn-cerrar btn-info" id="cerrarresultado">Cerrar</a>
        </div>
    </div>
    <div class="modal fade static" id="itemspanelunidades" style="display: none;">
        <div class="modal-header">
            <h3 class="paneltitle">Adicionar Unidades</h3>
        </div>
        <div class="modal-body panelbody">
            <div class="alert alert-info incompletounidades" style="display: none;">
                <i class="fa fa-info-sign"></i> Complete todos los campos para continuar
            </div>
            <div class="alert alert-danger" id="incompletovaloresunidades" style="display: none;">
                <i class="fa fa-info-sign"></i> Revise los valores, la fecha/hora DESDE no debe ser mayor a la fecha/hora HASTA
            </div>
            <div class="alert alert-danger" id="alertaingresounidades" style="display: none;"> FECHAS YA FUERON INGRESADAS</div>
            <div class="row-fluid">
                <form id="formulario2" class='form-vertical' action="" method="POST" >
                    {% csrf_token %}
                    Descripción: <input type="text" name="unidades" id="id_unidades">
                    N.:<br><input type="text" name="ordenunidades" id="id_ordenunidades" class="imp-numbermed-right">
                    <br>
                    {% if contenidos %}
                        Contenidos mínimos:
                        <br>
                        <select name="contminimo" id="id_contminimo" multiple style="width: 100%;">
                            {% for contenido in contenidos %}
                                <option value="{{ contenido.id }}">{{ contenido.descripcioncontenido }}</option>
                            {% endfor %}
                        </select>
                    {% endif %}
                    <input type="hidden" name="uni" id="iduni">
                </form>
            </div>
        </div>
        <div class="modal-footer">
            <a href="javascript:;" class="btn btn-success" id="adicionarycerrarunidades"><i class="fa fa-plus"></i> Guardar</a>
            <a href="javascript:;" class="btn btn-cerrar btn-info" id="cerrarunidades">Cerrar</a>
        </div>
    </div>

    <div class="modal fade" id="contenidosMinimosModal" tabindex="-1" role="dialog" aria-labelledby="contenidosMinimosModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="contenidosMinimosModalLabel">UNIDAD <span id="unidadNombre"></span> | Contenidos mínimos registrados</h5>
                </div>
                <div class="modal-body">
                    <ul id="contenidosMinimosList" class="list-group">
                        <!-- Los contenidos mínimos se agregarán aquí dinámicamente -->
                    </ul>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-danger" data-dismiss="modal">Cerrar</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade static" id="itemspaneltemas" style="display: none;">
        <div class="modal-header">
            <h3 class="paneltitle">Adicionar Temas</h3>
        </div>
        <div class="modal-body panelbody">
            <div class="alert alert-info incompletotemas" style="display: none;">
                <i class="fa fa-info-sign"></i> Complete todos los campos para continuar
            </div>
            <div class="alert alert-danger" id="incompletovalorestemas" style="display: none;">
                <i class="fa fa-info-sign"></i> Revise los valores, la fecha/hora DESDE no debe ser mayor a la fecha/hora HASTA
            </div>
            <div class="alert alert-danger" id="alertaingresotemas" style="display: none;"> FECHAS YA FUERON INGRESADAS</div>
            <div class="row-fluid">
                <form id="formulario2" class='form-vertical' action="" method="POST" >
                    Descripción: <input type="text" name="temas" id="id_temas">
                    N.:<br><input type="text" name="ordentemas" id="id_ordentemas" class="imp-numbermed-right">
                    <input type="hidden" name="tem" id="idtem">
                </form>
            </div>
        </div>
        <div class="modal-footer">
            <a href="javascript:;" class="btn btn-success" id="adicionarycerrartemas"><i class="fa fa-plus"></i> Guardar</a>
            <a href="javascript:;" class="btn btn-cerrar btn-info" id="cerrartemas">Cerrar</a>
        </div>
    </div>
    <div class="modal fade static" id="itemspanelsubtemas" style="display: none;">
        <div class="modal-header">
            <h3 class="paneltitle">Adicionar SubTemas</h3>
        </div>
        <div class="modal-body panelbody">
            <div class="alert alert-info incompletosubtemas" style="display: none;">
                <i class="fa fa-info-sign"></i> Complete todos los campos para continuar
            </div>
            <div class="alert alert-danger" id="incompletovaloressubtemas" style="display: none;">
                <i class="fa fa-info-sign"></i> Revise los valores, la fecha/hora DESDE no debe ser mayor a la fecha/hora HASTA
            </div>
            <div class="alert alert-danger" id="alertaingresosubtemas" style="display: none;"> FECHAS YA FUERON INGRESADAS</div>
            <div class="row-fluid">
                <form id="formulario2" class='form-vertical' action="" method="POST" >
                    <input type="text" name="subtemas" id="id_subtemas">
                    N.:<br><input type="text" name="ordensubtemas" id="id_ordensubtemas" class="imp-numbermed-right">
                    <input type="hidden" name="subtem" id="idsubtem">
                </form>
            </div>
        </div>
        <div class="modal-footer">
            <a href="javascript:;" class="btn btn-success" id="adicionarycerrarsubtemas"><i class="fa fa-plus"></i> Guardar</a>
            <a href="javascript:;" class="btn btn-cerrar btn-info" id="cerrarsubtemas">Cerrar</a>
        </div>
    </div>
    {#    PANTALLAS MODAL EDITAR PARA LE MENU TREE#}
    <div class="modal fade static" id="itemspanelresultadoedit" style="display: none;">
        <div class="modal-header">
            <h3 class="paneltitle">Editar Resultados de Aprendizajes</h3>
        </div>
        <div class="modal-body panelbody">
            <div class="alert alert-info incompletoresultadoedit" style="display: none;">
                <i class="fa fa-info-sign"></i> Complete todos los campos para continuar
            </div>
            <div class="alert alert-danger" id="incompletovaloresresultadoedit" style="display: none;">
                <i class="fa fa-info-sign"></i> Revise los valores, la fecha/hora DESDE no debe ser mayor a la fecha/hora HASTA
            </div>
            <div class="alert alert-danger" id="alertaingresoresultadoedit" style="display: none;"> FECHAS YA FUERON INGRESADAS</div>
            <div class="row-fluid">
                <form id="formulario2" class='form-vertical' action="" method="POST" >
                    Descripción:<input type="text" name="resultadoedit" id="id_resultadoedit">
                    N.:<br><input type="text" name="ordenresultadoedit" id="id_ordenresultadoedit" class="imp-numbermed-right">
                    <input type="hidden" name="resuledit" id="idresuledit">
                </form>
            </div>
        </div>
        <div class="modal-footer">
            <a href="javascript:;" class="btn btn-success" id="adicionarycerrarresultadoedit"><i class="fa fa-plus"></i> Guardar</a>
            <a href="javascript:;" class="btn btn-cerrar btn-info" id="cerrarresultadoedit">Cerrar</a>
        </div>
    </div>
    <div class="modal fade static" id="itemspanelunidadesedit" style="display: none;">
        <div class="modal-header">
            <h3 class="paneltitle">Editar Unidades</h3>
        </div>
        <div class="modal-body panelbody">
            <div class="alert alert-info incompletounidadesedit" style="display: none;">
                <i class="fa fa-info-sign"></i> Complete todos los campos para continuar
            </div>
            <div class="alert alert-danger" id="incompletovaloresunidadesedit" style="display: none;">
                <i class="fa fa-info-sign"></i> Revise los valores, la fecha/hora DESDE no debe ser mayor a la fecha/hora HASTA
            </div>
            <div class="alert alert-danger" id="alertaingresounidadesedit" style="display: none;"> FECHAS YA FUERON INGRESADAS</div>
            <div class="row-fluid">
                <form id="formulario2" class='form-vertical' action="" method="POST" >
                    Descripción: <input type="text" name="unidadesedit" id="id_unidadesedit">
                    N.:<br><input type="text" name="ordenunidadesedit" id="id_ordenunidadesedit" class="imp-numbermed-right">
                    <br>Resultado Aprendizaje.:<br>
                    <select id="id_resultadoaprendizaje" style="width: 450px" class="imp-numbermed-right">
                        <option  value="0">Resultados</option>
                        {% for cont in  contenido %}
                            <option  value="{{ cont.id }}">{{ cont }}</option>
                        {% endfor %}
                    </select>
                    <br>
                    {% if contenidos %}
                        Contenidos mínimos:
                        <br>
                        <select class = "select2" name="contminimoedit" id="id_contminimoedit" multiple style="width: 100%;">
                            {% for contenido in contenidos %}
                                <option value="{{ contenido.id }}"
                                    {% if contenido.id in contenidos_minimos %}
                                        selected
                                    {% endif %}
                                >{{ contenido.descripcioncontenido }}</option>
                            {% endfor %}
                        </select>
                    {% endif %}
                    <input type="hidden" name="uniedit" id="iduniedit">
                </form>
            </div>
        </div>
        <div class="modal-footer">
            <a href="javascript:;" class="btn btn-success" id="adicionarycerrarunidadesedit"><i class="fa fa-plus"></i> Guardar</a>
            <a href="javascript:;" class="btn btn-cerrar btn-info" id="cerrarunidadesedit">Cerrar</a>
        </div>
    </div>
    <div class="modal fade static" id="itemspaneltemasedit" style="display: none;">
        <div class="modal-header">
            <h3 class="paneltitle">Editar Temas</h3>
        </div>
        <div class="modal-body panelbody">
            <div class="alert alert-info incompletotemasedit" style="display: none;">
                <i class="fa fa-info-sign"></i> Complete todos los campos para continuar
            </div>
            <div class="alert alert-danger" id="incompletovalorestemasedit" style="display: none;">
                <i class="fa fa-info-sign"></i> Revise los valores, la fecha/hora DESDE no debe ser mayor a la fecha/hora HASTA
            </div>
            <div class="alert alert-danger" id="alertaingresotemasedit" style="display: none;"> FECHAS YA FUERON INGRESADAS</div>
            <div class="row-fluid">
                <form id="formulario2" class='form-vertical' action="" method="POST" >
                    Unidad.:<br>
                    <select id="codigounidades" name="codigounidades" style="width: 370px;">
                        <option></option>
                    </select><br>
                    Descripción: <input type="text" name="temasedit" id="id_temasedit">
                    N.:<br><input type="text" name="ordentemasedit" id="id_ordentemasedit" class="imp-numbermed-right">
                    <input type="hidden" name="temedit" id="idtemedit">
                </form>
            </div>
        </div>
        <div class="modal-footer">
            <a href="javascript:;" class="btn btn-success" id="adicionarycerrartemasedit"><i class="fa fa-plus"></i> Guardar</a>
            <a href="javascript:;" class="btn btn-cerrar btn-info" id="cerrartemasedit">Cerrar</a>
        </div>
    </div>
    <div class="modal fade static" id="itemspanelsubtemasedit" style="display: none;">
        <div class="modal-header">
            <h3 class="paneltitle">Editar SubTemas</h3>
        </div>
        <div class="modal-body panelbody">
            <div class="alert alert-info incompletosubtemasedit" style="display: none;">
                <i class="fa fa-info-sign"></i> Complete todos los campos para continuar
            </div>
            <div class="alert alert-danger" id="incompletovaloressubtemasedit" style="display: none;">
                <i class="fa fa-info-sign"></i> Revise los valores, la fecha/hora DESDE no debe ser mayor a la fecha/hora HASTA
            </div>
            <div class="alert alert-danger" id="alertaingresotemasedit" style="display: none;"> FECHAS YA FUERON INGRESADAS</div>
            <div class="row-fluid">
                <form id="formulario2" class='form-vertical' action="" method="POST" >
                    Descripción: <input type="text" name="subtemasedit" id="id_subtemasedit">
                    N.:<br><input type="text" name="ordensubtemasedit" id="id_ordensubtemasedit" class="imp-numbermed-right">
                    <input type="hidden" name="subtemedit" id="idsubtemedit">
                </form>
            </div>
        </div>
        <div class="modal-footer">
            <a href="javascript:;" class="btn btn-success" id="adicionarycerrarsubtemasedit"><i class="fa fa-plus"></i> Guardar</a>
            <a href="javascript:;" class="btn btn-cerrar btn-info" id="cerrarsubtemasedit">Cerrar</a>
        </div>
    </div>


{% endblock %}