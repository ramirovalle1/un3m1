{% extends "base.html" %}
{% load sga_extras %}
{% load humanize %}
{% block heading %}
    <link href="/static/css/table-responsive.css?1.0.0" type="text/css" rel="stylesheet"/>
    <script type="text/javascript" src='/static/js/select2.js?v=1.0.0'></script>
    <link type='text/css' rel='stylesheet' href="/static/css/select2.css?v=1.0.0"/>
    <link href="/static/bootstrap5/libs/datepicker/css/bootstrap-datepicker.css" rel="stylesheet">
    <script src="/static/bootstrap5/libs/datepicker/js/bootstrap-datepicker.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.3/font/bootstrap-icons.css">
    <script type="text/javascript" src="/static/js/jquery.fancybox.pack.js?v=1.0.0"></script>
    <link rel="stylesheet" href="/static/css/jquery.fancybox.css?v=1.0.0" type="text/css" media="screen"/>
    <style>
        .nav-link.active {
            border-bottom: 2px solid #fe9900b0 !important;
        }

        .nav-link:hover {
            border-bottom: 2px solid #fe9900b0 !important;
            opacity: .9;
        }

        .modulecard:hover {
            transform: scale(99%);
            background: #EAF2F8;
        }

        .select2-selection__rendered {
            font-size: 15px;
            font-weight: bold;
        }

        .select2-selection.select2-selection--single {
            border-radius: 0 !important;
            border: 0;
        }

        table.table thead th, table.table thead td {
            text-transform: uppercase;
            text-align: center;
        }

        table.table tbody th, table.table tbody td {
            vertical-align: middle;
        }

        .border-right-filters {
            border-right: 2px solid #f0f0f0;
        }

        .filter-select {
            width: 100%
        }

        #searchinput {
            border: 0.5px solid #18113c2e;
        }

    </style>
    <script>
        $(function () {

            $(".fancybox").fancybox();

            $('#search_incidente').on('onKeyDown', function () {
                $('#form-filters').submit();
            });

            $('select').select2();

            $('#btn-reportes').on('show.bs.dropdown', function () {
                $('#icon-btn-reportes').removeClass('fa-folder').addClass('fa-folder-open');
            }).on('hide.bs.dropdown', function () {
                $('#icon-btn-reportes').removeClass('fa-folder-open').addClass('fa-folder');
            });

            ItemsDisplay = function (item) {
                if (item.name) {
                    return $('<span>' + item.name + '</span>');
                } else {
                    //return '---------';
                }
            };
            $("#id_tecnico").select2({
                //placeholder: "---------",
                allowClear: true,
                ajax: {
                    url: function (params) {
                        return "/reportes?action=data&model=HdDetalle_Grupo&p=1&s=10&q=" + params.term;
                    },
                    dataType: 'json',
                    delay: 250,
                    data: function (params) {
                        return {
                            q: params.term,
                            page: params.page
                        };
                    },
                    processResults: function (data, params) {
                        // parse the results into the format expected by Select2
                        // since we are using custom formatting functions we do not need to
                        // alter the remote JSON data, except to indicate that infinite
                        // scrolling can be used
                        params.page = params.page || 1;

                        return {
                            results: data.results,
                            pagination: {
                                more: (params.page * 30) < data.total_count
                            }
                        };
                    },
                    cache: true
                }
                ,
                escapeMarkup: function (markup) {
                    return markup;
                }, // let our custom formatter work
                minimumInputLength: 1,
                templateResult: ItemsDisplay, // omitted for brevity, see the source of this page
                templateSelection: ItemsDisplay
            });

            $("#id_bloquepdf").select2({minimumResultsForSearch: 2});
            $("#id_estadopdf").select2({minimumResultsForSearch: 2});
            $("#id_tecnicopdf").select2({minimumResultsForSearch: 2});

            ItemsDisplay = function (item) {
                if (item.name) {
                    return $('<span>' + item.name + '</span>');
                } else {
                    // return '---------';
                }
            };
            $("#id_tecnicopdf").select2({
                //placeholder: "---------",
                allowClear: true,
                ajax: {
                    url: function (params) {
                        return "/reportes?action=data&model=HdDetalle_Grupo&p=1&s=10&q=" + params.term;
                    },
                    dataType: 'json',
                    delay: 250,
                    data: function (params) {
                        return {
                            q: params.term,
                            page: params.page
                        };
                    },
                    processResults: function (data, params) {
                        // parse the results into the format expected by Select2
                        // since we are using custom formatting functions we do not need to
                        // alter the remote JSON data, except to indicate that infinite
                        // scrolling can be used
                        params.page = params.page || 1;

                        return {
                            results: data.results,
                            pagination: {
                                more: (params.page * 30) < data.total_count
                            }
                        };
                    },
                    cache: true
                }
                ,
                escapeMarkup: function (markup) {
                    return markup;
                }, // let our custom formatter work
                minimumInputLength: 1,
                templateResult: ItemsDisplay, // omitted for brevity, see the source of this page
                templateSelection: ItemsDisplay
            });

            $("#checktodosexc").on('change', function () {
                //cod = $("#id_tipoincidente").val();
                if ($("#checktodosexc").is(':checked')) {
                    $("#id_tecnico").attr('disabled', 'disabled');
                    $('input[name=checktodosexc]').val(1);
                } else {
                    $("#id_tecnico").removeAttr('disabled');
                    $('input[name=checktodosexc]').val(0);  //alert($(this).val());
                }
            });
            $("#checktodospdf").on('change', function () {
                //cod = $("#id_tipoincidente").val();
                if ($("#checktodospdf").is(':checked')) {
                    $("#id_tecnicopdf").attr('disabled', 'disabled');
                    $('input[name=checktodospdf]').val(1);
                } else {
                    $("#id_tecnicopdf").removeAttr('disabled');
                    $('input[name=checktodospdf]').val(0);  //alert($(this).val());
                }
            });

            $("#id_fecha_inicio, #id_fecha_fin, #id_fecha_iniciopartes, #id_fecha_finpartes, #id_fecha_inicioencuesta, #id_fecha_finencuesta, #id_fecha_inicioencuestaexcel, #id_fecha_finencuestaexcel").datepicker({format: "dd-mm-yyyy"}).on('changeDate', function (ev) {
                $(this).datepicker('hide');
            });
            $("#id_fecha_de").datepicker({format: "dd-mm-yyyy"}).on('changeDate', function (ev) {
                $(this).datepicker('hide');
            });
            $("#id_fecha_hasta").datepicker({format: "dd-mm-yyyy"}).on('changeDate', function (ev) {
                $(this).datepicker('hide');
            });
            $("#id_fecha_deh").datepicker({format: "dd-mm-yyyy"}).on('changeDate', function (ev) {
                $(this).datepicker('hide');
            });
            $("#id_fecha_hastah").datepicker({format: "dd-mm-yyyy"}).on('changeDate', function (ev) {
                $(this).datepicker('hide');
            });
            $("#id_fecha_dehpdf").datepicker({format: "dd-mm-yyyy"}).on('changeDate', function (ev) {
                $(this).datepicker('hide');
            });
            $("#id_fecha_hastahpdf").datepicker({format: "dd-mm-yyyy"}).on('changeDate', function (ev) {
                $(this).datepicker('hide');
            });
            var tabhelpdeskadmin = localStorage.getItem('tabhelpdeskadmin');
            if (!tabhelpdeskadmin) {
                tabhelpdeskadmin = "#1";
                localStorage.setItem("tabhelpdeskadmin", tabhelpdeskadmin);
            }

            $('.tabs').each(function () {
                if ($(this).attr('href') == tabhelpdeskadmin) {
                    $(this).trigger('click');
                }
            }).click(function () {
                localStorage.setItem("tabhelpdeskadmin", $(this).attr('href'));
            });

            $("#itemspanel .btn-cerrar").click(function () {
                $("#itemspanel").modal("hide");
                return false;
            });
            $(".cerrar_detalle").click(function () {
                $("#itemspanel").modal("hide");
            });

            busqueda = function () {
                bloqueointerface();
                $('#form-filters').submit();
            };

            $("#search").click(function () {
                busqueda();
            });

            $('#searchinput').keyup(function (e) {
                if (e.keyCode == 13) {
                    debugger;
                    busqueda();
                }
            });
            $("#estado_list").change(function () {
                busqueda();
            });

            $("#idgrupo").on('select2:select', function (e) {
                busqueda();
            });

            $("#equipo_codigo").change(function () {
                busqueda();
            });

            $(".tl").tooltip({position: "center up"});

            $("#cerrar_excel").click(function () {
                document.getElementById('id_fecha_de').value = '';
                document.getElementById('id_fecha_hasta').value = '';
                $('#itemspanelreportegeneral_excel').modal('hide');
            });
            $(".generar_reporte_general_excel").click(function () {
                $(".panelbody").html();
                $("#itemspanelreportegeneral_excel").modal({backdrop: 'static', width: '450px'}).modal('show');

            });
            $("#generar_excel").click(function () {
                var fechade = $("#id_fecha_de").val();
                var fechahasta = $("#id_fecha_hasta").val();
                location.href = "/helpdesk_hdincidente?action=reportegeneral_excel&de=" + fechade + "&hasta=" + fechahasta;
                document.getElementById('id_fecha_de').value = '';
                document.getElementById('id_fecha_hasta').value = '';
                $('#itemspanelreportegeneral_excel').modal('hide');
            });


            $("#cerrar_excelh").click(function () {
                document.getElementById('id_fecha_deh').value = '';
                document.getElementById('id_fecha_hastah').value = '';
                $('#itemspanelreportegeneral_excelh').modal('hide');
            });
            $(".generar_reporte_general_excelh").click(function () {
                $(".panelbody").html();
                $("#itemspanelreportegeneral_excelh").modal({backdrop: 'static', width: '700px'}).modal('show');

            });
            $("#generar_excelh").click(function () {
                var fechade = $("#id_fecha_deh").val();
                var fechahasta = $("#id_fecha_hastah").val();
                var tecnico = $("#id_tecnico").val();
                var bloque = $("#id_bloque").val();
                var estado = $("#id_estado").val();
                var checktodos = $("#checktodosexc").val();

                location.href = "/helpdesk_hdincidente?action=reportegeneral_excelcompleto&de=" + fechade + "&hasta=" + fechahasta + "&tecnico=" + tecnico + "&bloque=" + bloque + "&estado=" + estado + "&checktodos=" + checktodos;
                document.getElementById('id_fecha_de').value = '';
                document.getElementById('id_fecha_hasta').value = '';
                $('#itemspanelreportegeneral_excelh').modal('hide');
            });


            $("#cerrar_excelhpdf").click(function () {

                document.getElementById('id_fecha_dehpdf').value = '';
                document.getElementById('id_fecha_hastahpdf').value = '';
                $('#itemspanelreportegeneral_excelhpdf').modal('hide');
            });
            $(".generar_reporte_general_excelhpdf").click(function () {
                $(".panelbody").html();
                $("#itemspanelreportegeneral_excelhpdf").modal({backdrop: 'static', width: '700px'}).modal('show');

            });
            $("#generar_excelhpdf").click(function () {
                var fechade = $("#id_fecha_dehpdf").val();
                var fechahasta = $("#id_fecha_hastahpdf").val();
                var tecnico = $("#id_tecnicopdf").val();
                var bloque = $("#id_bloquepdf").val();
                var estado = $("#id_estadopdf").val();
                var checktodos = $("#checktodospdf").val();

                location.href = "/helpdesk_hdincidente?action=ordenpdf&de=" + fechade + "&hasta=" + fechahasta + "&tecnico=" + tecnico + "&bloque=" + bloque + "&estado=" + estado + "&checktodos=" + checktodos;
                document.getElementById('id_fecha_de').value = '';
                document.getElementById('id_fecha_hasta').value = '';
                $('#itemspanelreportegeneral_excelh').modal('hide');
            });


            $(".informeincidente").click(function () {
                $("#itemspanel3").modal({backdrop: 'static', width: '290'}).modal('show');
            });

            $("#itemspanel_cerrar_3").click(function () {
                $("#itemspanel3").modal('hide');
                $(".invalidofechas").hide();
            });

            $("#itemspanel_adicionar_3").click(function () {
                $(".invalidofechas").hide();
                var ini = $("#id_fecha_inicio").val();
                var fin = $("#id_fecha_fin").val();
                if (ini && fin && ini <= fin) {
                    $("#itemspanel3").modal('hide');
                    openwindow('POST', '/helpdesk_hdincidente', {
                        action: 'informeincidente',
                        'ini': ini,
                        'fin': fin,
                        'g': 1
                    }, '_blank');
                } else {
                    $(".invalidofechas").show();
                }
            });
            $(".informeencuestaexcel").click(function () {
                $("#itemspanelencuestaexcel").modal({backdrop: 'static', width: '290'}).modal('show');
            });
            $("#itemspanel_cerrar_encuestaexcel").click(function () {
                $("#itemspanelencuestaexcel").modal('hide');
                $(".invalidoencuestaexcel").hide();
            });
            $("#generar_excelencuesta").click(function () {
                var fechade = $("#id_fecha_inicioencuestaexcel").val();
                var fechahasta = $("#id_fecha_finencuestaexcel").val();
                location.href = "/helpdesk_hdincidente?action=excellistaencuesta&ini=" + fechade + "&fin=" + fechahasta;
                document.getElementById('id_fecha_inicioencuestaexcel').value = '';
                document.getElementById('id_fecha_finencuestaexcel').value = '';
                $('#itemspanelencuestaexcel').modal('hide');
            });


            $(".informeencuesta").click(function () {
                $("#itemspanelencuesta").modal({backdrop: 'static', width: '290'}).modal('show');
            });
            $("#itemspanel_cerrar_encuesta").click(function () {
                $("#itemspanelencuesta").modal('hide');
                $(".invalidoencuesta").hide();
            });
            $("#itemspanel_adicionar_encuesta").click(function () {
                $(".invalidoencuesta").hide();
                var ini = $("#id_fecha_inicioencuesta").val();
                var fin = $("#id_fecha_finencuesta").val();
                if (ini && fin && ini <= fin) {
                    $("#itemspanelencuesta").modal('hide');
                    openwindow('POST', '/helpdesk_hdincidente', {
                        action: 'pdflistaencuesta',
                        'ini': ini,
                        'fin': fin,
                        'g': 1
                    }, '_blank');
                } else {
                    $(".invalidoencuesta").show();
                }
            });
            $(".informeincidentepartes").click(function () {
                $("#itemspanelpartes").modal({backdrop: 'static', width: '290'}).modal('show');
            });
            $("#itemspanel_cerrar_partes").click(function () {
                $("#itemspanelpartes").modal('hide');
                $(".invalidopartes").hide();
            });
            $("#itemspanel_adicionar_partes").click(function () {
                $(".invalidopartes").hide();
                var ini = $("#id_fecha_iniciopartes").val();
                var fin = $("#id_fecha_finpartes").val();
                if (ini && fin && ini <= fin) {
                    $("#itemspanelpartes").modal('hide');
                    openwindow('POST', '/helpdesk_hdincidente', {
                        action: 'pdflistapartes',
                        'ini': ini,
                        'fin': fin,
                        'g': 1
                    }, '_blank');
                } else {
                    $(".invalidopartes").show();
                }
            });
            $(".mostrardetalle").click(function () {
                $("#aprobarcerrar").css('display', 'none');
                var id = $(this).attr('idd');
                bloqueointerface();
                $.get("/helpdesk_hdincidentetic", {'action': 'modaldetalle', 'id': id}, function (data) {
                    $.unblockUI();
                    if (data.result == 'ok') {
                        $(".panelbody").html(data.data);
                        $("#itemspanel").modal({backdrop: 'static', width: '1200px', height: '510px'}).modal('show');
                    } else {
                        smoke.alert(data.mensaje);
                    }
                }, 'json');
            });


            $(".seleccionaractivo").click(function () {
                var id = $(this).attr('id');
                $('#guardar').attr('id', $(this).attr('id'));
                $("#itemspanelseleccionaractivo").modal({
                    backdrop: 'static',
                    width: '500px',
                    height: '100px'
                }).modal('show');
            });
            ItemsDisplay = function (item) {
                if (item.name) {
                    return $('<span>' + item.name + '</span>');
                } else {
                    return '---------';
                }
            };

            $("#id_activo_select2").select2({
                placeholder: "-------------------------------------------",
                allowClear: true,
                ajax: {
                    url: function (params) {
                        {#                        return "/reportes?action=data&model=ActivoFijo&p=1&s=10&q=" + params.term;#}
                        return "/helpdesk_hdincidente?action=buscaractivo&q=" + params.term + "&idt=" + 0;
                    },
                    dataType: 'json',
                    delay: 400,
                    data: function (params) {
                        return {
                            q: params.term,
                            page: params.page
                        };
                    },
                    processResults: function (data, params) {
                        // parse the results into the format expected by Select2
                        // since we are using custom formatting functions we do not need to
                        // alter the remote JSON data, except to indicate that infinite
                        // scrolling can be used
                        params.page = params.page || 1;

                        return {
                            results: data.results,
                            pagination: {
                                more: (params.page * 30) < data.total_count
                            }
                        };
                    },
                    cache: true
                },
                escapeMarkup: function (markup) {
                    return markup;
                }, // let our custom formatter work
                minimumInputLength: 1,
                templateResult: ItemsDisplay, // omitted for brevity, see the source of this page
                templateSelection: ItemsDisplay // omitted for brevity, see the source of this page
            }).on("select2:select", function (evt) {
                $("#id_activo").attr({"value": (evt.params.data.id)});
            });
            $("#itemspanelseleccionaractivo .btn-cerrar").click(function () {
                $("#itemspanelseleccionaractivo").modal("hide");
            });
            $("#itemspanelseleccionaractivo #guardar").click(function () {
                var ida = $("#id_activo").val();
                var id = $(this).attr('id');
                if (parseInt(ida) > 0) {
                    bloqueointerface();
                    $.post("/helpdesk_hdincidente", {
                        'action': 'seleccionaractivo',
                        'id': id,
                        'ida': ida
                    }, function (data) {
                        $.unblockUI();
                        if (data.result == 'ok') {
                            $("#incidetesincodigo_" + id).empty();
                            $("#itemspanelseleccionaractivo").modal("hide");
                        } else {
                            smoke.alert(data.mensaje);
                        }
                    }, 'json');
                } else {
                    smoke.alert('Debe seleccionar un activo');
                }
            });
            $(".generarot").click(function () {
                var id = $(this).attr('idr');
                openwindow('POST', '/helpdesk_hdincidente', {action: 'generarot', 'id': id}, '_blank');
            });
            $(".imprimirincidente").click(function () {
                var id = $(this).attr('idr');
                openwindow('POST', '/helpdesk_hdincidente', {action: 'imprimirincidente', 'id': id}, '_blank');
            });

            $(".detalleactivo").click(function () {
                var id = $(this).attr("cid");
                bloqueointerface();
                $.ajax({
                    type: "POST",
                    url: "/helpdesk_hdincidente",
                    data: {'action': 'detalle_activo', 'id': id},
                    success: function (data) {
                        $.unblockUI();
                        if (data.result == 'ok') {
                            $("#detalleactivomodal_body").html(data.html);
                            $("#detalleactivomodal").modal({"backdrop": "static", "width": "1000px"}).modal("show");
                        } else {
                            smoke.alert(data.mensaje);
                        }
                    },
                    error: function () {
                        $.unblockUI();
                        smoke.alert("Error de conexión.");
                    },
                    dataType: "json"
                });
                return false;
            });

            $("#detalleactivomodal_aceptar").click(function () {
                $("#detalleactivomodal").modal("hide");
            });

        });
    </script>
{% endblock %}
{% block canvas %}

    <div class='row'>
        <div class='col-lg-12 ps-1'>
            <div class="headtitle">
                <h3 class="texto-blue">{{ title }}</h3>
                <h5 class="fs-6 ps-2">{{ administrador }} {{ cargo }}</h5>
            </div>
        </div>
    </div>
    <div class="row">
        <div class='col-12'>
            <div class="card">
                <div class="card-header">
                    <ul class="nav nav-lb-tab" id="tab" role="tablist">
                        <li class="nav-item">
                            <a class="nav-link active fw-lighter" id="table-tab" data-bs-toggle="pill" href="#table"
                               role="tab" aria-controls="table" aria-selected="true">Activos</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link fw-lighter" id="config-tab" data-bs-toggle="pill" href="#config"
                               role="tab" aria-controls="config" aria-selected="false">Configuraciones</a>
                        </li>
                    </ul>
                </div>
                <div class="card-body">
                    <div class="tab-content" id="tabContent">
                        <div class="tab-pane fade show active" id="table" role="tabpanel" aria-labelledby="table-tab">
                            <div class="row">
                                <div class='col-12'>
                                    <a href="?action=add" class='btn btn-success bloqueo_pantalla'><span
                                            class="fa fa-plus "></span> Adicionar</a>
                                    <div class="btn-group">
                                        <button id="btn-reportes" type="button" class="btn btn-default dropdown-toggle"
                                                data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                            <i id="icon-btn-reportes" class="fa fa-folder"></i> Reportes
                                        </button>
                                        <div class="dropdown-menu" style="font-size: 16px">
                                            <a href="javascript:;"
                                               class='btn btn-default dropdown-item generar_reporte_general_excelh'><i
                                                    class="fa fa-file-excel-o "></i> &nbsp;Ordenes de Trabajo</a>
                                            <a href="javascript:;"
                                               class='btn btn-default dropdown-item generar_reporte_general_excelhpdf'><i
                                                    class="fa fa-file-pdf-o "></i> &nbsp;Ordenes de Trabajo</a>
                                            <a href="javascript:;"
                                               class='btn btn-default dropdown-item generar_reporte_general_excel'><i
                                                    class="fa fa-file-excel-o "></i> &nbsp;General</a>
                                            <a href="javascript:;"
                                               class='btn btn-default dropdown-item informeincidente'><span
                                                    class="fa fa-print"></span> &nbsp;Informe de incidentes</a>
                                            <a href="javascript:;"
                                               class='btn btn-default dropdown-item informeincidentepartes'><span
                                                    class="fa fa-print"></span> &nbsp;Informe de piezas y partes</a>
                                            <a href="javascript:;"
                                               class='btn btn-default dropdown-item informeencuesta'><span
                                                    class="fa fa-print"></span> &nbsp;Informe de encuestas</a>
                                            <a href="javascript:;"
                                               class='btn btn-default dropdown-item informeencuestaexcel'><span
                                                    class="fa fa-file-excel-o"></span> &nbsp;Descargar resultados
                                                encuestas</a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <br>
                            <form method="GET" id="form-filters" enctype="multipart/form-data">
                                <div class="card">
                                    <div class="card-body">
                                        <div class="row">
                                            <div class='col-sm-3 border-right-filters'>
                                                <label for="idgrupo" class="fw-lighter ps-2">Filtro por grupo *</label>
                                                <select id="idgrupo" class="filter-select" name="idg"
                                                        style="width: 100%;">
                                                    <option value="0">Todos los grupos</option>
                                                    {% for item in grupos %}
                                                        <option {% if item.0 == idgrupo %}selected{% endif %}
                                                                value="{{ item.0 }}">{{ item.1 }}</option>
                                                    {% endfor %}
                                                </select>
                                            </div>
                                            <div class='col-sm-3 border-right-filters'>
                                                <label for="estado_list" class="fw-lighter ps-2">Filtro por estado
                                                    *</label>
                                                <select id="estado_list" class="filter-select" name="ide" style="width: 100%;">
                                                    <option value="0">Todos los estados</option>
                                                    {% for estado in estados %}
                                                        <option {% if estado.id == estadoid %}selected{% endif %}
                                                                value="{{ estado.id }}">{{ estado.nombre }}</option>
                                                    {% endfor %}
                                                </select>
                                            </div>
                                            <div class='col-sm-3 border-right-filters'>
                                                <label for="estadoOT_list" class="fw-lighter ps-2">Filtro por estado *</label>
                                                <select id="estadoOT_list" class="filter-select" name="ideot">
                                                    <option value="0">Todos los estados OT</option>
                                                    {% for estado in estado %}
                                                    <option {% if estado.0 == estadoOT %}selected{% endif %} value="{{ estado.0 }}">{{ estado.1 }}</option>
                                                    {% endfor %}
                                                </select>
                                            </div>
                                            <div class='col-sm-3'>
                                                <label for="equipo_codigo" class="fw-lighter ps-2">Filtro por código de
                                                    equipo *</label>
                                                <select id="equipo_codigo" class="filter-select" name="idec"
                                                        style="width: 100%;">
                                                    <option value="0">Todos</option>
                                                    <option {% if selecttipoeq == 1 %}selected{% endif %} value="1">SIN
                                                        CÓDIGO
                                                    </option>
                                                    <option {% if selecttipoeq == 2 %}selected{% endif %} value="2">
                                                        CÓDIGO EXTERNO
                                                    </option>
                                                    <option {% if selecttipoeq == 3 %}selected{% endif %} value="3">
                                                        ORDEN DE TRABAJO
                                                    </option>
                                                    <option {% if selecttipoeq == 4 %}selected{% endif %} value="4">SIN
                                                        ORDEN DE TRABAJO
                                                    </option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <br>
                                <div class="col-12">
                                    <div class="row">
                                        <div class="col-lg-12 col-md-12 col-sm-12">
                                            <div class="input-group mb-0">
                                                <input id="searchinput" type="text" class="form-control"
                                                       placeholder=" Buscar por nombre del requisito..."
                                                       aria-label="Buscar" aria-describedby="button-addon2" name="s"
                                                       value="{{ s|default:'' }}"
                                                       style="font-family:Arial, FontAwesome">
                                                {% if s or idgrupo or estadoid or selecttipoeq %}
                                                    <a title="Ver todo" href="/helpdesk_adm_hdincidentetic"
                                                       class="btn btn-default tr cleartext"><i
                                                            class="fas fa-sync-alt"></i></a>
                                                {% endif %}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </form>
                            <div class="row">
                                <div class='col-12'>
                                    <div class="card mb-4">
                                        <div class="card-body border-top border-3 rounded-3 border-dark-info">
                                            <div class="table-responsive">
                                                <table class='table table-bordered'>
                                                    <thead>
                                                    <tr>
                                                        <td style="width: 30px;">Código</td>
                                                        <td style="width: 90px">Fecha</td>
                                                        <td style="width: 200px;">Asunto</td>
                                                        <td style="width: 200px">Nombre Solicitante</td>
                                                        <td style="width: 100px">Ubicación/Ubicación</td>
                                                        <td style="width: 80px;">Grupo</td>
                                                        <td style="width: 80px;">Agente</td>
                                                        <td style="width: 50px;">Estado</td>
                                                        <td style="width: 60px;">Prioridad</td>
                                                        <td style="width: 20px">Archivo</td>
                                                        <td style="width: 80px;">Resolución</td>
                                                        <td style="width: 60px;"></td>
                                                    </tr>
                                                    </thead>
                                                    <tbody>
                                                    {% for incidente in incidentescab %}
                                                        <tr {% if not incidente.ultimo_registro.estadoasignacion == 1 %}bgcolor="#EAF2F8"{% endif %}
                                                            class="fw-lighter">
                                                            <td style="text-align: center;"
                                                                data-title='Codigo'>{{ incidente.id }} </td>
                                                            <td data-title='Fecha'>
                                                                {{ incidente.fechareporte|date:"d-m-Y" }}<br> {{ incidente.horareporte }}
                                                            </td>
                                                            <td data-title='Asunto'>
                                                                {{ incidente.asunto }}<br>
                                                                {% if not incidente.esta_abierto %}
                                                                    <span class="label label-warning"><b>Cant. Revisiones: </b>{{ incidente.cantidad_detalle_incidente }}</span>
                                                                {% endif %}
                                                                {% if incidente.revisionequiposincodigo %}
                                                                    <span class="label label-important"
                                                                          id="incidetesincodigo_{{ incidente.id }}">Equipo sin código</span>
                                                                {% endif %}
                                                                {% if incidente.revisionequipoexterno %}
                                                                    <span class="label label-info"><b>Equipo externo</b></span>
                                                                {% endif %}
                                                                {% if incidente.tipoincidente.id == 3 and incidente.ordentrabajo %}
                                                                    <br>
                                                                    <span class="label label-info"><b>Orden Trabajo: </b> {{ incidente.ordentrabajo }}</span>
                                                                {% endif %}
                                                                <label class="label {% if incidente.esta_abierto %} label-success{% elif incidente.esta_pendiente %} label-warning{% else %} label-info{% endif %}">{{ incidente.estado }}</label>
                                                            </td>
                                                            <td data-title='Nombre Solicitante'>{{ incidente.persona }}</td>
                                                            <td data-title='Ubicación/Ubicación'>
                                                                {% if incidente.departamento %}
                                                                    {{ incidente.departamento }}{% else %}
                                                                    {{ incidente.ubicacion.bloque }} -
                                                                    {{ incidente.ubicacion.ubicacion }}{% endif %}
                                                            </td>
                                                            <td style="text-align: center" data-title='Grupo'>
                                                                {% if incidente.tipoincidente %}
                                                                    {{ incidente.tipoincidente }}
                                                                {% endif %}
                                                                {% if incidente.activo %}
                                                                    <a class="btn btn-info btn-mini detalleactivo tu"
                                                                       title="Detalle de Activo" href='javascript:;'
                                                                       cid="{{ incidente.activo.id }}"> <i
                                                                            class='fa fa-list'></i> </a>
                                                                {% endif %}
                                                            </td>
                                                            <td style="text-align: center" data-title='Agente'>
                                                                {% if incidente.ultimo_registro %}
                                                                    {% if incidente.ultimo_registro.agente and incidente.ultimo_registro.estadoasignacion == 1 %}
                                                                        {{ incidente.ultimo_registro.agente.persona.usuario }}
                                                                    {% endif %}
                                                                {% endif %}
                                                            </td>
                                                            <td style="text-align: center;" data-title='Estado'>
                                                                {% if incidente.esta_abierto %}
                                                                    <img title="{{ incidente.estado  }}" alt="..." width="20" height="20" src="https://sga.unemi.edu.ec/{{ incidente.estado.imagen.url }}">
                                                                {% elif  incidente.esta_pendiente  %}
                                                                    <img title="{{ incidente.estado  }}" alt="..." width="20" height="20" src="https://sga.unemi.edu.ec/{{ incidente.estado.imagen.url }}">
                                                                {% elif  incidente.esta_cerrado  %}
                                                                    <img title="{{ incidente.estado  }}" alt="..." width="20" height="20" src="https://sga.unemi.edu.ec/{{ incidente.estado.imagen.url }}">
                                                                {% elif  incidente.esta_resulto  %}
                                                                    <img title="{{ incidente.estado  }}" alt="..." width="20" height="20" src="https://sga.unemi.edu.ec/{{ incidente.estado.imagen.url }}">
                                                                {% endif %}
                                                            </td>
                                                            <td style="text-align: center" data-title='Prioridad'>
                                                                {% if incidente.detallesubcategoria.prioridad %}
                                                                    {% if incidente.detallesubcategoria.prioridad.prioridad.imagen %}
                                                                        <img  alt="..." width="20" height="20" title="{{ incidente.detallesubcategoria.prioridad.prioridad.nombre }}" src="https://sga.unemi.edu.ec/{{ incidente.detallesubcategoria.prioridad.prioridad.imagen.url }}">
                                                                        {% else %}
                                                                        {{ incidente.detallesubcategoria.prioridad.prioridad.nombre }}
                                                                    {% endif %}
                                                                {% endif %}
                                                            </td>
                                                            <td style="text-align: center;" data-title='Archivo'>
                                                                {% if incidente.archivo %}
                                                                    <a href='https://sga.unemi.edu.ec/{{ incidente.download_link }}'
                                                                       title="{{ incidente.asunto }}"
                                                                       class='btn btn-info btn-mini fancybox'><i
                                                                            class='fa fa-arrow-down '></i></a>
                                                                {% endif %}
                                                            </td>
                                                            <td style="text-align: center;"
                                                                data-title='Tiempo de resolución'>
                                                                {% if incidente.detallesubcategoria %}
                                                                    {% if incidente.tiene_prioridad %}
                                                                        {% if incidente.detallesubcategoria.prioridad.modificar %}
                                                                            {{ incidente.detallesubcategoria.prioridad.horamax }}
                                                                            :
                                                                            {{ incidente.detallesubcategoria.prioridad.minutomax }}
                                                                            :
                                                                            {{ incidente.detallesubcategoria.prioridad.segundomax }}
                                                                        {% else %}
                                                                            {{ incidente.detallesubcategoria.prioridad.prioridad.horamax }}
                                                                            :
                                                                            {{ incidente.detallesubcategoria.prioridad.prioridad.minutomax }}
                                                                            :
                                                                            {{ incidente.detallesubcategoria.prioridad.prioridad.segundomax }}
                                                                        {% endif %}
                                                                        &nbsp;horas
                                                                    {% else %}
                                                                        <label class="label label-important">NO
                                                                            ASIGNADO</label>
                                                                    {% endif %}
                                                                {% endif %}
                                                            </td>
                                                            <td data-title='Acciones'
                                                                style="text-align: center;vertical-align: middle;">
                                                                <div class="dropdown">
                                                                    <a href="javascript:void(0);"
                                                                       class="btn-icon btn btn-ghost btn-sm rounded-circle dropdown-toggle"
                                                                       data-bs-toggle="dropdown" aria-haspopup="true"
                                                                       aria-expanded="false">
                                                                        <i class="fa fa-ellipsis-v fs-6"></i>
                                                                    </a>
                                                                    <ul class="dropdown-menu" x-placement="right-start">
                                                                        <span class="dropdown-header">ACCIONES</span>
                                                                        {% with migrupo=incidente|args:persona_id|call:'es_mi_grupo' miagente=incidente|args:persona_id|call:'es_mi_agente' %}
                                                                            {% if migrupo and miagente %}
                                                                                {% if incidente.estado.id != 5 %}
                                                                                    <li class="dropdown-item"><a
                                                                                            href='?action=resolverincidente&id={{ incidente.id }}'
                                                                                            class="bloqueo_pantalla"><i
                                                                                            class="fa fa-edit"></i>
                                                                                        Resolver
                                                                                        Incidente </a></li>
                                                                                    <li class="dropdown-item"><a
                                                                                            href='?action=reasignaragente&id={{ incidente.id }}'
                                                                                            class="bloqueo_pantalla"><i
                                                                                            class="fa fa-user"></i>Reasingar
                                                                                        Agente</a></li>
                                                                                    <li class="dropdown-item"><a
                                                                                            href="?action=escalarincidente&id={{ incidente.id }}"
                                                                                            class="bloqueo_pantalla"><i
                                                                                            class="fa fa-times fa-fw fa fa-group"></i>Escalar
                                                                                        a Grupo</a></li>
                                                                                {% endif %}
                                                                            {% endif %}
                                                                        {% endwith %}
                                                                        {% if incidente.estado.id != 3 %}
                                                                            <li class="dropdown-item"><a
                                                                                    href='?action=resolverincidente&id={{ incidente.id }}'
                                                                                    class="bloqueo_pantalla"><i
                                                                                    class="fa fa-edit"></i> Resolver
                                                                                Incidente</a></li>
                                                                            <li class="dropdown-item"><a
                                                                                    href='?action=edit&id={{ incidente.id }}'
                                                                                    class="bloqueo_pantalla"><i
                                                                                    class="fa fa-edit"></i> Editar</a>
                                                                            </li>
                                                                            <li class="dropdown-item"><a
                                                                                    class="eliminacionmodal"
                                                                                    href="javascript:;"
                                                                                    nhref="/helpdesk_hdincidente?action=delincidente&id={{ incidente.id }}"><i
                                                                                    class="fa fa-trash"></i>
                                                                                Eliminar</a>
                                                                            </li>
                                                                        {% endif %}
                                                                        <li class="dropdown-item"><a
                                                                                class="seleccionaractivo"
                                                                                id="{{ incidente.id }}"><i
                                                                                class="fa fa-laptop"></i> Seleccionar
                                                                            activo</a>
                                                                        </li>
                                                                        <li class="dropdown-item"><a href="javascript:;"
                                                                                                     class="mostrardetalle tu"
                                                                                                     idd="{{ incidente.id|encrypt }}"><i
                                                                                class="fa fa-list"></i> Detalle</a></li>
                                                                        {% if incidente.tipoincidente.id == 3 %}
                                                                            {% if incidente.estado.id != 3 %}
                                                                                <li class="dropdown-item"><a
                                                                                        href="javascript:;"
                                                                                        class="tu generarot"
                                                                                        idr="{{ incidente.id }}"><i
                                                                                        class="fa fa-file-pdf-o "></i>Generar
                                                                                    OT </a></li>
                                                                            {% endif %}
                                                                            {% if incidente.estado.id == 3 %}
                                                                                <li class="dropdown-item"><a
                                                                                        href="javascript:;"
                                                                                        class="tu imprimirincidente"
                                                                                        idr="{{ incidente.id }}"><i
                                                                                        class="fa fa-file-pdf-o "></i>Imprimir
                                                                                    OT</a></li>
                                                                                <li class="dropdown-item"><a
                                                                                        href="javascript:;"
                                                                                        class="confirmacionmodal"
                                                                                        nhref="/helpdesk_hdincidente?action=aprobarIngresomateriales&id={{ incidente.id }}"><i
                                                                                        class="fa fa-check"></i> Aprobar
                                                                                    Ingreso de Materiales</a></li>
                                                                            {% endif %}
                                                                        {% endif %}
                                                                    </ul>
                                                                </div>
                                                            </td>
                                                        </tr>
                                                        {% empty %}
                                                        <tr>
                                                            <td colspan="12">NO EXISTEN INCIDENTES REGISTRADOS</td>
                                                        </tr>
                                                    {% endfor %}
                                                    </tbody>
                                                </table>
                                            </div>
                                            <div class="card-footer">
                                                {% include 'paginacionb4.html' %}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="tab-pane fade" id="config" role="tabpanel" aria-labelledby="config-tab">
                            <div class="row">
                                <div class="col-9">
                                    {% for mt in module_type %}
                                        {% if not forloop.first %}<br>{% endif %}
                                        <h3>{{ mt.1 }}</h3>
                                        <div class="row">
                                            {% for mod in modules %}
                                                {% if mt.0 == mod.type %}
                                                    <div class="col-sm-6 col-md-2">
                                                        <a href="{{ mod.url }}" class="text-black" target="_blank">
                                                            <div class="card modulecard {% if forloop.last %}mb-4{% endif %}"
                                                                 style="min-height: 95px;max-height: 95px;overflow-y: hidden;">
                                                                <div class="card-body">
                                                                    <div class="row mb-2 mt-0 pt-0 text-left">
                                                                        <div class="col-12 ps-3">
                                                                            <i class="{{ mod.icon }} fs-3"></i>
                                                                            <h6 class="fw-lighter"
                                                                                style="font-size: 14px;">{{ mod.name }}</h6>
                                                                            {#                                                                    <small class="text-justify font-italic" style="font-size: 13px;">{{ mod.description }}</small>#}
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </a>
                                                    </div>
                                                {% endif %}
                                            {% endfor %}
                                        </div>
                                    {% endfor %}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade static" id="itemspanel" style="display: none;">
        <div class="modal-dialog modal-dialog-centered modal-xl" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="text-center"><b class="paneltitle m-2">DETALLE DE INCIDENTE</b></h4>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-12">
                            <div class="panelbody"></div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer" id="footermodal">
                    <a href="javascript:" class="btn btn-danger" data-bs-dismiss="modal">&times; Cerrar</a>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade static" id="itemspanelreportegeneral_excel" style="display: none;">
        <div class="modal-dialog modal-dialog-centered modal-xl" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="paneltitle"><span class="fa fa-file-excel-o"></span> Reporte general en excel </h3>
                </div>
                <div class="modal-body panelbody">

                    <div class='span2'>
                        <span>De: </span><input type="text" class="selectorfecha" value="" id="id_fecha_de"
                                                style="width: 120px">
                    </div>
                    <div class='span2'>
                        <span>Hasta: </span><input type="text" class="selectorfecha" value="" id="id_fecha_hasta"
                                                   style="width: 120px">
                    </div>
                    <br>

                </div>
                <div class="modal-footer">
                    <table class="pull-right">
                        <tr>
                            <td><a href="javascript:;" class="btn btn-generar btn-success" id="generar_excel"><i
                                    class="fa fa-file-pdf-o"></i> Generar</a></td>
                            <td><a href="javascript:;" class="btn btn-cerrar btn-info" id="cerrar_excel"><i
                                    class="fa fa-close"></i> Cerrar</a></td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="itemspanelreportegeneral_excelh" style="display: none;" tabindex="-1" role="dialog"
         aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-xl" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="paneltitle"><span class="fa fa-file-excel-o"></span> Reporte general en excel </h3>
                </div>
                <div class="modal-body panelbody">
                    <div class="row">
                        <div class='span3'>
                            <span>De: </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="text" class="selectorfecha"
                                                                                   value="{{ fecha|date:"d-m-Y"  }}"
                                                                                   id="id_fecha_deh"
                                                                                   style="width: 120px">
                        </div>
                        <div class='span3'>
                            <span>Hasta: </span>&nbsp;&nbsp;<input type="text" class="selectorfecha"
                                                                   value="{{ fecha|date:"d-m-Y"  }}"
                                                                   id="id_fecha_hastah"
                                                                   style="width: 120px">
                        </div>
                        <br><br>
                    </div>
                    <div class="row">
                        <div class='span3'><span>Estado: </span>
                            <select id='id_estado' style="width: 200px">
                                <option value="0">TODOS LOS ESTADOS</option>
                                {% for c in estado %}
                                    <option value='{{ c.0 }}'>{{ c.1 }}</option>
                                {% endfor %}
                            </select> <br>
                        </div>
                        <div class='span3'><span>Bloque: </span>
                            <select id='id_bloque' style="width: 200px">
                                <option value="0">TODOS LOS BLOQUES</option>
                                {% for c in bloque %}
                                    <option value='{{ c.id }}'>{{ c.nombre }}</option>
                                {% endfor %}
                            </select>
                        </div>
                        <br><br>
                    </div>
                    <div class="row">
                        <div class='span5'><span>Técnico: </span>
                            <select id='id_tecnico' style="width: 400px">
                                <option value="0">TODOS LOS TÉCNICOS</option>
                                {% for c in tecnico %}
                                    <option value='{{ c.id }}'>{{ c.nombre_completo_inverso }}</option>
                                {% endfor %}
                            </select>
                        </div>
                        <div class="form-check">
                            <input type="checkbox" class="form-check-input" id="checktodosexc" value="0"
                                   name="checktodosexc">
                            <span>TODOS: </span>
                        </div>
                        <br>
                    </div>

                </div>
                <div class="modal-footer">
                    <table class="pull-right">
                        <tr>
                            <td><a href="javascript:;" class="btn btn-generar btn-success" id="generar_excelh"><i
                                    class="fa fa-file-pdf-o"></i> Generar</a></td>
                            <td><a href="javascript:;" class="btn btn-cerrar btn-info" id="cerrar_excelh"><i
                                    class="fa fa-close"></i> Cerrar</a></td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="itemspanelreportegeneral_excelhpdf" style="display: none;" tabindex="-1" role="dialog"
         aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-xl" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="paneltitle"><span class="fa fa-file-pdf-o"></span> Reporte general en Pdf </h3>
                </div>
                <div class="modal-body panelbody">
                    <div class="row">
                        <div class='span3'>
                            <span>De: </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type="text" class="selectorfecha"
                                                                                   value="{{ fecha|date:"d-m-Y"  }}"
                                                                                   id="id_fecha_dehpdf"
                                                                                   style="width: 120px">
                        </div>
                        <div class='span3'>
                            <span>Hasta: </span>&nbsp;&nbsp;<input type="text" class="selectorfecha"
                                                                   value="{{ fecha|date:"d-m-Y"  }}"
                                                                   id="id_fecha_hastahpdf"
                                                                   style="width: 120px">
                        </div>
                        <br><br>
                    </div>
                    <div class="row">
                        <div class='span3'><span>Estado: </span>
                            <select id='id_estadopdf' style="width: 200px">
                                <option value="0">TODOS LOS ESTADOS</option>
                                {% for c in estado %}
                                    <option value='{{ c.0 }}'>{{ c.1 }}</option>
                                {% endfor %}
                            </select> <br>
                        </div>
                        <div class='span3'><span>Bloque: </span>
                            <select id='id_bloquepdf' style="width: 200px">
                                <option value="0">TODOS LOS BLOQUES</option>
                                {% for c in bloque %}
                                    <option value='{{ c.id }}'>{{ c.nombre }}</option>
                                {% endfor %}
                            </select>
                        </div>
                        <br><br>
                    </div>
                    <div class="row">
                        <div class='span5'><span>Técnico: </span>
                            <select id='id_tecnicopdf' style="width: 400px">
                                <option value="0">TODOS LOS TÉCNICOS</option>
                                {% for c in tecnico %}
                                    <option value='{{ c.id }}'>{{ c.nombre_completo_inverso }}</option>
                                {% endfor %}
                            </select>
                        </div>
                        <div class="form-check">
                            <input type="checkbox" class="form-check-input" id="checktodospdf" value="0"
                                   name="checktodospdf">
                            <span>TODOS: </span>
                        </div>
                        <br>
                    </div>

                </div>
                <div class="modal-footer">
                    <table class="pull-right">
                        <tr>
                            <td><a href="javascript:;" class="btn btn-generar btn-success" id="generar_excelhpdf"><i
                                    class="fa fa-file-pdf-o"></i> Generar</a></td>
                            <td><a href="javascript:;" class="btn btn-cerrar btn-info" id="cerrar_excelhpdf"><i
                                    class="fa fa-close"></i> Cerrar</a></td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade static" id="itemspanel3" style="display: none;">
        <div class="modal-dialog modal-dialog-centered modal-xl" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="paneltitle">Informe de incidentes</h4>
                </div>
                <div class="modal-body panelbody">
                    <div class="alert alert-danger invalidofechas" style="display: none">
                        <i class="fa fa-info-sign"></i> Seleccione un rango de fechas valida para continuar...!!!
                    </div>
                    <div style="text-align: center;">
                        <input placeholder="Fecha desde" type="text" value="{{ fechainicio }}" name="fini"
                               id="id_fecha_inicio"
                               style="width: 100px">
                        <input placeholder="Fecha hasta" type="text" value="{{ fechafin }}" name="ffin"
                               id="id_fecha_fin"
                               style="width: 100px"><br><br>
                    </div>
                </div>
                <div class="modal-footer" style="text-align: center">
                    <a href="javascript:;" class="btn btn-danger" id="itemspanel_adicionar_3"><i class="fa fa-plus"></i>
                        Procesar</a>
                    <a href="javascript:;" class="btn btn-info" id="itemspanel_cerrar_3"> Cerrar</a>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade static" id="itemspanelpartes" style="display: none;">
        <div class="modal-dialog modal-dialog-centered modal-xl" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="paneltitle">Informe de incidentes</h4>
                </div>
                <div class="modal-body panelbodypartes">
                    <div class="alert alert-danger invalidopartes" style="display: none">
                        <i class="fa fa-info-sign"></i> Seleccione un rango de fechas valida para continuar...!!!
                    </div>
                    <div style="text-align: center;">
                        <input placeholder="Fecha desde" type="text" value="{{ fechainicio }}" name="fini"
                               id="id_fecha_iniciopartes" style="width: 100px">
                        <input placeholder="Fecha hasta" type="text" value="{{ fechafin }}" name="ffin"
                               id="id_fecha_finpartes"
                               style="width: 100px"><br><br>
                    </div>
                </div>
                <div class="modal-footer" style="text-align: center">
                    <a href="javascript:;" class="btn btn-danger" id="itemspanel_adicionar_partes"><i
                            class="fa fa-plus"></i>
                        Procesar</a>
                    <a href="javascript:;" class="btn btn-info" id="itemspanel_cerrar_partes"> Cerrar</a>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade static" id="itemspanelencuesta" style="display: none;">
        <div class="modal-dialog modal-dialog-centered modal-xl" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="paneltitle">Informe de encuesta</h4>
                </div>
                <div class="modal-body panelbodyencuesta">
                    <div class="alert alert-danger invalidoencuesta" style="display: none">
                        <i class="fa fa-info-sign"></i> Seleccione un rango de fechas valida para continuar...!!!
                    </div>
                    <div style="text-align: center;">
                        <input placeholder="Fecha desde" type="text" value="{{ fechainicio }}" name="fini"
                               id="id_fecha_inicioencuesta" style="width: 100px">
                        <input placeholder="Fecha hasta" type="text" value="{{ fechafin }}" name="ffin"
                               id="id_fecha_finencuesta" style="width: 100px"><br><br>
                    </div>
                </div>
                <div class="modal-footer" style="text-align: center">
                    <a href="javascript:;" class="btn btn-danger" id="itemspanel_adicionar_encuesta"><i
                            class="fa fa-plus"></i>
                        Procesar</a>
                    <a href="javascript:;" class="btn btn-info" id="itemspanel_cerrar_encuesta"> Cerrar</a>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade static" id="itemspanelencuestaexcel" style="display: none;">
        <div class="modal-dialog modal-dialog-centered modal-xl" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="paneltitle">Informe de encuesta</h4>
                </div>
                <div class="modal-body panelbodyencuestaexcel">
                    <div class="alert alert-danger invalidoencuestaexcel" style="display: none">
                        <i class="fa fa-info-sign"></i> Seleccione un rango de fechas valida para continuar...!!!
                    </div>
                    <div style="text-align: center;">
                        <input placeholder="Fecha desde" type="text" value="{{ fechainicio }}" name="fini"
                               id="id_fecha_inicioencuestaexcel" style="width: 100px">
                        <input placeholder="Fecha hasta" type="text" value="{{ fechafin }}" name="ffin"
                               id="id_fecha_finencuestaexcel" style="width: 100px"><br><br>
                    </div>
                </div>
                <div class="modal-footer" style="text-align: center">
                    <a href="javascript:;" class="btn btn-danger" id="generar_excelencuesta"><i class="fa fa-plus"></i>
                        Procesar</a>
                    <a href="javascript:;" class="btn btn-info" id="itemspanel_cerrar_encuestaexcel"> Cerrar</a>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade static" id="itemspanelseleccionaractivo" style="display: none;">
        <div class="modal-dialog modal-dialog-centered modal-xl" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="paneltitled">SELECCIONAR ACTIVO</h3>
                </div>
                <div class="modal-body panelbody">
                    <form id="form2" class="form-horizontal form-modal" style="width: 100%; margin-bottom: 0">
                        {% for field in form2 %}
                            <fieldset id="fieldset_{{ field.name }}" class="control-group nomargins"
                                      style="min-height:35px; float: left; width: 100%">
                                <div class="control-label label-text"
                                     {% if field.field.widget.attrs.labelwidth %}labelwidth="{{ field.field.widget.attrs.labelwidth }}"{% endif %}
                                     style="display: table;height: 30px;">
                                    <div style="display: table-cell; vertical-align: middle; line-height: 11px">
                                        <label for="id_{{ field.name }}"
                                               style="padding-right: 20px">{{ field.label }}</label>
                                    </div>
                                </div>
                                <div class="control" style="float: left; width: 100%">
                                    {% if field.field.widget.attrs.select2search %}
                                        <select id="id_{{ field.name }}_select2"
                                                {% if field.field.widget.attrs.disabled %}disabled=""{% endif %}
                                                style="width: 100%">
                                            <option value="0" selected="selected">---------</option>
                                        </select>
                                        <input type='hidden' name="{{ field.name }}" id="id_{{ field.name }}"
                                               value="{{ field.value }}" hidden="hidden"
                                               {% if field.field.widget.attrs.descripcion %}descripcion="{{ field.field.widget.attrs.descripcion }}"{% endif %}
                                               class="select2hidden">
                                    {% else %}
                                        {{ field }}
                                    {% endif %}
                                    <p class="help-text"
                                       style="font-size: xx-small; margin-bottom: 0; height: 13px; line-height: 13px">{{ field.help_text }} </p>
                                </div>
                            </fieldset>
                        {% endfor %}
                    </form>
                </div>
                <div class="modal-footer">
                    <table class="pull-right">
                        <tr>
                            <a href="javascript:;" class="btn btn-success" id="guardar"><i class="fa fa-save"></i>Guardar</a>
                            <td><a href="javascript:;" class="btn btn-cerrar btn-info">Cerrar</a></td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade static" id="detalleactivomodal" style="display: none;">
        <div class="modal-dialog modal-dialog-centered modal-xl" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="paneltitle">Detalles de activo</h3>
                </div>
                <div class="modal-body" id="detalleactivomodal_body"></div>
                <div class="modal-footer">
                    <div style="float: right">
                        <a href="javascript:;" id="detalleactivomodal_aceptar"
                           class="btn btn-info btn-aceptar">Aceptar</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}