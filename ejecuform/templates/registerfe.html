{% extends "baseformacionejecutiva.html" %}
{% load sga_extras %}
{% block heading %}
    <link rel="shortcut icon" type="image/x-icon" href="/static/formacionejecutiva/images/favicon/favicon.ico">

    <!-- Libs CSS -->
    <link href="/static/formacionejecutiva/fonts/feather/feather.css" rel="stylesheet">
    <link href="/static/formacionejecutiva/libs/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet" />
    <link href="/static/formacionejecutiva/libs/dragula/dist/dragula.min.css" rel="stylesheet" />
    <link href="/static/formacionejecutiva/libs/%40mdi/font/css/materialdesignicons.min.css" rel="stylesheet" />
    <link href="/static/formacionejecutiva/libs/dropzone/dist/dropzone.css" rel="stylesheet" />
    <link href="/static/formacionejecutiva/libs/magnific-popup/dist/magnific-popup.css" rel="stylesheet" />
    <link href="/static/formacionejecutiva/libs/bootstrap-select/dist/css/bootstrap-select.min.css" rel="stylesheet">
    <link href="/static/formacionejecutiva/libs/%40yaireo/tagify/dist/tagify.css" rel="stylesheet">
    <link href="/static/formacionejecutiva/libs/tiny-slider/dist/tiny-slider.css" rel="stylesheet">
    <link href="/static/formacionejecutiva/libs/tippy.js/dist/tippy.css" rel="stylesheet">
    <link href="/static/formacionejecutiva/libs/datatables.net-bs5/css/dataTables.bootstrap5.min.css" rel="stylesheet">
    <link href="/static/formacionejecutiva/libs/prismjs/themes/prism-okaidia.min.css" rel="stylesheet">
    <link href="/static/formacionejecutiva/libs/simplebar/dist/simplebar.min.css" rel="stylesheet">
    <link href="/static/formacionejecutiva/libs/nouislider/dist/nouislider.min.css" rel="stylesheet">
    <link href="/static/formacionejecutiva/libs/glightbox/dist/css/glightbox.min.css" rel="stylesheet">

    {#<link rel="stylesheet" href="/static/formacionejecutiva/vendor/select2/css/select2.min.css">#}

        <!-- Theme CSS -->
    <link rel="stylesheet" href="/static/formacionejecutiva/css/theme.min.css">

	<!-- Scripts -->
	<!-- Libs JS -->
    <script src="/static/formacionejecutiva/libs/jquery/dist/jquery.min.js"></script>
    <script src="/static/formacionejecutiva/libs/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="/static/formacionejecutiva/libs/odometer/odometer.min.js"></script>
    <script src="/static/formacionejecutiva/libs/magnific-popup/dist/jquery.magnific-popup.min.js"></script>
    <script src="/static/formacionejecutiva/libs/bootstrap-select/dist/js/bootstrap-select.min.js"></script>
    <script src="/static/formacionejecutiva/libs/flatpickr/dist/flatpickr.min.js"></script>
    <script src="/static/formacionejecutiva/libs/inputmask/dist/jquery.inputmask.min.js"></script>
    <script src="/static/formacionejecutiva/libs/apexcharts/dist/apexcharts.min.js"></script>
    <script src="/static/formacionejecutiva/libs/quill/dist/quill.min.js"></script>
    <script src="/static/formacionejecutiva/libs/file-upload-with-preview/dist/file-upload-with-preview.min.js"></script>
    <script src="/static/formacionejecutiva/libs/dragula/dist/dragula.min.js"></script>
    <script src="/static/formacionejecutiva/libs/bs-stepper/dist/js/bs-stepper.min.js"></script>
    <script src="/static/formacionejecutiva/libs/dropzone/dist/min/dropzone.min.js"></script>
    <script src="/static/formacionejecutiva/libs/jQuery.print/jQuery.print.js"></script>
    <script src="/static/formacionejecutiva/libs/prismjs/prism.js"></script>
    <script src="/static/formacionejecutiva/libs/prismjs/components/prism-scss.min.js"></script>
    <script src="/static/formacionejecutiva/libs/%40yaireo/tagify/dist/tagify.min.js"></script>
    <script src="/static/formacionejecutiva/libs/tiny-slider/dist/min/tiny-slider.js"></script>
    <script src="/static/formacionejecutiva/libs/%40popperjs/core/dist/umd/popper.min.js"></script>
    <script src="/static/formacionejecutiva/libs/tippy.js/dist/tippy-bundle.umd.min.js"></script>
    <script src="/static/formacionejecutiva/libs/typed.js/lib/typed.min.js"></script>
    <script src="/static/formacionejecutiva/libs/jsvectormap/dist/js/jsvectormap.min.js"></script>
    <script src="/static/formacionejecutiva/libs/jsvectormap/dist/maps/world.js"></script>
    <script src="/static/formacionejecutiva/libs/datatables.net/js/jquery.dataTables.min.js"></script>
    <script src="/static/formacionejecutiva/libs/datatables.net-bs5/js/dataTables.bootstrap5.min.js"></script>
    <script src="/static/formacionejecutiva/libs/datatables.net-responsive/js/dataTables.responsive.min.js"></script>
    <script src="/static/formacionejecutiva/libs/datatables.net-responsive-bs5/js/responsive.bootstrap5.min.js"></script>
    <script src="/static/formacionejecutiva/libs/prismjs/plugins/toolbar/prism-toolbar.min.js"></script>
    <script src="/static/formacionejecutiva/libs/prismjs/plugins/copy-to-clipboard/prism-copy-to-clipboard.min.js"></script>
    <script src="/static/formacionejecutiva/libs/fullcalendar/main.min.js"></script>
    <script src="/static/formacionejecutiva/libs/%40lottiefiles/lottie-player/dist/lottie-player.js"></script>
    <script src="/static/formacionejecutiva/libs/simplebar/dist/simplebar.min.js"></script>
    <script src="/static/formacionejecutiva/libs/nouislider/dist/nouislider.min.js"></script>
    <script src="/static/formacionejecutiva/libs/wnumb/wNumb.min.js"></script>
    <script src="/static/formacionejecutiva/libs/glightbox/dist/js/glightbox.min.js"></script>

    <!-- CDN File for moment -->
    {#<script src='../../../cdn.jsdelivr.net/npm/moment%402.29.1/min/moment.min.js'></script>#}
    <script src="https://cdn.jsdelivr.net/npm/moment@2.29.1/min/moment.min.js"></script>



    <script src="/static/bootstrap5/libs/jquery/dist/jquery.min.js"></script>
    <script type='text/javascript' src="/static/bootstrap5/js/jquery.blockUI.js?v=2.71.0"></script>

    <!-- Theme JS -->
    {#<script src="/static/formacionejecutiva/vendor/select2/js/select2.full.min.js"></script>#}
    {#<script src="/static/formacionejecutiva/js/plugins-init/select2-init.js"></script>#}
    <script src='/static/fullcalendar-6.1.4/dist/index.global.js?v={{ version_static|default_if_none:'0.1' }}'></script>

{#    <script type="text/javascript" src="/js/select2.js?v=4.0.0"></script>#}
{#    <link type="text/css" rel="stylesheet" href="/css/select2.css?v=4.0.0">#}

    <link rel="stylesheet" href="/static/formacionejecutiva/vendor/select2/css/select2.min.css">
    <script src="/static/formacionejecutiva/vendor/select2/js/select2.full.min.js"></script>
    <script src="/static/formacionejecutiva/js/plugins-init/select2-init.js"></script>

    <script src='/static/js/jquery.validationEngine.js' type="text/javascript"></script>
    <script src='/static/js/jquery.validationEngine-es.js' type="text/javascript"></script>
    <script src='/static/validaciones/funciones.js' type="text/javascript"></script>
    <link type='text/css' rel='stylesheet' href="/static/css/validationEngine.jquery.css"/>

    <script type="text/javascript">
        $(function () {
            $("select").select2({width: '100%'});

            $("#id_identificacion").change(function () {
                var tipoidentificacion = $("#id_tipo").val();

                bloqueointerface();
                $.ajax({
                    type: "POST",
                    url: "/registroformacionejecutiva",
                    data: {
                        'action': 'consultacedula2',
                        "cedula": this.value,
                        'tipoidentificacion': tipoidentificacion,
                    },
                    success: function (data) {
                        if (data.result == 'ok') {
                            console.log('llama consulta decedula');
                            $("#id_nombres").val(data.nombres);
                            $("#id_apellido1").val(data.apellido1);
                            $("#id_apellido2").val(data.apellido2);
                            $("#id_email").val(data.email);
                            $("#id_celular").val(data.telefono);
                            $("#id_sexo").val(data.genero);
                            $('#id_sexo').change();

                            $.unblockUI();

                        } else {
                            if (data.result == 'no') {
                                $("#id_nombres").val('');
                                $("#id_apellido1").val('');
                                $("#id_apellido2").val('');
                                $("#id_email").val('');
                                $("#id_celular").val('');
                                $("#id_sexo").val('');
                                $('#id_sexo').change();
                                $.unblockUI();
                            } else {
                                alertaWarning(data.mensaje);
//                                $('#mensajealerta').text(data.mensaje);
//                                $('#iconoalerta').attr("src", "/static/logos/icon_alerta.svg");
//                                $('#btn_alerta').attr("href", "{{ url_ }}?codigocarrera={{ carrera.id|encrypt }}");
//                                $('#modalAlertas').modal({backdrop: 'static', width: '100'}).modal('show');

                                $("#id_cedula").val('');
                                $("#id_nombres").val('');
                                $("#id_apellido1").val('');
                                $("#id_apellido2").val('');
                                $("#id_email").val('');
                                $("#id_celular").val('');
                                $("#id_sexo").val('');
                                $('#id_sexo').change();
                                $.unblockUI();
                            }
                        }
                    },
                    error: function () {
                        $.unblockUI();
                        alertaDanger('Error al enviar los datos al servidor');
//                        $("#errormensaje_r").html().show();
//                        $("#errormensaje_r2").html('Error al enviar los datos al servidor').show();
                    },
                    dataType: "json"
                });
            });

            $("#id_identificacion, #id_nombres, #id_sexo, #id_apellido1, #id_apellido2, #id_email, #id_celular").addClass("validate[required]");
            $("#id_email").addClass("validate[custom[email]");

            $("#registrar").click(function () {
                var cedpersona = $("#id_identificacion").val().trim();
                console.log($("#id_identificacion").val().trim());
                var valid = $("form").validationEngine('validate');
                if (valid && cedpersona) {
                    $('.controls input').each(function () {
                        if ($(this).attr('type') == 'text')  {
                            $(this).val($(this).val().trim());
                        }
                    });
//                    $('#modalconfirmacion').modal('hide');
                    var identificacion = $("#id_identificacion").val();
                    var tipoiden = $("#id_tipo").val();
                    var nombres = $("#id_nombres").val();
                    var apellido1 = $("#id_apellido1").val();
                    var apellido2 = $("#id_apellido2").val();
                    var genero = $("#id_sexo").val();
                    var correo = $("#id_email").val();
                    var telefono = $("#id_celular").val();

                    bloqueointerface();
                    $.ajax({
                        type: "POST",
                        url: "/registroformacionejecutiva",
                        data: {
                            'action': 'registrar', "identificacion": identificacion, "id_tipoiden": tipoiden,
                            "nombres": nombres, "apellido1": apellido1, "apellido2": apellido2, "email": correo, "telefono": telefono, "genero": genero,
                        },
                        success: function (data) {
                            if (data.result == 'ok') {
                                $.unblockUI();
                                $('#tituloalerta').text('Registro exitoso');
                                $('#mensajealerta').text(data.mensaje);
                                $('#iconoalerta').attr("src", "/static/logos/icon_check.svg");
                                $('#btn_alerta').attr("href", "/loginformacionejecutiva");
                                $('#btn_alerta').text('Salir');
                                $('#btn_alerta').removeAttr("data-toggle", "modal");
                                $('#btn_alerta').removeAttr("data-dismiss", "modal");
                                $('#modalAlertas').modal({backdrop: 'static', width: '100'}).modal('show');

                                $("#id_cedula").val('');
                                $("#id_apellido1").val('');
                                $("#id_apellido2").val('');
                                $("#id_nombres").val('');
                                $("#id_email").val('');
                                $("#id_celular").val('');
                            } else {
                                $('#tituloalerta').text('Registro denegado');
                                $('#mensajealerta').text(data.mensaje);
                                $('#iconoalerta').attr("src", "/static/logos/icon_alerta.svg");
                                $('#btn_alerta').attr("href", "/");
                                $('#modalAlertas').modal({backdrop: 'static', width: '100'}).modal('show');

                                $.unblockUI();
                                $("#id_cedula").val('');
                                $("#id_apellido1").val('');
                                $("#id_apellido2").val('');
                                $("#id_nombres").val('');
                                $("#id_email").val('');
                                $("#id_celular").val('');
                            }
                        },
                        error: function () {
                            $.unblockUI();
                            $("#errormensaje_r").html('Error al enviar los datos al servidor').show();
                            $("#errormensaje_r2").html('Error al enviar los datos al servidor').show();
                        },
                        dataType: "json"
                    });
                } else {
                    alertaWarning('Ingrese todos sus Datos Personales correctamente.');
                    setTimeout(function () {
                        $('.help-text').html("");
                    }, 8000);
                    $.unblockUI();
                }
            });

        });
    </script>

{% endblock %}
{% block pagetitle %}Registro de usuario{% endblock %}
{% block canvas %}
	<!-- Page content -->
	<div class="container d-flex flex-column">
		<div class="row align-items-center justify-content-center g-0 min-vh-100">
			<div class="col-lg-6 col-md-8 py-8 py-xl-0">
				<!-- Card -->
				<div class="card shadow">
					<!-- Card body -->
					<div class="card-body p-6">
                        <div class="mb-4">
                            <a href="/"><img src="/static/logos/logo_posgrado.png" class="mb-4" alt=""
                                                         width="300"/></a>
                                <h2 class="mb-1 fw-bold">Formación Ejecutiva</h2>
                                <span>¿Ya tienes una cuenta?
								<a href="/loginformacionejecutiva" class="ms-1">Iniciar sesión</a></span>
                        </div>
                        <!-- Form -->
						<form>
                            <div class="row">
                                <div class="col-lg-6 col-md-3 col-sm-12">
                                    <div class="mb-3">
                                        <label for="id_tipo" class="form-label">Tipo de Identificación</label><br>
                                        <select class="select2-accessible" id="id_tipo"
                                                style="width: 100%">
                                            <option value="1" selected="selected">CEDULA</option>
                                            <option value="2">PASAPORTE</option>
                                        </select>
                                        <div class="help-text" style="color: red"></div>
                                    </div>
                                </div>
                                <div class="col-lg-6 col-md-3 col-sm-12">
                                    <div class="mb-3">
                                        <label for="id_identificacion" class="form-label">Identificación</label>
                                        <input type="text" id="id_identificacion" class="form-control" name="username" placeholder="Identificación" required />
                                        <div class="help-text" style="color: red"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-lg-6 col-md-3 col-sm-12">
                                    <div class="mb-3">
                                        <label for="id_apellido1" class="form-label">Primer Apellido</label>
                                        <input type="text" id="id_apellido1" class="form-control" name="id_apellido1"
                                               placeholder="Primer Apellido"
                                               required/>
                                        <div class="help-text" style="color: red"></div>
                                    </div>
                                </div>
                                <div class="col-lg-6 col-md-3 col-sm-12">
                                    <div class="mb-3">
                                        <label for="id_apellido2" class="form-label">Segundo Apellido</label>
                                        <input type="text" id="id_apellido2" class="form-control" name="id_apellido2"
                                               placeholder="Segundo Apellido"
                                               required/>
                                        <div class="help-text" style="color: red"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-lg-6 col-md-3 col-sm-12">
                                    <div class="mb-3">
                                        <label for="id_nombres" class="form-label">Nombres</label>
                                        <input type="text" id="id_nombres" class="form-control" name="id_nombres" placeholder="Nombres"
                                            required />
                                        <div class="help-text" style="color: red"></div>
                                    </div>
                                </div>
                                <div class="col-lg-6 col-md-3 col-sm-12">
                                    <div class="mb-3">
                                        <label for="id_celular" class="form-label"># Celular</label>
                                        <input type="text" id="id_celular" class="form-control" name="id_celular" placeholder="Celular"
                                            required />
                                        <div class="help-text" style="color: red"></div>
                                    </div>
                                </div>
                            </div>
							<div class="mb-3">
                                <label for="id_sexo" class="form-label">Sexo:</label><br>
                                <select class="select2-accessible" id="id_sexo" style="width: 100%">
                                    <option value="0" selected="selected" disabled>Seleccione una opción</option>
                                    <option value="1">MUJER</option>
                                    <option value="2">HOMBRE</option>
                                </select>
                                <div class="help-text" style="color: red"></div>
                            </div>
							<div class="mb-3">
								<label for="username" class="form-label">Email</label>
                                <input type="email" id="id_email" class="form-control" name="id_email"
                                       placeholder="Dirección de correo electrónico"
                                       required pattern="[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,}$"/>
                                <div class="help-text" style="color: red"></div>
                            </div>
{#							<div class="mb-3">#}
{#								<label for="password" class="form-label">Contraseña</label>#}
{#								<input type="password" id="password" class="form-control" name="password" placeholder="**************"#}
{#									required />#}
{#							</div>#}
								<!-- Checkbox -->
							<div class="mb-3">
								<div class="form-check">
									<input type="checkbox" class="form-check-input" id="agreeCheck" />
									<label class="form-check-label" for="agreeCheck"><span>Estoy de acuerdo con los <a href="terms-condition-page.html">Términos y condiciones</a> y la
											<a href="terms-condition-page.html">Política de privacidad</a></span></label>
								</div>
							</div>
							<div>
									<!-- Button -->
									<div class="d-grid">
								<a id="registrar" class="btn btn-info text-black" style="background-color: #FE9900; border-color: #FE9900">
									Crear una cuenta gratis
								</a>
								</div>
							</div>
							<hr class="my-4" />
							<div class="mt-4 text-center">
								<!--Facebook-->
								<a href="#" class="btn-social btn-social-outline btn-facebook">
									<i class="mdi mdi-facebook fs-4"></i>
								</a>
								<!--Twitter-->
								<a href="#" class="btn-social btn-social-outline btn-twitter">
									<i class="mdi mdi-twitter fs-4"></i>
								</a>
								<!--LinkedIn-->
								<a href="#" class="btn-social btn-social-outline btn-linkedin">
									<i class="mdi mdi-linkedin"></i>
								</a>
								<!--GitHub-->
								<a href="#" class="btn-social btn-social-outline btn-github">
									<i class="mdi mdi-github"></i>
								</a>
							</div>
						</form>
					</div>
				</div>
			</div>
		</div>
	</div>

    <div class="modal fade opacity" id="modalAlertas" style="display: none;">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-wrap">
                    <div class="modal-header"
                         style="text-align: right; display: list-item; border-bottom: 1px solid white">
                        <button style="margin: 0" type="button" class="btn-close btn-cerrar-modal" data-toggle="modal"
                                data-dismiss="modal" aria-label="Close">X
                        </button>
                    </div>
                    <div>
                        <center style="margin-top: -37px; margin-bottom: 23px;"><br>
                            <img src="/static/logos/icon_alerta.svg" style="width: 70px" id="iconoalerta">
                            <div>
                                <h3 class="texto-blue" id="tituloalerta"></h3>
                            </div>
                            <div style="width: 350px">
                                <span class="texto-gris" id="mensajealerta"></span>
                            </div>
                            <div>
                                <br><a id="btn_alerta" href="javascript:void(0);" class="btn btn-warning"
                                       style="width: 20%;  border-radius: 3.2rem; font-size: 15px">Salir</a>
                            </div>
                        </center>
                    </div>
                </div>
            </div>
        </div>
    </div>

{% endblock %}
