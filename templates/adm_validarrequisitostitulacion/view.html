{% extends "ajaxformbs.html" %}
{% load sga_extras %}
{% block extraheading %}
    <style>
        .text-center  th td{
            text-align: center;
        }
        .datatable-header {
            padding-bottom: 40px;
        }
        /*.modal .fade .in {
            margin-top: 10%;
        }*/

    </style>
    <script type="text/javascript">
        oPermissions = {
            canView: eval({% if persona.usuario.is_staff %} true {% else %} false {% endif %})
        };
        $.extend(true, $.fn.dataTable.defaults, {
            oLanguage: {
                sSearch: "<span>Filtro:</span> _INPUT_",
                sLengthMenu: "<span>Mostrar Entradas:</span> _MENU_",
                sZeroRecords: "No se encontraron resultados",
                sProcessing: "Procesando...",
                sEmptyTable: "Ningún dato disponible para visualizar",
                sInfo: "Mostrando registros del _START_ al _END_ de un total de _TOTAL_ registros",
                sInfoEmpty: "Mostrando registros del 0 al 0 de un total de 0 registros",
                sLoadingRecords: "Cargando...",
                oPaginate: {
                    sFirst: "<i title='Inicio' class='fa fa-step-backward'></i>",
                    sLast: "<i title='Último' class='fa fa-step-forward'></i>",
                    sNext: "<i title='Siguiente' class='fa fa-fast-forward'></i>",
                    sPrevious: "<i title='Anterior' class='fa fa-fast-backward'></i>"
                },
            }
        });

        var ValidationQualificationRequirementsController = {
            init: function ()
            {
                var self = this;
                self.$table = $('#divDetailData table');
                self.$elTemplates = $('#el-templates');
                $('[name="filtro_periodo"] , [name="filtro_carrera"], [name="filtro_estado"], [name="filtro_coordinacion"]').select2();

                $(".migrateEnrrolled").click(function (){
                    var idc = $('#idc').val();
                    ModalMigrateEnrrolled.open();
                });

                $(".reportValidacion").click(function (){
                    console.log("reportValidacion")
                    ModalRunReportValidate.open();
                });

                $(".reportTitulacion").click(function (){
                    var rid= $(this).attr('rid');
                    ModalCertificacionTitulacion.open(rid);
                })

                self.$table.dataTable({
                    responsive: true,
                    searchDelay: 1000,
                    bJQueryUI: false,
                    bAutoWidth: false,
                    bProcessing: false,
                    bServerSide: true,
                    bSort: false,
                    sPaginationType: "full_numbers",
                    iDisplayLength: 25,
                    sDom: '<"datatable-header"fl><"datatable-scroll"tr><"datatable-footer"ip>',
                    sAjaxSource: "adm_validarrequisitostitulacion",
                    sServerMethod : "POST",
                    fnServerParams: function (aoData)
                    {
                        //$('#divDetailData table').block({message: $('#throbber'), css: { 'border': '1px solid', 'border-radius' : '10px', 'left': '46%', 'width':'120px',  'padding': '15px',  '-webkit-border-radius': '10px', '-moz-border-radius': '10px', opacity: .6, color: '#000' }});
                        aoData.push(
                            {"name": "action", "value": 'LoadDataTable'},
                            {"name": "idc", "value": $('select[name=filtro_carrera] option:selected').val()},
                            {"name": "idp", "value": $('select[name=filtro_periodo] option:selected').val()},
                            {"name": "ide", "value": $('select[name=filtro_estado] option:selected').val()},
                        );
                    },
                    aoColumnDefs:
                        [
                            {
                                /*ALUMNO*/
                                aTargets: [0],
                                width: "20%",
                                fnCreatedCell: function(nTd, sData, oData, iRow, iCol)
                                {
                                    if(sData != 'NULL') {
                                        $(nTd).css('text-align', 'left')
                                        $(nTd).css('vertical-align', 'middle')
                                        $(nTd).css('padding', '8px')
                                    }
                                }
                            },
                            {
                                /*CARRERA*/
                                aTargets: [1],
                                width: "15%",
                                fnCreatedCell: function(nTd, sData, oData, iRow, iCol)
                                {
                                    if(sData != 'NULL') {
                                        $(nTd).css('text-align', 'center')
                                        $(nTd).css('vertical-align', 'middle')
                                        $(nTd).css('padding', '8px')
                                    }
                                }
                            },
                            {
                                /*TIPO DE TITULACIÓN*/
                                aTargets: [2],
                                width: "10%",
                                fnCreatedCell: function(nTd, sData, oData, iRow, iCol)
                                {
                                    if(sData != 'NULL') {
                                        $(nTd).css('text-align', 'center')
                                        $(nTd).css('vertical-align', 'middle')
                                        $(nTd).css('padding', '8px')
                                    }
                                }
                            },
                            {
                                /*ESTADO DE TITULACION*/
                                aTargets: [3],
                                width: "10%",
                                mRender: function (data, type, row)
                                {
                                    return '<input type="hidden" class="dt-col-estado-usuario" value="' + (data) + '"/>';
                                },
                                fnCreatedCell: function(nTd, sData, oData, iRow, iCol)
                                {
                                    if(sData != 'NULL') {
                                        $(nTd).css('text-align', 'center')
                                        $(nTd).css('vertical-align', 'middle')
                                        $(nTd).css('padding', '8px')
                                    }
                                }
                            },
                            {
                                /*ESTADO DE BASE DE DATOS*/
                                aTargets: [4],
                                width: "10%",
                                mRender: function (data, type, row)
                                {
                                    return '<input type="hidden" class="dt-col-status" value="' + (data ? 1 : 0) + '"/>';
                                },
                                fnCreatedCell: function(nTd, sData, oData, iRow, iCol)
                                {
                                    if(sData != 'NULL') {
                                        $(nTd).css('text-align', 'center')
                                        $(nTd).css('vertical-align', 'middle')
                                        $(nTd).css('padding', '8px')
                                    }
                                },
                                visible: oPermissions.canView,
                            },
                            {
                                /*ACCIONES*/
                                aTargets: [5],
                                width: "10%",
                                mRender: function (data, type, row)
                                {
                                    return '<input type="hidden" class="dt-col-option" value="' + (data.id) + '"/>'+
                                        '<input type="hidden" class="dt-col-option-status" value="' + (data.status ? 1 : 0) + '"/>'+
                                        '<input type="hidden" class="dt-col-option-idm" value="' + (data.idm) + '"/>' +
                                        '<input type="hidden" class="dt-col-option-idi" value="' + (data.idi) + '"/>' +
                                        '<input type="hidden" class="dt-col-option-alumno" value="' + (data.alumno) + '" />';
                                },
                                fnCreatedCell: function(nTd, sData, oData, iRow, iCol)
                                {
                                    if(sData != 'NULL') {
                                        $(nTd).css('text-align', 'center')
                                        $(nTd).css('vertical-align', 'middle')
                                        $(nTd).css('padding', '8px')
                                    }
                                }
                            },
                        ]
                    ,
                    fnDrawCallback: function (oSettingst)
                    {
                        var count = 0;

                        //$('#divDetailData table').unblock();

                        //aTargets: [3]
                        $('.dt-col-estado-usuario').each(function () {
                            var data = $(this).val();
                            var html = '';
                            /*
                            (1, u'APTO'),
                            (2, u'NO APTO'),
                            (3, u'NO VALIDADO'),
                            */
                            if(data==1){
                                html = '<span class="label label-success" >APTO</span>';
                            }
                            else if(data==2){
                                html = '<span class="label label-important" >NO APTO</span>';
                            }
                            else if(data==3){
                                html = '<span class="label label-warning" >NO VALIDADO</span>';
                            }
                            else if(data==5){
                                html = '<span class="label label-default" >EN REVISIÓN</span>';
                            }

                            var $html = $(html);

                            $(this).after($html);
                        });

                        //aTargets: [4]
                        $('.dt-col-status').each(function () {
                            var data = $(this).val();
                            var html = '';
                            if (data==1){
                                html = '<span class="label label-success" >Activo</span>';
                            }
                            else{
                                html = '<span class="label label-important" >Inactivo</span>';
                            }
                            var $html = $(html);
                            $(this).after($html);
                        });

                        //aTargets: [5]
                        $('.dt-col-option').each(function () {
                            var id = $(this).val();
                            var idm = $('.dt-col-option-idm').eq(count).val();
                            var idi = $('.dt-col-option-idi').eq(count).val();
                            var status = $('.dt-col-option-status').eq(count).val();
                            var alumno = $('.dt-col-option-alumno').eq(count).val();
                            var html = ''+
                                '<div class="btn-group">'+
                                '<a class="btn btn-mini dropdown-toggle" data-toggle="dropdown" href="javascript:;">Acciones<span class="caret"></span></a>'+
                                '<ul class="dropdown-menu pull-right list-group" style="text-align: left;">'+
                                '<li><a href="javascript:;" class="dt-action-validar" id="'+id+'"><i class="fa fa-bell" ></i> Requisitos de Titulación</a></li>'+
                                '<li><a href="/inscripciones?id='+idi+'" target="_blank"><i class="fa fa-users"></i> Inscripción</a></li>'+
                                '<li><a href="/inscripciones?action=record&id='+idi+'" target="_blank"><i class="fa fa-flag"></i> Record Académico</a></li>'+
                                '<li><a href="/inscripciones?action=alumalla&id='+idi+'" target="_blank"><i class="fa fa-th"></i> Su Malla</a></li>'+
                                '</ul>'+
                                '</a>'+
                                '</div>';

                            /*var html = '' +
                                '<div class="table-controls">' +
                                '<a class="btn btn-warning btn-mini dt-action-edit tu" title="Editar" data-original-title="Editar"  href="javascript:;" id="' + id + '"><span class="fa fa-edit"></span> </a> ';

                            if( oPermissions.canView && status==1) {
                                if (oPermissions.canView){
                                    html += '<a class="btn btn-danger btn-mini dt-action-inactive tu" title="Inactivar" data-original-title="Inactivar"  href="javascript:;" id="'+id+'"><span class="fa fa-close"></span> </a>';
                                }
                            }else if(status==0){
                                html += '<a class="btn btn-info btn-mini dt-action-active tu" title="Activar" data-original-title="Activar"  href="javascript:;" id="'+id+'"><span class="fa fa-check"></span> </a>';
                            }*/

                            var $html = $(html);

                            $(".dt-action-validar", $html).click(function (){
                                //ModalActivityRegister.open(false, idc, idd, responsable);
                                var aData = {"id": id, "idm": idm, "idi": idi, "alumno": alumno, "action": "LoadRequirementsStudentInformation"}
                                ModalValidateRequirements.open(aData);
                                //console.log(id);
                            });

                            $(this).after($html);
                            count++;
                        });
                    }

                });

                $('[name="filtro_periodo"] , [name="filtro_carrera"], [name="filtro_estado"]').change(function () {
                    var filtro_carrera = $('[name="filtro_carrera"]').val();
                    //console.log(filtro_carrera);
                    if (filtro_carrera>0){
                        $('#divDetailData table').dataTable().fnDraw();
                    }

                });

                $('[name=filtro_coordinacion]').change(function () {
                    var self = this;
                    var html = '';
                    var id_coordinacion_select = $('select[name=filtro_coordinacion] option:selected').val();
                    $('[name=filtro_carrera]').empty();
                    var data = {'action': 'LoadCarrerasByCoordinacion', 'idc': id_coordinacion_select}
                    if(id_coordinacion_select > 0)
                    {
                        bloqueointerface();
                        ValidationQualificationRequirementsModel.Ajax(data, function (rData){
                            $.unblockUI();
                            if (rData.result == 'ok')
                            {

                                if(rData.eCarreras && rData.eCarreras.length >0){
                                    //console.log(html);
                                    html = '<option value="0">------------------</option>';

                                    /*var data = {
                                        id: 0,
                                        text: '------------------'
                                    };
                                    var newOptionClear = new Option(data.text, data.id, false, false);
                                    $('[name=filtro_carrera]').append(newOptionClear).trigger('change');*/


                                    $.each(rData.eCarreras, function( index, objData ){
                                        //console.log(objData);
                                        html+='<option value="'+objData.id+'">'+objData.text+'</option>';
                                    });
                                }
                                else
                                {
                                    html ='<option value="0">NO EXISTEN CARRERAS</option>';
                                    /*var data = {
                                        id: 0,
                                        text: 'NO EXISTEN CARRERAS'
                                    };
                                    var newOptionClear = new Option(data.text, data.id, false, false);
                                    $('[name=filtro_carrera]').append(newOptionClear).trigger('change');*/
                                }
                                $('[name=filtro_carrera]').html(html);
                                $('[name=filtro_carrera]').val('0'); // Select the option with a value of '1'
                                $('[name=filtro_carrera]').trigger('change'); // Notify any JS components that the value changed
                            }
                            else
                            {
                                smoke.alert(data.mensaje);
                            }
                        }, function (fError){
                            $.unblockUI();
                            smoke.alert("No hay datos de respuesta en esta solicitud!");
                        });
                    }
                    else
                    {
                        html ='<option value="0">NO EXISTEN CARRERAS</option>';
                        $('[name=filtro_carrera]').html(html);
                        /*var data = {
                            id: 0,
                            text: 'NO EXISTEN CARRERAS'
                        };
                        var newOptionClear = new Option(data.text, data.id, false, false);
                        $('[name=filtro_carrera]').append(newOptionClear).trigger('change');*/

                        $('[name=filtro_carrera]').val('0'); // Select the option with a value of '1'
                        $('[name=filtro_carrera]').trigger('change'); // Notify any JS components that the value changed
                    }
                    //$('[name=filtro_carrera]').trigger("refresh");
                    //$('[name=filtro_carrera]').trigger("change");

                });

                $('[name=filtro_coordinacion_m]').change(function () {
                    var self = this;
                    var html = '';
                    var id_coordinacion_select = $('select[name=filtro_coordinacion_m] option:selected').val();
                    $('[name=filtro_carrera_m]').empty();
                    var data = {'action': 'LoadCarrerasByCoordinacion', 'idc': id_coordinacion_select}
                    if(id_coordinacion_select > 0)
                    {
                        bloqueointerface();
                        ValidationQualificationRequirementsModel.Ajax(data, function (rData){
                            $.unblockUI();
                            if (rData.result == 'ok')
                            {

                                if(rData.eCarreras && rData.eCarreras.length >0){
                                    //console.log(html);
                                    html = '<option value="0">TODO</option>';

                                    /*var data = {
                                        id: 0,
                                        text: '------------------'
                                    };
                                    var newOptionClear = new Option(data.text, data.id, false, false);
                                    $('[name=filtro_carrera]').append(newOptionClear).trigger('change');*/


                                    $.each(rData.eCarreras, function( index, objData ){
                                        //console.log(objData);
                                        html+='<option value="'+objData.id+'">'+objData.text+'</option>';
                                    });
                                }
                                else
                                {
                                    html ='<option value="0">TODO</option>';
                                    /*var data = {
                                        id: 0,
                                        text: 'NO EXISTEN CARRERAS'
                                    };
                                    var newOptionClear = new Option(data.text, data.id, false, false);
                                    $('[name=filtro_carrera]').append(newOptionClear).trigger('change');*/
                                }
                                $('[name=filtro_carrera_m]').html(html);
                                $('[name=filtro_carrera_m]').val('0'); // Select the option with a value of '1'
                                $('[name=filtro_carrera_m]').trigger('change'); // Notify any JS components that the value changed
                            }
                            else
                            {
                                smoke.alert(data.mensaje);
                            }
                        }, function (fError){
                            $.unblockUI();
                            smoke.alert("No hay datos de respuesta en esta solicitud!");
                        });
                    }
                    else
                    {
                        html ='<option value="0">TODO</option>';
                        $('[name=filtro_carrera_m]').html(html);
                        /*var data = {
                            id: 0,
                            text: 'NO EXISTEN CARRERAS'
                        };
                        var newOptionClear = new Option(data.text, data.id, false, false);
                        $('[name=filtro_carrera]').append(newOptionClear).trigger('change');*/

                        $('[name=filtro_carrera_m]').val('0'); // Select the option with a value of '1'
                        $('[name=filtro_carrera_m]').trigger('change'); // Notify any JS components that the value changed
                    }
                    //$('[name=filtro_carrera]').trigger("refresh");
                    //$('[name=filtro_carrera]').trigger("change");

                });


            },
            valueFilterByElement: function (element)
            {
                var valor = [];
                $('[name="' + element + '"] option:selected').each(function () {
                    valor.push([$(this).attr('value')]);
                });
                return valor;
            }
        };

        var ModalMigrateEnrrolled = {
            init: function ()
            {
                var self = this;

                self.$modalMigrateEnrolled = $('#modalMigrateEnrolled');
                self.$frmMigrateEnrolled = $("[name='frmMigrateEnrolled']", self.$modalMigrateEnrolled);
                self.$tbDetalleMigrate = $("#tbDetalleMigrate", self.$modalMigrateEnrolled);
                self.$elTableMigrateRow = $('[element="table-migrate-row"]');


                /*ENTRA UNA UNICA VEZ*/
                height_window = $( window ).height();
                //altura = $(this).outerHeight();
                self.$modalMigrateEnrolled.find('.modal-body').css({
                    'height': function (){
                        //console.log($(this).outerHeight());
                        altura_body = $(this).outerHeight();
                        return height_window-altura_body-100;
                    }
                });
                altura_body = $(this).find('.modal-body').height();
                //console.log(height_window-altura_body)
                self.$modalMigrateEnrolled.css('margin-top', altura_body-height_window+50)

                self.$modalMigrateEnrolled.on("show.bs.modal", function () {

                });

                self.$modalMigrateEnrolled.on("hidden.bs.modal", function () {
                });

                $(".action-close", self.$modalMigrateEnrolled).click(function (){
                    var self = this;
                    //$('#modalMigrateEnrolled').modal('hide');
                    ModalMigrateEnrrolled.close();
                });

                $(".action-migrate", self.$modalMigrateEnrolled).click(function (){
                    //var self = this;
                    self.actionMigrate();
                });

                $('[name=obj_migrar_is_coordinacion]', self.$frmMigrateEnrolled).click(function() {
                    var self = this;
                    var isChecked = Boolean ($('[name=obj_migrar_is_coordinacion]', self.$frmMigrateEnrolled).is(':checked')===true);
                    //console.log(isChecked)
                    if (isChecked)
                    {
                        $('#idObj_migrar_carrera', self.$frmMigrateEnrolled).hide();
                    }
                    else
                    {
                        $('#idObj_migrar_carrera', self.$frmMigrateEnrolled).show();
                    }
                    $('[name=obj_migrar_coordinacion]', self.$frmMigrateEnrolled).change();
                });

                $('[name=obj_migrar_coordinacion]', self.$frmMigrateEnrolled).change(function () {
                    var self = this;
                    var html = '';
                    var id_coordinacion_select = $('select[name=obj_migrar_coordinacion] option:selected', self.$frmMigrateEnrolled).val();
                    var isCheckedCoordinacion = Boolean ($('[name=obj_migrar_is_coordinacion]', self.$frmMigrateEnrolled).is(':checked')===true);
                    $('[name=obj_migrar_carrera]', self.$frmMigrateEnrolled).empty();
                    var data = {'action': 'LoadCarrerasByCoordinacion', 'idc': id_coordinacion_select}
                    if(id_coordinacion_select > 0)
                    {

                        if (isCheckedCoordinacion){

                            var data = {
                                'action': 'LoadDataInformationMigrate',
                                'idp': $('[name=obj_migrar_periodo]', self.$frmMigrateEnrolled).val(),
                                'idc': $('[name=obj_migrar_coordinacion]', self.$frmMigrateEnrolled).val(),
                                'idcc': JSON.stringify([]),
                                'isCoordinacion': isCheckedCoordinacion ? 1 : 0
                            }
                            $('#tbodyDetalleMigrate', ModalMigrateEnrrolled.$modalMigrateEnrolled).empty();
                            $("#tbDetalleMigrate", ModalMigrateEnrrolled.$modalMigrateEnrolled).css('display','none');
                            //console.log(data);
                            bloqueointerface();
                            ValidationQualificationRequirementsModel.Ajax(data, function (rData){
                                $.unblockUI();
                                //console.log(rData);
                                if(rData.result=='ok')
                                {
                                    if(rData.aData && rData.aData.length >0){
                                        //html = '<option value="0">------------------</option>';
                                        ModalMigrateEnrrolled.trLoadMigrateInfo(rData.aData);
                                        $("#tbDetalleMigrate", self.$modalMigrateEnrolled).css({'display': 'block'});
                                        //$("#divDetalleMigrate", self.$modalMigrateEnrolled).css({'display': 'block', 'height': '200px'});
                                        //$('#modalMigrateEnrolled').css("margin-top", "-10%");
                                    }
                                    else
                                    {
                                        smoke.alert("No hay registros de datos a migrar!");
                                    }
                                }
                                else
                                {
                                    smoke.alert(rData.mensaje);
                                }
                            }, function (fError){
                                $.unblockUI();
                                smoke.alert("No hay datos de respuesta en esta solicitud!");
                            });
                        }
                        else
                        {
                            bloqueointerface();
                            ValidationQualificationRequirementsModel.Ajax(data, function (rData){
                                $.unblockUI();
                                if (rData.result == 'ok')
                                {

                                    if(rData.eCarreras && rData.eCarreras.length >0){
                                        //html = '<option value="0">------------------</option>';
                                        $.each(rData.eCarreras, function( index, objData ){
                                            html+='<option value="'+objData.id+'">'+objData.text+'</option>';
                                        });
                                    }
                                    else
                                    {
                                        //html ='<option value="0">NO EXISTEN CARRERAS</option>';
                                    }
                                    $('[name=obj_migrar_carrera]', self.$frmMigrateEnrolled).html(html);
                                    //$('[name=obj_migrar_carrera]', self.$frmMigrateEnrolled).val('0'); // Select the option with a value of '1'
                                    $('[name=obj_migrar_carrera]', self.$frmMigrateEnrolled).trigger('change'); // Notify any JS components that the value changed
                                }
                                else
                                {
                                    smoke.alert(data.mensaje);
                                }
                            }, function (fError){
                                $.unblockUI();
                                smoke.alert("No hay datos de respuesta en esta solicitud!");
                            });
                        }
                    }
                    else
                    {
                        //html ='<option value="0">NO EXISTEN CARRERAS</option>';
                        $('[name=obj_migrar_carrera]', self.$frmMigrateEnrolled).html(html);
                        //$('[name=obj_migrar_carrera]', self.$frmMigrateEnrolled).val('0'); // Select the option with a value of '1'
                        $('[name=obj_migrar_carrera]', self.$frmMigrateEnrolled).trigger('change'); // Notify any JS components that the value changed
                    }
                });

                $('[name=obj_migrar_carrera]', self.$frmMigrateEnrolled).change(function () {
                    var self = this;
                    var carreras = JSON.stringify($(this).val());
                    var ifCarreras = Boolean ($(this).val()===null)
                    $('#tbodyDetalleMigrate', ModalMigrateEnrrolled.$modalMigrateEnrolled).empty();
                    $("#tbDetalleMigrate", ModalMigrateEnrrolled.$modalMigrateEnrolled).css('display','none');
                    var isCheckedCoordinacion = Boolean ($('[name=obj_migrar_is_coordinacion]', self.$frmMigrateEnrolled).is(':checked')===true);
                    if (!ifCarreras)
                    {
                        //console.log(carreras)
                        var data = {
                            'action': 'LoadDataInformationMigrate',
                            'idp': $('[name=obj_migrar_periodo]', self.$frmMigrateEnrolled).val(),
                            'idc': $('[name=obj_migrar_coordinacion]', self.$frmMigrateEnrolled).val(),
                            'idcc':carreras ,
                            'isCoordinacion': isCheckedCoordinacion ? 1 : 0
                        }
                        //console.log(data);
                        bloqueointerface();
                        ValidationQualificationRequirementsModel.Ajax(data, function (rData){
                            $.unblockUI();
                            //console.log(rData);
                            if(rData.result=='ok')
                            {
                                if(rData.aData && rData.aData.length >0){
                                    //html = '<option value="0">------------------</option>';
                                    ModalMigrateEnrrolled.trLoadMigrateInfo(rData.aData);
                                    $("#tbDetalleMigrate", self.$modalMigrateEnrolled).css({'display': 'block'});
                                    //$("#divDetalleMigrate", self.$modalMigrateEnrolled).css({'display': 'block', 'height': '200px'});
                                    //$('#modalMigrateEnrolled').css("margin-top", "-30%");
                                }
                                else
                                {
                                    smoke.alert("No hay registros de datos a migrar!");
                                }
                            }
                            else
                            {
                                smoke.alert(rData.mensaje);
                            }
                        }, function (fError){
                            $.unblockUI();
                            smoke.alert("No hay datos de respuesta en esta solicitud!");
                        });
                    }

                });

            },
            actionMigrate: function ()
            {
                var self = this;
                var alternativas = [];
                var tMatriculados = 0;
                $('#tbodyDetalleMigrate > tr', self.$modalMigrateEnrolled).each(function () {
                    var $tr = $(this);

                    var dt = $tr.data();

                    alternativas.push(dt.id_alternativa);
                    tMatriculados = tMatriculados + dt.total
                });

                var isCheckedCoordinacion = Boolean ($('[name=obj_migrar_is_coordinacion]', self.$frmMigrateEnrolled).is(':checked')===true);
                var data = {
                    'action': 'SaveMigrateData',
                    'idp': $('[name=obj_migrar_periodo]', self.$frmMigrateEnrolled).val(),
                    'idc': $('[name=obj_migrar_coordinacion]', self.$frmMigrateEnrolled).val(),
                    'idcc': JSON.stringify($('[name=obj_migrar_carrera]', self.$frmMigrateEnrolled).val()) ,
                    'isCoordinacion': isCheckedCoordinacion ? 1 : 0,
                    'idas' : JSON.stringify(alternativas),
                    'total' : tMatriculados,
                }
                bloqueointerface();
                ValidationQualificationRequirementsModel.Ajax(data, function (rData){
                    $.unblockUI();
                    //console.log(rData);
                    if(rData.result=='ok')
                    {
                        //ValidationQualificationRequirementsController.$table
                        ModalMigrateEnrrolled.close();
                        $('#divDetailData table').dataTable().fnDraw();
                        smoke.alert(rData.mensaje);
                    }
                    else
                    {
                        smoke.alert(rData.mensaje);
                    }
                }, function (fError){
                    $.unblockUI();
                    smoke.alert("No hay datos de respuesta en esta solicitud!");
                });
            },
            trLoadMigrateInfo: function (data)
            {
                var self = this;
                $.each(data, function( index, objData ){
                    aFacultad = objData.aFacultad;
                    aPeriodo = objData.aPeriodo;
                    aTotalMatriculados = objData.aTotalMatriculados;
                    aGrupos = objData.aGrupos;
                    $("#tbPeriodoTitulacion", self.$modalMigrateEnrolled).html(aPeriodo.nombre);
                    $("#tbCoordinacion", self.$modalMigrateEnrolled).html(aFacultad.nombre);
                    $("#tbTotal", self.$modalMigrateEnrolled).html(aTotalMatriculados);
                    //$tBody
                    $.each(aGrupos, function (i, objGrupo) {
                        //console.log(objGrupo.aAlternativas);
                        aAlternativas = objGrupo.aAlternativas;
                        $.each(aAlternativas, function (i, objAlternativa) {
                            //console.log(objAlternativa.aCarrera.nombre);
                            //console.log(objAlternativa.aTipo.nombre);

                            var $tr = $("tbody > tr", self.$elTableMigrateRow).clone();

                            $tr.data({'id_alternativa': objAlternativa.id, 'total': objAlternativa.aMatriculados});
                            $('td:nth-child(1)', $tr).html(objAlternativa.aCarrera.nombre);
                            $('td:nth-child(2)', $tr).html(objAlternativa.aTipo.nombre);
                            $('td:nth-child(3)', $tr).html(objAlternativa.aMatriculados);
                            //$('td:nth-child(4)', $tr).html("");
                            $('#tbodyDetalleMigrate', self.$modalMigrateEnrolled).append($tr)
                        });
                    });
                });
            },
            open: function()
            {
                var self = this
                //$('[name=obj_migrar_is_coordinacion]', self.$frmMigrateEnrolled).change();
                $('[name=obj_migrar_is_coordinacion]', self.$frmMigrateEnrolled).prop("checked", false).change();
                $('#idObj_migrar_carrera', self.$frmMigrateEnrolled).show();
                self.$modalMigrateEnrolled
                    .off('shown.bs.modal')
                    .on('shown.bs.modal', function () {
                        $(this).find('.modal-body').css({'overflow-y': 'scroll'});

                        $('[name=obj_migrar_periodo]', self.$frmMigrateEnrolled).val($('[name=obj_migrar_periodo]:eq(1)', self.$frmMigrateEnrolled).val()); // Select the option with a value of '1'
                        $('[name=obj_migrar_periodo]', self.$frmMigrateEnrolled).trigger('change'); // Notify any JS components that the value changed
                        $('[name=obj_migrar_coordinacion]', self.$frmMigrateEnrolled).val($('[name=obj_migrar_coordinacion]:eq(1)', self.$frmMigrateEnrolled).val()); // Select the option with a value of '1'
                        $('[name=obj_migrar_coordinacion]', self.$frmMigrateEnrolled).trigger('change'); // Notify any JS components that the value changed
                    })
                    .modal('show');
            },
            close: function()
            {
                var self = this;
                $('[name=obj_migrar_is_coordinacion]', self.$frmMigrateEnrolled).prop("checked", false);
                $("#tbDetalleMigrate", self.$modalMigrateEnrolled).css('display','none');
                self.$modalMigrateEnrolled.modal('hide');
                //$(selector).modal('hide').destroy();
            }
        };

        var ModalValidateRequirements = {
            init: function ()
            {
                var self = this;

                self.$modalValidarRequisitos = $('#modalValidarRequisitos');
                //self.$frmValidarRequisitos = $("[name='frmValidarRequisitos']", self.$modalValidarRequisitos);
                self.$tableRequisitos = $("#tbDetalleRequisitos", self.$modalValidarRequisitos);
                self.$elTableRequisitoRow = $('[element="table-requisitos-row"]');
                height_window = $( window ).height();
                self.$modalValidarRequisitos.find('.modal-body').css({
                    'height': function (){
                        altura_body = $(this).outerHeight();
                        return height_window-altura_body-100;
                    },'overflow-y': 'scroll'});
                altura_body = self.$modalValidarRequisitos.find('.modal-body').height();
                self.$modalValidarRequisitos.css('margin-top', -((height_window-50)/2))

                self.$modalValidarRequisitos.on("show.bs.modal", function () {
                });

                self.$modalValidarRequisitos.on("hidden.bs.modal", function () {
                });

                $(".action-close", self.$modalValidarRequisitos).click(function (){
                    ModalValidateRequirements.close();
                });

                $(".action-validate", self.$modalValidarRequisitos).click(function (){
                    //var self = this;
                    //self.actionMigrate();
                });
            },
            trLoadRequisitoInfo: function (data)
            {
                //console.log(data);
                var self = this;
                $('#tbodyDetalleRequisitos', ModalValidateRequirements.$modalValidarRequisitos).empty();
                //$('#tbodyDetalleMigrate', ModalMigrateEnrrolled.$modalMigrateEnrolled).empty();
                $.each(data, function( index, objData ){
                    id                  = objData.id;
                    ultimo_usuario      = objData.ultimo_usuario;
                    ultima_fecha        = objData.ultima_fecha;
                    requisito           = objData.requisito;
                    estado_usuario      = objData.estado_usuario;
                    observacion_usuario = objData.observacion_usuario;
                    tipo_requisito      = objData.tiporequisito;
                    inscripcion         = objData.inscripcion;
                    estado_usuario_html = '';
                    if (estado_usuario==1){
                        estado_usuario_html = '<span class="label label-success" >APTO</span>';
                    }
                    else if(estado_usuario==2){
                        estado_usuario_html = '<span class="label label-important" >NO APTO</span>';
                    }
                    else if(estado_usuario==3){
                        estado_usuario_html = '<span class="label label-warning" >NO VALIDADO</span>';
                    }
                    else if(estado_usuario==4){
                        estado_usuario_html = '<span class="label label-info" >NO APLICA</span>';
                    }


                    var html_controls = '' +
                        '<div class="table-controls">' +
                        '<a class="btn btn-info btn-mini dt-action-view tu" title="Ver" data-original-title="Ver"  href="javascript:;" id="'+id+'" tiporequisito="'+tipo_requisito+'" estado="'+estado_usuario+'"><span class="fa fa-search-plus"></span></a> ' +
                        '<a class="btn btn-default btn-mini dt-action-certificate tu" title="Certificado" data-original-title="Certificado"  href="javascript:;" id="'+id+'" tiporequisito="'+tipo_requisito+'" inscripcion="'+inscripcion+'"><span class="fa fa-folder-open"></span></a> ' +
                        '</div>';

                    var $tr = $("tbody > tr", self.$elTableRequisitoRow).clone();
                    $tr.data({'id_validar': id, 'tiporequisito': tipo_requisito});
                    $('td:nth-child(1)', $tr).html(requisito);
                    $('td:nth-child(2)', $tr).html("<span>Usuario: "+ ultimo_usuario + "</span> <br/> <span>Fecha: "+ ultima_fecha +"</span>");
                    $('td:nth-child(3)', $tr).html(estado_usuario_html);
                    $('td:nth-child(4)', $tr).html(observacion_usuario);
                    $('td:nth-child(5)', $tr).html(html_controls);

                    //var $html_controls = $(html_controls);

                    $(".dt-action-view", $tr).click(function (){
                        //console.log($(this).attr("id"));
                        //console.log($(this).attr("tiporequisito"));
                        var id_view = $(this).attr("id")
                        var tiporequisito_view = $(this).attr("tiporequisito")
                        var estado_view = $(this).attr("estado")
                        ModalViewRequest.open({"id": id_view, "tiporequisito": tiporequisito_view, 'action': 'LoadInfRequestStudent', "estado": estado_view});
                    });

                    $(".dt-action-certificate", $tr).click(function(){
                        var id_view = $(this).attr("id")
                        var tiporequisito_view = $(this).attr("tiporequisito")
                        var inscripcion_view = $(this).attr("inscripcion")
                        ModalViewCertificate.open({"id": id_view, "tiporequisito": tiporequisito_view, 'action': 'LoadInfCertificateStudent', "inscripcion": inscripcion_view});
                    });
                    $('#tbodyDetalleRequisitos', self.$modalValidarRequisitos).append($tr)
                    //$('#tbodyDetalleRequisitos', self.$modalValidarRequisitos).after($tr)
                });
            },
            open: function(data)
            {
                /*{"id": id, "idm": idm, "idi": idi, "alumno": alumno, "action": "LoadRequirementsStudentInformation"}*/
                var self = this
                bloqueointerface();
                $('.student-name-title', self.$modalValidarRequisitos).html(data.alumno);
                ValidationQualificationRequirementsModel.Ajax(data, function (rData){
                    $.unblockUI();
                    //console.log(rData);
                    if(rData.result=='ok')
                    {
                        $('#tbodyDetalleRequisitos', ModalValidateRequirements.$modalValidarRequisitos).empty();
                        ModalValidateRequirements.trLoadRequisitoInfo(rData.aData);
                    }
                    else
                    {
                        smoke.alert(rData.mensaje);
                    }
                }, function (fError){
                    $.unblockUI();
                    smoke.alert("No hay datos de respuesta en esta solicitud!");
                });


                self.$modalValidarRequisitos
                    .off('shown.bs.modal')
                    .on('shown.bs.modal', function (event) {
                        $(this).find('.modal-body').css({'overflow-y': 'scroll'});
                    })
                    .modal('show');
            },
            close: function(){
                var self = this;
                //console.log($('#tbodyDetalleRequisitos'));
                $('#tbodyDetalleRequisitos', ModalValidateRequirements.$modalValidarRequisitos).empty();
                //console.log($('#tbodyDetalleRequisitos'));
                self.$modalValidarRequisitos.modal('hide');
            }
        }

        var ModalViewRequest = {
            init: function ()
            {
                var self = this;
                self.$modalViewRequest = $('#modalViewRequest');
                height_window = $( window ).height();
                self.$modalViewRequest.find('.modal-body').css({
                    'height': function (){
                        altura_body = $(this).outerHeight();
                        return height_window-altura_body-100;
                    },'overflow-y': 'scroll'});
                altura_body = self.$modalViewRequest.find('.modal-body').height();
                self.$modalViewRequest.css('margin-top', -((height_window-100)/2))

                self.$modalViewRequest.on("show.bs.modal", function () {
                });

                self.$modalViewRequest.on("hidden.bs.modal", function () {
                });

                $(".action-close", self.$modalViewRequest).click(function (){
                    ModalViewRequest.close();
                });


                $('.action-save-no-aplica, .action-save-apto, .action-save-no-apto', self.$modalViewRequest).click(function(){

                    var ide = $(this).attr("ide");
                    var id_estado_sistema = $('#id_estado_sistema', self.$modalViewRequest).val()
                    var id = $('#id_validacion', self.$modalViewRequest).val();
                    var msg = "";
                    console.log("id:" + id);
                    console.log("ide:" + ide);
                    console.log("id_estado_sistema:" + id_estado_sistema);
                    if (ide==2)
                    {
                        msg = "Ingrese la observacion, por el cual no esta apto"
                    }
                    if (ide==4)
                    {
                        msg = "Ingrese la observacion, por el cual no aplica"
                    }
                    if (ide == 2 || ide ==4)
                    {
                        smoke.prompt(msg, function(e){
                            if (e){
                                var aData = {"action": "SaveRequestStudent", "id": id, "ide": ide, "observacion": e, "id_estado_sistema": id_estado_sistema}
                                bloqueointerface();
                                ValidationQualificationRequirementsModel.Ajax(aData, function (rData){
                                    //console.log(rData);
                                    if(rData.result=='ok')
                                    {
                                        $('#tbodyDetalleRequisitos', ModalValidateRequirements.$modalValidarRequisitos).empty();
                                        ModalValidateRequirements.trLoadRequisitoInfo(rData.aData);
                                        $.unblockUI();
                                        smoke.alert(rData.mensaje);
                                        ModalViewRequest.close();
                                        ValidationQualificationRequirementsController.$table.dataTable().fnDraw();
                                    }
                                    else
                                    {
                                        $.unblockUI();
                                        smoke.alert(rData.mensaje);
                                    }

                                }, function (fError){
                                    $.unblockUI();
                                    smoke.alert("No hay datos de respuesta en esta solicitud!");
                                });
                            }else{
                                smoke.alert("Error, no se ha guardado, falta observación");
                                return;
                            }
                        }, {
                            ok: "Enviar",
                            cancel: "Cancelar",
                            classname: "custom-class",
                            reverseButtons: true,
                            value: ""
                        });
                    }else
                    {
                        var aData = {"action": "SaveRequestStudent", "id": id, "ide": ide, "observacion": null, "id_estado_sistema": id_estado_sistema}
                        bloqueointerface();
                        ValidationQualificationRequirementsModel.Ajax(aData, function (rData){
                            //console.log(rData);
                            if(rData.result=='ok')
                            {
                                $('#tbodyDetalleRequisitos', ModalValidateRequirements.$modalValidarRequisitos).empty();
                                ModalValidateRequirements.trLoadRequisitoInfo(rData.aData);
                                $.unblockUI();
                                smoke.alert(rData.mensaje);
                                ModalViewRequest.close();
                                ValidationQualificationRequirementsController.$table.dataTable().fnDraw();
                            }
                            else
                            {
                                $.unblockUI();
                                smoke.alert(rData.mensaje);
                            }

                        }, function (fError){
                            $.unblockUI();
                            smoke.alert("No hay datos de respuesta en esta solicitud!");
                        });
                    }
                    //console.log(id);
                    //console.log(observacion);


                });
                /*$('.action-save-apto', self.$modalViewRequest).show();
                $('.action-save-no-apto', self.$modalViewRequest).show();*/

                /*$(".action-validate", self.$modalViewRequest).click(function (){
                    //var self = this;
                    //self.actionMigrate();
                });*/
            },
            open: function(data)
            {
                var self = this
                console.log(data);
                $('#id_validacion', self.$modalViewRequest).val(data.id)
                $('.action-save-no-aplica', self.$modalViewRequest).hide();
                $('.action-save-apto', self.$modalViewRequest).hide();
                $('.action-save-no-apto', self.$modalViewRequest).hide();
                /*{"id": id_view, "tiporequisito": tiporequisito_view, 'action': 'LoadInfRequestStudent', "estado": estado_view}*/
                /*TIPO_REQUISITOS = ((1, u"ESTADO CREDITO"),(2, u"ESTADO NIVEL"),(3, u"ESTADO ADEUDAR"),(4, u"ESTADO FICHA ESTUDIANTIL"),
                                    (5, u"ESTADO INGLES"),(6, u"ESTADO PRACTICAS PREPROFESIONALES"),(7, u"ESTADO VINCULACION"),(8, u"ESTADO COMPUTACION"))*/
                var html_requisito = "";
                switch (parseInt(data.tiporequisito)) {
                    case 1:
                        html_requisito = "Aprobación de las asignaturas desde el primero al penúltimo nivel de la malla curricular.";
                        break;
                    case 2:
                        html_requisito = "Aprobación de las asignaturas desde el primero al último nivel de la malla curricular.";
                        break;
                    case 3:
                        html_requisito = "No adeudar aranceles.";
                        break;
                    case 4:
                        html_requisito = "Ficha estudiantil actualizada y completa.";
                        break;
                    case 5:
                        html_requisito = "Aprobación de módulos de idioma inglés.";
                        break;
                    case 6:
                        html_requisito = "Prácticas pre profesionales.";
                        break;
                    case 7:
                        html_requisito = "Vinculación con la sociedad.";
                        break;
                    case 8:
                        html_requisito = "Aprobación de créditos de computación.";
                    default:
                        html_requisito;
                        break;
                }



                bloqueointerface();
                $('.request-name-title', self.$modalViewRequest).html(html_requisito);
                $('.viewpage_request_html', self.$modalViewRequest).empty();
                if (data.estado == 1)
                {
                    $('.action-save-no-aplica', self.$modalViewRequest).hide();
                    $('.action-save-apto', self.$modalViewRequest).hide();
                    $('.action-save-no-apto', self.$modalViewRequest).hide();
                }
                if (data.estado == 2)
                {
                    $('.action-save-no-aplica', self.$modalViewRequest).show();
                    $('.action-save-apto', self.$modalViewRequest).show();
                    $('.action-save-no-apto', self.$modalViewRequest).hide();
                }
                if(data.estado == 3)
                {
                    $('.action-save-no-aplica', self.$modalViewRequest).show();
                    $('.action-save-apto', self.$modalViewRequest).show();
                    $('.action-save-no-apto', self.$modalViewRequest).show();
                }

                if(data.estado == 4)
                {
                    $('.action-save-no-aplica', self.$modalViewRequest).hide();
                    $('.action-save-apto', self.$modalViewRequest).show();
                    $('.action-save-no-apto', self.$modalViewRequest).show();
                }
                ValidationQualificationRequirementsModel.Ajax(data, function (rData){
                    $.unblockUI();
                    //console.log(rData);
                    if(rData.result=='ok')
                    {
                        $('.viewpage_request_html', self.$modalViewRequest).html(rData.data);
                        $('#id_estado_sistema', self.$modalViewRequest).val(rData.aData.estado_sistema)
                    }
                    else
                    {
                        smoke.alert(rData.mensaje);
                    }
                }, function (fError){
                    $.unblockUI();
                    smoke.alert("No hay datos de respuesta en esta solicitud!");
                });

                self.$modalViewRequest
                    .off('shown.bs.modal')
                    .on('shown.bs.modal', function (event) {
                        $(this).find('.modal-body').css({'overflow-y': 'scroll'});
                    })
                    .modal('show');
            },
            close: function()
            {
                var self = this;
                $('#id_validacion', self.$modalViewRequest).val(0)
                $('#id_estado_sistema', self.$modalViewRequest).val(0)
                self.$modalViewRequest.modal('hide');
            }
        }

        var ModalViewCertificate = {
            init: function ()
            {
                var self = this;
                self.$modalViewCertificate = $('#modalViewCertificate');
                self.$tableCertificados = $("#tbDetalleCertificados", self.$modalViewCertificate);
                self.$elTableCertificateRow = $('[element="table-certificate-row"]');
                height_window = $( window ).height();
                self.$modalViewCertificate.find('.modal-body').css({
                    'height': function (){
                        altura_body = $(this).outerHeight();
                        return height_window-altura_body;
                    },'overflow-y': 'scroll'});
                altura_body = self.$modalViewCertificate.find('.modal-body').height();

                self.$modalViewCertificate.css('margin-top', -((height_window-100)/2))

                self.$modalViewCertificate.on("show.bs.modal", function () {
                });

                self.$modalViewCertificate.on("hidden.bs.modal", function () {
                });

                $(".action-close", self.$modalViewCertificate).click(function (){
                    ModalViewCertificate.close();
                });

                $(".generateCertificate", self.$modalViewCertificate).click(function (){
                    //nhref="/reportes?action=run&n=certificado_asistencia_alumno_unemi_digital&variableqr=167909&rt=pdf"
                    var id = parseInt($("#id_va_certificate").val());
                    var inscripcion = parseInt($("#id_inscripcion").val());
                    var tiporequisito = parseInt($("#id_tiporequisito").val());

                    /*TIPO_REQUISITOS = (
                        (1, u"ESTADO CREDITO"), SI
                        (2, u"ESTADO NIVEL"), SI
                        (3, u"ESTADO ADEUDAR"), SI
                        (4, u"ESTADO FICHA ESTUDIANTIL"), SI
                        (5, u"ESTADO INGLES"), SI
                        (6, u"ESTADO PRACTICAS PREPROFESIONALES"),
                        (7, u"ESTADO VINCULACION"), SI
                        (8, u"ESTADO COMPUTACION"), SI
                    )*/
                    var href = null
                    var data = {}

                    if (tiporequisito == 1)
                    {
                        href = "/reportes"
                        data = {"action": "run", "n": "rpt_certificado_aprobar_penultimo_nivel_malla_carrera_alumno_externo", "vqr": inscripcion, "rt": "pdf" }
                    }

                    if (tiporequisito == 2)
                    {
                        href = "/reportes"
                        data = {"action": "run", "n": "rpt_certificado_aprobar_toda_malla_carrera_alumno_externo", "vqr": inscripcion, "rt": "pdf" }
                    }

                    if (tiporequisito == 3)
                    {
                        href = "/reportes"
                        data = {"action": "run", "n": "rpt_certificado_no_adeudo_pregrado", "vqr": inscripcion, "rt": "pdf" }
                    }

                    if (tiporequisito == 4)
                    {
                        href = "/reportes"
                        data = {"action": "run", "n": "certificado_ficha_estudiantil", "inscripcion": inscripcion, "rt": "pdf" }
                    }

                    if (tiporequisito == 5)
                    {
                        href = "/reportes"
                        data = {"action": "run", "n": "rpt_certificado_ingles_alumno_externo", "vqr": inscripcion, "rt": "pdf" }
                    }

                    if (tiporequisito == 7)
                    {
                        href = "/reportes"
                        data = {"action": "run", "n": "rpt_certificado_aprobado_vinculacion", "vqr": inscripcion, "rt": "pdf" }
                    }

                    if (tiporequisito == 8)
                    {
                        href = "/reportes"
                        data = {"action": "run", "n": "rpt_certificado_aprobado_herramientas_informatica_alumno_externo", "vqr": inscripcion, "rt": "pdf" }
                    }

                    if (tiporequisito == 9)
                    {
                        href = "/reportes"
                        data = {"action": "run", "n": "rpt_certificado_sancion_alumno_externo", "vqr": inscripcion, "rt": "pdf" }
                    }

                    bloqueointerface();
                    ValidationQualificationRequirementsModel.Ajax(data, function (rData){
                        console.log(rData);
                        if(rData.result=='ok')
                        {
                            console.log(rData.reportfile)
                            //smoke.alert(rData.reportfile);
                            //url = rData.reportfile;
                            var iData = {"action": "SaveCertificateStudent", "id": id, "url": rData.reportfile }
                            ValidationQualificationRequirementsModel.Ajax(iData, function (eData){
                                $.unblockUI();
                                if(eData.result=='ok')
                                {
                                    ModalViewCertificate.trLoadCerticate(eData.aData);
                                    $(".viewpage_certificate_html", ModalViewCertificate.$modalViewCertificate).html(eData.data);
                                }
                                else
                                {
                                    //smoke.alert(rData.mensaje);
                                    $(".viewpage_certificate_html", ModalViewCertificate.$modalViewCertificate).html('<div style="text-align: center" class="alert alert-danger">' + eData.mensaje + '</div>');
                                }
                            }, function (fError){
                                $.unblockUI();
                                smoke.alert("No hay datos de respuesta en esta solicitud!");
                            });
                        }
                        else
                        {
                            smoke.alert(rData.mensaje);
                        }
                    }, function (fError){
                        $.unblockUI();
                        smoke.alert("No hay datos de respuesta en esta solicitud!");
                    },"GET", "json", href);
                });
            },
            trLoadCerticate: function (data)
            {
                console.log(data);
                var self = this;
                $('#tbodyDetalleCertificados', ModalViewCertificate.$modalViewCertificate).empty();
                $.each(data, function( index, objData ){
                    validacion          = objData.validacion;
                    certificado         = objData.certificado;
                    url                 = objData.url;
                    activo              = objData.activo;
                    fecha_genearacion   = objData.fecha_genearacion;
                    usuario_generacion  = objData.usuario_generacion;
                    activo_html = ''
                    if (activo=='1')
                    {
                        activo_html = '<a class="action-estado" idc="'+certificado+'" activo="'+activo+'" href="javascript:;"><label class="label label-success"><i class="fa fa-check"></i></label></a>';
                    }
                    else
                    {
                        activo_html = '<a class="action-estado" idc="'+certificado+'" activo="'+activo+'" href="javascript:;"><label class="label label-important"><i class="fa fa-remove"></i></label></a>';
                    }

                    //<a class="btn imprimirins btn-warning tu" title="Estudiante"  href="javascript:;" tipos="{{ reporte_10.tiporeporte }}" nhref="/reportes?action=run&n={{ reporte_10.nombre }}&variableqr={{ inscripcion }}"><span class="fa fa-print"></span>Imprimir </a>
                    var html_controls = '' +
                        '<div class="table-controls">' +
                        '<a class="btn btn-info btn-mini dt-action-open tu" title="Abrir Certificado" data-original-title="Abrir Certificado"  href="javascript:;" id="'+validacion+'" id_certificado="'+certificado+'" url="'+url+'"><span class="fa fa-file-pdf-o"></span></a> ' +
                        '</div>';

                    var $tr = $("tbody > tr", self.$elTableCertificateRow).clone();
                    $tr.data({'id_validacion': validacion, 'id_certificado': certificado});
                    $('td:nth-child(1)', $tr).html(fecha_genearacion);
                    $('td:nth-child(2)', $tr).html(usuario_generacion);
                    $('td:nth-child(3)', $tr).html(activo_html);
                    $('td:nth-child(4)', $tr).html(html_controls);

                    $(".action-estado", $tr).click(function (){
                        console.log("entro action-estado")
                        var idc = parseInt($(this).attr("idc"));
                        var activo = parseInt($(this).attr("activo"));
                        if (activo == 0)
                        {
                            bloqueointerface();
                            var data = {"action": "ActiveCertificate", "id": idc }
                            ValidationQualificationRequirementsModel.Ajax(data, function (rData){
                                $.unblockUI();
                                if(rData.result=='ok')
                                {
                                    ModalViewCertificate.trLoadCerticate(rData.aData);
                                    smoke.alert(rData.mensaje);
                                    //$(".viewpage_certificate_html", ModalViewCertificate.$modalViewCertificate).html(rData.data);
                                }
                                else
                                {
                                    smoke.alert(rData.mensaje);
                                }
                            }, function (fError){
                                $.unblockUI();
                                smoke.alert("No hay datos de respuesta en esta solicitud!");
                            });

                        }
                    });


                    $(".dt-action-open", $tr).click(function (){
                        //console.log($(this).attr("id"));
                        //console.log($(this).attr("tiporequisito"));
                        //var id = $(this).attr("id")
                        //var tiporequisito = $(this).attr("id_certificado")
                        var url = $(this).attr("url")

                        bloqueointerface();
                        var data = {"action": "LoadCertificate", "url": url }
                        ValidationQualificationRequirementsModel.Ajax(data, function (rData){
                            $.unblockUI();
                            if(rData.result=='ok')
                            {
                                $(".viewpage_certificate_html", ModalViewCertificate.$modalViewCertificate).html(rData.data);
                            }
                            else
                            {
                                //smoke.alert(rData.mensaje);
                                $(".viewpage_certificate_html", ModalViewCertificate.$modalViewCertificate).html('<div style="text-align: center" class="alert alert-danger">' + rData.mensaje + '</div>');
                            }
                        }, function (fError){
                            $.unblockUI();
                            smoke.alert("No hay datos de respuesta en esta solicitud!");
                        });

                    });

                    $('#tbodyDetalleCertificados', ModalViewCertificate.$modalViewCertificate).append($tr)
                });
            },
            open: function(data)
            {
                var self = this
                console.log(data);
                $('#id_va_certificate', self.$modalViewCertificate).val(data.id)
                $('#id_inscripcion', self.$modalViewCertificate).val(data.inscripcion)
                $('#id_tiporequisito', self.$modalViewCertificate).val(data.tiporequisito)
                /*{"id": id_view, "tiporequisito": tiporequisito_view, 'action': 'LoadInfCertificateStudent', "estado": estado_view}*/
                /*TIPO_REQUISITOS = ((1, u"ESTADO CREDITO"),(2, u"ESTADO NIVEL"),(3, u"ESTADO ADEUDAR"),(4, u"ESTADO FICHA ESTUDIANTIL"),
                                    (5, u"ESTADO INGLES"),(6, u"ESTADO PRACTICAS PREPROFESIONALES"),(7, u"ESTADO VINCULACION"),(8, u"ESTADO COMPUTACION"))*/
                var html_requisito = "";
                switch (parseInt(data.tiporequisito)) {
                    case 1:
                        html_requisito = "Aprobación de las asignaturas desde el primero al penúltimo nivel de la malla curricular.";
                        break;
                    case 2:
                        html_requisito = "Aprobación de las asignaturas desde el primero al último nivel de la malla curricular.";
                        break;
                    case 3:
                        html_requisito = "No adeudar aranceles.";
                        break;
                    case 4:
                        html_requisito = "Ficha estudiantil actualizada y completa.";
                        break;
                    case 5:
                        html_requisito = "Aprobación de módulos de idioma inglés.";
                        break;
                    case 6:
                        html_requisito = "Prácticas pre profesionales.";
                        break;
                    case 7:
                        html_requisito = "Vinculación con la sociedad.";
                        break;
                    case 8:
                        html_requisito = "Aprobación de créditos de computación.";
                    default:
                        html_requisito;
                        break;
                }

                bloqueointerface();
                $('.certificate-name-title', self.$modalViewCertificate).html(html_requisito);
                $('.viewpage_certificate_html', self.$modalViewCertificate).empty();

                ValidationQualificationRequirementsModel.Ajax(data, function (rData){
                    $.unblockUI();
                    //console.log(rData);
                    if(rData.result=='ok')
                    {
                        $('#tbodyDetalleCertificados', ModalViewCertificate.$modalViewCertificate).empty();
                        ModalViewCertificate.trLoadCerticate(rData.aData);
                    }
                    else
                    {
                        smoke.alert(rData.mensaje);
                    }
                }, function (fError){
                    $.unblockUI();
                    smoke.alert("No hay datos de respuesta en esta solicitud!");
                });



                self.$modalViewCertificate
                    .off('shown.bs.modal')
                    .on('shown.bs.modal', function (event) {
                        $(this).find('.modal-body').css({'overflow-y': 'scroll'});
                    })
                    .modal('show');
            },
            close: function()
            {
                var self = this;
                $('#id_va_certificate', self.$modalViewCertificate).val(0)
                $('#id_inscripcion', self.$modalViewCertificate).val(0)
                $('#id_tiporequisito', self.$modalViewCertificate).val(0)
                self.$modalViewCertificate.modal('hide');
            }

        }

        var ModalRunReportValidate = {
            init: function ()
            {
                var self = this
                self.$modalReporteValidacion = $("#modalReporteValidacion");
                //reportValidacion
                self.$frmGenerarReporteValidacion = $("[name='frmGenerarReporteValidacion']", self.$modalReporteValidacion);

                $("#obj_rpt_fecha_inicio, #obj_rpt_fecha_fin").datepicker({format: "dd-mm-yyyy"}).addClass("validate[required]").on('changeDate', function (ev) { //
                    $(this).datepicker('hide');
                });

                /*height_window = $( window ).height();
                self.$modalReporteValidacion.find('.modal-body').css({
                    'height': function (){
                        altura_body = $(this).outerHeight();
                        return height_window-altura_body;
                    },'overflow-y': 'scroll'});
                altura_body = self.$modalReporteValidacion.find('.modal-body').height();

                self.$modalReporteValidacion.css('margin-top', -((height_window-100)/2))*/

                self.$modalReporteValidacion.on("show.bs.modal", function () {
                });

                self.$modalReporteValidacion.on("hidden.bs.modal", function () {
                });

                $(".action-close", self.$modalReporteValidacion).click(function (){
                    ModalRunReportValidate.close();
                });

                $(".action-run-reporte", self.$modalReporteValidacion).click(function(){
                    var id_periodo      = $('#obj_rpt_periodo', self.$modalReporteValidacion).val();
                    var formato         = $('#obj_rpt_format', self.$modalReporteValidacion).val();
                    var id_facultad     = $('#facultad_rp', self.$modalReporteValidacion).val();
                    var id_carrera      = $('#carrera_rp', self.$modalReporteValidacion).val();
                    var fecha_inicio    = $('#obj_rpt_fecha_inicio', self.$modalReporteValidacion).val();
                    var fecha_fin       = $('#obj_rpt_fecha_fin', self.$modalReporteValidacion).val();

                    let fInicio = new Date(fecha_inicio);
                    let fFin = new Date(fecha_fin)
                    let rDias = Math.round((fFin.getTime() - fInicio.getTime()) / (1000*60*60*24) )
                    console.log(rDias)
                    if (rDias < 0)
                    {
                        smoke.alert("Error, el rango de fecha no es el correcto");
                    }
                    else if(rDias > 30)
                    {
                        smoke.alert("Error, el rango de fecha no puede superar de 30 días");
                    }
                    else
                    {
                        console.log("pasa a generar");

                        //console.log(Math.round(resta/ (1000*60*60*24)))

                        bloqueointerface();
                        var href = "/reportes"
                        var data = {"action": "run",
                            "n": "reporte_validacion_requisito_titulacion",
                            "periodo": id_periodo,
                            "fecha_inicio": fecha_inicio,
                            "fecha_fin": fecha_fin,
                            "rt": formato,
                            "id_facultad":id_facultad,
                            "id_carrera":id_carrera}

                        ValidationQualificationRequirementsModel.Ajax(data, function (rData){
                            console.log(rData);
                            $.unblockUI();
                            if(rData.result=='ok')
                            {
                                //console.log(rData.reportfile)
                                window.open(rData.reportfile)
                                ModalRunReportValidate.close();
                                //smoke.alert(rData.reportfile);
                                //url = rData.reportfile;
                                //var iData = {"action": "SaveCertificateStudent", "id": id, "url": rData.reportfile }

                            }
                            else
                            {
                                smoke.alert(rData.mensaje);
                            }
                        }, function (fError){
                            $.unblockUI();
                            smoke.alert("No hay datos de respuesta en esta solicitud!");
                        },"GET", "json", href);
                    }

                })
            },
            open: function()
            {
                var self = this
                //console.log("OPEN");
                //console.log(self.$modalReporteValidacion);
                self.$modalReporteValidacion
                    .off('shown.bs.modal')
                    .on('shown.bs.modal', function (event) {
                        //$(this).find('.modal-body').css({'overflow-y': 'scroll'});
                    })
                    .modal('show');
            },
            close: function()
            {
                var self = this;
                $('#obj_rpt_periodo', self.$modalReporteValidacion).val($('[name=obj_rpt_periodo]:eq(0)', self.$modalReporteValidacion).val())
                $('#obj_rpt_format', self.$modalReporteValidacion).val($('[name=obj_rpt_format]:eq(0)', self.$modalReporteValidacion).val())
                $('#obj_rpt_fecha_inicio', self.$modalReporteValidacion).empty()
                $('#obj_rpt_fecha_fin', self.$modalReporteValidacion).empty()
                $('#filtro_facultad', self.$modalReporteValidacion).empty
                $('#filtro_carrera', self.$modalReporteValidacion).empty
                self.$modalReporteValidacion.modal('hide');
            }
        };

        var ValidationQualificationRequirementsModel = {
            Ajax: function(data, fSuccess, fFail/*=null*/, methodType/*=undefined*/, dType/*=undefined*/, href/*=undefined*/) {
                if(typeof (methodType) === "undefined")
                {
                    methodType = "POST"
                }

                if(typeof(dType)  === "undefined")
                {
                    dType = "json"
                }
                else if (dType!="json" || dType!="html")
                {
                    dType = "json"
                }

                if(typeof(href)  === "undefined")
                {
                    href = "/adm_validarrequisitostitulacion"
                }

                $.ajax({
                    //async: false,
                    type: methodType,
                    dataType: dType,
                    url: href,
                    data: data,
                    success: function (res, textStatus, jqXHR) // Function( PlainObject data, String textStatus, jqXHR jqXHR )
                    {
                        fSuccess(res, textStatus, jqXHR);
                    }
                }).fail(function (jqXHR, textStatus, errorThrown) {
                    if (fFail) {
                        fFail();
                        return;
                    }

                    //alert(textStatus);
                    smoke.alert(textStatus);
                    if (console && console.log) {
                        console.log(textStatus);
                    }
                });
            },


        };

        var ModalCertificacionTitulacion = {
            init: function ()
            {
                var self = this
                self.$modalRpt = $("#modalCertificacionTtiulacion");
                self.$frmCertificacionTtiulacion = $("[name='frmCertificacionTtiulacion']", self.$modalRpt);


                self.$modalRpt.on("show.bs.modal", function () {
                });

                self.$modalRpt.on("hidden.bs.modal", function () {
                });

                $('[name=objRptFacultad]', self.$modalRpt).change(function () {
                    var self = this;
                    var html = '';
                    var id_coordinacion_select = $('select[name=objRptFacultad] option:selected').val();
                    $('[name=objRptCarrera]').empty();
                    var data = {'action': 'LoadCarrerasByCoordinacion', 'idc': id_coordinacion_select}
                    if(id_coordinacion_select > 0)
                    {
                        bloqueointerface();
                        ValidationQualificationRequirementsModel.Ajax(data, function (rData){
                            $.unblockUI();
                            if (rData.result == 'ok')
                            {

                                if(rData.eCarreras && rData.eCarreras.length >0){
                                    html = '<option value="0">------------------</option>';
                                    $.each(rData.eCarreras, function( index, objData ){
                                        html+='<option value="'+objData.id+'">'+objData.text+'</option>';
                                    });
                                }
                                else
                                {
                                    html ='<option value="0">NO EXISTEN CARRERAS</option>';
                                }
                                $('[name=objRptCarrera]').html(html);
                                $('[name=objRptCarrera]').val('0'); // Select the option with a value of '1'
                                $('[name=objRptCarrera]').trigger('change'); // Notify any JS components that the value changed
                            }
                            else
                            {
                                smoke.alert(data.mensaje);
                            }
                        }, function (fError){
                            $.unblockUI();
                            smoke.alert("No hay datos de respuesta en esta solicitud!");
                        });
                    }
                    else
                    {
                        html ='<option value="0">NO EXISTEN CARRERAS</option>';
                        $('[name=objRptCarrera]').html(html);
                        $('[name=objRptCarrera]').val('0'); // Select the option with a value of '1'
                        $('[name=objRptCarrera]').trigger('change'); // Notify any JS components that the value changed
                    }

                });

                $(".action-close", self.$modalRpt).click(function (){
                    self.close();
                });

                $(".action-run-reporte", self.$modalRpt).click(function(){
                    var rid             = $('[name="rid"]', self.$modalRpt).val();
                    var formato         = $('[name="objRtpFormat"]', self.$modalRpt).val();
                    var ptid            = $('[name="objRptPeriodoTitulacion"]', self.$modalRpt).val();
                    var pmid            = $('[name="objRptPeriodoMatricula"]', self.$modalRpt).val();
                    var cid             = $('[name="objRptCarrera"]', self.$modalRpt).val();
                    bloqueointerface();
                    var href = "/adm_validarrequisitostitulacion"
                    var data = {"action": "run", "rid": rid, "ptid": ptid, "pmid": pmid, "cid": cid, "rt": formato  }

                    ValidationQualificationRequirementsModel.Ajax(data, function (rData){
                        console.log(rData);
                        $.unblockUI();
                        if(rData.result=='ok')
                        {
                            window.open(rData.reportfile)
                            self.close();
                        }
                        else
                        {
                            smoke.alert(rData.mensaje);
                        }
                    }, function (fError){
                        $.unblockUI();
                        smoke.alert("No hay datos de respuesta en esta solicitud!");
                    },"POST", "json", href);

                })
            },
            open: function(rid)
            {
                var self = this
                $('[name="rid"]', self.$modalRpt).val(0);
                $('[name="objRtpFormat"]', self.$modalRpt).val(0);
                $('[name="objRptPeriodoTitulacion"]', self.$modalRpt).val($('[name=objRptPeriodoTitulacion]:eq(0)', self.$modalRpt).val());
                $('[name="objRptPeriodoMatricula"]', self.$modalRpt).val($('[name=objRptPeriodoMatricula]:eq(0)', self.$modalRpt).val());
                $('[name="objRptFacultad"]', self.$modalRpt).val($('[name=objRptFacultad]:eq(0)', self.$modalRpt).val());
                $('[name="objRptCarrera"]', self.$modalRpt).empty();
                self.$modalRpt
                    .off('shown.bs.modal')
                    .on('shown.bs.modal', function (event) {
                        //$(this).find('.modal-body').css({'overflow-y': 'scroll'});
                    })
                    .modal('show');

                $('[name=rid]', self.$modalRpt).val(rid);
                $('[name=objRptFacultad]', self.$modalRpt).change();
            },
            close: function()
            {
                var self = this;

                self.$modalRpt.modal('hide');
            }
        };

        $(function() {
            ValidationQualificationRequirementsController.init();
            ModalMigrateEnrrolled.init();
            ModalValidateRequirements.init();
            ModalViewRequest.init();
            ModalViewCertificate.init();
            ModalRunReportValidate.init();
            ModalCertificacionTitulacion.init();
        });
    </script>
{% endblock %}
{% block atras %}/{% endblock %}
{% block titulo %}{{ title }}{% endblock %}
{% block canvas %}
    <h4>{{ title }}</h4><br>
    <div class="row-fluid">
        <div class="span12">
            <a class="btn btn-warning migrateEnrrolled" href="javascript:;"><span class="fa fa-clone"></span> Migrar Matriculados</a>
            <a class="btn btn-default reportValidacion" href="javascript:;"><span class="fa fa-print"></span> Reporte de Validados</a>
{#            <a class="btn btn-default reportTitulacion" href="javascript:;" rid="{{ reporte_0.id }}"><span class="fa fa-print"></span> Certificación estar apto para el proceso de titulación</a>#}
{#            <a class="btn btn-default reportTitulacion" href="javascript:;" rid="{{ reporte_1.id }}"><span class="fa fa-print"></span> Certificación estar apto para titularse</a>#}
{#        <a href='/adm_validarrequisitostitulacion?action=asignaturastitulacion' class="btn btn-success bloqueo_pantalla">#}
{#                <i class="fa fa-book"> </i> Integración curricular#}
{#            </a>#}
        </div>
    </div>
    <div class='row-fluid'>
        <div class='span3'>
            <form class="form-search">
                <label><strong>Periodo titulación</strong></label>
                <select name="filtro_periodo" style="">
                    {% for periodot in periodos %}
                        <option {% if periodoid.id == periodot.id %} selected {% endif %} value="{{ periodot.id }}">{{ periodot.nombre }}</option>
                    {% empty %}
                        <option selected value="0">NO EXISTEN PERIODOS DE TITULACIÓN</option>
                    {% endfor %}
                </select>
            </form>
        </div>
        <div class='span3'>
            <form class="form-search">
                <label><strong>Coordinación</strong></label>
                <select name="filtro_coordinacion" style="">
                    {% for coordinacion in coordinaciones %}
                        <option {% if coordinacionid.id == coordinacion.id %} selected {% endif %} value="{{ coordinacion.id }}">{{ coordinacion.nombre }}</option>
                    {% empty %}
                        <option selected value="0">NO EXISTEN COORDINACIÓN</option>
                    {% endfor %}
                </select>
            </form>
        </div>
        <div class='span3'>
            <form class="form-search">
                <label><strong>Carreras</strong></label>
                <select name="filtro_carrera" style="">
                    {% for carrera in carreras %}
                        <option {% if carreraid.id == carrera.id %} selected {% endif %} value="{{ carrera.id }}">{{ carrera.nombre }}</option>
                    {% empty %}
                        <option selected value="0">NO EXISTEN CARRERAS</option>
                    {% endfor %}
                </select>
            </form>
        </div>
        <div class='span3'>
            <form class="form-search">
                <label><strong>Estado de Validación</strong></label>
                <select name="filtro_estado" style="">
                    <option selected value="0">---TODOS---</option>
                    {% for estado in estados %}
                        <option value="{{ estado.0 }}">{{ estado.1 }}</option>
                    {% endfor %}
                </select>
            </form>
        </div>
    </div>
    <div class="row-fluid">
        <div class="span12">
            <!--<input type="search" style="text-transform: uppercase; margin-bottom: 0px" class="input-block-level" id="FilterTextBox" name="FilterTextBox">-->
            <div class="datatable" id="divDetailData">
                <table class='table table-bordered table-striped'>
                    <thead>
                    <tr>
                        <th style="text-align: center">Alumno</th>
                        <th style="text-align: center">Carrera</th>
                        <th style="text-align: center">Tipo de Titulación</th>
                        <th style="text-align: center">Estado de Validación</th>
                        <th style="text-align: center">Estado</th>
                        <th style="text-align: center"></th>
                    </tr>
                    </thead>
                    <tbody>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    </div>
{% endblock %}
{% block moreblock %}
    <div id="modalMigrateEnrolled" data-width="60%" class="modal fade" aria-labelledby="" aria-hidden="true" tabindex="-1" role="dialog" style="display: block;"  data-keyboard="false" data-backdrop="static">
        <div class="modal-dialog modal-dialog-center" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <!--<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>-->
                    <h3 class="modal-title panel-title"><span></span> Migrar Matriculados de Titulación</h3>
                </div>
                <div class="modal-body">
                    <form enctype="multipart/form-data" name="frmMigrateEnrolled" action="javascript:;" role="form">
                        <div class="row-fluid">
                            <div class="span6">
                                <label><strong>Periodo titulación</strong></label>
                                <select name="obj_migrar_periodo" style="">
                                    {% for periodot in periodos %}
                                        <option {% if periodoid.id == periodot.id %} selected {% endif %} value="{{ periodot.id }}">{{ periodot.nombre }}</option>
                                    {% empty %}
                                        <option selected value="0">NO EXISTEN PERIODOS DE TITULACIÓN</option>
                                    {% endfor %}
                                </select>
                            </div>
                            <div class="span6">
                                <label><strong>Solo Coordinación</strong></label>
                                <input type="checkbox" name="obj_migrar_is_coordinacion">
                            </div>
                        </div>
                        <div class="row-fluid">
                            <div class="span6">
                                <label><strong>Coordinación</strong></label>
                                <select name="obj_migrar_coordinacion" style="">
                                    {% for coordinacion in coordinaciones %}
                                        <option {% if coordinacionid.id == coordinacion.id %} selected {% endif %} value="{{ coordinacion.id }}">{{ coordinacion.nombre }}</option>
                                    {% empty %}
                                        <option selected value="0">NO EXISTEN COORDINACIÓN</option>
                                    {% endfor %}
                                </select>
                            </div>
                            <div class="span6" id="idObj_migrar_carrera">
                                <label><strong>Carreras</strong></label>
                                <select name="obj_migrar_carrera" style="" multiple>
                                    {% for carrera in carreras %}
                                        <option {% if carreraid.id == carrera.id %} selected {% endif %} value="{{ carrera.id }}">{{ carrera.nombre }}[{{ carrera.malla_set.inicio.year }}]</option>
                                    {% endfor %}
                                </select>
                            </div>
                        </div>
                    </form>
                    <div class="row-fluid" id="divDetalleMigrate">
                        <div class="span12">
                            <table class="table table-bordered table-striped" id="tbDetalleMigrate" style="display: none;" width="100%;">
                                <thead>
                                <tr>
                                    <th style="width: 100%; text-align: center; vertical-align: middle" class="text-center" colspan="4" id="tbPeriodoTitulacion"></th>
                                </tr>
                                <tr>
                                    <th style="width: 100%; text-align: left; vertical-align: middle" colspan="4" id="tbCoordinacion"></th>
                                </tr>
                                <tr>
                                    <th style="width: 40%; text-align: center; vertical-align: middle">Carrera</th>
                                    <th style="width: 30%; text-align: center; vertical-align: middle" class="text-center">Tipo</th>
                                    <th style="width: 20%; text-align: center; vertical-align: middle" class="text-center">Cantidad a Migrar</th>
                                    <th style="width: 10%; text-align: center; vertical-align: middle" class="text-center"></th>
                                </tr>
                                </thead>
                                <tbody id="tbodyDetalleMigrate">
                                </tbody>
                                <tfoot>
                                <tr>
                                    <td style="text-align: right; vertical-align: middle" colspan="2">Total</td>
                                    <td style="text-align: center; vertical-align: middle" id="tbTotal"></td>
                                    <td style="text-align: center; vertical-align: middle"></td>
                                </tr>
                                </tfoot>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <a href="javascript:;" class="btn btn-success action-migrate"> Migrar</a>
                    <!--<a href="javascript:;" class="btn btn-success action-edit"><i class="fa fa-edit"></i> Editar</a>-->
                    <a href="javascript:;" class="btn btn-info action-close" data-dismiss="modal"> Cerrar</a>
                </div>
            </div>
        </div>
    </div>

    <div id="modalValidarRequisitos" data-width="80%" class="modal fade" aria-labelledby="" aria-hidden="true" tabindex="-1" role="dialog" style="display: block;"  data-keyboard="false" data-backdrop="static">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <!--<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>-->
                    <h3 class="modal-title panel-title"><span></span> Requisitos de Titulacion de <span class="student-name-title"></span></h3>
                </div>
                <div class="modal-body">
                    <div class="row-fluid" style="">
                        <div class="span12" style="">
                            <table class="table table-bordered table-striped" id="tbDetalleRequisitos" style="display: block; width: 100%">
                                <thead>
                                <tr>
                                    <th style="width: 40%; text-align: center; vertical-align: middle" class="text-center">Requisito</th>
                                    <th style="width: 15%; text-align: center; vertical-align: middle" class="text-center">Ultimas Modificaciones</th>
                                    <th style="width: 8%; text-align: center; vertical-align: middle" class="text-center">Estado</th>
                                    <th style="width: 30%; text-align: center; vertical-align: middle" class="text-center">Observación</th>
                                    <th style="width: 7%; text-align: center; vertical-align: middle" class="text-center"></th>
                                </tr>
                                </thead>
                                <tbody id="tbodyDetalleRequisitos">
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <!--<a href="javascript:;" class="btn btn-success action-validate"> Validar</a>
                    <a href="javascript:;" class="btn btn-success action-edit"><i class="fa fa-edit"></i> Editar</a>-->
                    <a href="javascript:;" class="btn btn-info action-close" data-dismiss="modal"> Cerrar</a>
                </div>
            </div>
        </div>
    </div>

    <div id="modalViewRequest" data-width="90%" class="modal fade" aria-labelledby="" aria-hidden="true" tabindex="-1" role="dialog" style="display: block;"  data-keyboard="false" data-backdrop="static">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h4 class="modal-title panel-title"><span></span> Requisito de Titulacion de <span class="request-name-title"></span></h4>
                </div>
                <div class="modal-body">
                    <input type="hidden" id="id_validacion" value="0">
                    <input type="hidden" id="id_estado_sistema" value="0">
                    <div class="viewpage_request_html"></div>
                </div>
                <div class="modal-footer">
                    <!--<a href="javascript:;" class="btn btn-success action-validate"> Validar</a>-->
                    <a href="javascript:;" class="btn btn-default action-save-no-aplica" ide="4"><i class="fa fa-edit"></i> No Aplica</a>
                    <a href="javascript:;" class="btn btn-success action-save-apto" ide="1"><i class="fa fa-edit"></i> Apto</a>
                    <a href="javascript:;" class="btn btn-warning action-save-no-apto" ide="2"><i class="fa fa-edit"></i> No Apto</a>
                    <a href="javascript:;" class="btn btn-info action-close" data-dismiss="modal"> Cerrar</a>
                </div>
            </div>
        </div>
    </div>

    <div id="modalViewCertificate" data-width="90%" class="modal fade" aria-labelledby="" aria-hidden="true" tabindex="-1" role="dialog" style="display: block;"  data-keyboard="false" data-backdrop="static">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h4 class="modal-title panel-title"><span></span> Certificado de <span class="certificate-name-title"></span></h4>
                </div>
                <div class="modal-body">
                    <input type="hidden" id="id_va_certificate" value="0">
                    <input type="hidden" id="id_inscripcion" value="0">
                    <input type="hidden" id="id_tiporequisito" value="0">
                    <div class="row-fluid">
                        <div class="span4" style="overflow-y: scroll; max-height: 500px">

                            <table class='table table-bordered' cellpadding="0" cellspacing="0" id="tbDetalleCertificados">
                                <thead>
                                <tr>
                                    <th style="text-align: right" colspan="4">
                                        <a class="btn btn-success generateCertificate" href="javascript:;"><span class="fa fa-pull-right"></span> Generar Certificado</a>
                                    </th>
                                </tr>
                                <tr>
                                    <th style="text-align: center; vertical-align: middle; width: 20%">Fecha de Generación</th>
                                    <th style="text-align: center; vertical-align: middle; width: 62%">Usuario de Generación</th>
                                    <th style="text-align: center; vertical-align: middle; width: 8%">Activo</th>
                                    <th style="text-align: center; vertical-align: middle; width: 10%"></th>
                                </tr>
                                </thead>
                                <tbody id="tbodyDetalleCertificados">
                                </tbody>
                            </table>
                        </div>
                        <div class="span8" style="">
                            <div class="viewpage_certificate_html"></div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <a href="javascript:;" class="btn btn-info action-close" data-dismiss="modal"> Cerrar</a>
                </div>
            </div>
        </div>
    </div>

    <div id="modalReporteValidacion" data-width="" class="modal fade" aria-labelledby="" aria-hidden="true" tabindex="-1" role="dialog" style="display: block;"  data-keyboard="false" data-backdrop="static">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <!--<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>-->
                    <h3 class="modal-title panel-title"><span></span> Generación de Reporte</h3>
                </div>
                <div class="modal-body">
                    <form name="frmGenerarReporteValidacion" action="javascript:;" role="form">
                        <div class="row-fluid">
                            <div class="span8">
                                <label><strong>Periodo</strong></label>
                                <select name="obj_rpt_periodo" id="obj_rpt_periodo" style="">
                                    {% for periodot in periodos %}
                                        <option {% if periodoid.id == periodot.id %} selected {% endif %} value="{{ periodot.id }}">{{ periodot.nombre }}</option>
                                    {% empty %}
                                        <option selected value="0">NO EXISTEN PERIODOS DE TITULACIÓN</option>
                                    {% endfor %}
                                </select>
                            </div>
                            <div class="span4">
                                <label><strong>Formato</strong></label>
                                <select name="obj_rpt_format" id="obj_rpt_format" style="">
                                    <option selected value="pdf">PDF</option>
                                    <option value="xls">Excel</option>
                                    <!--<option value="docx">Word</option>-->
                                </select>
                            </div>
                        </div>
                        <div class="row-fluid">
                            <div class="span6">
                                 <label><strong>Facultad</strong></label>
                                <select name="filtro_coordinacion_m" id="facultad_rp">
                                    <option value="0">TODO</option>
                                    {% for coordinacion in coordinaciones %}
                                        <option value="{{ coordinacion.id }}">{{ coordinacion.nombre }}</option>
                                    {% empty %}
                                        <option selected value="0">NO EXISTEN COORDINACIONES</option>
                                    {% endfor %}
                                </select>
                            </div>
                            <div class="span6">
                                 <label><strong>Carrera</strong></label>
                                <select name="filtro_carrera_m" id="carrera_rp">
                                    <option selected value="0">TODO</option>
                                </select>
                            </div>
                        </div>
                        <div class="row-fluid">
                            <div class="span6">
                                <label><strong>Fecha Inicio</strong></label>
                                <input type="text" name="obj_rpt_fecha_inicio" id="obj_rpt_fecha_inicio">
                            </div>
                            <div class="span6">
                                <label><strong>Fecha Fin</strong></label>
                                <input type="text" name="obj_rpt_fecha_fin" id="obj_rpt_fecha_fin">
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <a href="javascript:;" class="btn btn-success action-run-reporte"> Generar</a>
                    <!--<a href="javascript:;" class="btn btn-success action-edit"><i class="fa fa-edit"></i> Editar</a>-->
                    <a href="javascript:;" class="btn btn-info action-close" data-dismiss="modal"> Cerrar</a>
                </div>
            </div>
        </div>
    </div>

    <div id="modalCertificacionTtiulacion" data-width="" class="modal fade" aria-labelledby="" aria-hidden="true" tabindex="-1" role="dialog" style="display: block;"  data-keyboard="false" data-backdrop="static">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title panel-title"><span></span> Generación de certificación estudiantes estar aptos en el proceso de titulación</h3>
                </div>
                <div class="modal-body">
                    <form name="frmCertificacionTtiulacion" action="javascript:;" role="form">
                        <input type="hidden" name="rid" value="0">
                        <div class="row-fluid">
                            <div class="span8">
                                <label><strong>Periodo</strong></label>
                                <select name="objRptPeriodoTitulacion" style="">
                                    {% for periodot in periodos %}
                                        <option {% if periodoid.id == periodot.id %} selected {% endif %} value="{{ periodot.id }}">{{ periodot.nombre }}</option>
                                    {% empty %}
                                        <option selected value="0">NO EXISTEN PERIODOS DE TITULACIÓN</option>
                                    {% endfor %}
                                </select>
                            </div>
                            <div class="span4">
                                <label><strong>Formato</strong></label>
                                <select name="objRtpFormat" id="obj_rpt_format" style="">
                                    <option selected="selected" value="pdf">PDF</option>
                                </select>
                            </div>
                        </div>
                        <div class="row-fluid">
                            <div class="span6">
                                <label><strong>Facultad</strong></label>
                                <select name="objRptFacultad" style="">
                                    {% for coordinacion in coordinaciones %}
                                        <option value="{{ coordinacion.id }}">{{ coordinacion.nombre }}</option>
                                    {% empty %}
                                        <option selected value="0">NO EXISTEN COORDINACIONES</option>
                                    {% endfor %}
                                </select>
                            </div>
                            <div class="span6">
                                <label><strong>Carrera</strong></label>
                                <select name="objRptCarrera" style="">
                                    <option selected value="0">NO EXISTEN CARRERAS</option>
                                </select>
                            </div>
                        </div>
                        <div class="row-fluid">
                            <div class="span12">
                                <label><strong>Periodos de matriculación</strong></label>
                                <select name="objRptPeriodoMatricula" style="">
                                    {% for periodo in periodos_matriculacion %}
                                        <option value="{{ periodo.id }}">{{ periodo }}</option>
                                    {% empty %}
                                        <option selected value="0">NO EXISTEN PERIODOS</option>
                                    {% endfor %}
                                </select>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <a href="javascript:;" class="btn btn-success action-run-reporte"> Generar</a>
                    <a href="javascript:;" class="btn btn-info action-close" data-dismiss="modal"> Cerrar</a>
                </div>
            </div>
        </div>
    </div>


    <div id="el-templates" style="display: none;">
        <div element="table-migrate-row">
            <table>
                <tbody>
                <tr>
                    <td style="text-align: center; vertical-align: middle"></td>
                    <td style="text-align: center; vertical-align: middle"></td>
                    <td style="text-align: center; vertical-align: middle"></td>
                    <td style="text-align: center; vertical-align: middle"></td>
                </tr>
                </tbody>
            </table>
        </div>
        <div element="table-requisitos-row">
            <table>
                <tbody>
                <tr>
                    <td style="text-align: left; vertical-align: middle"></td>
                    <td style="text-align: left; vertical-align: middle"></td>
                    <td style="text-align: center; vertical-align: middle"></td>
                    <td style="text-align: left; vertical-align: middle"></td>
                    <td style="text-align: center; vertical-align: middle"></td>
                </tr>
                </tbody>
            </table>
        </div>
        <div element="table-certificate-row">
            <table>
                <tbody>
                <tr>
                    <td style="text-align: center; vertical-align: middle"></td>
                    <td style="text-align: left; vertical-align: middle"></td>
                    <td style="text-align: center; vertical-align: middle"></td>
                    <td style="text-align: center; vertical-align: middle"></td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>
{% endblock %}
