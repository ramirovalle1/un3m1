{% extends "base.html" %}
{% load sga_extras %}
{% load humanize %}
{% block heading %}

    <link href="/static/picons-thin/style.css" rel="stylesheet">
    <script type="text/javascript" src='/static/js/jquery.validationEngine.js?v=1.0.0'></script>
    <script type="text/javascript" src='/static/js/jquery.validationEngine-es.js?v=1.0.0'></script>
    <link type='text/css' rel='stylesheet' href="/static/css/validationEngine.jquery.css?v=1.0.0"/>
    <script src="/static/adicionalesjs/formquestionb4.js?0.24"></script>
    <script>

        function solicitudaajax_mio(pk, nombre, accion, url, titulo) {
            Swal.fire({
                title: `${titulo}\n ${nombre}`,
                text: "Esta acción es irreversible",
                type: 'info',
                showCancelButton: true,
                allowOutsideClick: false,
                confirmButtonColor: '#3085d6',
                cancelButtonColor: '#d33',
                confirmButtonText: 'Si, deseo hacerlo',
                cancelButtonText: 'Cancelar'
            }).then((result) => {
                if (result.value) {
                    {#bloqueointerface();#}
                    $.ajax({
                        type: "POST",
                        url: url,
                        data: {action: accion, id: pk,},
                        success: function (data) {
                            if (data.result == 'ok') {
                                location.reload();
                            } else {
                                Swal.fire({
                                    title: `Advertencia`,
                                    text: data.mensaje,
                                    type: 'warning',
                                    showCancelButton: false,
                                    allowOutsideClick: false,
                                    confirmButtonColor: '#3085d6',
                                    cancelButtonColor: '#d33',
                                    confirmButtonText: 'Aceptar',
                                    cancelButtonText: 'Cancelar'
                                })
                            }
                        },
                        error: function () {
                            setTimeout($.unblockUI, 1);
                            mensajeWarning("Error de conexión.");
                        },
                        dataType: "json"
                    });
                }
            })
        }

        function confirmarajax_mio(pk, nombre, accion, url, titulo) {
            Swal.fire({
                title: `${titulo}\n ${nombre}`,
                text: "Esta acción es irreversible",
                type: 'info',
                showCancelButton: true,
                allowOutsideClick: false,
                confirmButtonColor: '#3085d6',
                cancelButtonColor: '#d33',
                confirmButtonText: 'Si, deseo hacerlo',
                cancelButtonText: 'Cancelar'
            }).then((result) => {
                if (result.value) {
                    {#bloqueointerface();#}
                    $.ajax({
                        type: "POST",
                        url: url,
                        data: {action: accion, id: pk,},
                        success: function (data) {
                            if (data.result == 'ok') {
                                location.reload();
                            } else {
                                Swal.fire({
                                    title: `Advertencia`,
                                    text: data.mensaje,
                                    type: 'warning',
                                    showCancelButton: false,
                                    allowOutsideClick: false,
                                    confirmButtonColor: '#3085d6',
                                    cancelButtonColor: '#d33',
                                    confirmButtonText: 'Aceptar',
                                    cancelButtonText: 'Cancelar'
                                })
                            }
                        },
                        error: function () {
                            setTimeout($.unblockUI, 1);
                            mensajeWarning("Error de conexión.");
                        },
                        dataType: "json"
                    });
                }
            })
        }

        $(function () {

            var iconoNotificacion = document.getElementById('noti-icon');
            {% if notificaciones %}
                iconoNotificacion.classList.add('notification');
            {% endif %}

            var iconoNotificacionlicen = document.getElementById('noti-licen');
            {% if notilicencias %}
                iconoNotificacionlicen.classList.add('notification');
            {% endif %}

            var tabhojavida = localStorage.getItem('tabhojavida');


            {% if tab %}
                tabhojavida = "#{{ tab }}";
                localStorage.setItem("tabhojavida", tabhojavida);
            {% else %}
                if (!tabhojavida) {
                    tabhojavida = "#1";
                    localStorage.setItem("tabhojavida", tabhojavida);
                }
            {% endif %}

            $('.tabs').each(function () {
                if ($(this).attr('href') == tabhojavida) {
                    $(this).trigger('click');
                }
            }).click(function () {
                localStorage.setItem("tabhojavida", $(this).attr('href'));
            });
            abrir_reporte2 = function (href, tipos) {
                if (!tipos) {
                    tipos = "pdf, xls, csv, doc";
                }
                if (tipos.contains("pdf")) {
                    $("#formatopdf").removeAttr("hidden");
                } else {
                    $("#formatopdf").attr({"hidden": "hidden"});
                }
                if (tipos.contains("doc")) {
                    $("#formatodoc").removeAttr("hidden");
                } else {
                    $("#formatodoc").attr({"hidden": "hidden"});
                }
                if (tipos.contains("xls")) {
                    $("#formatoxls").removeAttr("hidden");
                } else {
                    $("#formatoxls").attr({"hidden": "hidden"});
                }
                if (tipos.contains("csv")) {
                    $("#formatocsv").removeAttr("hidden");
                } else {
                    $("#formatocsv").attr({"hidden": "hidden"});
                }

                primero = $("#formatoreporte_formato").find("option:first").val();
                $("#formatoreporte_formato").val(primero);
                $('#formatoreporte').modal({'width': '400'}).modal('show');
                $('#formatoreporte_run').attr('nhref', href);
            };


            $("#search").click(function () {
                var term = $("#searchinput").val().toUpperCase();
                location.href = "/th_hojaruta?s=" + term;
            });

            $('#searchinput').keyup(function (e) {
                if (e.keyCode == 13) {
                    $("#search").trigger("click");
                }
            });

            /*BUSQUEDA*/

            busquedaact = function () {
                var term = $("#searchinputact").val().trim().toUpperCase();
                var actselect = $("#activoselect").val();

                location.href = "/mis_activos?s=" + term + "&actselect=" + actselect;
                return false;
            };

            $("#activoselect").change(function () {
                bloqueointerface();
                busquedaact();
            })


            $("#searchact").click(function () {
                busquedaact();
            });

            $(".detallesolicitud").click(function () {
                var id = $(this).attr('idsolicitud');
                bloqueointerface();
                $.ajax({
                    type: "GET",
                    url: "/mis_activos",
                    data: {'action': 'detallesolicitudtraspaso', 'id': id},
                    success: function (data) {
                        $.unblockUI();
                        if (data.result === true) {
                            $(".panelbody").html(data.data);
                            $("#itemspanel").modal({backdrop: 'static', width: '1000px'}).modal('show');
                        } else {
                            smoke.alert(data.mensaje);
                        }
                    },
                    error: function () {
                        $.unblockUI();
                        smoke.alert("Error de conexión.");
                    },
                    dataType: "json"
                });
            });
            $(".recorridosolicitud").click(function () {
                var id = $(this).attr('idsolicitud');
                bloqueointerface();
                $.ajax({
                    type: "GET",
                    url: "/mis_activos",
                    data: {'action': 'recorridosolicitud', 'id': id},
                    success: function (data) {
                        $.unblockUI();
                        if (data.result === true) {
                            $("#recorridosolicitud .panelbody").html(data.data);
                            $("#recorridosolicitud").modal({backdrop: 'static', width: '1000px'}).modal('show');
                        } else {
                            smoke.alert(data.mensaje);
                        }
                    },
                    error: function () {
                        $.unblockUI();
                        smoke.alert("Error de conexión.");
                    },
                    dataType: "json"
                });
            });
            $(".rechazarsolicitudtraspaso").click(function () {
                var idsolicitudtraspaso = $(this).attr('idsolicitud');
                var accionrechazosolicitud = $(this).attr('tipoaccion');
                $('#idsolicitudtraspasoactivo').val(idsolicitudtraspaso);
                $('#accionrechazosolicitudtraspaso').val(accionrechazosolicitud);
                $("#rechazosolicitudtraspaso").modal({"backdrop": "static", "width": "1000px"}).modal("show");
            });
            $("#btnrechazarsolicitudtraspaso").click(function () {
                var observacion = $('#id_observacion').val();
                var accion = $('#accionrechazosolicitudtraspaso').val();
                var id = $('#idsolicitudtraspasoactivo').val();
                $.ajax({
                    type: "POST",
                    url: '/mis_activos',
                    data: {action: accion, id: id, observacionrechazo: observacion},
                    success: function (data) {
                        if (data.result == 'ok') {
                            location.reload();
                        } else {
                            Swal.fire({
                                title: `Advertencia`,
                                text: 'Error al rechazar la solicitud',
                                type: 'warning',
                                showCancelButton: false,
                                allowOutsideClick: false,
                                confirmButtonColor: '#3085d6',
                                cancelButtonColor: '#d33',
                                confirmButtonText: 'Aceptar',
                                cancelButtonText: 'Cancelar'
                            })
                        }
                    },
                    error: function () {
                        setTimeout($.unblockUI, 1);
                        mensajeWarning("Error de conexión.");
                    },
                    dataType: "json"
                });
            })

            $(".correcionessolicitud").click(function () {
                var id = $(this).attr("idsolicitud");
                bloqueointerface();
                $.ajax({
                    type: "GET",
                    url: "/mis_activos",
                    data: {'action': 'correccionessolicitudtraspaso', 'id': id},
                    success: function (data) {
                        $.unblockUI();
                        if (data.result == 'ok') {
                            $("#detalleconsmodal_body").html(data.html);
                            $("#correccionsolicitudtraspaso").modal({
                                "backdrop": "static",
                                "width": "1000px"
                            }).modal("show");
                        } else {
                            smoke.alert(data.mensaje);
                        }
                    },
                    error: function () {
                        $.unblockUI();
                        smoke.alert("Error de conexión.");
                    },
                    dataType: "json"
                });
            });

        });

        {% comment %}var checkactivo = function (page/*=undefined*/) {
            var ac = $('[name="activocheck"]:checked').val();
            page = typeof page == 'undefined' ? 1 : page;
            bloqueointerface();
            location.href = `/mis_activos?ac=${ac}}&page=${page}`;

        };{% endcomment %}

        function formModal(id, text, action, footer = true) {
            bloqueointerface()
            $('#footermodalvac').show();
            $.ajax({
                type: "GET",
                url: `{{ request.path }}`,
                data: {
                    'action': action,
                    'id': id,
                },
                success: function (data) {
                    $.unblockUI()
                    if (data.result === true) {
                        if (footer === true) {
                            $('#footermodalvac').hide();
                        }
                        $('.panelbodyvac').html(data.data);
                        $('#itemspanelvac .paneltitlevac').html(text);
                        $("#itemspanelvac").modal({backdrop: 'static', width: '950'}).modal('show');
                        $("#itemspanelvac").css("margin-top", "-402px");
                    } else {
                        smoke.alert(data.mensaje);
                    }
                },
                error: function () {
                    $.unblockUI()
                    smoke.alert("Error de conexión.");
                },
                dataType: "json"
            });
        }

        function formModal2(id, text, action) {
            bloqueointerface();
            $.ajax({
                type: "GET",
                url: `{{ request.path }}`,
                data: {
                    'action': action,
                    'id': id,
                },
                success: function (data) {

                    $.unblockUI();
                    if (data.result === true) {
                        $('.panelbody').html(data.data);
                        $('#itemspanel .paneltitle').html(text);
                        $("#itemspanel").modal({backdrop: 'static', width: '700'}).modal('show');
                    } else {
                        smoke.alert(data.mensaje);
                    }
                },
                error: function (data) {
                    $.unblockUI();
                    smoke.alert("Error de conexión.");
                },
                dataType: "json"
            });
        }

        function formModal4(id, tipo, text, action, idpadre) {
            $.ajax({
                type: "GET",
                url: `{{ request.path }}`,
                data: {
                    'action': action,
                    'id': id,
                    'tipo': tipo,
                    'idpadre': idpadre,
                },
                success: function (data) {
                    if (data.result === true) {
                        $('.panelbody').html(data.data);
                        $('#itemspanel .paneltitle').html(text);
                        $("#itemspanel").modal({backdrop: 'static', width: '900'}).modal('show');
                    } else {
                        smoke.alert(data.mensaje);
                    }
                },
                error: function () {
                    smoke.alert("Error de conexión.");
                },
                dataType: "json"
            });
        }

        function formModalFirmar(id, text, action, footer = true, dimension) {
            $('.panelbodyreasigna').empty();
            $('.panelbody1').empty();
            $('.panelbodyproceso').empty();
            $('.panelbodyform').empty();
            bloqueointerface();
            $.ajax({
                type: "GET",
                url: `{{ request.path }}`,
                data: {
                    'action': action,
                    'id': id,
                },
                success: function (data) {
                    $.unblockUI();
                    if (dimension) {
                        $('#wmodal').removeClass('modal-lg modal-sm modal-xl modal-md modal-fullscreen').addClass(dimension)
                    }
                    if (data.result === true) {
                        if (footer === true) {
                            $('#footermodal1').hide();
                        }
                        $('.panelbody1').html(data.data);
                        $('#modalfirma .paneltitle1').html(text);
                        $("#modalfirma").modal({backdrop: 'static'}).modal('show');
                    } else {
                        mensajeDanger(data.mensaje);
                    }
                },
                error: function () {
                    $.unblockUI();
                    mensajeDanger("Error de conexión.");
                },
                dataType: "json"
            });
        }

        $(function () {
            $("select").select2();
            $.fn.select2.defaults.set('language', 'es');
        });


    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0/js/i18n/es.js"></script>
{% endblock %}
{% block canvas %}
    <div class='row'>
        <div class='col-lg-12'>
            <div class="headtitle">
                <h3 class="texto-blue">{{ title }}</h3>
                <h6>Administración</h6>
            </div>
        </div>
    </div>

    {#<div class='container-fluid'>#}
    {#    <div class="col p-0">#}
    {#    <a href="/mis_activos?action=viewlistnotificaciones" id='noti' class="btn btn-default">#}
    {#        <i class="fa fa-bell" id="noti-icon"></i> Notificaciones#}
    {#    </a>#}
    {#</div>#}
    {#</div>#}

    <div class='container-fluid'>
        <div class="btn-group" role="group">
            <div class="row">

                <div class="col p-0" role="group">
                    <a href="/mis_activos?action=viewlistnotificaciones" id='noti' class="btn btn-cian-opacity">
                        <i class="fa fa-bell" id="noti-icon"></i> Notificación de Activos
                    </a>
                </div>
                <div class="col p-0" role="group">
                    <a href="/mis_activos?action=viewnotificacionlicencia" id='noti' class="btn btn-cian-opacity">
                        <i class="fa fa-bell" id="noti-licen"></i> Notificación de Licencias
                    </a>
                </div>
                {% if reporte_activos_persona %}
                    <div class="col p-0" role="group">
                        <a class="dropdown-item reportedirecto reporte" href="javascript:;"
                           tipos="{{ reporte_activos_persona.tiporeporte }}"
                           nhref="/reportes?action=run&n={{ reporte_activos_persona.nombre }}&persona={{ persona.id }}">
                            <i class='fa fa-arrow-down'></i> Listado Reporte
                        </a>
                    </div>
                {% endif %}
                 <div class="col p-0" role="group">
                    <div class="dropdown dropleft">
                        <button type="button" class="btn btn-default dropdown-toggle"
                                data-bs-toggle="dropdown" data-offset="-140" aria-haspopup="true"
                               aria-expanded="false">
                            <i class="fa fa-print"></i> Reportes <i class="bi bi-caret-down"></i>
                        </button>
                        <div class="dropdown-menu" x-placement="right-start">
                            <a class="dropdown-item"
                               target="_blank"
                               href="{{ request.path }}?action=rpt_mis_activos&tpa=1">
                                <i class="fa fa-file-pdf dropdown-item-icon"></i> Exportar a pdf
                            </a>
                            <a class="dropdown-item"
                               target="_blank"
                               href="{{ request.path }}?action=rpt_mis_activos&tpa=2">
                                <i class="fa fa-file-excel dropdown-item-icon"></i> Exportar a excel
                            </a>

                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="card mt-2">
            <div class="rounded-3">
                <!-- Card header -->
                <div class="card-header ">
                    <div class="header border-bottom-0 p-0 ">
                        <!-- Nav -->
                        <ul class="nav nav-lb-tab mt-0 justify-content-center " id="tab" role="tablist">
                            <li class="nav-item">
                                <a class="nav-link active py-1" id="table-tab" data-bs-toggle="pill" href="#table"
                                   role="tab" aria-controls="table" aria-selected="true">Activos</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link py-1" id="description-tab" data-bs-toggle="pill" href="#description"
                                   role="tab" aria-controls="description" aria-selected="false">Mantenimientos de
                                    activos</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link py-1" id="review-tab" data-bs-toggle="pill" href="#review" role="tab"
                                   aria-controls="review" aria-selected="false">Solicitudes de traspaso</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link py-1" id="review-tab" data-bs-toggle="pill" href="#prestamos"
                                   role="tab"
                                   aria-controls="review" aria-selected="false">Préstamos</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link py-1" id="review-tab" data-bs-toggle="pill" href="#traspasos"
                                   role="tab"
                                   aria-controls="review" aria-selected="false">Traspasos</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link py-1" id="constatacion-tab" data-bs-toggle="pill"
                                   href="#constataciones"
                                   role="tab"
                                   aria-controls="review" aria-selected="false"> Constataciones</a>
                            </li>
                        </ul>
                    </div>
                </div>
                <!-- Card Body -->
                <div class="card-body">
                    <div class="tab-content" id="tabContent">
                        <div class="tab-pane fade show active" id="table" role="tabpanel"
                             aria-labelledby="table-tab">
                            <!-- Card -->
                            <form class="form-row row-cols-1 row-cols-sm-3 row-cols-md-2 row-cols-lg-4 justify-content-end"
                                    method="GET">
                                <div class='col pe-2'>
                                    <select id='activoselect' name='actselect' class="select2activos">
                                        <option href="mis_activos" value="0" {% if not actselect %}
                                                selected {% endif %}selected="selected">Todos los activos
                                        </option>
                                        <option value="1" {% if actselect == 1 %} selected {% endif %}>Activo
                                            Tecnológico
                                        </option>
                                        <option value="2" {% if actselect == 2 %} selected {% endif %}>Activo Fijo
                                        </option>
                                    </select>
                                </div>
                                <div class='col'>
                                    <div class="input-group">
                                        <input type="text" id="searchinputact"
                                               class="form-control" placeholder="Buscar por codigo de activo..."
                                               aria-label="Buscar"
                                               aria-describedby="button-addon2" name="s" value="{{ search }}">
                                        <div class="input-group-append">
                                            <button type="submit" class='btn btn-primary-old'>
                                                <i class="fa fa-search"></i>
                                                <t class="hidden-phone hidden-tablet "></t>
                                            </button>
                                            {% if search %}
                                                <a href="mis_activos" class='btn btn-default bloqueo_pantalla'><i
                                                        class="fa fa-refresh "></i>
                                                    <t class="hidden-phone hidden-tablet "></t>
                                                </a>
                                            {% endif %}
                                        </div>
                                    </div>
                                </div>
                            </form>


                            <table class="tabla_responsive table table_primary">
                                <thead>
                                <thead>
                                <tr>
                                    <th style="width: 10%;">C&oacute;digo</th>
                                    <th style="width: 20%;">Activo</th>
                                    <th style="width: 20%">Ubicación</th>
                                    <th style="width: 15%">Detalles</th>
                                    <th style="width:10%">Valor</th>
                                    <th style="width:10%">Estado</th>
                                    <th style="width:20%">Detalles de baja</th>
                                    <th style="width:5%">Archivo</th>
                                </tr>
                                </thead>
                                <tbody>
                                {% for activo in activos %}
                                    <tr>
                                        <td>
                                            <p><b>Gobierno: </b>{{ activo.codigogobierno }}</p>
                                            <p><b>Interno: </b>{{ activo.codigogobierno }}</p></td>
                                        <td>{{ activo.catalogo|title2 }}<br><b>Descripci&oacute;n: </b>{{ activo.descripcion|title2 }}
                                        </td>
                                        <td>{{ activo.ubicacion|title2 }}</td>
                                        <td>
                                            <p><b>Marca:</b> {{ activo.marca|title2 }}</p>
                                            <p><b>Modelo:</b>{{ activo.modelo|title2 }}</p>
                                            <p><b>Serie:</b> {{ activo.serie|title2 }}</p>

                                        </td>

                                        <td>${{ activo.costo|floatformat:2|intcomma }}</td>
                                        <td>{{ activo.estado|title2 }}</td>
                                        <td>
                                            {% if activo.procesobaja %}
                                                <p><span class="text-info">Bien entregado</span></p>
                                            {% endif %}
                                            {% if activo.existeinformebaja %}
                                                <p><span class=" text-danger">Informe de baja</span></p>
                                            {% endif %}</td>
                                        <td style="text-align: center">
                                            {% if activo.archivobaja %}
                                                <div class="arrow-text">
                                                    <a href="{{ activo.archivobaja.url }}"
                                                       class="text-danger"
                                                       data-width="2048" data-height="1380"
                                                       data-fancybox="adjunto_{{ activo.id }}"
                                                       data-caption="Archivo de baja"
                                                       data-placement="top"><i class="fa fa-file-pdf-o fs-4"></i></a>
                                                </div>
                                            {% endif %}
                                        </td>
                                    </tr>
                                {% empty %}
                                    <tr>
                                        <td colspan="11" style="text-align: center">NO EXISTEN ACTIVOS REGISTRADOS
                                        </td>
                                    </tr>
                                {% endfor %}
                                </tbody>
                            </table>
                            {% include 'paginacionb4.html' %}

                        </div>
                        <div class="tab-pane fade" id="description" role="tabpanel"
                             aria-labelledby="description-tab">
                            <table class='table table-bordered table-striped'>
                                <thead>
                                <tr>
                                    <th colspan="6">Mantenimientos de activos</th>
                                </tr>
                                <tr>
                                    <th style="width: 150px;">Descripción</th>
                                    <th style="width: 100px;">Modelo</th>
                                    <th style="width: 250px">Ubicación</th>
                                    <th style="width: 100px">Fecha de mantenimiento</th>
                                    <th style="width:120px; text-align: center">Estado</th>
                                    <th style="width:10px; text-align: center"></th>
                                </tr>
                                </thead>
                                <tbody>
                                {% for activos in solicitudmantenimiento %}
                                    <tr>
                                        <td style="text-align: center;width: 150px">{{ activos.mantenimiento.observaciones }}
                                            - {{ activos.mantenimiento.activotecno.activotecnologico }}</td>
                                        <td style="text-align: center">{{ activos.mantenimiento.activotecno.activotecnologico.modelo }}</td>
                                        <td style="text-align: center">{{ activos.mantenimiento.activotecno.activotecnologico.ubicacion }}</td>
                                        <td style="text-align: center">
                                            {{ activos.mantenimiento.fecha|date:"d-m-Y" }}</td>
                                        <td style="text-align: center">
                                            {{ activos.get_estado_display|lower|capfirst }}
                                        </td>
                                        <td style="text-align: center;width: 10px" class="caja">
                                            {% if activos.estado == 1 %}
                                                <div class="dropdown" style="text-align: center">
                                                    <a class="btn btn-mini dropdown-toggle"
                                                       data-bs-toggle="dropdown"
                                                       href="javascript:;">Acciones<span
                                                            class="caret"></span></a>
                                                    <ul class="dropdown-menu">

                                                        <li class="dropdown-item">
                                                            <a style="cursor: pointer"
                                                               onclick="solicitudaajax_mio('{{ activos.id }}','{{ activos.activo }}','confmantenimiento','/mis_activos', 'Está por confirmar el mantenimiento realizado de su equipo')"><i
                                                                    class="fa fa-user"></i> Confirmar </a></li>
                                                        <li class="dropdown-item"><a style="cursor: pointer"
                                                                                     onclick="solicitudaajax_mio('{{ activos.id }}','{{ activos.activo }}','rechmantenimiento','/mis_activos', 'Está por rechazar el mantenimiento realizado de su equipo')"><i
                                                                class="fa fa-history"></i> Rechazar </a>
                                                        </li>
                                                    </ul>
                                                </div>
                                            {% endif %}
                                        </td>
                                    </tr>
                                {% empty %}
                                    <tr>
                                        <td colspan="10" style="text-align: center">NO EXISTEN SOLICITUDES</td>
                                    </tr>
                                {% endfor %}
                                </tbody>
                            </table>
                        </div>
                        <div class="tab-pane fade" id="review" role="tabpanel" aria-labelledby="review-tab">
                            {#                                <a href="/mis_activos?action=addsolicitudtraspaso" id='nuevasolicitudtraspaso'#}
                            {#                                   class='btn btn-success'><i class="fa fa-plus "></i> Nueva solicitud</a>#}
                            <table class='table table-bordered table-striped' style="margin-top:8px">
                                <thead>
                                <tr>
                                    <th colspan="6">Solicitudes pendientes</th>
                                </tr>
                                <tr>
                                    <th style="width: 150px;text-align: center">Descripción</th>
                                    <th style="width: 100px;text-align: center">Modelo</th>
                                    <th style="width: 250px;text-align: center">Ubicación</th>
                                    <th style="width: 100px;text-align: center">Fecha de solicitud</th>
                                    <th style="width: 100px;text-align: center">Responsable</th>
                                    <th style="width: 100px;text-align: center">Traspaso a</th>
                                    <th style="width:120px; text-align: center">Estado</th>
                                    <th style="width:10px; text-align: center"></th>
                                </tr>
                                </thead>
                                <tbody>
                                {% for activos in solicitudestraspasosat %}
                                    <tr>
                                        <td style="text-align: center;width: 150px">{{ activos.activo.codigointerno }}
                                            - {{ activos.activo }}</td>
                                        <td style="text-align: center">{{ activos.activo.modelo }}</td>
                                        <td style="text-align: center">{{ activos.activo.ubicacion }}</td>
                                        <td style="text-align: center">
                                            {{ activos.fechasolicitud|date:"d-m-Y" }}</td>
                                        <td style="text-align: center">
                                            {{ activos.activo.responsable }}</td>
                                        <td style="text-align: center">
                                            {{ activos.responsableasignacion }}</td>
                                        <td style="text-align: center">
                                            {% if activos.estado == 1 or activos.estado == 4 %}
                                                <label class="label label-warning">PENDIENTE</label>
                                            {% endif %}
                                        </td>
                                        <td style="text-align: center;width: 10px" class="caja">
                                            <div class="dropdown" style="text-align: center">
                                                <a class="btn btn-mini dropdown-toggle" data-bs-toggle="dropdown"
                                                   href="javascript:;">Acciones<span
                                                        class="caret"></span></a>
                                                {% if activos.estado == 4 %}
                                                    <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton1">
                                                        <li class="dropdown-item">
                                                            <a style="cursor: pointer"
                                                               onclick="solicitudaajax_mio('{{ activos.id }}','{{ activos.activo }}','traspasoconfirmado','/mis_activos', 'Está por confirmar la solicitud del activo')"><i
                                                                    class="fa fa-user"></i> Confirmar </a></li>
                                                        <li class="dropdown-item"><a style="cursor: pointer"
                                                                                     onclick="solicitudaajax_mio('{{ activos.id }}','{{ activos.activo }}','traspasoeliminar','/mis_activos', 'Está por rechazar la solicitud del activo')"
                                                        ><i
                                                                class="fa fa-history"></i> Rechazar </a>
                                                        </li>
                                                    </ul>
                                                {% else %}
                                                    {% if activos.estado == 1 %}
                                                        <ul class="dropdown-menu"
                                                            aria-labelledby="dropdownMenuButton1">
                                                            <li class="dropdown-item">
                                                                <a style="cursor: pointer"
                                                                   onclick="solicitudaajax_mio('{{ activos.id }}','{{ activos.activo }}','responsableconfirmatraspaso','/mis_activos', 'Está por confirmar la solicitud del activo')"><i
                                                                        class="fa fa-user"></i> Confirmar </a></li>
                                                            <li class="dropdown-item"><a style="cursor: pointer"
                                                                                         onclick="solicitudaajax_mio('{{ activos.id }}','{{ activos.activo }}','responsableeliminatraspaso','/mis_activos', 'Está por rechazar la solicitud del activo')"><i
                                                                    class="fa fa-history"></i> Rechazar </a>
                                                            </li>
                                                        </ul>
                                                    {% endif %}
                                                {% endif %}
                                            </div>
                                        </td>
                                    </tr>
                                {% empty %}
                                    <tr>
                                        <td colspan="10" style="text-align: center">NO EXISTEN SOLICITUDES</td>
                                    </tr>
                                {% endfor %}
                                </tbody>
                            </table>
                            <table class='table table-bordered table-striped'>
                                <thead>
                                <tr>
                                    <th colspan="6">Solicitudes atendidas</th>
                                </tr>
                                <tr>
                                    <th style="width: 150px;">Descripción</th>
                                    <th style="width: 100px;">Modelo</th>
                                    <th style="width: 250px">Ubicación</th>
                                    <th style="width: 100px">Fecha de solicitud</th>
                                    <th style="width: 100px;text-align: center">Responsable</th>
                                    <th style="width: 100px;text-align: center">Traspaso a</th>
                                    <th style="width:120px; text-align: center">Estado</th>
                                </tr>
                                </thead>
                                <tbody>
                                {% for activos in solicitudestraspasosatatendidas %}
                                    <tr>
                                        <td style="text-align: center;width: 150px">{{ activos.activo.codigointerno }}
                                            - {{ activos.activo }}</td>
                                        <td style="text-align: center">{{ activos.activo.modelo }}</td>
                                        <td style="text-align: center">{{ activos.activo.ubicacion }}</td>
                                        <td style="text-align: center">
                                            {{ activos.fechasolicitud|date:"d-m-Y" }}</td>
                                        <td style="text-align: center">
                                            {{ activos.activo.responsable }}</td>
                                        <td style="text-align: center">
                                            {{ activos.responsableasignacion }}</td>
                                        <td style="text-align: center">
                                            {% if activos.estado == 2 or activos.estado == 3 or activos.estado == 4 or activos.estado == 7 %}
                                                <label class="label label-success">APROBADO</label>
                                            {% else %}
                                                {% if activos.estado == 5 %}
                                                    <label class="label label-warning">RECHAZADO</label>
                                                {% endif %}
                                            {% endif %}
                                        </td>
                                    </tr>
                                {% empty %}
                                    {% if not solicitudestraspasosatatendidasfuturo and not solicitudestraspasosatatendidas %}
                                        <tr>
                                            <td colspan="10" style="text-align: center">NO EXISTEN SOLICITUDES</td>
                                        </tr>
                                    {% endif %}
                                {% endfor %}
                                {% for activos in solicitudestraspasosatatendidasfuturo %}
                                    <tr>
                                        <td style="text-align: center;width: 150px">{{ activos.activo.codigointerno }}
                                            - {{ activos.activo }}</td>
                                        <td style="text-align: center">{{ activos.activo.modelo }}</td>
                                        <td style="text-align: center">{{ activos.activo.ubicacion }}</td>
                                        <td style="text-align: center">
                                            {{ activos.fechasolicitud|date:"d-m-Y" }}</td>
                                        <td style="text-align: center">
                                            {{ activos.activo.responsable }}</td>
                                        <td style="text-align: center">
                                            {{ activos.responsableasignacion }}</td>
                                        <td style="text-align: center">
                                            {% if activos.estado == 2 or activos.estado == 7 %}
                                                <label class="label label-success">APROBADO</label>
                                            {% else %}
                                                {% if activos.estado == 3 %}
                                                    <label class="label label-warning">RECHAZADO</label>
                                                {% endif %}
                                            {% endif %}
                                        </td>
                                    </tr>
                                {% endfor %}
                                </tbody>
                            </table>
                        </div>
                        <div class="tab-pane fade" id="prestamos" role="tabpanel"
                             aria-labelledby="description-tab">
                            <table class='table table-bordered table-striped'>
                                <thead>
                                <tr>
                                    <th style="text-align: center; vertical-align: middle; width: 5%;">#</th>
                                    <th style="text-align: center; vertical-align: middle; width: 20%;">Activo
                                        tecnológico
                                    </th>
                                    <th style="text-align: center; vertical-align: middle; width: 20%;">Persona
                                        entrega
                                    </th>
                                    <th style="text-align: center; vertical-align: middle; width: 20%;">Persona
                                        recibe
                                    </th>
                                    <th style="text-align: center; vertical-align: middle; width: 8%;">Fecha desde
                                    </th>
                                    <th style="text-align: center; vertical-align: middle; width: 8%;">Fecha hasta
                                    </th>
                                    <th style="text-align: center; vertical-align: middle; width: 8%;">Fecha
                                        devolución
                                    </th>
                                    <th style="text-align: center; vertical-align: middle; width: 8%;">Observación
                                    </th>
                                    <th style="text-align: center; vertical-align: middle; width: 8%;">Estado</th>
                                    <th style="text-align: center; vertical-align: middle; width: 10%;">Acciones
                                    </th>
                                </tr>
                                </thead>
                                <tbody>
                                {% for prestamos in prestamoactivosoperaciones %}
                                    <tr>
                                        <td style="text-align: center; vertical-align: middle">{{ forloop.counter }}</td>
                                        <td style="text-align: left; vertical-align: middle">
                                            {{ prestamos.activotecnologico.activotecnologico }}
                                        </td>
                                        <td style="text-align: center; vertical-align: middle">
                                            {{ prestamos.personaentrega }}
                                        </td>
                                        <td style="text-align: center; vertical-align: middle">
                                            {{ prestamos.personarecibe }}
                                        </td>
                                        <td style="text-align: center; vertical-align: middle">
                                            {{ prestamos.desde|date:"d-m-Y" }}
                                        </td>
                                        <td style="text-align: center; vertical-align: middle">
                                            {{ prestamos.hasta|date:"d-m-Y" }}
                                        </td>
                                        <td style="text-align: center; vertical-align: middle">
                                            {{ prestamos.fechadevolucion|date:"d-m-Y"|default_if_none:"" }}
                                        </td>
                                        <td style="text-align: center; vertical-align: middle">
                                            {{ prestamos.observacion }}
                                        </td>
                                        <td style="text-align: center; vertical-align: middle">
                                            {% if prestamos.estado == 1 and fechaactual > prestamos.hasta %}
                                                <label class="label label-danger">TIEMPO LÍMITE</label>
                                            {% else %}
                                                <label class="label label-{% if prestamos.estado == 1 %}warning


                                                    {% else %}{% if prestamos.estado == 2 %}success{% endif %}{% endif %}">{{ prestamos.get_estado_display }}</label>
                                            {% endif %}
                                        </td>
                                        <td style="text-align: center; vertical-align: middle">

                                            <div class="dropdown" style="text-align: left">
                                                <a class="btn btn-mini dropdown-toggle" data-toggle="dropdown"
                                                   href="javascript:;">Acciones <span class="caret"></span></a>
                                                {% if prestamos.estado == 1 %}
                                                    <ul class="dropdown-menu" x-placement="right-start">
                                                        <li class="dropdown-item"><a style="cursor: pointer"
                                                                                     onclick="solicitudaajax_mio('{{ prestamos.id }}','{{ prestamos.activotecnologico.activotecnologico }}','devolveractivo','/mis_activos', 'Está por devolver el activo')"><i
                                                                class="fa fa-undo"></i>
                                                            Devolver</a></li>
                                                    </ul>
                                                {% endif %}
                                            </div>

                                        </td>
                                    </tr>
                                {% empty %}
                                    <tr>
                                        <td colspan="9" style="text-align: center"><b>NO EXISTE REGISTROS DE
                                            PRÉSTAMOS</b></td>
                                    </tr>
                                {% endfor %}
                                </tbody>
                            </table>
                        </div>
                        <div class="tab-pane fade" id="traspasos" role="tabpanel"
                             aria-labelledby="description-tab">
                            <a href="/mis_activos?action=addsolicitudtraspaso" id='nuevasolicitudtraspaso'
                               class='btn btn-success'><i class="fa fa-plus "></i> Nueva solicitud</a>
                            <table class='table table-bordered table-striped'>
                                <thead>
                                <tr>
                                    <th colspan="6">Mis solicitudes</th>
                                </tr>
                                <tr>
                                    <th style="text-align: center; vertical-align: middle; width: 2%;">#</th>
                                    <th style="text-align: center; vertical-align: middle; width: 10%;">Solicitante
                                    </th>
                                    <th style="text-align: center; vertical-align: middle; width:2%;">Fecha
                                        solicitud
                                    </th>
                                    <th style="text-align: center; vertical-align: middle; width: 10%;">Usuario
                                        entrega
                                    </th>
                                    <th style="text-align: center; vertical-align: middle; width: 8%;">Usuario
                                        recibe
                                    </th>
                                    <th style="text-align: center; vertical-align: middle; width: 8%;">Observación
                                    </th>
                                    <th style="text-align: center; vertical-align: middle; width: 2%;">Correcciones
                                    </th>
                                    <th style="text-align: center; vertical-align: middle; width: 2%;">Detalle
                                    </th>
                                    <th style="text-align: center; vertical-align: middle; width: 4%;">Estado
                                    </th>
                                    <th style="text-align: center; vertical-align: middle; width: 3%;">Acciones
                                    </th>
                                </tr>
                                </thead>
                                <tbody>
                                {% for traspaso in solicitudestraspasos %}
                                    <tr>
                                        <td style="text-align: center; vertical-align: middle">{{ forloop.counter }}</td>
                                        <td style="text-align: center; vertical-align: middle">
                                            {{ traspaso.solicitante }}
                                        </td>
                                        <td style="text-align: center; vertical-align: middle">
                                            {{ traspaso.fecha|date:"d-m-Y" }}
                                        </td>
                                        <td style="text-align: center; vertical-align: middle">
                                            {{ traspaso.usuarioentrega }}
                                        </td>
                                        <td style="text-align: center; vertical-align: middle">
                                            {{ traspaso.usuariorecibe }}
                                        </td>
                                        <td style="text-align: center; vertical-align: middle">
                                            {{ traspaso.observacion }}
                                        </td>
                                        <td style="text-align: center; vertical-align: middle">
                                            <a class="btn btn-warning btn-mini tu correcionessolicitud"
                                               idsolicitud="{{ traspaso.id }}"
                                               data-original-title="Correcciones"> <i class="fa fa-list"
                                                                                      aria-hidden="true"></i>
                                            </a>
                                        </td>
                                        <td style="text-align: center; vertical-align: middle">
                                            <a class="btn btn-info btn-mini tu detallesolicitud"
                                               idsolicitud="{{ traspaso.id }}"
                                               cid="33147" data-original-title="Detalles"> <i class="fa fa-list"
                                                                                              aria-hidden="true"></i>
                                            </a>
                                        </td>
                                        <td style="text-align: center; vertical-align: middle">
                                            {{ traspaso.get_estado_display }}
                                        </td>
                                        <td style="text-align: center; vertical-align: middle">

                                            <div class="dropdown" style="text-align: center">
                                                <a class="btn btn-mini dropdown-toggle" data-toggle="dropdown"
                                                   href="javascript:;">Acciones <span class="caret"></span></a>
                                                <ul class="dropdown-menu" x-placement="right-start">
                                                    {% if traspaso.estado == 1 %}
                                                        <li class="dropdown-item"><a style="cursor: pointer"
                                                                                     href="/mis_activos?action=editarsolicitudtraspaso&id={{ traspaso.id }}"><i
                                                                class="fa fa-edit"></i>
                                                            Editar</a></li>
                                                        <li class="dropdown-item"><a style="cursor: pointer"
                                                                                     onclick="solicitudaajax_mio('{{ traspaso.id }}','','cancelarsolicitud','/mis_activos', 'Está por cancelar la solicitud de traspaso')"><i
                                                                class="fa fa-close"></i>
                                                            Cancelar</a></li>
                                                    {% endif %}
                                                    {% if traspaso.estado == 20 %}
                                                        <li class="dropdown-item"><a style="cursor: pointer"
                                                                                     href="/mis_activos?action=editarsolicitudtraspaso&id={{ traspaso.id }}"><i
                                                                class="fa fa-edit"></i>
                                                            Corregir</a></li>
                                                    {% endif %}
                                                    {% if traspaso.puedefirmar %}
                                                        {% with puedefirmarpersona=traspaso|args:idpersonamisactivos|call:'persona_verificafirmasolicitud' %}
                                                            {% if puedefirmarpersona %}
                                                                <li class="dropdown-item"><a style="cursor: pointer"
                                                                                             onclick="formModalFirmar({{ traspaso.id }}, '','firmaractatraspaso', true, '1000px')"><i
                                                                        class="fa fa-signature"></i>
                                                                    Firmar</a></li>
                                                            {% endif %}
                                                        {% endwith %}
                                                    {% endif %}
                                                    {% if traspaso.puede_descargar_acta_firmada %}
                                                        <li class="dropdown-item"><a
                                                                href="/media/{{ traspaso.extraer_archivoactatraspaso }}"
                                                                style="cursor: pointer"><i
                                                                class="fa fa-arrow-down"></i> Descargar acta firmada</a>
                                                        </li>
                                                    {% endif %}
                                                    <li class="dropdown-item"><a style="cursor: pointer"
                                                                                 class="recorridosolicitud"
                                                                                 idsolicitud="{{ traspaso.id }}"><i
                                                            class="fa fa-eye"></i>
                                                        Mostrar recorrido</a></li>
                                                </ul>
                                            </div>
                                        </td>
                                    </tr>
                                {% empty %}
                                    <tr>
                                        <td colspan="10" style="text-align: center"><b>NO EXISTE REGISTROS DE
                                            SOLICITUDES</b></td>
                                    </tr>
                                {% endfor %}
                                </tbody>
                            </table>

                            <table class='table table-bordered table-striped'>
                                <thead>
                                <tr>
                                    <th colspan="6">Solicitudes recibidas</th>
                                </tr>
                                <tr>
                                    <th style="text-align: center; vertical-align: middle; width: 2%;">#</th>
                                    <th style="text-align: center; vertical-align: middle; width: 10%;">Solicitante
                                    </th>
                                    <th style="text-align: center; vertical-align: middle; width:2%;">Fecha
                                        solicitud
                                    </th>
                                    <th style="text-align: center; vertical-align: middle; width: 10%;">Usuario
                                        entrega
                                    </th>
                                    <th style="text-align: center; vertical-align: middle; width: 8%;">Usuario
                                        recibe
                                    </th>
                                    <th style="text-align: center; vertical-align: middle; width: 8%;">Observación
                                    </th>
                                    <th style="text-align: center; vertical-align: middle; width: 2%;">Correcciones
                                    </th>
                                    <th style="text-align: center; vertical-align: middle; width: 2%;">Detalle
                                    </th>
                                    <th style="text-align: center; vertical-align: middle; width: 4%;">Estado
                                    </th>
                                    <th style="text-align: center; vertical-align: middle; width: 3%;">Acciones
                                    </th>
                                </tr>
                                </thead>
                                <tbody>
                                {% for traspaso in solicitudestraspasosrecibidas %}
                                    <tr>
                                        <td style="text-align: center; vertical-align: middle">{{ forloop.counter }}</td>
                                        <td style="text-align: center; vertical-align: middle">
                                            {{ traspaso.solicitante }}
                                        </td>
                                        <td style="text-align: center; vertical-align: middle">
                                            {{ traspaso.fecha|date:"d-m-Y" }}
                                        </td>
                                        <td style="text-align: center; vertical-align: middle">
                                            {{ traspaso.usuarioentrega }}
                                        <td style="text-align: center; vertical-align: middle">
                                            {{ traspaso.usuariorecibe }}
                                        </td>
                                        <td style="text-align: center; vertical-align: middle">
                                            {{ traspaso.observacion }}
                                        </td>
                                        <td style="text-align: center; vertical-align: middle">
                                            <a class="btn btn-warning btn-mini tu correcionessolicitud"
                                               idsolicitud="{{ traspaso.id }}"
                                               data-original-title="Correcciones"> <i class="fa fa-list"
                                                                                      aria-hidden="true"></i>
                                            </a>
                                        </td>
                                        <td style="text-align: center; vertical-align: middle">
                                            <a class="btn btn-info btn-mini tu detallesolicitud"
                                               idsolicitud="{{ traspaso.id }}"
                                               data-original-title="Detalles"> <i class="fa fa-list"
                                                                                  aria-hidden="true"></i>
                                            </a>
                                        </td>
                                        <td style="text-align: center; vertical-align: middle">
                                            {{ traspaso.get_estado_display }}
                                        </td>
                                        <td style="text-align: center; vertical-align: middle">

                                            <div class="dropdown" style="text-align: center">
                                                <a class="btn btn-mini dropdown-toggle" data-toggle="dropdown"
                                                   href="javascript:;">Acciones <span class="caret"></span></a>
                                                <ul class="dropdown-menu" x-placement="right-start">
                                                    {% with custodioentrega=traspaso|args:idpersonamisactivos|call:'consultar_custodio_entrega' %}
                                                        {% if not custodioentrega %}
                                                            {% with custodiorecibe=traspaso|args:idpersonamisactivos|call:'persona_es_custodio_recibe' %}
                                                                {% if traspaso.estado == 1 or traspaso.estado == 2 or traspaso.estado == 21 %}
                                                                    {% if not custodiorecibe %}
                                                                        <li class="dropdown-item"><a
                                                                                style="cursor: pointer"
                                                                                onclick="solicitudaajax_mio('{{ traspaso.id }}','{{ traspaso.solicitante }}','confirmasolicitudusuariorecibe','/mis_activos', 'Está por confirmar la solicitud de la persona')"><i
                                                                                class="fa fa-check"></i>
                                                                            Confirmar</a></li>
                                                                        {#                                                                        <li class="dropdown-item"><a#}
                                                                        {#                                                                                style="cursor: pointer"#}
                                                                        {#                                                                                onclick="solicitudaajax_mio('{{ traspaso.id }}','{{ traspaso.solicitante }}','rechazasolicitudusuariorecibe','/mis_activos', 'Está por rechazar la solicitud de la persona')"><i#}
                                                                        {#                                                                                class="fa fa-close"></i>#}
                                                                        {#                                                                            Rechazar</a></li>#}
                                                                        <li class="dropdown-item"><a
                                                                                style="cursor: pointer"
                                                                                tipoaccion="rechazasolicitudusuariorecibe"
                                                                                class="rechazarsolicitudtraspaso"
                                                                                idsolicitud="{{ traspaso.id }}"><i
                                                                                class="fa fa-close"></i>
                                                                            Rechazar</a></li>
                                                                    {% endif %}
                                                                {% else %}
                                                                    {% with usuariorecibe=traspaso|args:idpersonamisactivos|call:'persona_es_usuario_recibe' %}
                                                                        {% if traspaso.estado == 4 and not usuariorecibe %}
                                                                            <li class="dropdown-item"><a
                                                                                    style="cursor: pointer"
                                                                                    onclick="solicitudaajax_mio('{{ traspaso.id }}','{{ traspaso.solicitante }}','confirmasolicitudcustodiorecibe','/mis_activos', 'Está por confirmar la solicitud de la persona')"><i
                                                                                    class="fa fa-check"></i>
                                                                                Confirmar</a></li>
                                                                            {#                                                                                <li class="dropdown-item"><a#}
                                                                            {#                                                                                        style="cursor: pointer"#}
                                                                            {#                                                                                        onclick="solicitudaajax_mio('{{ traspaso.id }}','{{ traspaso.solicitante }}','rechazasolicitudcustodiorecibe','/mis_activos', 'Está por rechazar la solicitud de la persona')"><i#}
                                                                            {#                                                                                        class="fa fa-close"></i>#}
                                                                            {#                                                                                    Rechazar</a></li>#}
                                                                            <li class="dropdown-item"><a
                                                                                    style="cursor: pointer"
                                                                                    tipoaccion="rechazasolicitudcustodiorecibe"
                                                                                    class="rechazarsolicitudtraspaso"
                                                                                    idsolicitud="{{ traspaso.id }}"><i
                                                                                    class="fa fa-close"></i>
                                                                                Rechazar</a></li>
                                                                        {% endif %}
                                                                    {% endwith %}
                                                                {% endif %}
                                                            {% endwith %}
                                                        {% endif %}
                                                    {% endwith %}
                                                    {% if traspaso.puedefirmar %}
                                                        {% with puedefirmarpersona=traspaso|args:idpersonamisactivos|call:'persona_verificafirmasolicitud' %}
                                                            {% if puedefirmarpersona %}
                                                                <li class="dropdown-item"><a style="cursor: pointer"
                                                                                             onclick="formModalFirmar({{ traspaso.id }}, '','firmaractatraspaso', true, '1000px')"><i
                                                                        class="fa fa-signature"></i>
                                                                    Firmar</a></li>
                                                            {% endif %}
                                                        {% endwith %}
                                                    {% endif %}
                                                    {% if traspaso.puede_descargar_acta_firmada %}
                                                        <li class="dropdown-item"><a
                                                                href="/media/{{ traspaso.extraer_archivoactatraspaso }}"
                                                                style="cursor: pointer"><i
                                                                class="fa fa-arrow-down"></i> Descargar acta firmada</a>
                                                        </li>
                                                    {% endif %}
                                                    <li class="dropdown-item"><a style="cursor: pointer"
                                                                                 class="recorridosolicitud"
                                                                                 idsolicitud="{{ traspaso.id }}"><i
                                                            class="fa fa-eye"></i>
                                                        Mostrar recorrido</a></li>
                                                </ul>
                                            </div>
                                        </td>
                                    </tr>
                                {% empty %}
                                    <tr>
                                        <td colspan="10" style="text-align: center"><b>NO EXISTE REGISTROS DE
                                            SOLICITUDES RECIBIDAS</b></td>
                                    </tr>
                                {% endfor %}
                                </tbody>
                            </table>
                        </div>
                        <div class="tab-pane fade" id="constataciones" role="tabpanel"
                             aria-labelledby="description-tab">
                            <div class="">
                                <h4 class="texto-blue"><i class="fa fa-laptop"></i> Activos Tecnológicos</h4>
                                <table class='table table_primary'>
                                    <thead>
                                    <tr>
                                        <th class="text-center">°N</th>
                                        <th class="text-center">Periodo
                                        </th>
                                        <th class="text-center">Fechas
                                        </th>
                                        <th class="text-center">Estado
                                        </th>
                                        <th class="text-center">Descripción
                                        </th>
                                        <th class="text-center">Acta
                                        </th>
                                        <th class="text-center"><i class="fa fa-cogs"></i></th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    {% for cronograma in cronogramas_cat %}
                                        <tr>
                                            <td class="text-center w-5">{{ forloop.counter }}</td>
                                            <td class="text-center w-25">{{ cronograma.periodo.nombre }}</td>
                                            <td class="fs-6 w-15">
                                                <p><b>F.Planificado:</b> {{ cronograma.fecha|date:"d-m-Y" }}
                                                    | {{ cronograma.hora|time:'h:i a' }}</p>
                                                {% if cronograma.fechainicio %}
                                                    <p>
                                                        <b>F.Inicio:</b> {{ cronograma.fechainicio|date:"d-m-Y | h:i a" }}
                                                    </p>
                                                {% endif %}
                                                {% if  cronograma.fechafin %}
                                                    <p><b>F.Fin:</b> {{ cronograma.fechafin|date:"d-m-Y | h:i a" }}</p>
                                                {% endif %}
                                                {% if cronograma.fechacierre %}
                                                    <p>
                                                        <b>F.Cierre:</b> {{ cronograma.fechacierre|date:"d-m-Y | h:i a" }}
                                                    </p>
                                                {% endif %}
                                            </td>
                                            <td class="text-center w-5">
                                                <span class="{{ cronograma.color_estado }}">{{ cronograma.get_estado_display }}</span>
                                            </td>
                                            <td class="w-25">
                                                <p>{{ cronograma.descripcion }}</p>
                                            </td>
                                            <td class="text-center w-5 align-middle">
                                                {% if cronograma.acta_firmada_orden_2 %}
                                                    <a href="{{ cronograma.acta_firmada_orden_2.archivo.url }}"
                                                       title="Acta de constataciones" data-bs-toggle="tooltip"
                                                       target="_blank"><i class="fa fa-file-pdf-o text-danger fs-3"></i></a>
                                                {% endif %}
                                            </td>
                                            <td class="w-5 text-center align-middle">
                                                <div class="dropdown dropstart">
                                                    <a href="javascript:void(0);"
                                                       class="btn-icon btn btn-ghost btn-sm rounded-circle"
                                                       data-bs-toggle="dropdown" data-offset="-140"
                                                       aria-haspopup="true" aria-expanded="false">
                                                        <i class="fa fa-ellipsis-v"></i>
                                                    </a>
                                                    <ul class="dropdown-menu" x-placement="right-start">
                                                        <li>
                                                            <a class="dropdown-item"
                                                               href="{{ request.path }}?action=constataciones&id={{ cronograma.id|encrypt }}">
                                                                <i class="fa fa-search-plus dropdown-item-icon"></i>
                                                                Activos constatados</a>
                                                        </li>
                                                        {% if cronograma.acta_firmada_orden_1 %}
                                                            <li>
                                                                <a class="dropdown-item"
                                                                   href="javascript:void(0);"
                                                                   onclick="formModalReport('{{ cronograma.id }}','Firmar acta de constatación','firmaracta')">
                                                                    <i class="fa fa-pencil dropdown-item-icon"></i>
                                                                    Firmar acta de constatación</a>
                                                            </li>
                                                        {% endif %}
                                                    </ul>
                                                </div>
                                            </td>
                                        </tr>
                                    {% empty %}
                                        <tr>
                                            <td colspan="10" class="text-center"><b>No existen registros</b></td>
                                        </tr>
                                    {% endfor %}
                                    </tbody>
                                </table>
                            </div>
                            <div class="">
                                <h4 class="texto-blue"><i class="fa fa-tags"></i> Activos Fijos</h4>
                                <table class='table table_primary'>
                                    <thead>
                                    <tr>
                                        <th class="text-center">°N</th>
                                        <th class="text-center">Periodo
                                        </th>
                                        <th class="text-center">Fechas
                                        </th>
                                        <th class="text-center">Estado
                                        </th>
                                        <th class="text-center">Observación
                                        </th>
                                        <th class="text-center">Acta
                                        </th>
                                        <th class="text-center"><i class="fa fa-cogs"></i></th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    {% for c in constataciones_af %}
                                        <tr>
                                            <td class="text-center w-5">{{ forloop.counter }}</td>
                                            <td class="text-center w-25">{{ c.periodo.nombre }}</td>
                                            <td class="fs-6 w-15">
                                                {% if c.fechainicio %}
                                                    <p>
                                                        <b>F.Inicio:</b> {{ c.fechainicio|date:"d-m-Y | h:i a" }}
                                                    </p>
                                                {% endif %}
                                                {% if  c.fechafin %}
                                                    <p><b>F.Fin:</b> {{ c.fechafin|date:"d-m-Y | h:i a" }}</p>
                                                {% endif %}
                                            </td>
                                            <td class="text-center w-5">
                                                <span class="{{ c.color_estado }}">{{ c.get_estado_display }}</span>
                                            </td>
                                            <td class="w-25">
                                                <p>{{ c.observacion }}</p>
                                            </td>
                                            <td class="text-center w-10 align-middle">
                                                    <a href="{{ c.get_documento.url }}"
                                                       data-bs-toggle="tooltip"
                                                       data-width="2048" data-height="1380"
                                                       data-fancybox="acta_{{ c.id }}"
                                                       data-caption="Acta de constatación: {{ c }}"
                                                       title="Acta de constataciones"
                                                       ><i class="fa fa-file-pdf-o text-danger fs-3"></i></a>
                                                    {{ c.get_estadoacta_display }}
                                            </td>
                                            <td class="w-5 text-center align-middle">
                                                <div class="dropdown dropstart">
                                                    <a href="javascript:void(0);"
                                                       class="btn-icon btn btn-ghost btn-sm rounded-circle"
                                                       data-bs-toggle="dropdown" data-offset="-140"
                                                       aria-haspopup="true" aria-expanded="false">
                                                        <i class="fa fa-ellipsis-v"></i>
                                                    </a>
                                                    <ul class="dropdown-menu" x-placement="right-start">
                                                        <li>
                                                            <a href="javascript:;"
                                                               class="dropdown-item"
                                                               onclick="formModalBase('{{ c.id|encrypt }}','Detalle de constataciones','det_constatacion')">
                                                                <i class="fa fa-list nav-icon dropdown-item-icon"></i> Detalle
                                                            </a>
                                                        </li>
                                                        {% if c.estado == 2 and not c.acta_firmada %}
                                                            <li>
                                                                  <a class="dropdown-item"
                                                                       href="javascript:void(0)"
                                                                       onclick="formModalBase('{{ c.id|encrypt }}','Firmar acta de constatación','firmaractaconstatacion','','modal-fullscreen')"
                                                                       > <i class='fa fa-signature nav-icon dropdown-item-icon'></i>
                                                                        Firmar acta
                                                                    </a>
                                                            </li>
                                                        {% endif %}
                                                    </ul>
                                                </div>
                                            </td>
                                        </tr>
                                    {% empty %}
                                        <tr>
                                            <td colspan="10" class="text-center"><b>No existen registros</b></td>
                                        </tr>
                                    {% endfor %}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal" role="dialog" id="itemspanel" style="padding-right: 25%">
                <div class="modal-dialog modal-dialog-centered" role="document" style="margin-top:7px;">
                    <div class="modal-content" style="width:1000px">
                        <div class="modal-header">
                            <h4><i class="fa fa-list"></i> <b class="paneltitle">Detalle solicitud</b></h4>
                        </div>
                        <div class="modal-body" style="margin-left:10px;">
                            <div class="row-fluid panelbody" style="">
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                        </div>
                    </div>
                </div>
            </div>

            {#    <div class="modal" role="dialog" id="recorridosolicitud" style="">#}
            {#        <div class="modal-dialog modal-dialog-centered" role="document" style="margin-top:7px;margin-left:30%">#}
            {#            <div class="modal-content" style="width:1000px">#}
            {#                <div class="modal-header">#}
            {#                    <h4><i class="fa fa-list"></i> <b class="paneltitle">Seguimiento traspaso</b></h4>#}
            {#                </div>#}
            {#                <div class="modal-body" style="margin-left:10px;">#}
            {#                    <div class="row-fluid panelbody" style="">#}
            {#                    </div>#}
            {#                </div>#}
            {#                <div class="modal-footer">#}
            {#                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>#}
            {#                </div>#}
            {#            </div>#}
            {#        </div>#}
            {#    </div>#}

            <div class="modal" id="modalfirma" style="display: none;">
                <div class="modal-dialog modal-dialog-centered modal-lg modal-fullscreen-xxl-down" role="document"
                     id="wmodal">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h4><i class="fa fa-list"></i> FIRMA SOLICITUD TRASPASO ACTIVO<b class="paneltitle1">FIRMA
                                TRASPASO
                                ACTIVO</b></h4>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close">
                            </button>
                            </button>
                        </div>
                        <div class="modal-body">
                            <form autocomplete="off" method="post"
                                  enctype="multipart/form-data" action="{{ request.path }}">
                                {% csrf_token %}
                                <div class="row-fluid panelbody1">
                                </div>
                            </form>
                        </div>
                        <div class="modal-footer" id="footermodal1">
                            <a href="javascript:;" class="btn btn-default" data-bs-dismiss="modal"><i
                                    class="fa fa-window-close"></i>
                                Cerrar</a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal fade" id="rechazosolicitudtraspaso" style="display: none;">
                <input type="hidden" value="" id="idsolicitudtraspasoactivo">
                <input type="hidden" value="" id="accionrechazosolicitudtraspaso" name="action">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h4 id="paneltitle">Rechazo solicitud traspaso</h4>
                        </div>
                        <div class="modal-body">
                            <div class="">
                                <label for="id_observacion" class="col-form-label"><b>Observación:</b> <span
                                        style="color: red"><b>*</b></span></label>
                                <textarea name="observacionrechazo" maxlength="1000" style="width: 100%;height: 100%"
                                          class="form-control" id="id_observacion"
                                          placeholder="Ingrese el motivo del rechazo de la solicitud..."></textarea>
                                </select>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <a href="javascript:;" id="btnrechazarsolicitudtraspaso" class="btn btn-danger">Rechazar
                                solicitud</a>
                            <a href="javascript:;" class="btn btn-default" data-bs-dismiss="modal">Cerrar</a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal fade" id="correccionsolicitudtraspaso" style="display: none;">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h3 class="paneltitle">Correcciones: <span cid={{ c.id }}></span></h3>
                        </div>
                        <div class="modal-body">
                            <div id="detalleconsmodal_body" style="max-height: 400px; overflow: auto">

                            </div>
                        </div>
                        <div class="modal-footer">
                            <div style="float: right">
                                <a href="javascript:;" class="btn btn-info" data-bs-dismiss="modal"> Aceptar</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal fade" id="recorridosolicitud" style="display: none;padding-right:30%">
                <div class="modal-dialog" role="document">
                    <div class="modal-content" style="width:900px">
                        <div class="modal-header">
                            <h3 class="paneltitle">Seguimiento de la solicitud: <span cid={{ c.id }}></span></h3>
                        </div>
                        <div class="modal-body">
                            <div id="" class="panelbody" style="max-height: 400px; overflow: auto">

                            </div>
                        </div>
                        <div class="modal-footer">
                            <div style="float: right">
                                <a href="javascript:;" class="btn btn-info" data-bs-dismiss="modal"> Aceptar</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
{% endblock %}