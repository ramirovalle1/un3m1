{% extends "basebs.html" %}
{% load sga_extras %}
{% block heading %}
    <script type="text/javascript" src='/static/js/select2.js?v=1.0.0'></script>
    <link type='text/css' rel='stylesheet' href="/static/css/select2.css?v=1.0.0"/>
    <link href="/static/css/table-responsive.css?1.0.0" type="text/css" rel="stylesheet"/>
    <script type="text/javascript" src='/static/js/fontawesomev3.js?v=1.0.0'></script>
    <script type="text/javascript">
        $(function () {

            $("#generar_evidenciamensual").click(function () {
                var fecinicio = $('#fecinicio').val();
                var fecfin = $('#fecfin').val();
                if (fecinicio && fecfin) {
                    openwindow('GET', '/pro_laboratoriocronograma', {
                        action: 'descargatutoriasfechas',
                        fecinicio: fecinicio,
                        fecfin: fecfin
                    }, '_blank');
                } else {
                    smoke.alert('Seleccione un rango de fechas')
                }
            });

            $("#generar_reportemensual").click(function () {
                var fecfin = $('#fecfinmen').val();
                var carrera = $('#carrera').val();
                var mesinforme = $('#mesinforme').val();
                if (fecfin && carrera && mesinforme) {
                    openwindow('GET', '/pro_laboratoriocronograma', {
                        action: 'informemensualpdf',
                        carrera: carrera,
                        mesinforme: mesinforme,
                        fecfin: fecfin
                    }, '_blank');
                } else {
                    smoke.alert('Complete los parametros')
                }
            });

            function formModal(id, text, action) {
                bloqueointerface();
                $.ajax({
                    type: "GET",
                    url: `{{ request.path }}`,
                    data: {
                        'action': action,
                        'id': id,
                    },
                    success: function (data) {
                        $.unblockUI();
                        if (data.result === true) {
                            $('.panelbody').html(data.data);
                            $('#itemspanel .paneltitle').html(text);
                            $("#itemspanel").modal({backdrop: 'static', width: '900'}).modal('show');
                        } else {
                            smoke.alert(data.mensaje);
                        }
                    },
                    error: function () {
                        $.unblockUI();
                        smoke.alert("Error de conexión.");
                    },
                    dataType: "json"
                });
            }


            $("select").select2({minimumResultsForSearch: 2});

            busqueda = function () {
                var term = $("#searchinput").val().trim().toUpperCase();
                var tipo = $('#tipo_solicitud').val();
                if ((term.length > 0) && (tipo > 0)) {
                    location.href = "/pro_laboratoriocronograma?action=listatutorias&s=" + term + "&tipo=" + tipo;
                } else {
                    if (term.length > 0) {
                        location.href = "/pro_laboratoriocronograma?action=listatutorias&s=" + term;
                    } else {
                        location.href = "/pro_laboratoriocronograma?action=listatutorias&tipo=" + tipo;
                    }
                }

                return false;
            };

            $("#search").click(function () {
                busqueda();
            });

            $('#searchinput').keyup(function (e) {
                if (e.keyCode == 13) {
                    busqueda();
                }
            });

            $(".cargarobservacion").click(function () {
                var idsolicitud = $(this).attr('idsolicitud');
                var ancho = (parseInt($(this).attr('ancho')) == 0) ? $(window).width() - 100 : $(this).attr('ancho');
                var alto = (parseInt($(this).attr('alto')) == 0) ? '530px' : $(this).attr('alto');
                bloqueointerface();
                $.ajax({
                    type: "GET",
                    url: "/pro_laboratoriocronograma",
                    data: {'action': 'ver_observacion', 'idsolicitud': idsolicitud},
                    success: function (data) {
                        $.unblockUI();
                        if (data.result == 'ok') {
                            $(".panelbodyobs").html(data.data);
                            $("#itemspanelobs").modal({backdrop: 'static', width: ancho, height: alto}).modal('show');
                        } else {
                            smoke.alert(data.mensaje);
                        }
                    },
                    error: function () {
                        $.unblockUI();
                        smoke.alert("Error de conexión.");
                    },
                    dataType: "json"
                });
            });

            $("#cerrarpanelobs").click(function () {
                $("#itemspanelobs").modal("hide");
                return false;
            });


            $(".detalletutoria").click(function () {
                var id = $(this).attr('idt');
                bloqueointerface();
                $.ajax({
                    type: "GET",
                    url: "/pro_laboratoriocronograma",
                    data: {'action': 'traertutorias', 'id': id},
                    success: function (data) {
                        $.unblockUI();
                        if (data.result == 'ok') {
                            $("#body-tutoria").html(data.data);
                            $("#vertutorias").modal({backdrop: 'static', width: '900px'}).modal('show');
                        } else {
                            smoke.alert(data.mensaje);
                        }
                    },
                    error: function () {
                        $.unblockUI();
                        smoke.alert("Error de conexión.");
                    },
                    dataType: "json"
                });
            });
            $("#cerrarvertutorias").click(function () {
                $("#vertutorias").modal("hide");
                return false;
            });

        });

        function reporteevidencias() {
            $("#reporteevidencias").modal({backdrop: 'static', width: '500px'}).modal('show');
        }

        function reportemensual() {
            $("#reportemensual").modal({backdrop: 'static', width: '500px'}).modal('show');
        }

    </script>
{% endblock %}
{% block atras %}/pro_laboratoriocronograma{% endblock %}
{% block canvas %}

    <div class="modal fade static" id="reporteevidencias" style="display: none;">
        <div class="modal-header">
            <h4 class="paneltitle"><i class="fa fa-file-excel-o"></i> Reporte de Evidencias Tutoría Estudiantes</h4>
        </div>
        <div class="modal-body">
            <div>
                <label for="">Fecha Inicio</label>
                <input type="date" name="fecinicio" id="fecinicio" width="100%" class="form-control"
                       style="width: 100%">
            </div>
            <div>
                <label for="">Fecha Fin</label>
                <input type="date" name="fecfin" id="fecfin" width="100%" class="form-control" style="width: 100%">
            </div>
        </div>
        <div class="modal-footer" style="text-align: right">
            <a href="javascript:;" class="btn btn-success" id="generar_evidenciamensual"><i class="fa fa-download"></i>
                Generar</a>
            <a href="javascript:;" class="btn btn-default" data-dismiss="modal"><i class="fa fa-window-close"></i>
                Cerrar</a>
        </div>
    </div>

    <div class="modal fade static" id="reportemensual" style="display: none;">
        <div class="modal-header">
            <h4 class="paneltitle"><i class="fa fa-file-pdf-o"></i> Informe Mensual</h4>
        </div>
        <div class="modal-body">
            <div class="alert alert-primary" role="alert">
                <i class="fa fa-info-circle"></i> Las observaciones y recomendaciones se filtraran segun la el mes y año del informe.
            </div>
            <div>
                <label for="">Carrera</label>
                <select name="carrera" id="carrera" style="width: 100%" class="form-control">
                    {#                    <option value="0">TODAS</option>#}
                    {% for c in carrerasdocente %}
                        <option value="{{ c.pk }}">{{ c }}</option>
                    {% endfor %}
                </select>
            </div>
            <div>
                <label for="">Mes</label>
                <select name="mesinforme" id="mesinforme" style="width: 100%" class="form-control">
                    {#                    <option value="0">TODAS</option>#}
                    {% for c in meses %}
                        <option value="{{ c.pk }}">{{ c.get_mes|upper }} {{ c.anio }}</option>
                    {% endfor %}
                </select>
            </div>
            <div>
                <label for="">Fecha Generación Informe</label>
                <input type="date" name="fecfinmen" id="fecfinmen" width="100%" class="form-control"
                       style="width: 100%">
            </div>
            <br>
            <div class="alert alert-info" role="alert">
                <i class="fa fa-info-circle"></i> Tomar en cuenta el período actual para a generación de la información.
            </div>
        </div>
        <div class="modal-footer" style="text-align: right">
            <a href="javascript:;" class="btn btn-success" id="generar_reportemensual"><i class="fa fa-download"></i>
                Generar</a>
            <a href="javascript:;" class="btn btn-default" data-dismiss="modal"><i class="fa fa-window-close"></i>
                Cerrar</a>
        </div>
    </div>

    <div class='row-fluid'>
        <div class='span12'>
            <h4>{{ title }} </h4>
        </div>
    </div>
    <div class='row-fluid'>
        <div class='span6'>
            <div class="btn-group">
                <a class="btn dropdown-toggle" data-toggle="dropdown" href="javascript:;"><i class="fa fa-cogs"></i> Acción <span
                        class="caret"></span></a>
                <ul class="dropdown-menu pull-left">
{#                    <li><a href="/pro_laboratoriocronograma?action=programartutoria"><i class="fa fa-calendar"></i> Programar#}
{#                        Tutoría</a></li>#}
                    <li>
                        <a href="/pro_laboratoriocronograma?action=tutoriapractica"><i class="fa fa-calendar"></i> Registrar Tutoría</a>
                    </li>
                    <li>
                        <a href="?action=evidenciainformesmmensual"><i class="fa fa-tasks"></i> Evidencias Informe mensual</a>
                    </li>
                    <li>
                        <a href="javascript:void(0)" onclick="reportemensual();"><i class="fa fa-file-pdf-o"></i> Generar Informe mensual</a>
                    </li>
{#                    <li>#}
{#                        <a href="?action=registrarhorario"><i class="fa fa-calendar-plus"></i> Registrar Planificacion Tutorias</a>#}
{#                    </li>#}
                </ul>
            </div>
            <div class="btn-group">
                <a class="btn dropdown-toggle" data-toggle="dropdown" href="javascript:;"><i class="fa fa-file-excel"></i> Reportes <span
                        class="caret"></span></a>
                <ul class="dropdown-menu pull-left">
                    <li>
                        <a target="_blank" href="/pro_laboratoriocronograma?action=excelpracticas"><i class="fa fa-file-excel-o"></i> Excel Inscritos</a>
                    </li>
                    <li>
                        <a target="_blank" href="/pro_laboratoriocronograma?action=excelinquietudconsultaestudiante"><i class="fa fa-file-excel-o"></i> Inquietud Estudiantes Excel</a></li>
                    <li>
                        <a target="_blank" href="/pro_laboratoriocronograma?action=reporteinquietudconsultaestudiante"><i class="fa fa-file-pdf-o"></i> Inquietud Estudiantes PDF</a>
                    </li>
{#                    <li>#}
{#                        <a href="/pro_laboratoriocronograma?action=descargatutorias"><i class="fa fa-file-excel-o"></i> Reporte Tutoría</a>#}
{#                    </li>#}
                    <li>
                        <a href="javascript:void(0);" onclick="reporteevidencias();"><i class="fa fa-file-excel-o"></i>  Reporte Tutoría por Fechas</a>
                    </li>
                </ul>
            </div>
            {% if formatospractica %}
                <div class="btn-group">
                    <a class="btn dropdown-toggle" data-toggle="dropdown" href="javascript:;">Formatos <span
                            class="caret"></span></a>
                    <ul class="dropdown-menu pull-left">
                        {% for formatopractica in formatospractica %}
                            <li class="dropdown-submenu">
                                <a href="javascript:;"><i class="fa fa-folder"></i> {{ formatopractica.nombre }}</a>
                                <ul class="dropdown-menu">
                                    {% for detalleformato in formatopractica.detalleformatos %}
                                        <li><a href="{{ detalleformato.download_link }}" target="_blank"><i
                                                class="fa fa-file"></i> {{ detalleformato.nombre }}</a></li>
                                    {% endfor %}
                                </ul>
                            </li>
                        {% endfor %}
                    </ul>
                </div>
            {% endif %}
        </div>
        <div class='span6'>
            <form class="form-search" onsubmit="return busqueda()">
                <input class='searchinput' type='text' id='searchinput' value='{{ search }}' autocomplete="off"/>
                <select id='tipo_solicitud' style="width: 150px">
                    <option {% if tipo == 0 %} selected {% endif %} value='0'>Todos</option>
                    <option {% if tipo == 11 %} selected {% endif %} value='11'>Evidencia por aprobar</option>
                    <option {% if tipo == 12 %} selected {% endif %} value='12'>Evidencias pendientes por subir
                        estudiante
                    </option>
                    <option {% if tipo == 13 %} selected {% endif %} value='13'>Evidencias negadas</option>
                    <option {% if tipo == 10 %} selected {% endif %} value='10'>Prácticas culminadas</option>
                </select>
                <a href="javascript:;" id='search' class='btn btn-info'><i class="fa fa-search "></i> Buscar</a>
                {% if search or ids or tipo %}
                    <a href="/pro_laboratoriocronograma?action=listatutorias" class='btn btn-info'><i class="fa fa-refresh "></i>
                        Todos</a>
                {% endif %}
            </form>
        </div>
    </div>
    <div id="no-more-tables"><!-- inicio no more tables-->
        <div class="row-fluid">
            <div class="span12">
                <table class="table table-bordered table-striped filterable">
                    <thead>
                    {#                    <tr>#}
                    {#                        <th colspan="8">TUTORIAS PRÁCTICAS PRE PROFESIONALES</th>#}
                    {#                    </tr>#}
                    <tr>
                        <th style="width: 50px;text-align: center">N°</th>
                        <th>Estudiante</th>
                        <th style="width: 310px">Detalles</th>
                        <th style="text-align: center;">Tipo</th>
                        <th style="width: 80px;text-align: center;">Fechas</th>
                        <th style="width: 40px; text-align: center;">Horas</th>
                        <th style="text-align: center;">Institución</th>
                        <th style="width: 190px; text-align: center;">Tutoría</th>
                        <th style="width: 100px; text-align: center;">% Asistencía Tutoría</th>
                        <th style="width: 90px;"></th>
                    </tr>
                    </thead>
                    <tbody>
                    {% for practicaspreprofesionale in tutoriaspracticas %}
                        {#                    {% if not practicaspreprofesionale.culminada %}#}
                        <tr>
                            <td data-title='Nº:' style="text-align: center"><b>{{ practicaspreprofesionale.pk }}</b>
                                <br> <br>
                                {% if practicaspreprofesionale.tiene_tutorias %}
                                    <a class="btn btn-primary btn-mini detalletutoria tu" title="Tutorias"
                                       href='javascript:;' idt="{{ practicaspreprofesionale.id }}"><i class="fa fa-chalkboard-teacher"></i></a>
                                {% endif %}

                            </td>
                            <td data-title='Estudiante:'>
                                {{ practicaspreprofesionale.inscripcion.persona }}<br><b>{{ practicaspreprofesionale.inscripcion.carrera }}</b><br>
                                <strong>Ced.:</strong> {{ practicaspreprofesionale.inscripcion.persona.cedula }}<br>
                                <strong>Telf.:</strong> {{ practicaspreprofesionale.inscripcion.persona.telefono }}<br>
                                <strong>Email.:</strong> {{ practicaspreprofesionale.inscripcion.persona.email }}<br>
                                <strong>Email
                                    Inst.:</strong> {{ practicaspreprofesionale.inscripcion.persona.emailinst }}<br>
                                <strong>Dirección.:</strong><span style="font-size: 10px;">
                                {% if practicaspreprofesionale.inscripcion.persona.canton %}
                                    {{ practicaspreprofesionale.inscripcion.persona.canton }} -
                                {% endif %}
                                {% if practicaspreprofesionale.inscripcion.persona.direccion %}
                                    {{ practicaspreprofesionale.inscripcion.persona.direccion }}
                                {% endif %}
                                {% if practicaspreprofesionale.inscripcion.persona.direccion2 %}
                                    {{ practicaspreprofesionale.inscripcion.persona.direccion2 }}
                                {% endif %}</span> <br>
                                {% if practicaspreprofesionale.periodoppp %}
                                    <span class="label label-success tu"
                                          data-original-title="Evidencias Aprobadas">{{ practicaspreprofesionale.evidenciasaprobadas }} / {{ practicaspreprofesionale.totalevidencias }}</span>
                                    <span class="label label-warning tu"
                                          data-original-title="Evidencias Solicitadas">{{ practicaspreprofesionale.evidenciassolicitadas }}</span>
                                    <span class="label label-important tu"
                                          data-original-title="Evidencias Rechazadas">{{ practicaspreprofesionale.evidenciasreprobadas }}</span>
                                {% endif %}
                                {% if practicaspreprofesionale.tipo == 1 or practicaspreprofesionale.tipo == 2 %}
                                    {% if not practicaspreprofesionale.culminatutoria %}
                                        <span class="label label-warning">TUT. PENDIENTE</span>
                                    {% else %}
                                        <span class="label label-info"> TUT. CULMINADA</span>
                                    {% endif %}
                                    <span class="label label-default tu"
                                          data-original-title="Tutorías realizadas">{{ practicaspreprofesionale.cuenta_tutorias }}</span>
                                {% endif %}
                                {% if practicaspreprofesionale.culminada or practicaspreprofesionale.retirado %}
                                    {% if practicaspreprofesionale.tiposolicitud == 3 %}
                                        <span class="label label-success"> PRÁCTICA HOMOLOGADA</span>
                                    {% else %}
                                        {% if practicaspreprofesionale.retirado %}
                                            <span class="label label-important">RETIRADO POR VOLUNTAD PROPIA</span>
                                        {% else %}
                                            <span class="label label-success"> PRÁCTICA CULMINADA</span>
                                        {% endif %}
                                        {% if not practicaspreprofesionale.inscripcion.coordinacion.id == 1 %}
                                            {% if practicaspreprofesionale.estadosolicitud == 1 %}
                                                <span class="label label-warning tu"
                                                      data-original-title="Solicitado">{{ practicaspreprofesionale.get_estadosolicitud_display }}</span>
                                            {% endif %}
                                            {% if practicaspreprofesionale.estadosolicitud == 2 %}
                                                <span class="label label-success tu"
                                                      data-original-title="Aprobado">{{ practicaspreprofesionale.get_estadosolicitud_display }}</span>
                                            {% endif %}
                                            {% if practicaspreprofesionale.estadosolicitud == 3 %}
                                                <span class="label label-important tu"
                                                      data-original-title="Rechazado">{{ practicaspreprofesionale.get_estadosolicitud_display }}</span>
                                            {% endif %}
                                            {% if practicaspreprofesionale.estadosolicitud == 4 %}
                                                <span class="label label-info tu"
                                                      data-original-title="Pendiente">{{ practicaspreprofesionale.get_estadosolicitud_display }}</span>
                                            {% endif %}
                                            {% if practicaspreprofesionale.estadosolicitud == 5 %}
                                                <span class="label label-info tu"
                                                      data-original-title="Retirado">{{ practicaspreprofesionale.get_estadosolicitud_display }}</span>
                                            {% endif %}
                                            {% if practicaspreprofesionale.estadosolicitud == 6 %}
                                                <span class="label label-important tu"
                                                      data-original-title="Reprobado">{{ practicaspreprofesionale.get_estadosolicitud_display }}</span>
                                            {% endif %}
                                        {% endif %}
                                    {% endif %}
                                {% else %}
                                    {% if practicaspreprofesionale.tiposolicitud == 3 or practicaspreprofesionale.tiposolicitud == 4 %}
                                        <span class="label label-success">{{ practicaspreprofesionale.get_tiposolicitud_display }}</span>
                                    {% else %}
                                        <span class="label label-warning">{{ practicaspreprofesionale.get_tiposolicitud_display }}</span>
                                    {% endif %}
                                    {% if practicaspreprofesionale.estadosolicitud == 1 %}
                                        <span class="label label-warning tu"
                                              data-original-title="Solicitado">{{ practicaspreprofesionale.get_estadosolicitud_display }}</span>
                                    {% endif %}
                                    {% if practicaspreprofesionale.estadosolicitud == 2 %}
                                        <span class="label label-success tu"
                                              data-original-title="Aprobado">{{ practicaspreprofesionale.get_estadosolicitud_display }}</span>
                                    {% endif %}
                                    {% if practicaspreprofesionale.estadosolicitud == 3 %}
                                        <span class="label label-important tu"
                                              data-original-title="Rechazado">{{ practicaspreprofesionale.get_estadosolicitud_display }}</span>
                                    {% endif %}
                                    {% if practicaspreprofesionale.estadosolicitud == 4 %}
                                        <span class="label label-info tu"
                                              data-original-title="Pendiente">{{ practicaspreprofesionale.get_estadosolicitud_display }}</span>
                                    {% endif %}
                                {% endif %}
                                {% if practicaspreprofesionale.obseaprueba %}
                                    <a class="btn btn-tini cargarobservacion tu"
                                       data-original-title="Observación de Aprobación ó Negación"
                                       idsolicitud="{{ practicaspreprofesionale.id }}"><i class="fa fa-eye"></i></a>
                                {% endif %}
                                {% if practicaspreprofesionale.archivo %}
                                    <a href="/media/{{ practicaspreprofesionale.archivo }}" target="_blank"
                                       class="btn btn-warning btn-mini tu"
                                       title="Archivo Solicitud de Prácticas PreProfesionales"><i
                                            class="fa fa-file"></i></a>
                                {% endif %}
                                {% if practicaspreprofesionale.tiposolicitud != 3 %}
                                    {% if practicaspreprofesionale.preinscripcion.preinscripcion.periodo %}<br>
                                        <label class="label label-green">{{ practicaspreprofesionale.preinscripcion.preinscripcion.periodo }}</label>
                                    {% endif %}
                                {% endif %}
                            </td>
                            <td data-title='Detalles:' style="height: auto">
                                <b>Periodo: </b> {{ practicaspreprofesionale.periodoppp }}<br>
                                <b>F.Creación:</b> {{ practicaspreprofesionale.fecha_creacion|date:"Y-m-d h:i a" }}<br>
                                {% if practicaspreprofesionale.tutorunemi %}
                                    <strong>Tutor Acad:</strong>
                                    {{ practicaspreprofesionale.tutorunemi|default_if_none:""|upper }}<br>
                                {% endif %}
                                {% if practicaspreprofesionale.supervisor %}
                                    <strong>Supervisor:</strong>
                                    {{ practicaspreprofesionale.supervisor|default_if_none:""|upper }}<br>
                                {% endif %}
                                {% if practicaspreprofesionale.observacion %}
                                    <b>Obs:</b> {{ practicaspreprofesionale.observacion }}<br>
                                {% endif %}
                                {% if practicaspreprofesionale.itinerariomalla %}
                                    <b>Itinerario:</b> {{ practicaspreprofesionale.itinerariomalla.nombreitinerario }}
                                {% endif %}
                                {% if practicaspreprofesionale.periodoppp %}
                                    {% if practicaspreprofesionale.periodoppp.evaluarpromedio %}
                                        <br/><b>Promedio de práctica:</b>
                                        <span class="label label-info">{{ practicaspreprofesionale.total_promedio_nota_evidencia|floatformat:2 }}</span>
                                    {% endif %}
                                {% endif %}
                                {% if practicaspreprofesionale.oferta %}
                                    <br><b>Oferta:</b> <span class="label label-info">SI</span>
                                {% endif %}
                                {% if practicaspreprofesionale.retirado and practicaspreprofesionale.fechahastapenalizacionretiro %}
                                    <br><b>Fecha fin de penalización de retiro: </b>
                                    <span class="label label-info">{{ practicaspreprofesionale.fechahastapenalizacionretiro|date:"d-m-Y" }}</span>
                                {% endif %}


                            </td>
                            <td data-title='Tipo:'
                                style="text-align: center">{{ practicaspreprofesionale.get_tipo_display }}</td>
                            <td data-title='Fechas:' style="text-align: justify">
                                <b>F.Desde:</b><br>{{ practicaspreprofesionale.fechadesde|date:"d-m-Y" }}<br>
                                <b>F.Hasta:</b><br>{{ practicaspreprofesionale.fechahasta|date:"d-m-Y" }}<br>
                                {% if practicaspreprofesionale.fechaasigtutor %}
                                    <b>F.Asig Tutor:</b><br>{{ practicaspreprofesionale.fechaasigtutor|date:"d-m-Y" }}
                                    <br>
                                {% endif %}
                            </td>
                            <td data-title='Horas:' style="text-align: center">
                                {{ practicaspreprofesionale.numerohora }}
                                {% if practicaspreprofesionale.tiposolicitud == 3 %}<br>
                                    <span class="label label-default tu"
                                          data-original-title="Horas Homologadas">{{ practicaspreprofesionale.horahomologacion|default_if_none:"" }}</span>
                                {% endif %}
                            </td>
                            <td data-title='Inst.:'>
                                {% if practicaspreprofesionale.institucion %}
                                    {{ practicaspreprofesionale.institucion|upper }}
                                {% else %}
                                    {% if not practicaspreprofesionale.convenio and not practicaspreprofesionale.acuerdo %}
                                        {% if not practicaspreprofesionale.empresaempleadora %}
                                            {% if practicaspreprofesionale.otraempresaempleadora %}
                                                <span class="label label-default">{{ practicaspreprofesionale.otraempresaempleadora|upper }}</span>
                                            {% else %}
                                                <span class="label label-important">NO SE ASIGNÓ UNA EMPRESA O CAMPO "OTRA EMPRESA" VACÍO</span>
                                            {% endif %}
                                        {% else %}
                                            {{ practicaspreprofesionale.empresaempleadora.nombre|upper }}
                                        {% endif %}
                                    {% else %}
                                        {#                                            POR CONVENIO#}
                                        {% if practicaspreprofesionale.convenio %}
                                            {% if practicaspreprofesionale.convenio.empresaempleadora %}
                                                <span class="label label-default">{{ practicaspreprofesionale.convenio.empresaempleadora.nombre|upper }}</span>
                                            {% else %}
                                                <span class="label label-warning">EMPRESA DEL CONVENIO NO ASIGNADA</span>
                                            {% endif %}
                                        {% elif practicaspreprofesionale.acuerdo.empresa %}
                                            {% if practicaspreprofesionale.acuerdo.empresa %}
                                                <span class="label label-default">{{ practicaspreprofesionale.acuerdo.empresa.nombre|upper }}</span>
                                            {% else %}
                                                <span class="label label-warning">EMPRESA DEL ACUERDO NO ASIGNADA</span>
                                            {% endif %}
                                        {% else %}
                                            <span class="label label-important">DEBE SELECCIONAR UN ACUERDO O CONVENIO</span>
                                        {% endif %}
                                    {% endif %}
                                {% endif %}<br>
                                {#                                {% if practicaspreprofesionale.institucion %}#}
                                {#                                    {{ practicaspreprofesionale.institucion|upper }}#}
                                {#                                {% else %}#}
                                {#                                    {% if not practicaspreprofesionale.empresaempleadora %}#}
                                {#                                        <span class="label label-default">{{ practicaspreprofesionale.otraempresaempleadora|upper }}</span>#}
                                {#                                    {% else %}#}
                                {#                                        {{ practicaspreprofesionale.empresaempleadora|upper }}#}
                                {#                                    {% endif %}#}
                                {#                                {% endif %}<br>#}
                                {% if practicaspreprofesionale.departamento %}
                                    <strong>Dep:</strong>
                                    {{ practicaspreprofesionale.departamento|default_if_none:""|upper }}<br>
                                {% endif %}
                                <strong>Tutor
                                    Emp:</strong> {{ practicaspreprofesionale.tutorempresa|default_if_none:""|upper }}<br>
                                <strong>Sector Ec:</strong> {{ practicaspreprofesionale.sectoreconomico_letra }} <br>
                                <strong>Tipo Ins:</strong> {{ practicaspreprofesionale.get_tipoinstitucion_display }}
                                {% if practicaspreprofesionale.rotacionmalla %}
                                    <br><strong>Rotación:</strong> {{ practicaspreprofesionale.rotacionmalla }}
                                {% endif %}
                                {% if practicaspreprofesionale.lugarpractica %}
                                    <br><strong>Lugar Pract:</strong>
                                    {{ practicaspreprofesionale.lugarpractica.nombre|default_if_none:"sin asignar"|upper }}
                                {% endif %}
                                {% if practicaspreprofesionale.itinerariomalla %}
                                    <br><strong>Itinerario.:</strong>
                                    {{ practicaspreprofesionale.itinerariomalla.nombreitinerario }}
                                {% endif %}
                                {% if practicaspreprofesionale.asignacionempresapractica %}<br>
                                    <strong>Empresa Asignada:</strong>
                                    {{ practicaspreprofesionale.asignacionempresapractica|default_if_none:""|upper }}
                                    <br>
                                {% endif %}
                            </td>
                            <td style="text-align: left" data-title="Tutoría">
                                    <center>
                                        {% if practicaspreprofesionale.tipo == 1 or  practicaspreprofesionale.tipo == 2 %}
                                            {% if practicaspreprofesionale.aplicatutoria %}
                                                {% if practicaspreprofesionale.culminatutoria %}
                                                    <span class="label label-success">CULMINADA</span>
                                                {% else %}
                                                    <span class="label label-warning">PENDIENTE</span>
                                                {% endif %}
                                            {% else %}
                                                <span class="label label-default">NO OBLIGATORIAS</span>
                                            {% endif %}
                                        {% endif %}
                                    </center>
                            </td>
                            <td data-title="% Asistencía Tutorías" style="text-align: center">
                                    {% if practicaspreprofesionale.preinscripcion.preinscripcion.agendatutoria %}
                                        <center>
                                            {% if practicaspreprofesionale.porcentajeasistenciatutorias <= 69 %}
                                                <label class="btn">
                                                    <b style="font-size: 15px" class="text text-error">{{ practicaspreprofesionale.porcentajeasistenciatutorias }}%</b>
                                                </label>
                                            {% else %}
                                                <label class="btn">
                                                <b style="font-size: 15px" class="text text-success">{{ practicaspreprofesionale.porcentajeasistenciatutorias }}%</b>
                                                </label>
                                            {% endif %} <br>
                                            <a style="margin-top: 7px;" class="btn btn-primary btn-mini tu" title="Detalle Asistencia" onclick="mensajeFlotante('Detalle de Tutorías Agendadas', 'Total Agendadas: {{ practicaspreprofesionale.tottutoriasfinalizadas }}\nTotal de Faltas: {{ practicaspreprofesionale.tottutoriasnoasistidas }}\nTotal Asistidas: {{ practicaspreprofesionale.tottutoriasasistidas }}\n')"
                                               href='javascript:;'> <i class='fa fa-eye'></i> Ver Detalle
                                            </a>
                                        </center>
                                    {% else %}
                                        <label class="label label-default"><i class="fa fa-times"></i> NO REQUERIDO</label>
                                    {% endif %}
                            </td>
                            <td>
                                <div class="btn-group">
                                    <a class="btn dropdown-toggle" data-toggle="dropdown" href="javascript:;">
                                        {% if practicaspreprofesionale.misinquietudes.count %}
                                            <label href="javascript:void(0)" class="label label-warning tl" style="background-color: #ffad05;!important;" title="Inquietudes de Estudiantes">
                                                <b class="blinkimg"><i class="fa fa-bell"></i> {{ practicaspreprofesionale.misinquietudes.count }}</b>
                                            </label>
                                        {% endif %} Acciones
                                        <span class="caret"></span>
                                    </a>
                                    <ul class="dropdown-menu pull-right">
                                        {% if practicaspreprofesionale.formatoevidenciaalumno == 1 %}
                                            {% if practicaspreprofesionale.totalevidencias > 0 %}
                                                <li>
                                                    <a href='/pro_laboratoriocronograma?action=subirarchivos&id={{ practicaspreprofesionale.id }}&opc=1{% if tipo %}&tipo={{ tipo }}{% endif %}'><span
                                                            class="fa fa-list"></span> Ver Evidencias</a>

                                                </li>
                                            {% endif %}
                                        {% else %}
                                            <li>
                                                <a href='/pro_laboratoriocronograma?action=subirarchivos&id={{ practicaspreprofesionale.id }}&opc=1{% if tipo %}&tipo={{ tipo }}{% endif %}'><span
                                                        class="fa fa-list"></span> Ver Evidencias</a>
                                            </li>
                                        {% endif %}
                                        <li>
                                            <a href='/pro_laboratoriocronograma?action=inquietudconsultaestudiante&id={{ practicaspreprofesionale.id | encrypt }}'><b
                                                    style="color: red; font-size: 12px"> {{ practicaspreprofesionale.mensajes_sin_reesponder }} </b>
                                                <span class="fa fa-envelope-o"></span> Inquietudes</a>
                                        </li>

                                        {% if not practicaspreprofesionale.culminatutoria %}
                                            {% if practicaspreprofesionale.cuenta_tutorias >= 2 %}
                                                <li>
                                                    <a class="confirmacionmodal" href="javascript:;"
                                                       nhref='/pro_laboratoriocronograma?action=culminartutoria&id={{ practicaspreprofesionale.id | encrypt }}'>
                                                        <span class="fa fa-check-circle"></span> Culminar tutoria</a>

                                                </li>
                                            {% endif %}
                                            {#                                        {% else %}#}
                                            {#                                            <li>#}
                                            {#                                                <a href='/pro_laboratoriocronograma?action=inquietudconsultaestudiante&id={{ practicaspreprofesionale.id | encrypt }}'>#}
                                            {#                                                    <span class="fa fa-clock-o"></span> Tutoria adicional</a>#}
                                            {##}
                                            {#                                                <a onclick="formModal('{{practicaspreprofesionale.id}}','TUTORIA ADICIONAL','tutoriaadicional')"#}
                                            {#                                                   href="javascript:void(0);"class="btn btn-success"><i class="fa fa-plus"></i> Tutoria Adicional</a>#}
                                            {##}
                                            {#                                            </li>#}
                                        {% endif %}
                                    </ul>
                                </div>

                            </td>
                        </tr>
                        {#                    {%  endif %}#}
                    {% empty %}
                        <tr>
                            <td colspan="14">NO HAY REGITROS DE PRACTICAS PREPROFESIONALES</td>
                        </tr>
                    {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <div class='row-fluid'>
        <div class="span12">
            {% if paging.num_pages > 5 %}
                <div class='pagination'>
                    <ul>
                        {% if paging.primera_pagina %}
                            <li>
                                <a href="/pro_laboratoriocronograma?action=listatutorias&{% if tipo %}tipo={{ tipo }}&{% endif %}&{% if search %}s={{ search }}&{% endif %}page=1">1</a>
                            </li>
                            <li>
                                <a href="/pro_laboratoriocronograma?action=listatutorias&{% if tipo %}tipo={{ tipo }}&{% endif %}&{% if search %}s={{ search }}&{% endif %}page={{ paging.ellipsis_izquierda }}"
                                   class="active">...</a></li>
                        {% endif %}
                        {% for pagenumber in paging.paginas %}
                            <li {%  if pagenumber == page.number %}class='active'{% endif %}><a
                                    href="/pro_laboratoriocronograma?action=listatutorias&{% if tipo %}tipo={{ tipo }}&{% endif %}&{% if search %}s={{ search }}&{% endif %}page={{ pagenumber }}">{{ pagenumber }}</a>
                            </li>
                        {% endfor %}
                        {% if paging.ultima_pagina %}
                            <li>
                                <a href="/pro_laboratoriocronograma?action=listatutorias&{% if tipo %}tipo={{ tipo }}&{% endif %}&{% if search %}s={{ search }}&{% endif %}page={{ paging.ellipsis_derecha }}"
                                   class="active">...</a></li>
                            <li>
                                <a href="/pro_laboratoriocronograma?action=listatutorias&{% if tipo %}tipo={{ tipo }}&{% endif %}&{% if search %}s={{ search }}&{% endif %}page={{ paging.num_pages }}">{{ paging.num_pages }}</a>
                            </li>
                        {% endif %}
                    </ul>
                </div>
            {% else %}
                <div class='pagination'>
                    <ul>
                        {% for pagenumber in paging.page_range %}
                            <li {%  if pagenumber == page.number %}class='active'{% endif %}><a
                                    href="/pro_laboratoriocronograma?action=listatutorias&{% if tipo %}tipo={{ tipo }}&{% endif %}&{% if search %}s={{ search }}&{% endif %}page={{ pagenumber }}">{{ pagenumber }}</a>
                            </li>
                        {% endfor %}
                    </ul>
                </div>
            {% endif %}
        </div>
    </div>

    {% if archivosgenerales %}
        <div class='row-fluid'>
            <div class='span12'>
                <h4>Archivos Generales de Prácticas Pre Profesionales</h4>
            </div>
        </div>
        <div class='row-fluid'>
            <div class='span12'>
                {% for archivo in archivosgenerales %}
                    <a class='icon' target="_blank" href='{{ archivo.download_link }}'>
                        <div class='iconimage'>
                            <div class='pd'>
                                {% if archivo.tipo_archivo == "pdf" %}
                                    <img src='/static/images/iconos/pdf.png' border="0"/>
                                {% endif %}
                                {% if archivo.tipo_archivo == "doc" or archivo.tipo_archivo == 'docx' %}
                                    <img src='/static/images/iconos/word.png' border="0"/>
                                {% endif %}
                                {% if archivo.tipo_archivo == 'other' %}
                                    <img src='/static/images/iconos/other.png' border="0"/>
                                {% endif %}
                            </div>
                        </div>
                        <div class='iconname'>
                            <div class='pd'>
                                <span class='icondesc'>{{ archivo.nombre }}</span>
                            </div>
                        </div>
                    </a>
                {% endfor %}
            </div>
        </div>
    {% endif %}

    <div class="modal fade static" id="itemspanelobs" style="display: none;">
        <div class="modal-header">
            <table border="0" width="100%" style="background-color: transparent">
                <tr>
                    <td style="width: 80%"><h3 class="paneltitleobs">Observación</h3></td>
                    <td><a href="javascript:;" id="cerrarpanelobs" class="btn btn-danger btn-mini pull-right"><i
                            class="fa fa-remove"></i></a></td>
                </tr>
            </table>
        </div>
        <div class="modal-body panelbodyobs" align="justify">
        </div>
    </div>

    <div class="modal fade static" id="vertutorias" style="display: none;">
        <div class="modal-header">
            <h4 id="paneltitle">TUTORÍAS</h4>
        </div>
        <div class="modal-body" id="body-tutoria">
        </div>
        <div class="modal-footer">
            <a href="javascript:;" id="cerrarvertutorias" class="btn btn-success">Cerrar</a>
        </div>
    </div>

    <div class="modal fade static" id="itemspanel" style="display: none;">
        <div class="modal-header">
            <h4><i class="fa fa-list"></i> <b class="paneltitle">FORMULARIO MODAL</b></h4>
        </div>
        <div class="modal-body">
            <form id="form2" class="form-horizontal form-modal" autocomplete="off" method="post"
                  enctype="multipart/form-data" action="{{ request.path }}">
                {% csrf_token %}
                <div class="row-fluid panelbody">
                </div>
            </form>
        </div>
    </div>

{% endblock %}