{% extends "basebs.html" %}
{% load sga_extras %}
{% load humanize %}
{% block heading %}
    <link href="/static/css/table-responsive.css?1.0.0" type="text/css" rel="stylesheet" />
    <script type="text/javascript" src='/static/js/jquery.validationEngine.js?v=1.0.0'></script>
    <script type="text/javascript" src='/static/js/jquery.validationEngine-es.js?v=1.0.0' ></script>
    <link type='text/css' rel='stylesheet' href="/static/css/validationEngine.jquery.css?v=1.0.0"/>

    <style>
        .divider-line {
            border-top: 1px solid lightgrey;
            height: 2px;
            width: auto;
            padding: 1px;
            margin: 5px 10px 5px 10px;
        }
    </style>

    <script type="text/javascript">
        $(function() {
            var anioconvocatoria = {{ anioconvocatoria }};
            var cambiosarcheval = false;
            var cambiosarchevalfirma = false;
            var evaluacioncerrada = false;

            $("select").select2({minimumResultsForSearch: 5 });


            $('input[type=radio][name=buscarpor]').change(function() {
                $("#lblopcion1").removeClass("btn btn-info").addClass("btn btn-default");
                $("#lblopcion2").removeClass("btn btn-info").addClass("btn btn-default");
                $("#lblopcion3").removeClass("btn btn-info").addClass("btn btn-default");
                $("#lblopcion4").removeClass("btn btn-info").addClass("btn btn-default");
                $("#estadoproyecto").prop("disabled", true);

                if($("#estadoproyecto").val() != '0')
                    $("#estadoproyecto").val(0).trigger('change');

                if (this.value == '1') {
                    $("#lblopcion1").removeClass("btn btn-defult").addClass("btn btn-info");
                }
                else if (this.value == '2') {
                    $("#lblopcion2").removeClass("btn btn-defult").addClass("btn btn-info");
                }
                else if (this.value == '3'){
                    $("#lblopcion3").removeClass("btn btn-defult").addClass("btn btn-info");
                }else{
                    $("#lblopcion4").removeClass("btn btn-defult").addClass("btn btn-info");
                    $("#estadoproyecto").prop("disabled", false);
                }
            });

            $("#estadoproyecto").change(function () {
                $("#searchinput").val("");
                if($("input[name='buscarpor']:checked").val() == '4')
                    busqueda();
            });

            $("#search").click(function() {
                busqueda();
            });

            $('#searchinput').keyup(function(e) {
                if(e.keyCode == 13) {
                    $("#search").trigger("click");
                }
            });

            busqueda = function () {
                var term = $("#searchinput").val().toUpperCase().trim();
                var tipobus = $("input[name='buscarpor']:checked").val();
                var estado = $("#estadoproyecto").val();

                if (term.length > 0){
                    location.href = "/adm_proyectoinvestigacion?action=propuestasold&idc={{ convocatoriaid|encrypt }}&s="+$("#searchinput").val().toUpperCase()+"&tipobus="+tipobus;
                }
                else{
                    location.href = "/adm_proyectoinvestigacion?action=propuestasold&idc={{ convocatoriaid|encrypt }}&tipobus="+tipobus+"&estadoproyecto="+estado;
                }
            };

            $(".mostrarrecorrido").click(function() {
                var id = $(this).attr('ids');
                bloqueointerface();
                $.ajax({
                    type: "GET",
                    url: "/adm_proyectoinvestigacion",
                    data: {'action': 'mostrarrecorrido', 'id': id},
                    success: function(data) {
                        $.unblockUI();
                        if (data.result == 'ok') {
                            $(".panelbodyrecorrido").html(data.data);
                            $("#itemspanelrecorrido").modal({backdrop:'static', width: '700px', height: '500px'}).modal('show');
                        } else {
                            mostrarMensajeError("No se puede consultar", data.mensaje);
                        }
                    },
                    error: function() {
                        $.unblockUI();
                        mostrarMensajeError("No se puede consultar", "Error al enviar los datos");
                    },
                    dataType: "json"
                });
            });

            $("#itemspanelrecorrido .btn-cerrar").click(function() {
                $("#itemspanelrecorrido").modal("hide");
            });

            $(".historialarchivo").click(function() {
                var id = $(this).attr('ids');
                bloqueointerface();
                $.ajax({
                    type: "GET",
                    url: "/adm_proyectoinvestigacion",
                    data: {'action': 'historialarchivo', 'id': id},
                    success: function(data) {
                        $.unblockUI();
                        if (data.result == 'ok') {
                            $(".panelbodyhistorialarchivo").html(data.data);
                            $("#itemspanelhistorialarchivo").modal({backdrop:'static', width: '800px', height: '500px'}).modal('show');
                        } else {
                            mostrarMensajeError("No se puede consultar", data.mensaje);
                        }
                    },
                    error: function() {
                        $.unblockUI();
                        mostrarMensajeError("No se puede consultar", "Error el enviar los datos");
                    },
                    dataType: "json"
                });
            });

            $("#itemspanelhistorialarchivo .btn-cerrar").click(function() {
                $("#itemspanelhistorialarchivo").modal("hide");
            });

            $(".verificarrequisitos").click(function() {
                var idp = $(this).attr('idp');
                bloqueointerface();
                $.ajax({
                    type: "GET",
                    url: "/adm_proyectoinvestigacion",
                    data: {'action': 'verificarrequisitos', 'idp': idp},
                    success: function(data) {
                        $.unblockUI();
                        if (data.result == 'ok') {
                            $(".panelbodyverificarrequisitos").html(data.data);
                            $(".paneltitleverificarrequisitos").html(data.title);
                            $("#itemspanelverificarrequisitos").modal({backdrop:'static', width: '700px'}).modal('show');
                        } else {
                            smoke.alert(data.mensaje);
                        }
                    },
                    error: function() {
                        $.unblockUI();
                        smoke.alert("Error de conexión.");
                    },
                    dataType: "json"
                });
            });

            $("#itemspanelverificarrequisitos .guardar").click(function () {
                envioformularioreg("/adm_proyectoinvestigacion","verificarrequisitos", false);
                return false;
            });

            $("#itemspanelverificarrequisitos .cerrar").click(function () {
                $('#itemspanelverificarrequisitos').modal('hide');
            });

            $("#itemspanelverificarrequisitos .cerrar2").click(function () {
                $('#itemspanelverificarrequisitos').modal('hide');
            });

            envioformularioreg = function(url, action, destino){
                if(action == 'verificarrequisitos'){
                    var valido = validarformulario();
                }
                else if(action == 'aprobarproyecto' ){
                    $("#frmAprobarProyecto").validationEngine('attach',{ scroll: false });
                    var valido = $("#frmAprobarProyecto").validationEngine('validate', { scroll: false });
                }
                else if(action == 'asignarrevisorinformes'){
                    var valido = validarformulariorevisores();
                }
                else if(action == 'subircontrato'){
                    var valido = validarformulariocontrato();
                }
                else if(action == 'subirevaluacion'){
                    var valido = validarformularioevaluacion();
                }
                else if(action == 'subirevaluacionfirmada'){
                    var valido = validarformularioevaluacionfirmada();
                }
                else if(action == 'subirpresupuesto'){
                    $("#frmSubirPresupuesto").validationEngine('attach',{ scroll: false });
                    var valido = $("#frmSubirPresupuesto").validationEngine('validate', { scroll: false });
                }
                else if(action == 'subirdocumento'){
                    $("#frmSubirDocumento").validationEngine('attach',{ scroll: false });
                    var valido = $("#frmSubirDocumento").validationEngine('validate', { scroll: false });
                }
                else if(action == 'anularproyecto'){
                    $("#frmAnularProyecto").validationEngine('attach',{ scroll: false });
                    var valido = $("#frmAnularProyecto").validationEngine('validate', { scroll: false });
                }
                else if(action == 'editmontopresupuesto'){
                    $("#frmEditMontoPresupuesto").validationEngine('attach',{ scroll: false });
                    var valido = $("#frmEditMontoPresupuesto").validationEngine('validate', { scroll: false });
                }
                else if(action == 'subircontratoexterno'){
                    $("#frmSubirContratoExterno").validationEngine('attach',{ scroll: false });
                    var valido = $("#frmSubirContratoExterno").validationEngine('validate', { scroll: false });
                }

                if (valido){
                    bloqueointerface();

                    if(action == 'verificarrequisitos')
                        var formdata = new FormData($("#formulario1")[0]);
                    else if(action == 'aprobarproyecto')
                        var formdata = new FormData($("#frmAprobarProyecto")[0]);
                    else if(action == 'asignarrevisorinformes')
                        var formdata = new FormData($("#formulario3")[0]);
                    else if(action == 'subircontrato')
                        var formdata = new FormData($("#formulario4")[0]);
                    else if(action == 'subirevaluacion')
                        var formdata = new FormData($("#formulario5")[0]);
                    else if(action == 'subirevaluacionfirmada')
                        var formdata = new FormData($("#frmEvaluacionFirmada")[0]);
                    else if(action == 'subirpresupuesto')
                        var formdata = new FormData($("#frmSubirPresupuesto")[0]);
                    else if(action == 'subirdocumento')
                        var formdata = new FormData($("#frmSubirDocumento")[0]);
                    else if(action == 'anularproyecto')
                        var formdata = new FormData($("#frmAnularProyecto")[0]);
                    else if(action == 'editmontopresupuesto')
                        var formdata = new FormData($("#frmEditMontoPresupuesto")[0]);
                    else if(action == 'subircontratoexterno')
                        var formdata = new FormData($("#frmSubirContratoExterno")[0]);

                    $.ajax({
                        type: "POST",
                        action : action,
                        url: url,
                        data:  formdata,
                        success: function(data) {
                            if (data.result == 'ok') {
                                $.unblockUI();
                                if(action === 'subirevaluacion' || action === 'subirevaluacionfirmada'){
                                    mostrarMensajeSuccess("Registro guardado con éxito", "", data, action, "stand", "");
                                }
                                else if(action === 'aprobarproyecto' || action === 'subircontrato' || action === 'anularproyecto' || action == 'editmontopresupuesto' || action == 'subircontratoexterno')
                                {
                                    urlCarga = "/adm_proyectoinvestigacion?action=propuestasold&idc={{ convocatoriaid|encrypt }}&id="+data.idp;
                                    mostrarMensajeSuccess("Registro guardado con éxito", "", data, action, "load", urlCarga);
                                }
                                else if(action === 'asignarrevisorinformes' || action === 'subirpresupuesto' || action === 'subirdocumento' || action === 'subircontratoexterno'){
                                    mostrarMensajeSuccess("Registro guardado con éxito", "", data, action, "reload", "");
                                }
                            } else {
                                $.unblockUI();
                               if(data.swalType === 'warning')
                                    mensajeWarningSwal(data.titulo, data.mensaje);
                               else
                                    mensajeErrorSwal(data.titulo, data.mensaje);
                            }
                        },
                        error: function() {
                            $.unblockUI();
                            mostrarMensajeError("No se puede guardar", "Error al enviar los datos");
                        },
                        dataType: "json",
                        cache: false,
                        contentType: false,
                        processData: false
                    });
                }else{
                    setTimeout(function() {
                        $('.help-text').html("");
                    }, 8000);
                }
            };

            validarformulario = function (){
                var validacion = true;

                if($("#estado").val()==''){
                    smoke.alert("Seleccione el estado");
                    return false;
                }

                if($("#estado").val() == '32'){
                    if($("#observacion").val().trim() == ''){
                        smoke.alert("Ingrese las observaciones");
                        return false;
                    }
                }
                return validacion;
            };

            envioformulario = function(url, action, destino){
                if(action == 'cerrarevaluacion')
                    $("#frmCerrarEvaluacion").validationEngine('attach',{ scroll: false });
                    var valido = $("#frmCerrarEvaluacion").validationEngine('validate', { scroll: false });

                if(valido){
                    bloqueointerface();
                    if(action == 'cerrarevaluacion')
                        var formdata = new FormData($("#frmCerrarEvaluacion")[0]);

                    $.ajax({
                        type: "POST",
                        action: action,
                        url: url,
                        data: formdata,
                        success: function(data) {
                            if(data.result=='ok'){
                                $.unblockUI();
                                evaluacioncerrada = true;
                                mensajeSuccessSwalEvaluacionCerrada(data.titulo, data.mensaje, data.ide, data.estado);
                            }else{
                                $.unblockUI();
                                if(data.swalType == 'warning')
                                    mensajeWarningSwal(data.titulo, data.mensaje);
                                else
                                    mensajeErrorSwal(data.titulo, data.mensaje);
                            }
                        },
                        error: function() {
                            $.unblockUI();
                            mensajeErrorSwal("No se puede guardar", "Error al enviar los datos")
                        },
                        dataType: "json",
                        cache: false,
                        contentType: false,
                        processData: false
                    });
                }else{
                    setTimeout(function() {
                        $('.help-text').html("");
                    }, 8000);
                    $.unblockUI();
                }
            };

            $(".subirpresupuesto").click(function() {
                var id = $(this).attr('id');
                bloqueointerface();
                $.ajax({
                    type: "GET",
                    url: "/adm_proyectoinvestigacion",
                    data: {'action': 'subirpresupuesto', 'id': id},
                    success: function(data) {
                        $.unblockUI();
                        if (data.result == 'ok') {
                            $(".panelbodysubirpresupuesto").html(data.data);
                            $(".paneltitlesubirpresupuesto").html(data.title);
                            $("#itemspanelsubirpresupuesto").modal({backdrop:'static', width: '700px'}).modal('show');
                        } else {
                            smoke.alert(data.mensaje);
                        }
                    },
                    error: function() {
                        $.unblockUI();
                        smoke.alert("Error de conexión.");
                    },
                    dataType: "json"
                });
            });

            $("#itemspanelsubirpresupuesto .guardar").click(function () {
                envioformularioreg("/adm_proyectoinvestigacion", "subirpresupuesto", false);
                return false;
            });

            $("#itemspanelsubirpresupuesto .cerrar").click(function () {
                $('#itemspanelsubirpresupuesto').modal('hide');
            });

            $("#itemspanelsubirpresupuesto .cerrar2").click(function () {
                $('#itemspanelsubirpresupuesto').modal('hide');
            });

            $(".generardocumento").click(function () {
                var id=$(this).attr('id');

                bloqueointerface();
                $.ajax({
                    type: "POST",
                    url: "/adm_proyectoinvestigacion",
                    data: {'action':'generardocumento', 'id': id},
                    success: function(data) {
                        console.log(data);
                        //$.unblockUI();
                        if (data.result=='ok'){
                            window.open(data.documento, '_blank');
                            location.reload();
                        } else {
                            $.unblockUI();
                            if(data.swalType == 'warning')
                                mensajeWarningSwal(data.titulo, data.mensaje);
                            else
                                mensajeErrorSwal(data.titulo, data.mensaje);
                        }
                    },
                    error: function() {
                        $.unblockUI();
                        mensajeErrorSwal("No se puede consultar", "Error al enviar los datos");
                    },
                    dataType: "json"
                });
            });

            $(".subirdocumento").click(function() {
                var id = $(this).attr('id');
                bloqueointerface();
                $.ajax({
                    type: "GET",
                    url: "/adm_proyectoinvestigacion",
                    data: {'action': 'subirdocumento', 'id': id},
                    success: function(data) {
                        $.unblockUI();
                        if (data.result == 'ok') {
                            $(".panelbodysubirdocumento").html(data.data);
                            $(".paneltitlesubirdocumento").html(data.title);
                            $("#itemspanelsubirdocumento").modal({backdrop:'static', width: '700px'}).modal('show');
                        } else {
                            mensajeErrorSwal("No se puede consultar", data.mensaje);
                        }
                    },
                    error: function() {
                        $.unblockUI();
                        mensajeErrorSwal("No se puede consultar", "Error al enviar los datos")
                    },
                    dataType: "json"
                });
            });

            $("#itemspanelsubirdocumento .guardar").click(function () {
                envioformularioreg("/adm_proyectoinvestigacion", "subirdocumento", false);
                return false;
            });

            $("#itemspanelsubirdocumento .cerrar").click(function () {
                $('#itemspanelsubirdocumento').modal('hide');
            });

            $("#itemspanelsubirdocumento .cerrar2").click(function () {
                $('#itemspanelsubirdocumento').modal('hide');
            });

            $(".aprobarproyecto").click(function() {
                var idp = $(this).attr('idp');
                bloqueointerface();
                $.ajax({
                    type: "GET",
                    url: "/adm_proyectoinvestigacion",
                    data: {'action': 'aprobarproyecto', 'idp': idp},
                    success: function(data) {
                        $.unblockUI();
                        if (data.result == 'ok') {

                            $(".panelbodyaprobarproyecto").html(data.data);
                            $(".paneltitleaprobarproyecto").html(data.title);
                            $("#itemspanelaprobarproyecto").modal({backdrop:'static', width: '700px'}).modal('show');

                        } else {
                            mostrarMensajeError("No se puede consultar", data.mensaje);
                        }
                    },
                    error: function() {
                        $.unblockUI();
                        mostrarMensajeError("No se puede consultar", "Error al enviar los datos");
                    },
                    dataType: "json"
                });
            });

            $("#itemspanelaprobarproyecto .guardar").click(function () {
                envioformularioreg("/adm_proyectoinvestigacion","aprobarproyecto", false);
                return false;
            });

            $("#itemspanelaprobarproyecto .cerrar").click(function () {
                $('#itemspanelaprobarproyecto').modal('hide');
            });

            $("#itemspanelaprobarproyecto .cerrar2").click(function () {
                $('#itemspanelaprobarproyecto').modal('hide');
            });

            $(".mostrarevaluaciones").click(function() {
                cambiosarcheval = false;
                cambiosarchevalfirma = false;
                var id = $(this).attr('ids');
                bloqueointerface();
                $.ajax({
                    type: "GET",
                    url: "/adm_proyectoinvestigacion",
                    data: {'action': 'mostrarevaluaciones', 'id': id},
                    success: function(data) {
                        $.unblockUI();
                        if (data.result == 'ok') {
                            $(".panelbodyevaluaciones").html(data.data);
                            $("#itemspanelevaluaciones").modal({backdrop:'static', width: '1200px', height: '600px'}).modal('show');
                        } else {
                            mensajeErrorSwal("No se puede consultar", data.mensaje);
                        }
                    },
                    error: function() {
                        $.unblockUI();
                        mensajeErrorSwal("No se puede consultar", "Error al enviar los datos");
                    },
                    dataType: "json"
                });
            });

            $("#itemspanelevaluaciones .btn-cerrar").click(function() {
                if(!cambiosarcheval && !evaluacioncerrada)
                    $("#itemspanelevaluaciones").modal("hide");
                else
                    location.reload();
            });

            $(".asignarrevisorinformes").click(function() {
                var idp = $(this).attr('idp');
                bloqueointerface();
                $.ajax({
                    type: "GET",
                    url: "/adm_proyectoinvestigacion",
                    data: {'action': 'asignarrevisorinformes', 'idp': idp},
                    success: function(data) {
                        $.unblockUI();
                        if (data.result == 'ok') {
                            $(".panelbodyasignarrevisorinforme").html(data.data);
                            $(".paneltitleasignarrevisorinforme").html(data.title);
                            $("#itemspanelasignarrevisorinforme").modal({backdrop:'static', width: '700px'}).modal('show');
                        } else {
                            mostrarMensajeError("No se puede consultar", data.mensaje);
                        }
                    },
                    error: function() {
                        $.unblockUI();
                        mostrarMensajeError("No se puede consultar", "Error al enviar los datos");
                    },
                    dataType: "json"
                });
            });

            $("#itemspanelasignarrevisorinforme .guardar").click(function () {
                envioformularioreg("/adm_proyectoinvestigacion","asignarrevisorinformes", false);
                return false;
            });

            validarformulariorevisores = function (){
                var validacion = true;

                if($("#personaverifica").val()==''){
                    mostrarMensajeWarning("Seleccione la persona que verifica el informe", "");
                    return false;
                }

                if($("#personaaprueba").val()==''){
                    mostrarMensajeWarning("Seleccione la persona que aprueba el informe", "");
                    return false;
                }

                return validacion;
            };

            $("#itemspanelasignarrevisorinforme .cerrar").click(function () {
                $('#itemspanelasignarrevisorinforme').modal('hide');
            });

            $("#itemspanelasignarrevisorinforme .cerrar2").click(function () {
                $('#itemspanelasignarrevisorinforme').modal('hide');
            });

            $(".descargarpresupuesto").click(function() {
                var idc = $(this).attr('idc');
                bloqueointerface();
                $.ajax({
                    type: "POST",
                    url: "/adm_proyectoinvestigacion",
                    data: {"action": "descargarpresupuesto", "idc": idc},
                    success: function(data) {
                        $.unblockUI();
                        if (data.result=='ok'){
                            location.href = data.archivo;
                        } else {
                            $.unblockUI();
                            if(data.swalType == 'warning')
                                mensajeWarningSwal(data.titulo, data.mensaje);
                            else
                                mensajeErrorSwal(data.titulo, data.mensaje);
                        }
                    },
                    error: function() {
                        $.unblockUI();
                        mensajeErrorSwal("No se puede procesar", "Error al enviar los datos");
                    },
                    dataType: "json"
                });
            });

            $(".descargarpresupuestofinal").click(function() {
                var idc = $(this).attr('idc');
                bloqueointerface();
                $.ajax({
                    type: "POST",
                    url: "/adm_proyectoinvestigacion",
                    data: {"action": "descargarpresupuestofinal", "idc": idc},
                    success: function(data) {
                        $.unblockUI();
                        if (data.result=='ok'){
                            location.href = data.archivo;
                        } else {
                            $.unblockUI();
                            if(data.swalType == 'warning')
                                mensajeWarningSwal(data.titulo, data.mensaje);
                            else
                                mensajeErrorSwal(data.titulo, data.mensaje);
                        }
                    },
                    error: function() {
                        $.unblockUI();
                        mensajeErrorSwal("No se puede procesar", "Error al enviar los datos");
                    },
                    dataType: "json"
                });
            });

            $(".descargarcronograma").click(function() {
                var idc = $(this).attr('idc');
                bloqueointerface();
                $.ajax({
                    type: "POST",
                    url: "/adm_proyectoinvestigacion",
                    data: {"action": "descargarcronograma", "idc": idc},
                    success: function(data) {
                        $.unblockUI();
                        if (data.result=='ok'){
                            location.href = data.archivo;
                        } else {
                            $.unblockUI();
                            if(data.swalType == 'warning')
                                mensajeWarningSwal(data.titulo, data.mensaje);
                            else
                                mensajeErrorSwal(data.titulo, data.mensaje);
                        }
                    },
                    error: function() {
                        $.unblockUI();
                        mensajeErrorSwal("No se puede procesar", "Error al enviar los datos");
                    },
                    dataType: "json"
                });
            });

            $(".listadogeneral").click(function() {
                var idc = $(this).attr('idc');
                bloqueointerface();
                $.ajax({
                    type: "POST",
                    url: "/adm_proyectoinvestigacion",
                    data: {'action': 'verificarpropuestas', 'idc': idc},
                    success: function(data) {
                        $.unblockUI();
                        if (data.result == 'ok') {
                            openwindow('POST' ,'/adm_proyectoinvestigacion', {action:'listadogeneral',idc: idc}, '_blank');
                        } else {
                            smoke.alert(data.mensaje);
                        }
                    },
                    error: function() {
                        $.unblockUI();
                        smoke.alert("Error de conexión.");
                    },
                    dataType: "json"
                });
            });

            $(".subircontrato").click(function() {
                var id = $(this).attr('id');
                bloqueointerface();
                $.ajax({
                    type: "GET",
                    url: "/adm_proyectoinvestigacion",
                    data: {'action': 'subircontrato', 'id': id},
                    success: function(data) {
                        $.unblockUI();
                        if (data.result == 'ok') {
                            $(".panelbodysubircontrato").html(data.data);
                            $(".paneltitlesubircontrato").html(data.title);
                            $("#itemspanelsubircontrato").modal({backdrop:'static', width: '700px'}).modal('show');
                        } else {
                            mostrarMensajeError("No se puede consultar", data.mensaje);
                        }
                    },
                    error: function() {
                        $.unblockUI();
                        mostrarMensajeError("No se puede consultar", "Error al enviar los datos");
                    },
                    dataType: "json"
                });
            });

            $("#itemspanelsubircontrato .guardar").click(function () {
                envioformularioreg("/adm_proyectoinvestigacion","subircontrato", false);
                return false;
            });

            $("#itemspanelsubircontrato .cerrar").click(function () {
                $('#itemspanelsubircontrato').modal('hide');
            });

            $("#itemspanelsubircontrato .cerrar2").click(function () {
                $('#itemspanelsubircontrato').modal('hide');
            });

            validarformulariocontrato = function (){
                var validacion = true;

                if($("#archivocontrato").get(0).files.length == 0){
                    mostrarMensajeWarning("Seleccione el archivo del contrato de financiamiento", "");
                    return false;
                }

                return validacion;
            };

            $("#itemspanelsubirevaluacion .guardar").click(function () {
                envioformularioreg("/adm_proyectoinvestigacion","subirevaluacion", false);
                return false;
            });

            $("#itemspanelsubirevaluacion .cerrar").click(function () {
                $('#itemspanelsubirevaluacion').modal('hide');
            });

            $("#itemspanelsubirevaluacion .cerrar2").click(function () {
                $('#itemspanelsubirevaluacion').modal('hide');
            });

            validarformularioevaluacion = function (){
                var validacion = true;

                if($("#archivoevaluacion").get(0).files.length == 0){
                    mostrarMensajeWarning("Seleccione el archivo de la evaluación", "");
                    return false;
                }

                return validacion;
            };

            $("#itemspanelsubirevaluacionfirmada .guardar").click(function () {
                envioformularioreg("/adm_proyectoinvestigacion","subirevaluacionfirmada", false);
                return false;
            });

            $("#itemspanelsubirevaluacionfirmada .cerrar").click(function () {
                $('#itemspanelsubirevaluacionfirmada').modal('hide');
            });

            $("#itemspanelsubirevaluacionfirmada .cerrar2").click(function () {
                $('#itemspanelsubirevaluacionfirmada').modal('hide');
            });

            validarformularioevaluacionfirmada = function (){
                var validacion = true;

                if($("#archivoevaluacion").get(0).files.length == 0){
                    mostrarMensajeWarning("Seleccione el archivo de la evaluación firmada", "");
                    return false;
                }

                return validacion;
            };

            $("#itemspanelcerrarevaluacion .guardar").click(function () {
                envioformulario("/adm_proyectoinvestigacion","cerrarevaluacion", false);
                return false;
            });

            $("#itemspanelcerrarevaluacion .cerrar").click(function () {
                $('#itemspanelcerrarevaluacion').modal('hide');
            });

            $("#itemspanelcerrarevaluacion .cerrar2").click(function () {
                $('#itemspanelcerrarevaluacion').modal('hide');
            });

            mensajeSuccessSwalEvaluacionCerrada = function (titulo, mensaje, ide, estado){
                Swal.fire({
                    allowOutsideClick: false,
                    allowEscapeKey: false,
                    allowEnterKey: false,
                    type: 'success',
                    customClass: {
                        confirmButton: 'btn btn-info'
                    },
                    title: titulo,
                    text: mensaje,
                    confirmButtonText: 'Aceptar',
                }).then((result) => {
                    if (result.value) {
                        $("#celdaestado"+ide).empty();
                        if(parseInt(estado) == 5)
                            contenido = '<span class="label label-success" data-toggle="tooltip" data-placement="bottom" data-original-title="Evaluación Cerrada">CERRADA</span>';
                        else
                            contenido = '<span class="label label-important" data-toggle="tooltip" data-placement="bottom" data-original-title="Acta de evaluación con novedades">NOVEDAD</span>';

                        $("#celdaestado"+ide).append(contenido);
                        $('#itemspanelcerrarevaluacion').modal('hide');
                    }
                })
            };



            mostrarMensajeWarning = function (titulo, mensaje){
                Swal.fire({
                    allowOutsideClick: false,
                    allowEscapeKey: false,
                    allowEnterKey: false,
                    type: 'warning',
                    customClass: {
                        confirmButton: 'btn btn-info'
                    },
                    title: titulo,
                    text: mensaje,
                    confirmButtonText: 'Aceptar',
                })
            };

            mostrarMensajeError = function (titulo, mensaje){
                Swal.fire({
                    allowOutsideClick: false,
                    allowEscapeKey: false,
                    allowEnterKey: false,
                    type: 'error',
                    customClass: {
                        confirmButton: 'btn btn-info'
                    },
                    title: titulo,
                    text: mensaje,
                    confirmButtonText: 'Aceptar',
                })
            };

            mostrarMensajeSuccess = function (titulo, mensaje, data, action, option, url){
                Swal.fire({
                    allowOutsideClick: false,
                    allowEscapeKey: false,
                    allowEnterKey: false,
                    type: 'success',
                    customClass: {
                        confirmButton: 'btn btn-info'
                    },
                    title: titulo,
                    text: mensaje,
                    confirmButtonText: 'Aceptar',
                }).then((result) => {
                    if (result.value) {
                        if(action == 'subirevaluacion'){
                            cambiosarcheval = true;
                            if(option == 'stand'){
                                $('#itemspanelsubirevaluacion').modal('hide');

                                if($("#descargaevaluacion"+data.ide).length){
                                    $("#descargaevaluacion"+data.ide).attr('href', data.urlarchivo);
                                }else{
                                    boton_descarga = '<a id="descargaevaluacion'+data.ide+'" target="_blank" href="'+data.urlarchivo+'" class="btn btn-mini btn-info descargaarchivo" data-toggle="tooltip" data-placement="bottom" data-original-title="Descargar archivo"><i class="fa fa-download"></i> </a>';
                                    $("#celdaarchivo"+data.ide).prepend(boton_descarga);
                                    $("#celdaarchivo"+data.ide).find(".descargaarchivo").tooltip();
                                }
                            }
                        }
                        else if(action == 'subirevaluacionfirmada'){
                            cambiosarchevalfirma = true;
                            if(option == 'stand'){
                                $('#itemspanelsubirevaluacionfirmada').modal('hide');
                                if($("#descargaevaluacionfirmada"+data.ide).length){
                                    $("#descargaevaluacionfirmada"+data.ide).attr('href', data.urlarchivo);
                                }else{
                                    boton_descarga = '&nbsp;<a id="descargaevaluacionfirmada'+data.ide+'" target="_blank" href="'+data.urlarchivo+'" class="btn btn-mini btn-info descargaarchivofirmada" data-toggle="tooltip" data-placement="bottom" data-original-title="Descargar acta de evaluación firmada"><i class="fa fa-download"></i> </a>';
                                    $("#subirevaluacionfirmada"+data.ide).after(boton_descarga);
                                    $("#celdaarchivo"+data.ide).find(".descargaarchivofirmada").tooltip();
                                }
                            }
                        }
                        else if(action == 'aprobarproyecto' || action == 'subircontrato' || action == 'asignarrevisorinformes' || action == 'subirpresupuesto' || action == 'subirdocumento' || action == 'anularproyecto' || action == 'subircontratoexterno'){
                            if(option == 'load'){
                                bloqueointerface();
                                location.href = url;
                            }else {
                                bloqueointerface();
                                location.reload();
                            }
                        }
                    }
                })
            };


            $(".habilitaredicion").click(function () {
                var id=$(this).attr('id');
                var titulo=$(this).attr('titulo');
                habilitarEdicion(id, titulo);
            });

            habilitarEdicion = function (id, titulo){
                Swal.fire({
                    allowOutsideClick: false,
                    allowEscapeKey: false,
                    allowEnterKey: false,
                    type: 'warning',
                    //width: '50%',
                    buttonsStyling: false,
                    customClass: {
                        confirmButton: 'btn btn-success',
                        cancelButton: 'btn btn-danger'
                    },
                    title: 'Habilitar Edición de Propuesta para directores de proyectos',
                    text: "¿Está seguro de habilitar la edición de la información de la propuesta de proyecto: " + titulo + ", para el director del proyecto?",
                    showCancelButton: true,
                    confirmButtonColor: '#3085d6',
                    cancelButtonColor: '#d33',
                    confirmButtonText: 'Si, Confirmar!',
                    cancelButtonText: 'Cancelar'
                }).then((result) => {
                    if (result.value) {
                        bloqueointerface();
                        $.ajax({
                            type: "POST",
                            url: "/adm_proyectoinvestigacion",
                            data: {'action':'habilitaredicion', 'id': id},
                            success: function(data) {
                                console.log(data);
                                $.unblockUI();
                                if (data.result=='ok'){

                                    location.reload();

                                    //mostrarMensajeSuccess("Registro guardado con éxito", "", "reload", "");
                                } else {
                                    mostrarMensajeWarning(data.mensaje, "");
                                }
                            },
                            error: function() {
                                $.unblockUI();
                                mostrarMensajeError("No se puede guardar", "Error de conexión");
                            },
                            dataType: "json"
                        });
                    }
                });
            };

            $(".anular").click(function() {
                var id = $(this).attr('id');
                bloqueointerface();
                $.ajax({
                    type: "GET",
                    url: "/adm_proyectoinvestigacion",
                    data: {'action': 'anularproyecto', 'id': id},
                    success: function(data) {
                        $.unblockUI();
                        if (data.result == 'ok') {
                            $(".panelbodyanularproyecto").html(data.data);
                            $(".paneltitleanularproyecto").html(data.title);
                            $("#itemspanelanularproyecto").modal({backdrop:'static', width: '700px'}).modal('show');
                        } else {
                            smoke.alert(data.mensaje);
                        }
                    },
                    error: function() {
                        $.unblockUI();
                        smoke.alert("Error de conexión.");
                    },
                    dataType: "json"
                });
            });

            $("#itemspanelanularproyecto .guardar").click(function () {
                envioformularioreg("/adm_proyectoinvestigacion","anularproyecto", false);
                return false;
            });

            $("#itemspanelanularproyecto .cerrar").click(function () {
                $('#itemspanelanularproyecto').modal('hide');
            });

            $("#itemspanelanularproyecto .cerrar2").click(function () {
                $('#itemspanelanularproyecto').modal('hide');
            });

            $(".editarmontopresupuesto").click(function() {
                var id = $(this).attr('id');
                bloqueointerface();
                $.ajax({
                    type: "GET",
                    url: "/adm_proyectoinvestigacion",
                    data: {'action': 'editmontopresupuesto', 'id': id},
                    success: function(data) {
                        $.unblockUI();
                        if (data.result == 'ok') {
                            $(".panelbodyeditmontopresupuesto").html(data.data);
                            $(".paneltitleeditmontopresupuesto").html(data.title);
                            $("#itemspaneleditmontopresupuesto").modal({backdrop:'static', width: '700px'}).modal('show');
                        } else {
                            mostrarMensajeError("No se puede consultar", data.mensaje);
                        }
                    },
                    error: function() {
                        $.unblockUI();
                        mostrarMensajeError("No se puede consultar", "Error al enviar los datos");
                    },
                    dataType: "json"
                });
            });

            $("#itemspaneleditmontopresupuesto .guardar").click(function () {
                envioformularioreg("/adm_proyectoinvestigacion", "editmontopresupuesto", false);
                return false;
            });

            $("#itemspaneleditmontopresupuesto .cerrar").click(function () {
                $('#itemspaneleditmontopresupuesto').modal('hide');
            });

            $("#itemspaneleditmontopresupuesto .cerrar2").click(function () {
                $('#itemspaneleditmontopresupuesto').modal('hide');
            });

            $(".subircontratoexterno").click(function() {
                var id = $(this).attr('id');
                bloqueointerface();
                $.ajax({
                    type: "GET",
                    url: "/adm_proyectoinvestigacion",
                    data: {'action': 'subircontratoexterno', 'id': id},
                    success: function(data) {
                        $.unblockUI();
                        if (data.result == 'ok') {
                            $(".panelbodysubircontratoexterno").html(data.data);
                            $(".paneltitlesubircontratoexterno").html(data.title);
                            $("#itemspanelsubircontratoexterno").modal({backdrop:'static', width: '700px'}).modal('show');
                        } else {
                            mostrarMensajeError("No se puede consultar", data.mensaje);
                        }
                    },
                    error: function() {
                        $.unblockUI();
                        mostrarMensajeError("No se puede consultar", "Error al enviar los datos");
                    },
                    dataType: "json"
                });
            });

            $("#itemspanelsubircontratoexterno .guardar").click(function () {
                envioformularioreg("/adm_proyectoinvestigacion","subircontratoexterno", false);
                return false;
            });

            $("#itemspanelsubircontratoexterno .cerrar").click(function () {
                $('#itemspanelsubircontratoexterno').modal('hide');
            });

            $("#itemspanelsubircontratoexterno .cerrar2").click(function () {
                $('#itemspanelsubircontratoexterno').modal('hide');
            });

            {% if tipobus != 4 %}
                $("#estadoproyecto").prop("disabled", true);
            {% else %}
                $("#estadoproyecto").prop("disabled", false);
            {% endif %}
        });
    </script>
{% endblock %}
{% block atras %}/adm_proyectoinvestigacion{% endblock %}
{% block canvas %}
    <div class='row-fluid'>
        <div class='span12'>
            <h4>{{ title }}</h4>
        </div>
    </div>

    <div class="row-fluid">
        <div class='span12'>
            {% if tipoconvocatoria == 2 or tipoconvocatoria == 3 %}
                <div class="btn-group ">
                    <a class="btn btn-info dropdown-toggle" data-toggle="dropdown" href="#"> Archivo <span class="caret"></span></a>
                    <ul class="dropdown-menu">
                        <li><a href="/adm_proyectoinvestigacion?action=addpropuestaproyectoexterno&idc={{ convocatoriaid|encrypt }}"><i class="fa fa-plus"></i> Agregar Propuesta</a></li>
                    </ul>
                </div>
            {% endif %}
            {% if anioconvocatoria >= 2022 and tipoconvocatoria == 1 %}
                <div class="btn-group">
                    <a class="btn btn-warning dropdown-toggle" data-toggle="dropdown" href="javascript:;">Procesos <span class="caret"></span></a>
                    <ul class="dropdown-menu pull-left">
                        {% if anioconvocatoria == 2022 %}
                            <li><a href="javascript:;" class="descargarpresupuestofinal" idc="{{ convocatoriaid|encrypt }}"><i class="fa fa-money"></i> Descargar Presupuestos PDF</a></li>
                        {% else %}
                            <li><a href="javascript:;" class="descargarpresupuesto" idc="{{ convocatoriaid|encrypt }}"><i class="fa fa-money"></i> Descargar Presupuestos Excel</a></li>
                        {% endif %}
                        <li><a href="javascript:;" class="descargarcronograma" idc="{{ convocatoriaid|encrypt }}"><i class="fa fa-tasks"></i> Descargar Cronogramas Excel</a></li>
                    </ul>
                </div>
            {% endif %}
            <div class="btn-group">
                <a class="btn btn-success dropdown-toggle" data-toggle="dropdown" href="javascript:;">Reportes <span class="caret"></span></a>
                <ul class="dropdown-menu pull-left">
                    <li><a href="javascript:;" class="listadogeneral" idc="{{ convocatoriaid|encrypt }}"><i class="fa fa-list-ol"></i> Listado General de Propuestas de Proyectos</a></li>
{#                    <a href="javascript:;" class="btn btn-warning tu evidenciasarticulos" titulo="Descargar Evidencias de Artículos" title="Descargar Evidencias"><i class="fa fa-download"></i> Evidencias</a>#}
{#                    <li><a href="javascript:;" class="listadoaplicanbeca" idp="{{ configuracion.id|encrypt }}"><i class="fa fa-list-ol"></i> Listado Maestrantes aptos para beca</a></li>#}
                </ul>
            </div>
{#            <div class="btn-group ">#}
{#                <a class="btn btn-info dropdown-toggle" data-toggle="dropdown" href="#"> Configuraciones <span class="caret"></span></a>#}
{#                <ul class="dropdown-menu">#}
{#                    <li><a href="/adm_proyectoinvestigacion?action=convocatorias"><i class="fa fa-calendar"></i> Convocatorias de Proyectos</a></li>#}
{#                </ul>#}
{#            </div>#}

{#            <a href="/programasinvestigacion?action=listadoproyectos" class='btn btn-success tu' title="Mostrar Proyectos Anteriores"><span class="fa fa-list" ></span> Proyectos Anteriores</a>#}
        </div>
    </div>
    <div id="no-more-tables">
        <div class='row-fluid'>
            <div class="span12">
                <table class="table table-bordered" style="padding: 0px; margin: 0px">
                    <tr>
                        <td style="margin: 2px; padding: 4px;">Total Proyectos: <span class="badge badge-inverse tu" title="Total Proyectos">{{ total }}</span></td>
                        <td style="margin: 2px; padding: 4px;">En Edición: <span class="badge badge-default tu" title="Total proyectos en edición">{{ edicion }}</span></td>
                        <td style="margin: 2px; padding: 4px;">Registrados: <span class="badge badge-info tu" title="Total proyectos registrados">{{ registrado }}</span></td>
                        <td style="margin: 2px; padding: 4px;">Verificados: <span class="badge badge-success tu" title="Total proyectos verificados ">{{ verificado }}</span></td>
                        <td style="margin: 2px; padding: 4px;">Por verificar: <span class="badge badge-default tu" title="Total proyectos por verificar">{{ porverificar }}</span></td>
                        <td style="margin: 2px; padding: 4px;">Con novedades: <span class="badge badge-important tu" title="Total proyectos con novedades">{{ novedad }}</span></td>
                        <td style="margin: 2px; padding: 4px;">Aprobados: <span class="badge badge-success tu" title="Total proyectos aprobados ">{{ aprobado }}</span></td>
                        <td style="margin: 2px; padding: 4px;">Por aprobar: <span class="badge badge-default tu" title="Total proyectos por aprobar">{{ poraprobar }}</span></td>
                        <td style="margin: 2px; padding: 4px;">Descartados: <span class="badge badge-important tu" title="Total proyectos descartados">{{ descartado }}</span></td>
                        <td style="margin: 2px; padding: 4px;">En Ejecución: <span class="badge badge-warning tu" title="Total proyectos en ejecución">{{ enejecucion }}</span></td>
                        <td style="margin: 2px; padding: 4px;">Por ejecutar: <span class="badge badge-important tu" title="Total proyectos por ejecutar">{{ porejecutar }}</span></td>
                        <td style="margin: 2px; padding: 4px;">Finalizado: <span class="badge badge-success tu" title="Total proyectos finalizados">{{ finalizado }}</span></td>
                    </tr>
                </table>
            </div>
        </div>
    </div>
    <div class='row-fluid'>
        <div class="span5">
            <table class="table table-bordered" style="padding: 0px; margin: 0px">
                <tr>
                    <td>
                        <div class="btn-group" data-toggle="buttons">
                            <label class="btn btn-default">Buscar Por</label>
                            <label id="lblopcion1" class="btn btn-{% if tipobus == 1 %}info{% else %}default{% endif %}"><input type="radio" name="buscarpor" value="1" {% if tipobus == 1 %}checked{% endif %}>&nbsp;<strong>Proyecto</strong></label>
                            <label id="lblopcion2" class="btn btn-{% if tipobus == 2 %}info{% else %}default{% endif %}"><input type="radio" name="buscarpor" value="2" {% if tipobus == 2 %}checked{% endif %}>&nbsp;<strong>Integrantes</strong></label>
                            <label id="lblopcion3" class="btn btn-{% if tipobus == 3 %}info{% else %}default{% endif %}"><input type="radio" name="buscarpor" value="3" {% if tipobus == 3 %}checked{% endif %}>&nbsp;<strong>Año</strong></label>
                            <label id="lblopcion4" class="btn btn-{% if tipobus == 4 %}info{% else %}default{% endif %}"><input type="radio" name="buscarpor" value="4" {% if tipobus == 4 %}checked{% endif %}>&nbsp;<strong>Estado</strong></label>
                        </div>
                    </td>
                    <td>
                        <select id="estadoproyecto" name="estadoproyecto">
                            <option value="0" selected>TODOS</option>
                            {% for estado in estadosproyecto %}
                                <option {% if estado.id == estadoproyecto %}selected{% endif %} value="{{ estado.id }}">{{ estado.descripcion }}</option>
                            {% endfor %}
                        </select>
                    </td>
                </tr>
            </table>
        </div>

        <div class="span7" style="text-align: right">
            <form class="form-search" onsubmit="return false;">
                <input class='searchinput' type='text' id='searchinput' value='{{ search }}' autocomplete="off"/>
                <a href="javascript:;" id='search' class='btn btn-info'><span class="fa fa-search "></span> Buscar</a>
                {% if search or ids or estadoproyecto %}
                    <a href="/adm_proyectoinvestigacion?action=propuestasold&idc={{ convocatoriaid|encrypt }}" id='allresults' class='btn btn-info'><span class="fa fa-refresh "></span> Todos</a>
                {% endif %}
            </form>
        </div>
    </div>

    <div id="no-more-tables">
        <div class="row-fluid">
            <div class="span12">
                <div class="row-fluid">
                    <table class="table table-bordered">
                        <thead>
                            <tr>
                                <th style="width: 5%; font-weight: bold; text-align: center">F.Registro</th>
                                <th style="width: 10%; font-weight: bold; text-align: center">Categoría/Código</th>
                                <th style="width: 30%; font-weight: bold; text-align: center">Título/Línea</th>
                                <th style="width: 25%; font-weight: bold; text-align: center">Integrantes</th>
                                <th style="width: 2%; font-weight: bold; text-align: center">Descargas</th>
                                <th style="width: 8%; font-weight: bold; text-align: center">Tiempo ejecución</th>
                                <th style="width: 7%; font-weight: bold; text-align: center">Tipo/Cobertura</th>
                                <th style="width: 7%; font-weight: bold; text-align: center">Presupuesto</th>
                                <th style="width: 10%; font-weight: bold; text-align: center">Estado</th>
                                <th style="width: 5%; font-weight: bold; text-align: center">Acciones</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for proyecto in proyectos %}
                            <tr>
                                <td data-title="F.Registro:" style="text-align: center">{{ proyecto.id }}<BR>{{ proyecto.fecha_creacion|date:"d-m-Y" }}</td>
                                <td data-title="Categoría" style="text-align: center">
                                    {{ proyecto.categoria2.descripcion }}<br>
                                    {% if proyecto.codigo %}
                                        <span class="label label-success">{{ proyecto.codigo }}</span>
                                    {% endif %}
                                </td>
                                <td data-title="Título/Línea:" style="text-align: justify">
                                    {{ proyecto.titulo }}<br>
                                    <span class="label label-info">{{ proyecto.lineainvestigacion.nombre }}</span>
                                </td>
                                <td data-title="Integrantes:">
                                    {% if not proyecto.profesor and proyecto.convocatoria.tipo != 3 %}
                                        <span class="label label-important">EL PROYECTO NO TIENE ASIGNADO DIRECTOR</span><br>
                                    {% endif %}
                                    {% for integrante in proyecto.integrantes_proyecto %}
                                        <span class="label label-{% if integrante.funcion == 1 %}info{% else %}default{% endif %} tu" title="{{ integrante.get_funcion_display }}">
                                            {% if integrante.funcion == 1 %}DP{% elif integrante.funcion == 2 %}CO{% elif integrante.funcion == 3 %}IA{% elif integrante.funcion == 4 %}AI{% else %}IC{% endif %}</span>
                                        {{ integrante.persona.nombre_completo_inverso }}<br>
                                    {% endfor %}
                                </td>
                                <td data-title="Descargas:" style="text-align: center">
                                    {% if proyecto.archivopresupuesto %}
                                        <a target="_blank" href="{{ proyecto.archivopresupuesto.url }}" class="btn btn-mini btn-info tu" data-toggle="tooltip" data-placement="top" data-original-title="Descargar Presupuesto final"><i class="fa fa-download"></i> </a>
                                    {% endif %}
                                    {% if proyecto.archivoproyecto %}
                                        <a target="_blank" href="{{ proyecto.archivoproyecto.url }}" class="btn btn-mini btn-info tu" data-toggle="tooltip" data-placement="top" data-original-title="Descargar Archivo del proyecto"><i class="fa fa-download"></i> </a>
                                    {% endif %}
                                    {% if proyecto.documentogenerado %}
                                        <a target="_blank" href="{{ proyecto.archivodocumento.url }}" class="btn btn-mini btn-success tu" data-toggle="tooltip" data-placement="top" data-original-title="Descargar Archivo Formato Inscripción"><i class="fa fa-download"></i> </a>
                                    {% endif %}
                                    {% if proyecto.archivodocumentofirmado %}
                                        <a target="_blank" href="{{ proyecto.archivodocumentofirmado.url }}" class="btn btn-mini btn-warning tu" data-toggle="tooltip" data-placement="top" data-original-title="Descargar Formato Inscripción Firmado"><i class="fa fa-download"></i> </a>
                                    {% endif %}
                                    {% if proyecto.archivodocumentosindatint %}
                                        <a target="_blank" href="{{ proyecto.archivodocumentosindatint.url }}" class="btn btn-mini btn-info tu" data-toggle="tooltip" data-placement="top" data-original-title="Descargar Formato Inscripción sin datos integrantes"><i class="fa fa-download"></i> </a>
                                    {% endif %}
                                    {% if proyecto.archivoanulacion %}
                                        <a target="_blank" href="{{ proyecto.archivoanulacion.url }}" class="btn btn-mini btn-danger tu" data-toggle="tooltip" data-placement="top" data-original-title="Descargar Respaldo Anulación Proyecto"><i class="fa fa-download"></i> </a>
                                    {% endif %}
                                    {% if proyecto.archivocontratoejecucion %}
                                        <a target="_blank" href="{{ proyecto.archivocontratoejecucion.url }}" class="btn btn-mini btn-info tu" data-toggle="tooltip" data-placement="top" data-original-title="Descargar Contrato de Financiamiento"><i class="fa fa-download"></i> </a>
                                    {% endif %}
                                    {% if proyecto.estado.valor == 20 %}
                                        {% if proyecto.historial_monto_presupuesto %}
                                            <br>
                                            <a target="_blank" href="{{ proyecto.historial_monto_presupuesto.archivo.url }}" class="btn btn-mini btn-inverse tu" data-toggle="tooltip" data-placement="top" data-original-title="Descargar Soporte Edición Presupuesto"><i class="fa fa-download"></i> </a>
                                        {% endif %}
                                    {% endif %}
                                </td>
                                <td data-title="Tiempo ejecución:" style="text-align: center">
                                    {{ proyecto.tiempomes }} meses
                                    {% if proyecto.estado.valor == 18 or proyecto.estado.valor == 20 or proyecto.estado.valor == 21 %}
                                        {% if proyecto.fechainicio %}
                                            <table class='table table-striped table-bordered'>
                                                <tbody>
                                                <tr>
                                                    <td><span class="label label-info tu" title="Fecha Inicio">FI:</span></td>
                                                    <td>{{ proyecto.fechainicio|date:"d-m-Y" }}</td>
                                                </tr>
                                                <tr>
                                                    <td><span class="label label-warning tu" title="Fecha Fin Estimada">FF:</span></td>
                                                    <td>{{ proyecto.fechafinplaneado|date:"d-m-Y" }}</td>
                                                </tr>
                                                {% if proyecto.fechafinreal %}
                                                    <tr>
                                                        <td><span class="label label-success tu" title="Fecha Fin Real">FR:</span></td>
                                                        <td>{{ proyecto.fechafinreal|date:"d-m-Y" }}</td>
                                                    </tr>
                                                {% endif %}
                                                </tbody>
                                            </table>
                                        {% endif %}
                                    {% endif %}
                                </td>
                                <td data-title="Tipo/Cobertura:" style="text-align: center">
                                    {% if proyecto.tipo %}
                                        <span class="label label-warning">{{ proyecto.get_tipo_display }}</span><br>
                                    {% endif %}
                                    {{ proyecto.get_tipocobertura_display }}
                                </td>
                                <td data-title="Presupuesto:" style="text-align: right">
                                    $ {{ proyecto.presupuesto|floatformat:2|intcomma }}
                                    {% if proyecto.estado.valor == 20 or proyecto.estado.valor == 21 or proyecto.estado.valor == 26 %}
                                        <br>
                                        <span class="tu" style="color: darkblue" title="Devengado">$ {{ proyecto.devengado|floatformat:2|intcomma }}</span>
                                        <br>
                                        <span class="tu" style="color: green" title="Saldo">$ {{ proyecto.saldo|floatformat:2|intcomma }}</span>
                                        {% if proyecto.convocatoria.tipo == 1 and proyecto.presupuesto != proyecto.montototal %}
                                            <span class="label label-warning" style="text-align: justify">SE REQUIERE ACTUALIZACIÓN DEL DETALLE DE PRESUPUESTO</span>
                                        {% endif %}
                                        {% if proyecto.convocatoria.tipo == 2 and proyecto.presupuesto != proyecto.montounemi %}
                                            <span class="label label-warning" style="text-align: justify">SE REQUIERE ACTUALIZACIÓN DEL DETALLE DE PRESUPUESTO</span>
                                        {% endif %}
                                        {% if proyecto.convocatoria.tipo == 3 and proyecto.presupuesto != proyecto.montootrafuente %}
                                            <span class="label label-warning" style="text-align: justify">SE REQUIERE ACTUALIZACIÓN DEL DETALLE DE PRESUPUESTO</span>
                                        {% endif %}
                                        {% with permisorubros=proyecto|args:1|args:2|call:"permiso_edicion_vigente" %}
                                            {% if permisorubros %}
                                                <br>
                                                <span class="label label-warning" style="text-align: justify">
                                                {% if permisorubros.estado == 1 %}
                                                    TIENE PENDIENTE LA EDICIÓN DE LOS RUBROS DEL PRESUPUESTO
                                                {% else %}
                                                    UNA VEZ QUE EL VALOR DE TOTAL PRESUPUESTO REGISTRADO SEA IGUAL AL MONTO TOTAL DEL PROYECTO DEBE FINALIZAR EDICIÓN
                                                {% endif %}
                                                </span>
                                            {% endif %}
                                        {% endwith %}
                                    {% endif %}
                                </td>
                                <td data-title="Estado:" style="text-align: center">
                                    <span class="{{ proyecto.estado.clase }} tu" title="{{ proyecto.estado.observacion }}">{{ proyecto.estado.descripcion }}</span>
                                    {% if proyecto.faltan_archivos_evaluacion %}
                                        <span class="label label-warning">FALTAN SUBIR ARCHIVOS DE EVALUACIONES</span>
                                    {% endif %}
                                    {% if proyecto.falta_cerrar_evaluaciones %}
                                        <span class="label label-warning">TIENE EVALUACIONES PENDIENTES DE CERRAR</span>
                                    {% endif %}
                                    {% if proyecto.estado.valor == 30 %}
                                        <span class="label label-warning">VERIFICAR CAMBIOS MENORES REGISTRADOS</span>
                                    {% endif %}
                                    {% if proyecto.estado.valor == 31 %}
                                        <span class="label label-warning">VERIFICAR CAMBIOS MAYORES REGISTRADOS</span>
                                    {% endif %}
                                    {% if proyecto.estado.valor == 20 and not proyecto.verificainforme %}
                                        <span class="label label-important">NO TIENE ASIGNADO REVISOR DE INFORMES</span>
                                    {% endif %}
                                    {% if proyecto.estado.valor == 18 and proyecto.estadocronograma %}
                                        Estado Cronograma:<br>
                                        <span class="label label-{{ proyecto.color_estado_cronograma }}">{{ proyecto.get_estadocronograma_display }}</span>
                                    {% endif %}
                                    {% if proyecto.estado.valor == 20 %}
                                        {% with totalinformes=proyecto|call:"total_informes" %}
                                        <br>
                                        <table class='table table-striped table-bordered'>
                                            <tbody>
                                                <tr>
                                                    <td style="width: 50%; text-align: center"><span class="label label-warning tu" title="Total Informes">TI:</span></td>
                                                    <td style="width: 50%; text-align: center"><span class="badge badge-{% if totalinformes > 0 %}success{% else %}important{% endif %}">{{ totalinformes }}</span> </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                        {% endwith %}
                                        <span class="label label-info tu" title="Verifica Informe: {{ proyecto.verificainforme }}"><i class="fa fa-users"></i></span>
                                        <span class="label label-success tu" title="Aprueba Informe: {{ proyecto.apruebainforme }}"><i class="fa fa-users"></i></span>
                                    {% endif %}
                                </td>
                                <td data-title="Acciones:">
                                    <div class="btn-group" style="text-align: left">
                                        <a class="btn btn-mini dropdown-toggle" data-toggle="dropdown" href="javascript:;">Acciones<span class="caret"></span>
                                        </a>
                                        <ul class="dropdown-menu pull-right">
                                            <li><a class="mostrarrecorrido" ids="{{ proyecto.id|encrypt }}" href="javascript:;"><i class="fa fa-list-ol"></i> Mostrar Recorrido</a></li>
                                            {% if proyecto.convocatoria.tipo == 1 %}
                                                <li><a class="historialarchivo" ids="{{ proyecto.id|encrypt }}" href="javascript:;"><i class="fa fa-folder-open"></i> Historial Archivos</a></li>
                                                <li><a href="/adm_proyectoinvestigacion?action=informacionproyecto&id={{ proyecto.id|encrypt }}"><i class="fa fa-paste"></i> Mostrar Información</a></li>

                                                {% if proyecto.estado.valor == 2 %}
                                                    <li><a class="habilitaredicion" id="{{ proyecto.id|encrypt }}" titulo="{{ proyecto.titulo }}" href="javascript:;"><i class="fa fa-pencil-square-o"></i> Habilitar Edición</a></li>
                                                {% endif %}

                                                {% if proyecto.estado.valor == 20 or proyecto.estado.valor == 18 or proyecto.estado.valor == 13 %}
                                                    <li><a href="/adm_proyectoinvestigacion?action=personalproyecto&id={{ proyecto.id|encrypt }}"><i class="fa fa-users"></i> Integrantes Proyecto</a></li>
                                                {% endif %}

                                                {% if proyecto.puede_verificar %}
                                                    <li><a href="/adm_proyectoinvestigacion?action=verificarrequisitos&id={{ proyecto.id|encrypt }}"><i class="fa fa-check-square-o"></i> Verificar Requisitos</a></li>
                                                {% endif %}

                                                {% if proyecto.estado.valor == 30 or proyecto.estado.valor == 31 or proyecto.estado.valor == 42 or proyecto.estado.valor == 43 %}
                                                    <li><a href="/adm_proyectoinvestigacion?action=verificarcambios&id={{ proyecto.id|encrypt }}"><i class="fa fa-check-square-o"></i> Verificar Cambios {% if proyecto.estado.valor == 30 or proyecto.estado.valor == 42 %}menores{% else %}mayores{% endif %}</a></li>
                                                {% endif %}

                                                {% if proyecto.puede_asignar_evaluadores %}
                                                    <div class="divider-line"></div>
                                                    <li><a href="/adm_proyectoinvestigacion?action=asignarevaluador&idp={{ proyecto.id|encrypt }}"><i class="fa fa-users"></i> Asignar Evaluadores</a></li>
                                                {% endif %}

                                                {% with puedeasignar=proyecto|args:persona|call:"puede_asignar_revisor_informes" %}
                                                    {% if puedeasignar %}
                                                        <li><a href="javascript:;" class="asignarrevisorinformes" idp="{{ proyecto.id|encrypt }}"><i class="fa fa-users"></i> Asignar Revisor Informes</a></li>
                                                    {% endif %}
                                                {% endwith %}

                                                {% if proyecto.tiene_evaluaciones %}
                                                    {% if not proyecto.puede_asignar_evaluadores %}
                                                        <div class="divider-line"></div>
                                                    {% endif %}
                                                    <li><a class="mostrarevaluaciones" ids="{{ proyecto.id|encrypt }}" href="javascript:;"><i class="fa fa-search-plus"></i> Mostrar Evaluaciones</a></li>
                                                {% endif %}
                                                {% if proyecto.puede_actualizar_presupuesto %}
                                                    <div class="divider-line"></div>
                                                    <li><a href="javascript:;" class="subirpresupuesto" id="{{ proyecto.id|encrypt }}"><i class="fa fa-cloud-upload"></i> Subir Presupuesto Actualizado</a></li>
                                                    {% if proyecto.puede_generar_documento_investigacion %}
                                                        <li><a class="generardocumento" id="{{ proyecto.id|encrypt }}" href="javascript:;"><i class="fa fa-cubes"></i> Generar Documento Proyecto</a></li>
                                                    {% endif %}
                                                    {% if proyecto.puede_subir_documento_investigacion %}
                                                        <li><a href="javascript:;" class="subirdocumento" id="{{ proyecto.id|encrypt }}"><i class="fa fa-cloud-upload"></i> Subir Documento Proyecto Firmado</a></li>
                                                    {% endif %}
                                                {% else %}
                                                    {% if proyecto.puede_generar_documento_investigacion %}
                                                        <li><a class="generardocumento" id="{{ proyecto.id|encrypt }}" href="javascript:;"><i class="fa fa-cubes"></i> Generar Documento Proyecto</a></li>
                                                    {% endif %}
                                                    {% if proyecto.puede_subir_documento_investigacion %}
                                                        <li><a href="javascript:;" class="subirdocumento" id="{{ proyecto.id|encrypt }}"><i class="fa fa-cloud-upload"></i> Subir Documento Proyecto Firmado</a></li>
                                                    {% endif %}
                                                {% endif %}
                                                {% if proyecto.puede_aprobar %}
                                                    <div class="divider-line"></div>
                                                    <li><a href="javascript:;" class="aprobarproyecto" idp="{{ proyecto.id|encrypt }}"><i class="fa fa-handshake-o"></i> Aprobar Proyecto</a></li>
                                                {% endif %}

                                                {% if proyecto.estado.valor == 18 or proyecto.estado.valor == 20 %}
                                                    <li><a href="javascript:;" class="subircontrato" id="{{ proyecto.id|encrypt }}"><i class="fa fa-cloud-upload"></i> {% if proyecto.estado.valor == 18 %}Subir{% else %}Actualizar{% endif %} Contrato Financiamiento</a></li>
                                                {% endif %}

                                                {% if proyecto.estado.valor == 18 and proyecto.estadocronograma == 2 %}
                                                    <li><a href="/adm_proyectoinvestigacion?action=validarcronograma&id={{ proyecto.id|encrypt }}"><i class="fa fa-check-square-o"></i> Validar Cronograma</a></li>
                                                {% endif %}



                                                {% if proyecto.puede_ver_evidencias %}
                                                    {% if proyecto.verificainforme.id == persona.id or proyecto.apruebainforme.id == persona.id %}
                                                        <div class="divider-line"></div>
                                                        <li><a href="/adm_proyectoinvestigacion?action=informesproyecto&id={{ proyecto.id|encrypt }}"><i class="fa fa-file-text"></i> Informes</a></li>
                                                    {% endif %}
                                                {% endif %}

                                                {% if proyecto.estado.valor == 13 %}
                                                    <div class="divider-line"></div>
                                                    <li><a class="anular" id="{{ proyecto.id|encrypt }}" href="javascript:;"><i class="fa fa-remove"></i> Anular Proyecto</a></li>
                                                {% endif %}

                                                {% if proyecto.fase_aprobacion_superada %}
                                                    <div class="divider-line"></div>
                                                    <li class="dropdown-item"><a href="/adm_proyectoinvestigacion?action=cronograma&id={{ proyecto.id|encrypt }}"><i class="fa fa-tasks"></i> Cronograma</a></li>
                                                {% endif %}

                                                {% if proyecto.estado.valor >= 20 and proyecto.convocatoria.apertura.year >= 2023 %}
                                                    <div class="divider-line"></div>
                                                    {% if proyecto.puede_editar_monto_presupuesto %}
                                                        <li><a href="javascript:;" class="editarmontopresupuesto" id="{{ proyecto.id|encrypt }}"><i class="fa fa-money"></i> Editar Monto Presupuesto</a></li>
                                                    {% endif %}
                                                    <li><a href="/adm_proyectoinvestigacion?action=presupuesto&id={{ proyecto.id|encrypt }}"><i class="fa fa-money"></i> Presupuesto</a></li>
                                                    <li><a href="/adm_proyectoinvestigacion?action=devengadopresupuesto&id={{ proyecto.id|encrypt }}"><i class="fa fa-sort-amount-desc"></i> Control Devengado</a></li>
                                                {% endif %}

                                            {% else %}
                                                <li><a href="/adm_proyectoinvestigacion?action=informacionproyecto&id={{ proyecto.id|encrypt }}"><i class="fa fa-paste"></i> Mostrar Información</a></li>
                                                {% if proyecto.puede_editar_proyecto_externo %}
                                                    <div class="divider-line"></div>
                                                    <li><a href="/adm_proyectoinvestigacion?action=editpropuestaproyectoexterno&id={{ proyecto.id|encrypt }}"><i class="fa fa-edit"></i> Editar</a></li>
                                                    <li><a href="/adm_proyectoinvestigacion?action=integrantesproyecto&id={{ proyecto.id|encrypt }}"><i class="fa fa-users"></i> Integrantes</a></li>
                                                    <li><a href="/adm_proyectoinvestigacion?action=contenidoproyectoexterno&id={{ proyecto.id|encrypt }}"><i class="fa fa-list"></i> Contenido</a></li>
                                                    {% if proyecto.resumenpropuesta %}
                                                        <li class="dropdown-item"><a href="/adm_proyectoinvestigacion?action=presupuesto&id={{ proyecto.id|encrypt }}"><i class="fa fa-money"></i> Presupuesto</a></li>
                                                        <li class="dropdown-item"><a href="/adm_proyectoinvestigacion?action=cronograma&id={{ proyecto.id|encrypt }}"><i class="fa fa-tasks"></i> Cronograma</a></li>
                                                    {% endif %}
                                                {% endif %}
                                                {% if proyecto.puede_subir_contrato_proyecto_externo %}
                                                    <div class="divider-line"></div>
                                                    <li><a href="javascript:;" class="subircontratoexterno" id="{{ proyecto.id|encrypt }}"><i class="fa fa-cloud-upload"></i> {% if not proyecto.archivocontratoejecucion %}Subir{% else %}Actualizar{% endif %} Contrato Financiamiento</a></li>
                                                {% endif %}
                                                {% if not proyecto.puede_editar_proyecto_externo %}
                                                    <li class="dropdown-item"><a href="/adm_proyectoinvestigacion?action=presupuesto&id={{ proyecto.id|encrypt }}"><i class="fa fa-money"></i> Presupuesto</a></li>
                                                    <li><a href="/adm_proyectoinvestigacion?action=devengadopresupuesto&id={{ proyecto.id|encrypt }}"><i class="fa fa-sort-amount-desc"></i> Control Devengado</a></li>
                                                {% endif %}
                                            {% endif %}
                                        </ul>
                                    </div>
                                </td>
                            </tr>
                            {% empty %}
                            <tr><td style="text-align: center" colspan="10">NO EXISTEN REGISTROS DE PROPUESTAS DE PROYECTOS</td></tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>

        </div>
    </div>

    <div class='row-fluid'>
        {% if paging.num_pages > 20 %}
            <div class='pagination'>
                <ul>
                    {% if paging.primera_pagina %}
                        <li><a href="/adm_proyectoinvestigacion?action=propuestasold&idc={{ convocatoriaid|encrypt }}&page=1{% if tipobus %}&tipobus={{ tipobus }}{% endif%}{% if estadoproyecto %}&estadoproyecto={{ estadoproyecto }}{% endif %}">1</a></li>
                        <li><a href="/adm_proyectoinvestigacion?action=propuestasold&idc={{ convocatoriaid|encrypt }}&page={{ paging.ellipsis_izquierda }}{% if tipobus %}&tipobus={{ tipobus }}{% endif%}{% if estadoproyecto %}&estadoproyecto={{ estadoproyecto }}{% endif %}" class="active">...</a></li>
                    {% endif %}
                    {% for pagenumber in paging.paginas %}
                        <li {%  if pagenumber == page.number %}class='active'{% endif %}><a href="/adm_proyectoinvestigacion?action=propuestasold&idc={{ convocatoriaid|encrypt }}&page={{ pagenumber }}{% if tipobus %}&tipobus={{ tipobus }}{% endif%}{% if estadoproyecto %}&estadoproyecto={{ estadoproyecto }}{% endif %}">{{ pagenumber }}</a></li>
                    {% endfor %}
                    {% if paging.ultima_pagina %}
                        <li><a href="/adm_proyectoinvestigacion?action=propuestasold&idc={{ convocatoriaid|encrypt }}&page={{ paging.ellipsis_derecha }}{% if tipobus %}&tipobus={{ tipobus }}{% endif %}{% if estadoproyecto %}&estadoproyecto={{ estadoproyecto }}{% endif %}" class="active">...</a></li>
                        <li><a href="/adm_proyectoinvestigacion?action=propuestasold&idc={{ convocatoriaid|encrypt }}&page={{ paging.num_pages }}{% if tipobus %}&tipobus={{ tipobus }}{% endif %}{% if estadoproyecto %}&estadoproyecto={{ estadoproyecto }}{% endif %}">{{ paging.num_pages }}</a></li>
                    {% endif %}
                </ul>
            </div>
        {% else %}
            <div class='pagination'>
                <ul>
                    {% for pagenumber in paging.page_range %}
                        <li {%  if pagenumber == page.number %}class='active'{% endif %}><a href="/adm_proyectoinvestigacion?action=propuestasold&idc={{ convocatoriaid|encrypt }}&{% if search %}s={{ search }}&{% endif %}page={{ pagenumber }}{% if tipobus %}&tipobus={{ tipobus }}{% endif %}{% if estadoproyecto %}&estadoproyecto={{ estadoproyecto }}{% endif %}">{{ pagenumber }}</a></li>
                    {% endfor %}
                </ul>
            </div>
        {% endif %}
    </div>

    <div class="modal fade static" data-keyboard="false" id="itemspanelrecorrido" style="display: none;">
        <div class="modal-header">
            <h4 class="paneltitlerecorrido">Mostrar Recorrido de la Propuesta de Proyecto</h4>
        </div>
        <div class="modal-body panelbodyrecorrido">
        </div>
        <div class="modal-footer">
            <table class="pull-right">
                <tr>
                    <td><a href="javascript:;" class="btn btn-cerrar btn-info">Cerrar</a></td>
                </tr>
            </table>
        </div>
    </div>

    <div class="modal fade static" data-keyboard="false" id="itemspanelhistorialarchivo" style="display: none;">
        <div class="modal-header">
            <h4 class="paneltitlerecorrido">Historial de Archivos del Proyecto de Investigación</h4>
        </div>
        <div class="modal-body panelbodyhistorialarchivo">
        </div>
        <div class="modal-footer">
            <table class="pull-right">
                <tr>
                    <td><a href="javascript:;" class="btn btn-cerrar btn-info">Cerrar</a></td>
                </tr>
            </table>
        </div>
    </div>

    <div class="modal fade static"  data-keyboard="false" id="itemspanelverificarrequisitos" style="display: none;">
        <div class="modal-header">
            <table border="0" width="100%" style="background-color: transparent">
                <tr>
                    <td style="width: 80%"><h4 class="paneltitleverificarrequisitos">Título del Modal</h4></td>
                    <td><a href="javascript:;" title="Cerrar" class="btn btn-danger btn-mini pull-right cerrar2"><i class="fa fa-remove"></i></a></td>
                </tr>
            </table>
        </div>
        <div class="modal-body panelbodyverificarrequisitos">
        </div>
        <div class="modal-footer" style="text-align: right">
            <a href="javascript:;" class="btn btn-success guardar"> Guardar</a>
            <a href="javascript:;" class="btn btn-danger cerrar"> Cancelar</a>
        </div>
    </div>

    <div class="modal fade static"  data-keyboard="false" id="itemspanelaprobarproyecto" style="display: none;">
        <div class="modal-header">
            <table border="0" width="100%" style="background-color: transparent">
                <tr>
                    <td style="width: 80%"><h4 class="paneltitleaprobarproyecto">Título del Modal</h4></td>
                    <td><a href="javascript:;" title="Cerrar" class="btn btn-danger btn-mini pull-right cerrar2"><i class="fa fa-remove"></i></a></td>
                </tr>
            </table>
        </div>
        <div class="modal-body panelbodyaprobarproyecto">
        </div>
        <div class="modal-footer" style="text-align: right">
            <a href="javascript:;" class="btn btn-success guardar"> Guardar</a>
            <a href="javascript:;" class="btn btn-danger cerrar"> Cancelar</a>
        </div>
    </div>

    <div class="modal fade static" data-keyboard="false" id="itemspanelevaluaciones" style="display: none;">
        <div class="modal-header">
            <h4 class="paneltitleevaluaciones">Evaluaciones de la Propuesta de Proyecto</h4>
        </div>
        <div class="modal-body panelbodyevaluaciones">
        </div>
        <div class="modal-footer">
            <table class="pull-right">
                <tr>
                    <td><a href="javascript:;" class="btn btn-cerrar btn-info">Cerrar</a></td>
                </tr>
            </table>
        </div>
    </div>

    <div class="modal fade static"  data-keyboard="false" id="itemspanelasignarrevisorinforme" style="display: none;">
        <div class="modal-header">
            <table border="0" width="100%" style="background-color: transparent">
                <tr>
                    <td style="width: 80%"><h4 class="paneltitleasignarrevisorinforme">Título del Modal</h4></td>
                    <td><a href="javascript:;" title="Cerrar" class="btn btn-danger btn-mini pull-right cerrar2"><i class="fa fa-remove"></i></a></td>
                </tr>
            </table>
        </div>
        <div class="modal-body panelbodyasignarrevisorinforme">
        </div>
        <div class="modal-footer" style="text-align: right">
            <a href="javascript:;" class="btn btn-success guardar"> Guardar</a>
            <a href="javascript:;" class="btn btn-danger cerrar"> Cancelar</a>
        </div>
    </div>

    <div class="modal fade static"  data-keyboard="false" id="itemspanelsubircontrato" style="display: none;">
        <div class="modal-header">
            <table border="0" width="100%" style="background-color: transparent">
                <tr>
                    <td style="width: 80%"><h4 class="paneltitlesubircontrato">Título del Modal</h4></td>
                    <td><a href="javascript:;" title="Cerrar" class="btn btn-danger btn-mini pull-right cerrar2"><i class="fa fa-remove"></i></a></td>
                </tr>
            </table>
        </div>
        <div class="modal-body panelbodysubircontrato">
        </div>
        <div class="modal-footer" style="text-align: right">
            <a href="javascript:;" class="btn btn-success guardar"> Guardar</a>
            <a href="javascript:;" class="btn btn-danger cerrar"> Cancelar</a>
        </div>
    </div>

    <div class="modal fade static"  data-keyboard="false" id="itemspanelsubirevaluacion" style="display: none;">
        <div class="modal-header">
            <table border="0" width="100%" style="background-color: transparent">
                <tr>
                    <td style="width: 80%"><h4 class="paneltitlesubirevaluacion">Título del Modal</h4></td>
                    <td><a href="javascript:;" title="Cerrar" class="btn btn-danger btn-mini pull-right cerrar2"><i class="fa fa-remove"></i></a></td>
                </tr>
            </table>
        </div>
        <div class="modal-body panelbodysubirevaluacion">
        </div>
        <div class="modal-footer" style="text-align: right">
            <a href="javascript:;" class="btn btn-success guardar"> Guardar</a>
            <a href="javascript:;" class="btn btn-danger cerrar"> Cancelar</a>
        </div>
    </div>

    <div class="modal fade static"  data-keyboard="false" id="itemspanelsubirevaluacionfirmada" style="display: none;">
        <div class="modal-header">
            <table border="0" width="100%" style="background-color: transparent">
                <tr>
                    <td style="width: 80%"><h4 class="paneltitlesubirevaluacionfirmada">Título del Modal</h4></td>
                    <td><a href="javascript:;" title="Cerrar" class="btn btn-danger btn-mini pull-right cerrar2"><i class="fa fa-remove"></i></a></td>
                </tr>
            </table>
        </div>
        <div class="modal-body panelbodysubirevaluacionfirmada">
        </div>
        <div class="modal-footer" style="text-align: right">
            <a href="javascript:;" class="btn btn-success guardar"> Guardar</a>
            <a href="javascript:;" class="btn btn-danger cerrar"> Cancelar</a>
        </div>
    </div>

    <div class="modal fade static"  data-keyboard="false" id="itemspanelcerrarevaluacion" style="display: none;">
        <div class="modal-header">
            <table border="0" width="100%" style="background-color: transparent">
                <tr>
                    <td style="width: 80%"><h4 class="paneltitlecerrarevaluacion">Título del Modal</h4></td>
                    <td><a href="javascript:;" title="Cerrar" class="btn btn-danger btn-mini pull-right cerrar2"><i class="fa fa-remove"></i></a></td>
                </tr>
            </table>
        </div>
        <div class="modal-body panelbodycerrarevaluacion">
        </div>
        <div class="modal-footer" style="text-align: right">
            <a href="javascript:;" class="btn btn-success guardar"> Guardar</a>
            <a href="javascript:;" class="btn btn-danger cerrar"> Cancelar</a>
        </div>
    </div>

    <div class="modal fade static"  data-keyboard="false" id="itemspanelsubirpresupuesto" style="display: none;">
        <div class="modal-header">
            <table border="0" width="100%" style="background-color: transparent">
                <tr>
                    <td style="width: 80%"><h4 class="paneltitlesubirpresupuesto">Título del Modal</h4></td>
                    <td><a href="javascript:;" title="Cerrar" class="btn btn-danger btn-mini pull-right cerrar2"><i class="fa fa-remove"></i></a></td>
                </tr>
            </table>
        </div>
        <div class="modal-body panelbodysubirpresupuesto">
        </div>
        <div class="modal-footer" style="text-align: right">
            <a href="javascript:;" class="btn btn-success guardar"> Guardar</a>
            <a href="javascript:;" class="btn btn-danger cerrar"> Cancelar</a>
        </div>
    </div>

    <div class="modal fade static"  data-keyboard="false" id="itemspanelsubirdocumento" style="display: none;">
        <div class="modal-header">
            <table border="0" width="100%" style="background-color: transparent">
                <tr>
                    <td><h4><i class="fa fa-cloud-upload"></i> <span class="paneltitlesubirdocumento">Título del Modal</span></h4></td>
                    <td><a href="javascript:;" title="Cerrar" class="btn btn-danger btn-mini pull-right cerrar2"><i class="fa fa-remove"></i></a></td>
                </tr>
            </table>
        </div>
        <div class="modal-body panelbodysubirdocumento">
        </div>
        <div class="modal-footer" style="text-align: right">
            <a href="javascript:;" class="btn btn-success guardar"> Guardar</a>
            <a href="javascript:;" class="btn btn-danger cerrar"> Cancelar</a>
        </div>
    </div>

    <div class="modal fade static"  data-keyboard="false" id="itemspanelanularproyecto" style="display: none;">
        <div class="modal-header">
            <table border="0" width="100%" style="background-color: transparent">
                <tr>
                    <td style="width: 80%"><h4 class="paneltitleanularproyecto">Revisar y Validar Contrato de Beca</h4></td>
                    <td><a href="javascript:;" title="Cerrar" class="btn btn-danger btn-mini pull-right cerrar2"><i class="fa fa-remove"></i></a></td>
                </tr>
            </table>
        </div>
        <div class="modal-body panelbodyanularproyecto">
        </div>
        <div class="modal-footer" style="text-align: right">
            <a href="javascript:;" class="btn btn-success guardar"> Guardar</a>
            <a href="javascript:;" class="btn btn-danger cerrar"> Cancelar</a>
        </div>
    </div>

    <div class="modal fade static"  data-keyboard="false" id="itemspaneleditmontopresupuesto" style="display: none;">
        <div class="modal-header">
            <table border="0" width="100%" style="background-color: transparent">
                <tr>
                    <td style="width: 80%"><h4 class="paneltitleeditmontopresupuesto">Título del Modal</h4></td>
                    <td><a href="javascript:;" title="Cerrar" class="btn btn-danger btn-mini pull-right cerrar2"><i class="fa fa-remove"></i></a></td>
                </tr>
            </table>
        </div>
        <div class="modal-body panelbodyeditmontopresupuesto">
        </div>
        <div class="modal-footer" style="text-align: right">
            <a href="javascript:;" class="btn btn-success guardar"> Guardar</a>
            <a href="javascript:;" class="btn btn-danger cerrar"> Cancelar</a>
        </div>
    </div>

    <div class="modal fade static"  data-keyboard="false" id="itemspanelsubircontratoexterno" style="display: none;">
        <div class="modal-header">
            <table border="0" width="100%" style="background-color: transparent">
                <tr>
                    <td style="width: 80%"><h4 class="paneltitlesubircontratoexterno">Título del Modal</h4></td>
                    <td><a href="javascript:;" title="Cerrar" class="btn btn-danger btn-mini pull-right cerrar2"><i class="fa fa-remove"></i></a></td>
                </tr>
            </table>
        </div>
        <div class="modal-body panelbodysubircontratoexterno">
        </div>
        <div class="modal-footer" style="text-align: right">
            <a href="javascript:;" class="btn btn-success guardar"> Guardar</a>
            <a href="javascript:;" class="btn btn-danger cerrar"> Cancelar</a>
        </div>
    </div>

{% endblock %}
