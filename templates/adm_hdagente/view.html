{% extends "basebs.html" %}
{% load sga_extras %}
{% load humanize %}
{% block heading %}
    <script type="text/javascript" src="/static/js/jquery.fancybox.pack.js?v=1.0.0"></script>
    <link rel="stylesheet" href="/static/css/jquery.fancybox.css?v=1.0.0" type="text/css" media="screen" />
    <script type="text/javascript" src='/static/js/select2.js?v=1.0.0' ></script>
    <link type='text/css' rel='stylesheet' href="/static/css/select2.css?v=1.0.0"/>
    <style type="text/css">
        .stop-scrolling {
            height: 100%;
            overflow: hidden;
        }
        .tab-content {
            overflow: inherit;
        }
        .table tbody td {
            vertical-align: middle !important;
        }
        .table thead th {
            text-align: center !important;
            vertical-align: middle !important;
        }
    </style>
    <script type="text/javascript">
        $(document).ready(function() {
            $(".fancybox").fancybox();
        });
        $(function() {
            $("select").select2({minimumResultsForSearch: 20 });

            /*$('.nav a').click(function(e) {
                e.preventDefault()
                $(this).tab('show')
            })

            $('a.tabs').on('click', function(e) {
                var href = $(this).attr('href');
                //console.log($(this));
                setTimeout(() => {
                  $('html, body').animate({
                    scrollTop: ($(href + '.active').offset().top)-50
                  }, 'slow');
                }, 500);
                e.preventDefault();
            });*/



            $("#detailOrdenPedidoModal_cerrar").click(function(){
                $("#detailOrdenPedidoModal").modal("hide");
                return false;
            });

            $(".detalleOrdenPedido").click(function() {
                var id = $(this).attr("op_id");
                bloqueointerface();
                $.ajax({
                    type: "POST",
                    url: "/adm_hdagente",
                    data: {'action':'LoadDetailOrdenPedido', 'id':id},
                    success: function(data) {
                        $.unblockUI();
                        if (data.result=='ok'){
                            $("#num_doc").html(data.numero);
                            $("#detailOrdenPedidoModal_contenido").html(data.data);
                            $("#detailOrdenPedidoModal").modal({"backdrop":"static", "width": "1000px"}).modal("show");
                        } else {
                            smoke.alert(data.mensaje);
                        }
                    },
                    error: function() {
                        $.unblockUI();
                        smoke.alert("Error de conexión.");
                    },
                    dataType: "json"
                });
            });

            $("#id_fecha_inicio, #id_fecha_fin").datepicker({format:"dd-mm-yyyy"}).on('changeDate', function(ev){ $(this).datepicker('hide'); });
            var tabhelpdesk = localStorage.getItem('tabhelpdesk');
            if (!tabhelpdesk){
                tabhelpdesk = "#1";
                localStorage.setItem("tabhelpdesk", tabhelpdesk);
            }

            $('.tab-content').css('height', '100%');
            $('.tabs').each(function(){
                if ($(this).attr('href') == tabhelpdesk){
                    $(this).trigger('click');
                }
            }).click(function(e){
                localStorage.setItem("tabhelpdesk", $(this).attr('href'));
            });

            busquedag = function(){
                var term = $("#searchinputg").val().trim().toUpperCase();
                bloqueointerface();
                if (term.length > 0){
                    if ((ide=parseInt($('#estado_listg').val()))>0)
                    {
                        location.href = "/adm_hdagente?estg=" + ide+"&sg="+term;
                    }
                    else
                    {
                        location.href = "/adm_hdagente?sg="+term;
                    }
                }
                else
                {
                    if ((ide=($("#estado_listg").val()))>0)
                    {
                        location.href = "/adm_hdagente?estg=" + ide;
                    }
                    else{
                        return false;
                    }
                }
            };

            $("#searchg").click(function() {
                busquedag();
            });

            $('#searchinputg').keyup(function(e) {
                if(e.keyCode == 13) {
                    busquedag();
                }
            });
            $("#estado_listg").change(function () {
                var id_estado = $(this).val();
                var term = $("#searchinputg").val().trim().toUpperCase();
                var tipo_equipo = $("#equipo_codigog").val();
                bloqueointerface();
                if (parseInt(id_estado)>0){
                    if (term.length > 0) {
                        if (parseInt(tipo_equipo)>0) {
                            location.href = "/adm_hdagente?sg=" + term + "&estg=" + id_estado + "&tipo_equipog="+tipo_equipo;
                        }else{
                            location.href = "/adm_hdagente?sg=" + term + "&estg=" + id_estado;
                        }
                    } else {
                        if (parseInt(tipo_equipo)>0) {
                            location.href = "/adm_hdagente?estg=" + id_estado +"&tipo_equipog="+tipo_equipo;
                        }else{
                            location.href = "/adm_hdagente?estg=" + id_estado;
                        }
                    }
                }else{
                    if (term.length > 0) {
                        if (parseInt(tipo_equipo)>0) {
                            location.href = "/adm_hdagente?sg=" + term + "&tipo_equipog="+tipo_equipo;
                        }else{
                            location.href = "/adm_hdagente?sg=" + term;
                        }
                    } else {
                        if (parseInt(tipo_equipo)>0) {
                            location.href = "/adm_hdagente?tipo_equipog="+tipo_equipo;
                        }else{
                            location.href = "/adm_hdagente";
                        }
                    }
                }
            });
            $("#equipo_codigog").change(function () {
                var tipo_equipo = $(this).val();
                var id_estado = $("#estado_listg").val();
                var term = $("#searchinputg").val().trim().toUpperCase();
                bloqueointerface();
                if (parseInt(tipo_equipo)>0){
                    if (parseInt(id_estado)>0){
                        if (term.length>0){
                            location.href = "/adm_hdagente?sg=" + term + "&est=" + id_estado+"&tipo_equipog="+tipo_equipo;
                        }else{
                            location.href = "/adm_hdagente?estg=" + id_estado+"&tipo_equipog="+tipo_equipo;
                        }
                    }else{
                        if (term.length>0){
                            location.href = "/adm_hdagente?sg=" + term + "&tipo_equipog="+tipo_equipo;
                        }else{
                            location.href = "/adm_hdagente?tipo_equipog="+tipo_equipo;
                        }
                    }
                }else{
                    if (parseInt(id_estado)>0){
                        if (term.length>0){
                            location.href = "/adm_hdagente?sg=" + term + "&estg=" + id_estado;
                        }else{
                            location.href = "/adm_hdagente?estg=" + id_estado;
                        }
                    }else{
                        if (term.length>0){
                            location.href = "/adm_hdagente?sg=" + term ;
                        }else{
                            location.href = "/adm_hdagente";
                        }
                    }
                }
            });

            busqueda = function(){
                var term = $("#searchinput").val().trim().toUpperCase();
                var id_estado = $('#estado_list').val();
                var tipo_equipo = $("#equipo_codigo").val();
                bloqueointerface();
                if (term.length>0){
                    if (parseInt(id_estado)>0){
                        if (parseInt(tipo_equipo)>0) {
                            location.href = "/adm_hdagente?s=" + term + "&id_estado=" + id_estado +"&tipo_equipo="+tipo_equipo;
                        }else{
                            location.href = "/adm_hdagente?s=" + term + "&id_estado=" + id_estado;
                        }
                    }else{
                        if (parseInt(tipo_equipo)>0) {
                            location.href = "/adm_hdagente?s=" + term + "&tipo_equipo="+tipo_equipo;
                        }else{
                            location.href = "/adm_hdagente?s=" + term;
                        }
                    }
                }else{
                    if (parseInt(tipo_equipo)>0) {
                        location.href = "/adm_hdagente?tipo_equipo="+tipo_equipo;
                    }else{
                        location.href = "/adm_hdagente";
                    }
                }
            };

            $("#search").click(function() {
                busqueda();
            });

            $('#searchinput').keyup(function(e) {
                if(e.keyCode == 13) {
                    busqueda();
                }
            });
            $("#estado_list").change(function () {
                var id_estado = $(this).val();
                var term = $("#searchinput").val().trim().toUpperCase();
                var tipo_equipo = $("#equipo_codigo").val();
                bloqueointerface();
                if (parseInt(id_estado)>0){
                    if (term.length > 0) {
                        if (parseInt(tipo_equipo)>0) {
                            location.href = "/adm_hdagente?s=" + term + "&est=" + id_estado + "&tipo_equipo="+tipo_equipo;
                        }else{
                            location.href = "/adm_hdagente?s=" + term + "&est=" + id_estado;
                        }
                    } else {
                        if (parseInt(tipo_equipo)>0) {
                            location.href = "/adm_hdagente?est=" + id_estado +"&tipo_equipo="+tipo_equipo;
                        }else{
                            location.href = "/adm_hdagente?est=" + id_estado;
                        }
                    }
                }else{
                    if (term.length > 0) {
                        if (parseInt(tipo_equipo)>0) {
                            location.href = "/adm_hdagente?s=" + term + "&tipo_equipo="+tipo_equipo;
                        }else{
                            location.href = "/adm_hdagente?s=" + term;
                        }
                    } else {
                        if (parseInt(tipo_equipo)>0) {
                            location.href = "/adm_hdagente?tipo_equipo="+tipo_equipo;
                        }else{
                            location.href = "/adm_hdagente";
                        }
                    }
                }
            });
            $("#equipo_codigo").change(function () {
                var tipo_equipo = $(this).val();
                var id_estado = $("#estado_list").val();
                var term = $("#searchinput").val().trim().toUpperCase();
                bloqueointerface();
                if (parseInt(tipo_equipo)>0){
                    if (parseInt(id_estado)>0){
                        if (term.length>0){
                            location.href = "/adm_hdagente?s=" + term + "&est=" + id_estado+"&tipo_equipo="+tipo_equipo;
                        }else{
                            location.href = "/adm_hdagente?est=" + id_estado+"&tipo_equipo="+tipo_equipo;
                        }
                    }else{
                        if (term.length>0){
                            location.href = "/adm_hdagente?s=" + term + "&tipo_equipo="+tipo_equipo;
                        }else{
                            location.href = "/adm_hdagente?tipo_equipo="+tipo_equipo;
                        }
                    }
                }else{
                    if (parseInt(id_estado)>0){
                        if (term.length>0){
                            location.href = "/adm_hdagente?s=" + term + "&est=" + id_estado;
                        }else{
                            location.href = "/adm_hdagente?est=" + id_estado;
                        }
                    }else{
                        if (term.length>0){
                            location.href = "/adm_hdagente?s=" + term ;
                        }else{
                            location.href = "/adm_hdagente";
                        }
                    }
                }
            });

            $("#itemspanel .btn-aprobarcerrar").click(function() {
                var idi = $("#id_incidente").val();
                var ida = $("#id_agente").val();
                $.ajax({
                    type: "POST",
                    url: "/adm_hdagente",
                    data: {'idi': idi, 'ida': ida, 'action': 'asignaragente'},
                    success: function(data) {
                        if (data.result=='ok') {
                            $("#itemspanel").modal("hide");
                            location.href = '/adm_hdagente';
                        } else {
                            $.unblockUI();
                            smoke.alert("Problemas al guardar la solicitud.");
                        }
                    },
                    error: function() {
                        desbloqueoUi();
                        smoke.alert("Error al enviar los datos al servidor.");
                    },
                    dataType: "json"
                });

            });

            $("#itemspanel .btn-cerrar").click(function() {
                $("#itemspanel").modal("hide");
                return false;
            });

            $("#itemspanel .btn-cerrar").click(function() {
                $("#itemspanel").modal("hide");
                return false;
            });
            $(".cerrar_detalle").click(function() {
                $("#itemspanel").modal("hide");
            });

            $(".mostrardetalle").click(function() {
                $("#aprobarcerrar").css('display', 'none');
                var id = $(this).attr('idd');
                bloqueointerface();
                $.post("/adm_hdagente", {'action': 'modaldetalle', 'id': id}, function(data) {
                    $.unblockUI();
                    if (data.result == 'ok') {
                        $(".panelbody").html(data.data);
                        $("#itemspanel").modal({backdrop:'static', width: '1200px', height:'510px;'}).modal('show');
                    } else {
                        smoke.alert(data.mensaje);
                    }
                }, 'json');
            });

            $(".informeincidente").click(function () {
                $("#itemspanel3").modal({backdrop:'static', width: '290'}).modal('show');
            });

            $("#itemspanel_cerrar_3").click(function () {
                $("#itemspanel3").modal('hide');
                $(".invalidofechas").hide();
            });

            $("#itemspanel_adicionar_3").click(function () {
                $(".invalidofechas").hide();
                var ini = $("#id_fecha_inicio").val();
                var fin = $("#id_fecha_fin").val();
                if (ini && fin && ini<=fin){
                    $("#itemspanel3").modal('hide');
                    openwindow('POST' ,'/adm_hdagente', {action: 'informeincidente', 'ini':ini, 'fin':fin, 'g':1},'_blank');
                }
                else{
                    $(".invalidofechas").show();
                }
            });
            $(".seleccionaractivo").click(function () {
                var id = $(this).attr('id');
                $('#guardar').attr('id',$(this).attr('id'));
                $("#itemspanelseleccionaractivo").modal({backdrop:'static', width: '500px', height:'100px'}).modal('show');
            });
            ItemsDisplay = function (item) {
                if (item.name){
                    return $('<span>' + item.name+ '</span>');
                }else{
                    return '---------';
                }
            };

            $("#id_activo_select2").select2({
                placeholder: "-------------------------------------------",
                allowClear: true,
                ajax: {
                    url: function (params) {
                        {#                        return "/reportes?action=data&model=ActivoFijo&p=1&s=10&q=" + params.term;#}
                        return "/adm_hdagente?action=buscaractivo&q=" + params.term+"&idt="+0;
                    },
                    dataType: 'json',
                    delay: 400,
                    data: function (params) {
                        return {
                            q: params.term,
                            page: params.page
                        };
                    },
                    processResults: function (data, params) {
                        // parse the results into the format expected by Select2
                        // since we are using custom formatting functions we do not need to
                        // alter the remote JSON data, except to indicate that infinite
                        // scrolling can be used
                        params.page = params.page || 1;

                        return {
                            results: data.results,
                            pagination: {
                                more: (params.page * 30) < data.total_count
                            }
                        };
                    },
                    cache: true
                },
                escapeMarkup: function (markup) { return markup; }, // let our custom formatter work
                minimumInputLength: 1,
                templateResult: ItemsDisplay, // omitted for brevity, see the source of this page
                templateSelection: ItemsDisplay // omitted for brevity, see the source of this page
            }).on("select2:select", function (evt) {
                $("#id_activo").attr({"value":(evt.params.data.id)});
            });
            $("#itemspanelseleccionaractivo .btn-cerrar").click(function () {
                $("#itemspanelseleccionaractivo").modal("hide");
            });
            $("#itemspanelseleccionaractivo #guardar").click(function () {
                var ida = $("#id_activo").val();
                var id = $(this).attr('id');
                if (parseInt(ida)>0){
                    bloqueointerface();
                    $.post("/adm_hdagente", {'action': 'seleccionaractivo', 'id': id, 'ida':ida}, function(data) {
                        $.unblockUI();
                        if (data.result == 'ok') {
                            $("#incidetesincodigo_"+id).empty();
                            $("#itemspanelseleccionaractivo").modal("hide");
                        } else {
                            smoke.alert(data.mensaje);
                        }
                    }, 'json');
                }else{
                    smoke.alert('Debe seleccionar un activo');
                }
            });

            $(".generarot").click(function () {
                var id = $(this).attr('idr');
                openwindow('POST' ,'/adm_hdagente', {action: 'generarot', 'id':id},'_blank');
            });
            $(".imprimirincidente").click(function () {
                var id = $(this).attr('idr');
                openwindow('POST' ,'/adm_hdagente', {action: 'imprimirincidente', 'id':id},'_blank');
            });

            $(".ordentrabajo").click(function() {
                bloqueointerface();
                location.href = '/adm_hdagente?action=listaordentrabajo';
            });
            $("#boton_apruebarechazaaprobada").click(function(){
                var idinscripcioncohorteestado = $('#idinscripcioncohorteestado').val();
                bloqueointerface();
                $.ajax({
                    type: "POST",
                    url: "/adm_hdagente",
                    data: {'action': 'separarincidente', 'idinscripcioncohorteestado': idinscripcioncohorteestado },
                    error: function () {
                        $.unblockUI();
                        smoke.alert("Error al obtener los datos.");
                    },
                    success: function (data) {
                        if (data.result == "ok") {
                            $("#modalapruebarechaza").modal({backdrop:'static', width: '600px'}).modal('hide');
                            location.reload();
                        } else {
                            $.unblockUI();
                            smoke.alert(data.mensaje);
                        }
                    }
                });

            });
            $("#cancel_apruebarechazacancela").click(function(){
                $('#modalapruebarechaza').modal('hide');
            });
        });
        function separarincidente(idinscripcion,nombrespostulante) {
            $('#idinscripcioncohorteestado').val(idinscripcion);
            bloqueointerface();
            $("#idnombres").html('');
            $("#idnombres").html(nombrespostulante);
            $("#modalapruebarechaza").modal({backdrop:'static', width: '600px'}).modal('show');
            $.unblockUI();
        }
    </script>
{% endblock %}
{% block canvas %}
    <div class='row-fluid'>
        <div class='span12'>
            <h4>{{ title }}</h4>
            <h5>{{ administrativo }} {{ cargo }}</h5>
        </div>
    </div>
    <div>
        <ul class="nav nav-tabs">
            <!--<li class="active"><a data-toggle="tab" href="#home">Home</a></li>
            <li><a data-toggle="tab" href="#menu1">Menu 1</a></li>
            <li><a data-toggle="tab" href="#menu2">Menu 2</a></li>
            <li><a data-toggle="tab" href="#menu3">Menu 3</a></li>-->
            <li><a class="tabs active"  href="#1" data-toggle="tab"><i class="fa fa-list-alt"></i> INCIDENTES <span title="Todos los incidentes" class="btn btn-default">{{ cant_todos }} </span>&nbsp;</a></li>
            <li><a class="tabs"  href="#2" data-toggle="tab"><i class="fa fa-envelope"></i> MIS INCIDENTES <span title="Mis incidentes" class="btn btn-default">{{ cant_mis_incidentes }} </span>&nbsp;</a></li>
            {%  if esdemantenimiento %}
                <li><a class="tabs ordentrabajo"  href="#" data-toggle="tab"><i class="fa fa-envelope"></i> ORDENES TRABAJO </a></li>
            {% endif %}
        </ul>

        <div class="tab-content">
            <div id="1" class="tab-pane fade in active">
                <div class='row-fluid'>
                    <div class='span2'>
                        <div class="btn-group">
                            <a class="btn dropdown-toggle btn-default" data-toggle="dropdown" href="#"><i class="fa fa-file-pdf-o "></i> Reporte <span class="caret"></span></a>
                            <ul class="dropdown-menu">
                                <li><a href="javascript:;" class='informeincidente'><span class="fa fa-print"></span> Informe de incidentes</a></li>
                            </ul>
                        </div>
                    </div>
                    <div class='span2'>
                        <form class="form-search">
                            <select id="estado_listg" onsubmit="return busquedag()" style="max-width: 185px; min-width: 85px; width: 185px;">
                                <option value="0">TODOS LOS ESTADOS</option>
                                {% for estado in estados %}
                                    <option {% if estado.id == estadoidg %} selected {% endif %}value="{{ estado.id }}">{{ estado.nombre }}</option>
                                {% endfor %}
                            </select>
                        </form>
                    </div>
                    <div class='span2' >
                        <form class="form-search">
                            <select id="equipo_codigog" style="max-width: 185px; min-width: 85px; width: 185px;">
                                <option value="0">TODOS</option>
                                <option {% if selecttipoeqg == 1 %}selected{% endif %} value="1">SIN CÓDIGO</option>
                                <option {% if selecttipoeqg == 2 %}selected{% endif %} value="2">CÓDIGO EXTERNO</option>
                                <option {% if selecttipoeqg == 3 %}selected{% endif %} value="3">ORDEN DE TRABAJO</option>
                                <option {% if selecttipoeqg == 4 %}selected{% endif %} value="4">SIN ORDEN DE TRABAJO</option>
                            </select>
                        </form>
                    </div>
                    <div class="span6" style="text-align: right">
                        <form class="form-search" onsubmit="return busquedag()">
                            <input class='searchinput' type='text' id='searchinputg' value='{{ searchg }}' autocomplete="off"/>
                            <a href="javascript:;" id='searchg' class='btn btn-info'><span class="fa fa-search "></span> Buscar</a>
                            {% if searchg or idsg or estadoidg %}
                                <a href="/adm_hdagente" id='allresults' class='btn btn-info bloqueo_pantalla'><span class="fa fa-refresh "></span> Todos</a>
                            {% endif %}
                        </form>
                    </div>
                </div>
                <table class='table table-bordered'>
                    <thead>
                        <tr>
                            <th style="width: 30px; text-align: center;">Nº</th>
                            <th style="width: 90px">Fecha</th>
                            <th style="width: 200px">Asunto</th>
                            <th style="width: 200px">Nombre del solicitante</th>
                            <th style="width: 90px">Bloque / Ubicación</th>
                            <th style="width: 60px; text-align: center">Grupo</th>
                            <th style="width: 60px; text-align: center">Agente</th>
                            <th style="width: 60px; text-align: center">Turno</th>
                            <th style="width: 50px; text-align: center">Estado</th>
                            <th style="width: 60px;text-align: center ">Prioridad</th>
                            <th style="width: 18px; text-align: center">Archivo</th>
                            <th style="width: 80px; text-align: center">tiempo de resolución</th>
                            <th style="width: 40px">Acciones</th>
                        </tr>
                    </thead>
                    <tbody>
                    {% for incidente in migrupo %}
                        <tr>
                            <td style="text-align: center;">{{ incidente.id }}</td>
                            <td>{{ incidente.fechareporte|date:'d-b-Y' }} {{ incidente.horareporte|time:"h:i a" }}</td>
                            <td>
                                {{ incidente.asunto }}
                                {% if incidente.tercerapersona %}
                                    <br><span class="label label-info">3ra. Persona {{ incidente.tercerapersona }}</span>
                                {% endif %}
                                <br>
                                {% if not incidente.esta_abierto %}
                                    <span class="label label-warning"><b>Cant. Revisiones: </b>{{ incidente.cantidad_detalle_incidente }}</span>
                                {% endif %}
                                {% if incidente.revisionequiposincodigo %}
                                    <span class="label label-important" id="incidetesincodigo_{{ incidente.id }}">Equipo sin código</span>
                                {% endif %}
                                {% if incidente.revisionequipoexterno %}
                                    <span class="label label-info"><b>Equipo externo</b></span>
                                {% endif %}
                                {%  if incidente.tipoincidente.id == 3 and incidente.ordentrabajo %}
                                    <br><span class="label label-info"><b>Orden Trabajo:. </b> {{ incidente.ordentrabajo }}</span>
                                {%  endif %}
                            </td>
                            <td>{{ incidente.persona }}</td>
                            <td>{% if incidente.departamento %}{{ incidente.departamento }}{% else %}{{ incidente.ubicacion.bloque }} - {{ incidente.ubicacion.ubicacion }}{% endif %}</td>
                            <td style="text-align: center">{% if incidente.tipoincidente %}{{ incidente.tipoincidente }}{% endif %}</td>
                            <td style="text-align: center">
                                {% if incidente.ultimo_registro %}
                                    {% if incidente.ultimo_registro.agente and incidente.ultimo_registro.estadoasignacion == 1 %}
                                        {{ incidente.ultimo_registro.agente.persona.usuario }}
                                    {% endif %}
                                {% endif %}
                            </td>
                            <td style="text-align: center">
                                {% if incidente.esta_abierto %}
                                    <label class="label label-warning">Total: {{ incidente.cantidad_pendientes }} </label><br>
                                    <label class="label label-darkgreen">Turno: {{ incidente.turno }}</label>
                                {% elif  incidente.esta_pendiente  %}
                                    <label class="label label-warning">Total: {{ incidente.cantidad_pendientes }} </label><br>
                                    <label class="label label-darkgreen">Turno: {{ incidente.turno }}</label>
                                {% elif  incidente.esta_cerrado  %}
                                    <label class="label label-danger"> Cerrado </label>
                                {% elif  incidente.esta_resulto  %}
                                    <label class="label label-success"> Terminado </label>
                                {% elif  incidente.esta_aprobado  %}
                                    <label class="label label-important"> Aprobado </label>
                                {% endif %}
                            </td>
                            <td style="text-align: center;">
                                {% if incidente.esta_abierto %}
                                    <a title="{{ incidente.estado  }}" class="fancybox" rel="group"><img src="{{ incidente.estado.imagen.url }}"></a>
                                {% elif  incidente.esta_pendiente  %}
                                    <a title="{{ incidente.estado  }}" class="fancybox" rel="group"><img src="{{ incidente.estado.imagen.url }}"></a>
                                {% elif  incidente.esta_cerrado  %}
                                    <a title="{{ incidente.estado  }}" class="fancybox" rel="group"><img src="{{ incidente.estado.imagen.url }}"></a>
                                {% elif  incidente.esta_resulto  %}
                                    <a title="{{ incidente.estado  }}" class="fancybox" rel="group"><img src="{{ incidente.estado.imagen.url }}"></a>
                                {% elif  incidente.esta_aprobado  %}
                                    <a title="{{ incidente.estado  }}"  class="fancybox" rel="group"><img src="{{ incidente.estado.imagen.url }}"></a>
                                {% elif  incidente.esta_rechazado  %}
                                    <a title="{{ incidente.estado  }}"  class="fancybox" rel="group"><img style="width: 30px" src="{{ incidente.estado.imagen.url }}"></a>
                                {% endif %}
                            </td>
                            <td style="text-align: center">
                                {% if incidente.detallesubcategoria %}
                                    {% if incidente.detallesubcategoria.prioridad %}
                                        <a title="{{ incidente.detallesubcategoria.prioridad.prioridad.nombre }}" href="{{ incidente.detallesubcategoria.prioridad.prioridad.imagen.url }}" class="fancybox" rel="group"><img src="{{ incidente.detallesubcategoria.prioridad.prioridad.imagen.url }}"></a>
                                    {% endif %}
                                {% endif %}
                            </td>
                            <td style="text-align: center;">
                                {% if incidente.archivo %}
                                    <a href='{{  incidente.download_link }}' target="_blank" title="Descargar Archivo" class='btn btn-info btn-mini'><i class='fa fa-arrow-down '></i></a>
                                {% endif %}
                            </td>
                            <td style="text-align: center;">
                                {% if incidente.detallesubcategoria %}
                                    {% if incidente.tiene_prioridad %}
                                        {% if incidente.detallesubcategoria.prioridad.modificar %}
                                            {{ incidente.detallesubcategoria.prioridad.horamax }}:{{ incidente.detallesubcategoria.prioridad.minutomax }}:{{ incidente.detallesubcategoria.prioridad.segundomax }}
                                        {% else %}
                                            {{ incidente.detallesubcategoria.prioridad.prioridad.horamax }}:{{ incidente.detallesubcategoria.prioridad.prioridad.minutomax }}:{{ incidente.detallesubcategoria.prioridad.prioridad.segundomax }}
                                        {% endif %}
                                        &nbsp;horas
                                    {% else %}
                                        <label class="label label-important">No asignado</label>
                                    {% endif %}
                                {% endif %}
                            </td>
                            <td style="text-align: center;">
                                <div class="btn-group">
                                    <a class="btn btn-mini dropdown-toggle" data-toggle="dropdown" href="javascript:;">Acciones<span class="caret"></span></a>
                                    <ul class="dropdown-menu pull-right list-group" style="text-align: left;">
                                        {% with migrupo=incidente|args:persona_id|call:'es_mi_grupo' miagente=incidente|args:persona_id|call:'es_mi_agente' es_tics=incidente|args:persona_id|call:'es_agente_tic'  moverincidente=incidente|args:persona_id|call:'ultimo_registropersona' %}
                                            {% if migrupo and miagente %}
                                                {#                                                                <li><a href='/adm_hdagente?action=resolverincidente&id={{ incidente.id }}&destino=idg'><i class="fa fa-edit" ></i> Resolver Incidente</a></li>#}
                                                {% if not moverincidente %}
                                                    <li><a href='#' onclick="separarincidente({{ incidente.id }},'{{ incidente.asunto }}')"><span class="fa fa-mail-forward"></span> Mover a mis incidente</a></li>
                                                {% endif %}
                                                {% if es_tics %}
                                                    <li><a href='/adm_hdagente?action=requerimientospiezapartes&idincidente={{ incidente.id }}&destino=idg'><i class="fa fa-list" ></i> Requerimiento de compras de piezas y partes</a></li>
                                                {% endif %}
                                                {% if incidente.revisionequiposincodigo %}
                                                    <li><a class="seleccionaractivo" id="{{ incidente.id }}"><i class="fa fa-laptop" ></i> Seleccionar activo</a></li>
                                                {% endif %}
                                                <li><a href='/adm_hdagente?action=reasignaragente&id={{ incidente.id }}&destino=idg'><i class="fa fa-user" ></i> Reasingar Agente</a></li>
                                                <li><a href="/adm_hdagente?action=escalarincidente&id={{ incidente.id }}&destino=idg"><i class="fa fa-times fa-fw fa fa-group"></i> Escalar a Grupo</a></li>
                                            {% endif %}
                                        {% endwith %}
                                        {% if incidente.revisionequiposincodigo %}
                                            <li><a class="seleccionaractivo" id="{{ incidente.id }}"><i class="fa fa-laptop" ></i> Seleccionar activo</a></li>
                                        {% endif %}
                                        <li><a href="javascript:;" class="mostrardetalle tu" idd="{{ incidente.id }}"><i class="fa fa-list" ></i> Detalle Incidente</a></li>

                                        {#                                                        {% if incidente.esta_resulto and reporte_0 %}#}
                                        {#                                                            <li><a href="javascript:;" tipos="{{ reporte_0.tiporeporte }}" nhref="/reportes?action=run&n={{ reporte_0.nombre }}&idincidente={{ incidente.incidente.id }}" class="reportedirecto"><span class="fa fa-list-alt"></span> Reporte Incidente</a> </li>#}
                                        {#                                                        {% endif %}#}
                                    </ul>
                                </div>
                            </td>
                        </tr>
                    {% empty %}
                        <tr>
                            <td colspan="15" styl e="text-align: center">
                                NO EXISTEN INCIDENTE REGISTRADO EN EL SISTEMA
                            </td>
                        </tr>
                    {% endfor %}
                    </tbody>
                </table>
                {% if paging_grupo.num_pages > 20 %}
                    <div class='pagination'>
                        <ul>
                            {% if paging_grupo.primera_pagina %}
                                <li><a href="/adm_hdagente?page_grupo=1{% if searchg %}&sg={{ searchg }}{% endif %}{% if estadoidg %}&estg={{ estadoidg }}{% endif %}{% if selecttipoeqg %}&tipo_equipog={{ selecttipoeqg }}{% endif %}">1</a></li>
                                <li><a href="/adm_hdagente?page_grupo={{ paging_grupo.ellipsis_izquierda }}" class="active">...</a></li>
                            {% endif %}
                            {% for pagenumber in paging_grupo.paginas %}
                                <li {% if pagenumber == page_grupo.number %}class='active'{% endif %}><a href="/adm_hdagente?page_grupo={{ pagenumber }}{% if searchg %}&sg={{ searchg }}{% endif %}{% if estadoidg %}&estg={{ estadoidg }}{% endif %}{% if selecttipoeqg %}&tipo_equipog={{ selecttipoeqg }}{% endif %}">{{ pagenumber }}</a></li>
                            {% endfor %}
                            {% if paging_grupo.ultima_pagina %}
                                <li><a href="/adm_hdagente?page_grupo={{ paging_grupo.ellipsis_derecha }}{% if searchg %}&sg={{ searchg }}{% endif %}{% if estadoidg %}&estg={{ estadoidg }}{% endif %}{% if selecttipoeqg %}&tipo_equipog={{ selecttipoeqg }}{% endif %}" class="active">...</a></li>
                                <li><a href="/adm_hdagente?page_grupo={{ paging_grupo.num_pages }}{% if searchg %}&sg={{ searchg }}{% endif %}{% if estadoidg %}&estg={{ estadoidg }}{% endif %}{% if selecttipoeqg %}&tipo_equipog={{ selecttipoeqg }}{% endif %}">{{ paging_grupo.num_pages }}</a></li>
                            {% endif %}
                        </ul>
                    </div>
                {% else %}
                    <div class='pagination'>
                        <ul>
                            {% for pagenumber in paging_grupo.page_range %}
                                <li {% if pagenumber == page_grupo.number %}class='active'{% endif %}><a href="/adm_hdagente?page_grupo={{ pagenumber }}{% if searchg %}&sg={{ searchg }}{% endif %}{% if estadoidg %}&estg={{ estadoidg }}{% endif %}{% if selecttipoeqg %}&tipo_equipog={{ selecttipoeqg }}{% endif %}">{{ pagenumber }}</a></li>
                            {% endfor %}
                        </ul>
                    </div>
                {% endif %}
            </div>
            <div id="2" class="tab-pane fade">
                <div class='row-fluid'>
                    <div class='span2'>
                        <form class="form-search">
                            <select id="estado_list" style="max-width: 185px; min-width: 85px; width: 185px;">
                                <option value="0">TODOS LOS ESTADOS</option>
                                {% for estado in estados %}
                                    <option {% if estado.id == estadoid %}selected{% endif %} value="{{ estado.id }}">{{ estado.nombre }}</option>
                                {% endfor %}
                            </select>
                        </form>
                    </div>
                    <div class='span2' >
                        <form class="form-search">
                            <select id="equipo_codigo" style="max-width: 185px; min-width: 85px; width: 185px;">
                                <option value="0">TODOS</option>
                                <option {% if selecttipoeq == 1 %}selected{% endif %} value="1">SIN CÓDIGO</option>
                                <option {% if selecttipoeq == 2 %}selected{% endif %} value="2">CÓDIGO EXTERNO</option>
                                <option {% if selecttipoeq == 3 %}selected{% endif %} value="3">ORDEN DE TRABAJO</option>
                                <option {% if selecttipoeq == 4 %}selected{% endif %} value="4">SIN ORDEN DE TRABAJO</option>
                            </select>
                        </form>
                    </div>
                    <div class="span8" style="text-align: right">
                        <form class="form-search">
                            <input class='searchinput' type='text' id='searchinput' value='{{ search }}' autocomplete="off"/>
                            <a href="javascript:;" id='search' class='btn btn-info'><span class="fa fa-search "></span> Buscar</a>
                            {% if search or ids or estadoid %}
                                <a href="/adm_hdagente" id='allresults' class='btn btn-info bloqueo_pantalla'><span class="fa fa-refresh "></span> Todos</a>
                            {% endif %}
                        </form>
                    </div>
                </div>
                <table class='table table-bordered'>
                    <thead>
                        <tr>
                            <th style="width: 30px; text-align: center;">Nº</th>
                            <th style="width: 90px">Fecha</th>
                            <th style="width: 200px">Asunto</th>
                            <th style="width: 200px">Nombre del solicitante</th>
                            <th style="width: 90px">Bloque / Ubicación</th>
                            <th style="width: 60px; text-align: center">Grupo</th>
                            <th style="width: 60px; text-align: center">Agente</th>
                            <th style="width: 50px; text-align: center">Turno</th>
                            <th style="width: 50px; text-align: center">Estado</th>
                            <th style="width: 80px;text-align: center ">Prioridad</th>
                            <th style="width: 20px; text-align: center">Archivo</th>
                            <th style="width: 80px; text-align: center">Tiempo de Resolución</th>
                            <th style="width: 40px">Acciones</th>
                        </tr>
                    </thead>
                    <tbody>
                    {% for incidente in misincidentes %}
                        <tr>
                            <td style="text-align: center;">{{ incidente.id }}</td>
                            <td>{{ incidente.fechareporte|date:'d-b-Y' }} {{ incidente.horareporte|time:"h:i a" }}</td>
                            <td>{{ incidente.asunto }}<br>
                                {% if not incidente.esta_abierto %}
                                    <span class="label label-warning"><b>Cant. Revisiones: </b>{{ incidente.cantidad_detalle_incidente }}</span>
                                {% endif %}
                                {% if incidente.revisionequiposincodigo %}
                                    <span class="label label-important" id="incidetesincodigo_{{ incidente.id }}">Equipo sin código</span>
                                {% endif %}
                                {% if incidente.revisionequipoexterno %}
                                    <span class="label label-info"><b>Equipo externo</b></span>
                                {% endif %}
                                {%  if incidente.tipoincidente.id == 3 and incidente.ordentrabajo %}
                                    <br><span class="label label-info"><b>Orden Trabajo:. </b> {{ incidente.ordentrabajo }}</span>
                                {%  endif %}
                            </td>
                            <td>{{ incidente.persona }}</td>
                            <td>{% if incidente.departamento %}{{ incidente.departamento }}{% else %}{{ incidente.ubicacion.bloque }} - {{ incidente.ubicacion.ubicacion }}{% endif %}</td>
                            <td style="text-align: center">{% if incidente.tipoincidente %}{{ incidente.tipoincidente }}{% endif %}</td>
                            <td style="text-align: center;">
                                {% with miagente=incidente|args:persona_id|call:'agente' %}
                                    {% if miagente %}
                                        {{ miagente.agente.persona.usuario }}
                                    {% endif %}
                                {% endwith %}
                            </td>
                            <td style="text-align: center">
                                {% if incidente.esta_abierto %}
                                        <label class="label label-warning">Total: {{ incidente.cantidad_pendientes }} </label><br>
                                        <label class="label label-darkgreen">Turno: {{ incidente.turno }}</label>
                                    {% elif  incidente.esta_pendiente  %}
                                        <label class="label label-warning">Total: {{ incidente.cantidad_pendientes }} </label><br>
                                        <label class="label label-darkgreen">Turno: {{ incidente.turno }}</label>
                                    {% elif  incidente.esta_cerrado  %}
                                        <label class="label label-danger"> Cerrado </label>
                                    {% elif  incidente.esta_resulto  %}
                                        <label class="label label-success"> Terminado </label>
                                    {% elif  incidente.esta_aprobado  %}
                                        <label class="label label-important"> Aprobado </label>
                                    {% endif %}
                            </td>
                            <td style="text-align: center;">
                                {% if incidente.esta_abierto %}
                                    <a title="{{ incidente.estado  }}" class="fancybox" rel="group"><img src="{{ incidente.estado.imagen.url }}"></a><br>
                                {% elif  incidente.esta_pendiente  %}
                                    <a title="{{ incidente.estado  }}" class="fancybox" rel="group"><img src="{{ incidente.estado.imagen.url }}"></a><br>
                                {% elif  incidente.esta_cerrado  %}
                                    <a title="{{ incidente.estado  }}" class="fancybox" rel="group"><img src="{{ incidente.estado.imagen.url }}"></a>
                                {% elif  incidente.esta_resulto  %}
                                    <a title="{{ incidente.estado  }}" class="fancybox" rel="group"><img src="{{ incidente.estado.imagen.url }}"></a><br>
                                {% elif  incidente.esta_aprobado  %}
                                    <a title="{{ incidente.estado  }}" class="fancybox" rel="group"><img src="{{ incidente.estado.imagen.url }}"></a>
                                {% elif  incidente.esta_rechazado  %}
                                    <a title="{{ incidente.estado  }}" class="fancybox" rel="group"><img style="width: 30px" src="{{ incidente.estado.imagen.url }}"></a>
                                {% endif %}

                            </td>
                            <td style="text-align: center">
                                {% if incidente.detallesubcategoria %}
                                    {% if incidente.detallesubcategoria.prioridad %}
                                        <a title="{{ incidente.detallesubcategoria.prioridad.prioridad.nombre }}" href="{{ incidente.detallesubcategoria.prioridad.prioridad.imagen.url }}" class="fancybox" rel="group"><img src="{{ incidente.detallesubcategoria.prioridad.prioridad.imagen.url }}"></a>
                                    {% endif %}
                                {% endif %}
                            </td>
                            <td style="text-align: center;">
                                {% if incidente.archivo %}
                                    <a href='{{  incidente.download_link }}' target="_blank" title="Descargar Archivo" class='btn btn-info btn-mini'><i class='fa fa-arrow-down '></i></a>
                                {% endif %}
                            </td>
                            <td style="text-align: center;">
                                {% if incidente.detallesubcategoria %}
                                    {% if incidente.tiene_prioridad %}
                                        {% if incidente.detallesubcategoria.prioridad.modificar %}
                                            {{ incidente.detallesubcategoria.prioridad.horamax }}:{{ incidente.detallesubcategoria.prioridad.minutomax }}
                                        {% else %}
                                            {{ incidente.detallesubcategoria.prioridad.prioridad.horamax }}:{{ incidente.detallesubcategoria.prioridad.prioridad.minutomax }}
                                        {% endif %}
                                        &nbsp;horas
                                    {% else %}
                                        <label class="label label-important">No asignado</label>
                                    {% endif %}
                                {% endif %}
                            </td>
                            <td style="text-align: center;">
                                <div class="btn-group">
                                    <a class="btn btn-mini dropdown-toggle" data-toggle="dropdown" href="javascript:;">Acciones<span class="caret"></span></a>
                                    <ul class="dropdown-menu pull-right list-group" style="text-align: left;">
                                        {% with migrupo=incidente|args:persona_id|call:'es_mi_grupo' miagente=incidente|args:persona_id|call:'es_mi_agente' es_tics=incidente|args:persona_id|call:'es_agente_tic' %}
                                            {% if migrupo and miagente %}
                                                <li><a href='/adm_hdagente?action=resolverincidente&id={{ incidente.id }}&destino=id' class="bloqueo_pantalla"><i class="fa fa-edit" ></i> Resolver Incidente</a></li>
                                                {% if es_tics %}
                                                    <li><a href='/adm_hdagente?action=requerimientospiezapartes&idincidente={{ incidente.id }}&destino=id'><i class="fa fa-list" ></i> Requerimiento de compras de piezas y partes</a></li>
                                                {% endif %}
                                                {% if incidente.revisionequiposincodigo %}
                                                    <li><a class="seleccionaractivo" id="{{ incidente.id }}"><i class="fa fa-laptop" ></i> Seleccionar activo</a></li>
                                                {% endif %}
                                                <li><a href='/adm_hdagente?action=reasignaragente&id={{ incidente.id }}&destino=id' class="bloqueo_pantalla"><i class="fa fa-user" ></i> Reasingar Agente</a></li>
                                                <li><a href="/adm_hdagente?action=escalarincidente&id={{ incidente.id }}&destino=id"><i class="fa fa-times fa-fw fa fa-group"></i> Escalar a Grupo</a></li>
                                            {% endif %}
                                        {% endwith %}
                                        {% if incidente.revisionequiposincodigo %}
                                            <li><a class="seleccionaractivo" id="{{ incidente.id }}"><i class="fa fa-laptop" ></i> Seleccionar activo</a></li>
                                        {% endif %}
                                        {% if incidente.esta_resulto and reporte_0 %}
                                            <li><a href="javascript:;" tipos="{{ reporte_0.tiporeporte }}" nhref="/reportes?action=run&n={{ reporte_0.nombre }}&idincidente={{ incidente.incidente.id }}" class="reportedirecto"><span class="fa fa-list-alt"></span> Reporte Incidente</a> </li>
                                        {% endif %}
                                        {% if incidente.tipoincidente.id == 3 %}
                                            {% if not incidente.tiene_ordenpedido %}
                                                {% if not incidete.ordentrabajo.codigoorden %}
                                                    {% if incidente.esta_abierto or incidente.esta_pendiente %}
                                                        <li><a href="/adm_hdagente?action=addodenpedido&id={{ incidente.id }}"><span class="fa fa-plus" ></span> Generar OP</a></li>
                                                    {% endif %}
                                                {% endif %}
                                            {% else %}
                                                <li class="dropdown-submenu pull-left"><a href="javascript:;"><i class="fa fa-folder-open"></i> Ordenes de Pedidos</a>
                                                    <ul class="dropdown-menu">
                                                        {% if incidente.esta_abierto or incidente.esta_pendiente %}
                                                            <li><a href="/adm_hdagente?action=addodenpedido&id={{ incidente.id }}"><span class="fa fa-plus" ></span> Nueva OP</a></li>
                                                        {% endif %}
                                                        {% for ordenpedido in incidente.mis_ordenpedidos %}
                                                            <li><a href="javascript:;" class="detalleOrdenPedido" op_id="{{ ordenpedido.id }}"><span class='fa fa-list'></span> {{ ordenpedido.codigodocumento }}</a></li>
                                                        {% endfor %}
                                                    </ul>
                                            {% endif %}
                                            {% if incidente.estado.id != 3 %}
                                                <li><a href="javascript:;" class="tu generarot" idr="{{ incidente.id }}" ><i class="fa fa-file-pdf-o "></i> Generar OT </a></li>
                                            {% endif %}
                                            {% if incidente.estado.id == 3 %}
                                                <li><a href="javascript:;" class="tu imprimirincidente" idr="{{ incidente.id }}" ><i class="fa fa-file-pdf-o "></i> Imprimir OT</a></li>
                                            {% endif %}
                                        {% endif %}
                                        <li><a href="javascript:;" class="mostrardetalle tu" idd="{{ incidente.id }}"><i class="fa fa-list" ></i> Detalle Incidente</a></li>
                                    </ul>
                                </div>

                            </td>
                        </tr>
                    {% empty %}
                        <tr>
                            <td colspan="15" style="text-align: center">
                                NO EXISTEN INCIDENTES REGISTRADOS
                            </td>
                        </tr>
                    {% endfor %}
                    </tbody>
                </table>
                {% if paging.num_pages > 20 %}
                    <div class='pagination'>
                        <ul>
                            {% if paging.primera_pagina %}
                                <li><a href="/adm_hdagente?page=1{% if search %}&s={{ search }}{% endif %}{% if estadoid %}&est={{ estadoid }}{% endif %}{% if selecttipoeq %}&tipo_equipo={{ selecttipoeq }}{% endif %}">1</a></li>
                                <li><a href="/adm_hdagente?page={{ paging.ellipsis_izquierda }}{% if search %}&s={{ search }}{% endif %}{% if estadoid %}&est={{ estadoid }}{% endif %}{% if selecttipoeq %}&tipo_equipo={{ selecttipoeq }}{% endif %}" class="active">...</a></li>
                            {% endif %}
                            {% for pagenumber in paging.paginas %}
                                <li {%  if pagenumber == page.number %}class='active'{% endif %}><a href="/adm_hdagente?page={{ pagenumber }}{% if search %}&s={{ search }}{% endif %}{% if estadoid %}&est={{ estadoid }}{% endif %}{% if selecttipoeq %}&tipo_equipo={{ selecttipoeq }}{% endif %}">{{ pagenumber }}</a></li>
                            {% endfor %}
                            {% if paging.ultima_pagina %}
                                <li><a href="/adm_hdagente?page={{ paging.ellipsis_derecha }}{% if search %}&s={{ search }}{% endif %}{% if estadoid %}&est={{ estadoid }}{% endif %}{% if selecttipoeq %}&tipo_equipo={{ selecttipoeq }}{% endif %}" class="active">...</a></li>
                                <li><a href="/adm_hdagente?page={{ paging.num_pages }}{% if search %}&s={{ search }}{% endif %}{% if estadoid %}&est={{ estadoid }}{% endif %}{% if selecttipoeq %}&tipo_equipo={{ selecttipoeq }}{% endif %}">{{ paging.num_pages }}</a></li>
                            {% endif %}
                        </ul>
                    </div>
                {% else %}
                    <div class='pagination'>
                        <ul>
                            {% for pagenumber in paging.page_range %}
                                <li {%  if pagenumber == page.number %}class='active'{% endif %}><a href="/adm_hdagente?page={{ pagenumber }}{% if search %}&s={{ search }}{% endif %}{% if estadoid %}&est={{ estadoid }}{% endif %}{% if selecttipoeq %}&tipo_equipo={{ selecttipoeq }}{% endif %}">{{ pagenumber }}</a></li>
                            {% endfor %}
                        </ul>
                    </div>
                {% endif %}
            </div>
        </div>
    </div>
{% endblock %}
{% block moreblock %}
    <div class="modal fade static" id="itemspanel1" style="display: none;">
        <div class="modal-body panelbody">
            <div class="modal-header">
                <h3 class="paneltitle">Mostrar detalle del Incidente</h3>
            </div>
        </div>
        <div class="modal-footer">
            <table class="pull-right">
                <tr>
                    <td id="aprobarcerrar"><a href="javascript:;" class="btn btn-aprobarcerrar btn-success"> Guardar</a></td>
                    <td><a href="javascript:;" class="btn btn-cerrar btn-info">Cerrar</a></td>
                </tr>
            </table>
        </div>
    </div>
    <div class="modal fade static" id="itemspanel3" style="display: none;">
        <div class="modal-header">
            <h4 class="paneltitle">Informe de incidentes</h4>
        </div>
        <div class="modal-body panelbody3">
            <div class="alert alert-danger invalidofechas" style="display: none">
                <i class="fa fa-info-sign"></i> Seleccione un rango de fechas valida para continuar...!!!
            </div>
            <div style="text-align: center;">
                <input placeholder="Fecha desde" type="text" value="{{ fechainicio }}" name="fini" id="id_fecha_inicio" style="width: 100px">
                <input placeholder="Fecha hasta" type="text" value="{{ fechafin }}" name="ffin" id="id_fecha_fin" style="width: 100px"><br><br>
            </div>
        </div>
        <div class="modal-footer" style="text-align: center">
            <a href="javascript:;" class="btn btn-danger" id="itemspanel_adicionar_3"><i class="fa fa-plus"></i> Procesar</a>
            <a href="javascript:;" class="btn btn-info" id="itemspanel_cerrar_3"> Cerrar</a>
        </div>
    </div>
    <div class="modal fade static" id="itemspanel" style="display: none;">
        <div class="modal-header">
            <h3 class="paneltitle" style="width: 92%">Detalle de Incidente</h3>
            <span class="btn btn-mini btn-default pull-right  cerrar_detalle" style="margin-top: -25px"><i class="fa fa-close" style="color: red"></i></span>
        </div>
        <div class="modal-body panelbody">
        </div>
        <div class="modal-footer">
            <table class="pull-right">
                <tr>
                    <td><a href="javascript:;" class="btn btn-cerrar btn-info">Cerrar</a></td>
                </tr>
            </table>
        </div>
    </div>
    <div class="modal fade static" id="itemspanelseleccionaractivo" style="display: none;">
        <div class="modal-header">
            <h3 class="paneltitled">Seleccionar activo</h3>
        </div>
        <div class="modal-body panelbody">
            <form id="form2" class="form-horizontal form-modal" style="width: 100%; margin-bottom: 0">
                {% for field in form2 %}
                    <fieldset id="fieldset_{{ field.name }}" class="control-group nomargins" style="min-height:35px; float: left; width: 100%" >
                        <div class="control-label label-text" {% if field.field.widget.attrs.labelwidth %}labelwidth="{{ field.field.widget.attrs.labelwidth }}"{% endif %} style="display: table;height: 30px;">
                            <div style="display: table-cell; vertical-align: middle; line-height: 11px">
                                <label for="id_{{ field.name }}" style="padding-right: 20px">{{ field.label }}</label>
                            </div>
                        </div>
                        <div class="control" style="float: left; width: 100%">
                            {% if field.field.widget.attrs.select2search %}
                                <select id="id_{{ field.name }}_select2" {% if field.field.widget.attrs.disabled %}disabled=""{% endif %} style="width: 100%" >
                                    <option value="0" selected="selected">---------</option>
                                </select>
                                <input type='hidden' name="{{ field.name }}" id="id_{{ field.name }}" value="{{ field.value }}" hidden="hidden" {% if field.field.widget.attrs.descripcion %}descripcion="{{ field.field.widget.attrs.descripcion }}"{% endif %} class="select2hidden">
                            {% else %}
                                {{ field }}
                            {% endif %}
                            <p class="help-text" style="font-size: xx-small; margin-bottom: 0; height: 13px; line-height: 13px">{{ field.help_text }} </p>
                        </div>
                    </fieldset>
                {% endfor %}
            </form>
        </div>
        <div class="modal-footer">
            <table class="pull-right">
                <tr>
                    <a href="javascript:;" class="btn btn-success" id="guardar"><i class="fa fa-save"></i> Guardar</a>
                    <td><a href="javascript:;" class="btn btn-cerrar btn-info">Cerrar</a></td>
                </tr>
            </table>
        </div>
    </div>
    <div class="modal fade static" id="modalapruebarechaza" style="display: none;">
        <div class="modal-header">
            <h4 id="paneltitle">Mover incidente</h4>
            <h4 id="idnombres"></h4>
        </div>
        <div class="modal-body apruebarechazabody">
            {#        <div class="alert alert-danger">#}
            {#            <h4 class="alert-heading">ALERTA</h4>#}
            {#            Al dar clic en Aceptar, se eliminará la inscripción en la cual aplicó.#}
            {#        </div>#}
            <p style="margin-top: 16px;">Esta seguro(a) que desea realizar acción?</p>
            <input type="hidden" id="idinscripcioncohorteestado" name="idinscripcioncohorteestado">
        </div>
        <div class="modal-footer">
            <p style="text-align: right; margin-bottom: 0">
                <a href="javascript:;" id="boton_apruebarechazaaprobada" idt="2" class='btn btn-success'> Mover incidente</a>
                <a href="javascript:;" id="cancel_apruebarechazacancela" class='btn btn-default'> Cancelar</a>
            </p>
        </div>
    </div>
    <div class="modal fade static" id="detailOrdenPedidoModal" style="display: none;">
        <div class="modal-header">
            <h3 class="paneltitle">Orden de Pedido Nro. <span id="num_doc"></span> </h3>
        </div>
        <div class="modal-body">
            <div id="detailOrdenPedidoModal_contenido" style="max-height: 400px; overflow: auto">

            </div>
        </div>
        <div class="modal-footer">
            <div style="float: right">
                <a href="javascript:;" id="detailOrdenPedidoModal_cerrar" class="btn btn-info btn-aceptar"> Aceptar</a>
            </div>
        </div>
    </div>
{% endblock %}