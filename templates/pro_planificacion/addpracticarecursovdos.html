{% extends "ajaxform.html" %}
{% load sga_extras %}
{% block validaciones %}
    actualizar_lista_activo()

    if (!lista_items3.length) {
        $('#help-text-objetivo').html('* Ingrese al menos un objetivo de la práctica').css('color', '#dc1414');
        var objetivoInput = $('#id_objetivos');
        $('html, body').animate({scrollTop: objetivoInput.offset().top - 100}, 100);
        valid = false;
    }

    lista_items4 = [];
    $(".listacomplementaria").each(function(){
        this.checked && lista_items4.push({codcomplementario: $(this).attr('codcomplementario')});
    });

    lista_items5 = [];
    $(".listabasico").each(function(){
        this.checked && lista_items5.push({basico: $(this).attr('codbasico')});
    });

    lista_items6 = [];
    $(".listavirtual").each(function(){
        this.checked && lista_items6.push($(this).attr('codarticulo'));
    });

    lista_items9 = [];
    $(".listaarticulo").each(function(){
        this.checked && lista_items9.push({idarticulo: $(this).attr('codarticulo')});
    });

    lista_items10 = [];
    $(".listauteca").each(function(){
        this.checked && lista_items10.push($(this).attr('codarticulo'))
    });
{% endblock %}
{% block extraheading %}
    <link href="/static/switchery/switchery.min.css" rel="stylesheet"/>
    <script src="/static/switchery/switchery.min.js"></script>

    <script type='text/javascript' src="/static/js/bootstrap-datepicker.js?4.0.0"></script>
    <link href="/static/css/datepicker.css?4.0.0" rel='stylesheet'/>

    <script type='text/javascript' src="/static/js/bootstrap-timepicker.js?4.0.0"></script>
    <link href="/static/css/bootstrap-timepicker.css?4.0.0" rel='stylesheet'/>
    <meta charset=UTF-8">
    <script type="text/javascript">
        var lista_items1 = [];
        var itemsact = 1;
        var lista_items2 = [];
        var lista_items3 = [];
        var itemspro = 1;
        var itemsobj = parseInt('{{ listaobjetivos|length|default:"1" }}');
        var lista_items4 = [];
        var itemsbas = 1;
        var lista_items5 = [];
        var itemscomp = 1;
        var lista_items6 = [];
        var itemsvirt = 1;
        var lista_items7 = [];
        var itemstema = 1;
        var lista_items8 = [];
        var itemsunidad = 1;
        var lista_items9 = [];
        var lista_items10 = [];
        var itemsarti = 1;
        let $switchery = {}
        let $material = '';
        let $material_id = 0;
        let $tipo = 0;
        var $ubicacionambiente = 0;

        $(function () {

            actualizar_lista_activo = function () {
                lista_items1 = [];
                $(".listadoequipos").each(function () {
                    let id = $(this).data('id');
                    lista_items1.push(id);
                });

                lista_items2 = [];
                $('.listadoinsumos').each(function(){
                    let $_id = $(this).data('id');
                    let cantidad = $(this).find('.cantidad').text();
                    lista_items2.push({'idproducto': $_id, 'cantidad': cantidad});
                });
            };

            $('.add-requerimiento-practica').click(function () {
                let tipo = parseInt($(this).data('tipo'));
                if (tipo === 1) {
                    $('.show-equipo-helpers').show();
                    $('.show-materiales-helpers').hide();
                } else {
                    $('.show-equipo-helpers').hide();
                    $('.show-materiales-helpers').show();
                }
                $tipo = tipo;
                $("#formmodal").modal({backdrop: 'static', width: '400px'}).modal('show');
            });

            $('#formmodal .btn-success').click(function () {
                let detalle = $('#id_detalle').val().trim();
                let ubicacion = $('#id_ubicacion').val();
                if (detalle) {
                    bloqueointerface();
                    $.post('{{ request.path }}', {
                        'action': 'addinsumopractica',
                        'id': '{{ silabo.silabo.materia.pk }}',
                        't': $tipo,
                        'detalle': detalle,
                        'ubicacion': ubicacion
                    }, function (data) {
                        if (data.result === 'ok') {
                            let object = $tipo === 1 ? $('#id_equipo') : $('#id_producto');
                            object.append('<option value="' + data.id + '">' + detalle + '</option>');
                            $('#formmodal').modal('hide');
                            $.unblockUI();
                        } else {
                            $.unblockUI();
                            mensajeWarning(data.mensaje);
                        }
                    });
                } else {
                    $('.help-text-detalle').html('* Este campo es obligatorio');
                    setTimeout(function(){
                        $('.help-text-detalle').html('');
                    }, 5000)
                }
            })

            $('#id_ubicacionambiente').on('change', function (e) {
                $ubicacionambiente = parseInt(this.value);
                /*
                $.get('{{ request.path }}', {'action': 'cargarequerimientos', 'u': this.value, 'c': '{{ silabo.silabo.materia.pk }}'}, function (data) {
                    $('#id_producto').empty().append('<option value="0" selected hidden>Seleccione Material/Insumo</option>');
                    $('#id_equipo').empty().append('<option value="0" selected hidden>Seleccione Equipo/Instrumento</option>');
                    data.data.forEach(x => {
                        let obj = parseInt(x.t) === 1 ? '#id_equipo' : '#id_producto';
                        $(obj).append('<option value="' + x.id + '">' + x.value + '</option>').trigger('change');
                    });
                });
                */

                $('.listadoequipos').each(function(){
                    !(parseInt($(this).data('ubicacion')) === $ubicacionambiente) && $(this).remove();
                    console.log("Equipo " + $(this).data('ubicacion') + ' - ' + $ubicacionambiente);
                });

                $('.listadoinsumos').each(function(){
                    !(parseInt($(this).data('ubicacion')) === $ubicacionambiente) && $(this).remove();
                    console.log("Insumo " + $(this).data('ubicacion') + ' - ' + $ubicacionambiente);
                });

                actualizar_lista_activo()
            });


            $("textarea").on('input', function () {
                $(this).height('auto');
                $(this).height($(this)[0].scrollHeight);
            });

            let elems = Array.prototype.slice.call(document.querySelectorAll('.js-switch'));

            elems.forEach(function (html) {
                $switchery[html.id] = new Switchery(html, {size: 'small', color: '#ffaa46'});
            });

            $('#flexRadioDefault4').change(function () {
                if (this.checked) {
                    $('.show-on-group-only').show('slow');
                } else {
                    $('.show-on-group-only').hide('slow');
                    $('#id_cantidadalumnos').val('');
                }
            });

            $('.js-switch').change(function () {
                if (this.checked) {
                    let $switchElement = $($(this).attr('data-pair'));
                    $switchElement.prop('checked', !this.checked).trigger('change');
                    $switchery[$switchElement[0].id].setPosition(false);
                }
            });

            $('#id_unidad').change(function () {
                var control = $(this);
                var id = parseInt($("#id_unidad").val());
                {#$('#itemsbodytema').remove();#}
                $("#itemsbodytema").empty();
                {#alert({{ silabo.id }})#}
                if (id > 0) {
                    bloqueointerface();
                    $.ajax({
                        type: "POST",
                        url: "/pro_planificacion",
                        data: {'action': 'consultatemas', 'idunidad': id, 'idsemana': {{ silabo.id }}},
                        success: function (data) {
                            $.unblockUI();
                            if (data.result == 'ok') {
                                {#alert(data.lista)#}
                                for (elemento in data.lista) {
                                    $("#itemsbodytema").append('<tr>' +
                                        '<td><input class="listatemas" codtema=' + data.lista[elemento][0] + ' type="checkbox"></td>' +
                                        '<td>' + data.lista[elemento][1] + '</td>' +
                                        '</tr>');
                                }
                            } else {
                                control.val(0).trigger("change");
                                mensajeWarning(data.mensaje);
                            }
                        },
                        error: function () {
                            $.unblockUI();
                            control.val(0).trigger("change");
                            mensajeDanger("Error de conexion.");
                        },
                        dataType: "json"
                    });
                }
            });

            $("#itemsadicionarobj").click(function () {
                $("#id_objetivos").val('');
                $("#alertaingreso").hide();
                $("#itemspanelobj .incompletoobj").hide();
                $("#itemspanelobj .incompletovaloresobj").hide();
                $("#adicionarycerrarobj").show();
                $("#guardar").hide();
                $("#itemspanelobj").modal({backdrop: 'static', width: '400px'}).modal('show');
                return false;
            });

            $("#cerrarobj").click(function () {
                $("#itemspanelobj .incompletoobj").hide();
                $("#itemspanelobj .incompletovaloresobj").hide();
                $("#itemspanelobj").modal("hide");
            });

            $("#adicionarycerrarobj").click(function () {
                adicionar_objetivos()
            });

            adicionar_objetivos = function (ocultar) {
                var objetivo = $("#id_objetivos").val();
                if (objetivo == '') {
                    $("#itemspanelobj .incompletoobj").show();
                    return false;
                }
                $('.show-on-empty').remove();

                let datasetobjetivo = `
                    <tr class="elementosobj" id="filaobj_${itemsobj}">
                        <td style="text-align: justify" class="objetivos">${objetivo}</td>
                        <td style="text-align: center"><a href="javascript:;" class="btn btn-danger tu eliminarobj" onclick="eliminarobjetivo(this)"><i class="fa fa-remove"></i></a></td>
                    </tr>
                `

                $("#itemsbodyobj").append(datasetobjetivo);
                $("#itemspanelobj").modal("hide");
                itemsobj += 1;
                actualizar_listaobj();
                $("#id_objetivos").val('').trigger('input');
            };

            $("#id_temapractica, #id_objetvopactica, id_instruccionobservacion, #id_actividaddesarrollar,#id_rubica").css({'text-transform': 'none'});
            $("#id_temapractica, #id_laboratorio, #id_numeropractica,#id_nombreambiente,#id_objetvopactica, #id_instruccionobservacion, #id_actividaddesarrollar,#id_rubica").addClass("validate[required]");

            $("#id_fechaelaboracion").addClass("validate[required]");
            $("#id_fechaelaboracion").datepicker({format: "dd-mm-yyyy"}).on('changeDate', function (ev) {
                $(this).datepicker('hide');
            });
            $("#id_numeropractica").prop("disabled", true);
            $('#fieldset_subtemapractica').hide();

            $("#id_tiempoactividad").timepicker({
                minuteStep: 1,
                appendWidgetTo: 'body',
                showSeconds: false,
                showMeridian: false,
                defaultTime: true
            });

            $("#id_temapractica").change(function () {
                var tema = $(this).val();
                if (tema > 0) {
                    $.post("/pro_planificacion", {
                        'action': 'mis_subtemas_semanales',
                        'ids': {{silabo.id}},
                        'idt': tema
                    }, function (data) {
                        if (data.result == 'ok') {
                            {#$('#id_subtemapractica').empty();#}
                            $('#id_subtemapractica').empty().append('<option value="">---------</option>').val(0).trigger("change");
                            for (elemento in data.lista) {
                                $('#id_subtemapractica').append('<option value="' + data.lista[elemento][0] + '">' + data.lista[elemento][1] + '</option>');
                            }
                            if (data.lista.length > 0) {
                                $('#fieldset_subtemapractica').show();
                            } else {
                                $('#fieldset_subtemapractica').hide();
                            }
                        } else {
                            mensajeWarning(data.mensaje);
                        }
                    }, 'json');
                } else {
                    $('#fieldset_subtemapractica').hide();
                }
            });

            $("#id_producto").on('select2:select', function (e) {
                if (parseInt(e.params.data.id)) {
                    $material = e.params.data.text
                    $material_id = e.params.data.id;
                    $('#id_cantidadpro').prop("disabled", false);
                } else {
                    $("#id_cantidadpro").prop("disabled", true);
                }

                $('#id_cantidadpro').val(0).trigger('change');
            });

            $('#id_equipo').on('select2:select', function (e) {
                let id = parseInt(e.params.data.id);
                if (id) {
                    let btndelete = `<a class="btn btn-danger" href="javascript:;" onclick="deleteequipo('${id}', 1)"><i class="fa fa-times"></i></a>`
                    if (!$("#elementosact-" + id).length) {
                        let html = `<tr id="elementosact-${id}" class="listadoequipos" data-id="${id}" data-ubicacion="${$ubicacionambiente}"><td style="text-align: center;">${lista_items1.length+1}</td><td colspan="6">${e.params.data.text}</td><td style="text-align:center;">${btndelete}</td></tr>`
                        $('#contenidoactivo').append(html);
                        lista_items1.push(id);
                    } else {
                        mensajeWarning('Este activo ya fue seleccionado')
                    }
                }
            });

            $('#id_cantidadpro').on('select2:select', function (e) {
                let cantidad = e.params.data.id;
                if (parseInt(cantidad)) {
                    let btndelete = `<a class="btn btn-danger" href="javascript:;" onclick="deleteequipo('${$material_id}', 2)"><i class="fa fa-times"></i></a>`
                    if (!$('#elementosact-' + $material_id).length) {
                        let html = `<tr id="elementosact-${$material_id}" class="listadoinsumos" data-id="${$material_id}" data-ubicacion="${$ubicacionambiente}">
                                        <td class="cantidad" style="text-align:center;">${cantidad}</td>
                                        <td>Unidad/es</td>
                                        <td colspan="5">${$material}</td>
                                        <td style="text-align:center;">${btndelete}</td>
                                    </tr>`

                        $('#contenidoproducto').append(html);
                        lista_items2.push({'idproducto': $material_id, 'cantidad': cantidad});
                    } else {
                        mensajeWarning('Este activo ya fue seleccionado')
                    }
                }
                $('#id_cantidadpro').val(0).trigger('change');
            });

            actualizar_listaobj();
            actualizar_lista_activo();
        });

        const actualizar_listaobj = () => {
            lista_items3 = [];
            $(".elementosobj").each(function () {
                var item = {
                    objetivos: $(this).find(".objetivos").html()
                };
                lista_items3.push(item);
            });
        };

        const eliminarobjetivo = (e) => {
            var padre = $(e).parent().parent();
            padre.remove();
            !$('.eliminarobj').length && $("#itemsbodyobj").append('<tr class="show-on-empty"><td colspan="2"><span id="help-text-objetivo">No existen registros en esta tabla</span></td></tr>');
            actualizar_listaobj();
        }

        const deleteequipo = (id) => {
            $('#elementosact-' + id).remove();
            lista_items1 = lista_items1.filter(e => e !== parseInt(id));
        }

        function leer_lista_equipo(id) {
            var ban = 0;
            for (i = 0; i < lista_items1.length; i++) {
                if (id == (lista_items1[i]['idequipo'])) {
                    ban = 1;
                } else {
                    ban = 0;
                }
            }
            return ban;
        }

        function leer_lista_producto(id) {
            var ban = 0;
            for (i = 0; i < lista_items2.length; i++) {
                if (id == (lista_items2[i]['idproducto'])) {
                    ban = 1;
                } else {
                    ban = 0;
                }
            }
            return ban;
        }

    </script>
    <style>
        .headtitle {
            margin-left: 2px !important;
        }

        .form-check-input:checked {
            background-color: #15CA9A;
            border-color: #15CA9A;
        }

        table {
            color: black !important;
        }

        input[disabled].form-control {
            background-color: inherit!important;
            color: black;
            border: 1px solid #ccc;
        }
    </style>
{% endblock %}
{% block atras %}/pro_planificacion?action=practicasrecursos&ids={{ silabo.id|encrypt }}{% endblock %}
{% block titulo %}{{ title }} {{ npractica }}{% endblock %}
{% block formdestination %}/pro_planificacion?action=practicasrecursos&ids={{ silabo.id|encrypt }}{% endblock %}
{% block formaction %}/pro_planificacion{% endblock %}
{% block formwidth %}form-sm{% endblock %}
{% block divcontainer %}col-sm-8{% endblock %}
{% block formsuffix %}
    <div class="accordion" id="accordionExample">
        {% for seccion in secciones %}
            <div class="accordion-item">
                <h2 class="accordion-header" id="heading{{ seccion.0 }}">
                    <button style="border-left:5px solid #1c3247!important;" class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse{{ seccion.0 }}" aria-expanded="true" aria-controls="collapse{{ seccion.0 }}">
                        {{ seccion.1|lower|capfirst }}
                    </button>
                </h2>
                <div id="collapse{{ seccion.0 }}" class="accordion-collapse collapse show"
                     aria-labelledby="heading{{ seccion.0 }}">
                    <div class="accordion-body">
                        <div class="container">
                            {% if seccion.0 == 1 %}
                                <div class="row mb-3">
                                    <div class="{% if practicasemana.tiempoactividad %}col-sm-8{% else %}col-sm-12{% endif %}">
                                        <b>Nombre(<span class="text-danger">*</span>):</b><br>
                                        <input type="text" disabled class="form-control" value="{{ nombrepractica }}">
                                    </div>
                                    {% if practicasemana.tiempoactividad %}
                                        <div class="col-sm-4">
                                            <b>Tiempo asignado para la actividad(<span class="text-danger">*</span>):</b><br>
                                            <input type="time" id="" name="tiempoactividad" value="{{ practicasemana.tiempoactividad|time:"H:i" }}">
                                        </div>
                                    {% endif %}
                                </div>
                                <div class="row mb-3">
                                    <b>Tipo practica(<span class="text-danger">*</span>):</b>
                                    <div class="col-sm-4">
                                        <div class="form-check">
                                            <input {% if practicasemana.asistida %}checked{% endif %} name="asistida" class="js-switch" type="checkbox"
                                                   name="flexRadioDefault" id="flexRadioDefault1"
                                                   data-pair="#flexRadioDefault2">
                                            <label class="form-check-label" for="flexRadioDefault1">Asistida</label>
                                        </div>
                                        <div class="form-check">
                                            <input {% if practicasemana.noasistida or not practicasemana %}checked{% endif %} name="noasistida" class="js-switch" type="checkbox"
                                                   name="flexRadioDefault" id="flexRadioDefault2"
                                                   data-pair="#flexRadioDefault1">
                                            <label class="form-check-label" for="flexRadioDefault2">No asistida</label>
                                        </div>
                                    </div>
                                    <div class="col-sm-4">
                                        <div class="form-check">
                                            <input {% if practicasemana.individual or not practicasemana %}checked{% endif %} name="individual" class="js-switch" type="checkbox" id="flexRadioDefault3" data-pair="#flexRadioDefault4">
                                            <label class="form-check-label" for="flexRadioDefault3">Práctica individual</label>
                                        </div>
                                        <div class="form-check">
                                            <input {% if practicasemana.grupo %}checked{% endif %} name="grupo" class="js-switch" type="checkbox" id="flexRadioDefault4" data-pair="#flexRadioDefault3">
                                            <label class="form-check-label" for="flexRadioDefault4">Práctica grupal</label>
                                        </div>
                                    </div>
                                    <div class="col-sm-4">
                                        <div class="show-on-group-only" style="{% if not practicasemana.grupo %}display:none;{% endif %}">
                                            <div class="row">
                                                <div class="col-sm-3">
                                                    <b>Grupos:</b><br>
                                                    <select name="cantidadgrupos" id="id_cantidadgrupos">
                                                        {% for c in cantidadgrupo %}
                                                            <option value="{{ c }}" {% if practicasemana.cantidadgrupos == c %}selected{% endif %}>{{ c }}</option>
                                                        {% endfor %}
                                                    </select>
                                                </div>
                                                <div class="col-sm-9">
                                                    <b>Alumnos por grupo:</b>
                                                    <select name="cantidadalumnogrupo" style="width: 80%!important;">
                                                        <option value="0">-----</option>
                                                        {% for n in listaestudiantes %}
                                                            <option value="{{ n }}" {% if practicasemana.cantidadalumnogrupo == n %}selected{% endif %}>{{ n }}</option>
                                                        {% endfor %}
                                                    </select>
                                                    <p class="help-text" style="color: #dc1414;font-size: xx-small; margin-bottom: 0; height: 13px; line-height: 13px;font-weight: normal!important;"></p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <b>Objetivos de la práctica(<span class="text-danger">*</span>):</b>
                                    <div class="table-responsive">
                                        <table class='table table-bordered' cellpadding="0" cellspacing="0">
                                            <thead class="table-light">
                                            <tr>
                                                <th style="text-align: left;vertical-align: middle;" width="95%">
                                                    <textarea style="font-size:13px;" placeholder="Escriba aquí..." class="border-2 shadow-none card-dashed-hover" name="objetivos" cols="40" rows="2" id="id_objetivos"></textarea>
                                                    <p class="help-text" style="color: #dc1414;font-size: xx-small; margin-bottom: 0; height: 13px; line-height: 13px;font-weight: normal!important;"></p>
                                                </th>
                                                <th style="text-align: center;vertical-align:top;" width="5%">
                                                    <a href="javascript:;" id="adicionarycerrarobj" class="btn btn-success tu" title="Adicionar objetivo de la práctica"><span class="fa fa-plus"></span></a>
                                                </th>
                                            </tr>
                                            </thead>
                                            <tbody id="itemsbodyobj" class="datatable">
                                                {% for objetivo in listaobjetivos %}
                                                    <tr class="elementosobj" id="filaobj_{{ forloop.counter }}">
                                                        <td style="text-align: justify" class="objetivos">{{ objetivo.nombre }}</td>
                                                        <td style="text-align: center"><a href="javascript:;" class="btn btn-danger tu eliminarobj" onclick="eliminarobjetivo(this)"><i class="fa fa-remove"></i></a></td>
                                                    </tr>
                                                {% empty %}
                                                    <tr class="show-on-empty">
                                                        <td colspan="2">
                                                            <span id="help-text-objetivo">No existen registros en esta tabla</span>
                                                        </td>
                                                    </tr>
                                                {% endfor %}
                                            </tbody>
                                            <tfoot>
                                            </tfoot>
                                        </table>
                                    </div>
                                </div>
                            {% endif %}
                            {% if seccion.0 == 2 %}
                                <table class='table table-bordered' cellpadding="0" cellspacing="0">
                                    <thead class="table-light">
                                    <tr>
                                        <th colspan="2" style="vertical-align: middle;">Ambiente de aprendizaje</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    <tr>
                                        <td width="25%">Tipo de ambiente de aprendizaje práctico</td>
                                        <td>
                                            <select formwidth="100%" id="id_tipoambiente" name="tipoambiente" tabindex="-1" class="select2-hidden-accessible" aria-hidden="true">
                                                {% for tipoam in tipoambiente %}
                                                    <option {% if practicasemana.tipoambiente == tipoam.0 %}selected{% endif %} value="{{ tipoam.0 }}">{{ tipoam.1 }}</option>
                                                {% endfor %}
                                            </select>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td width="25%">Ubicación del ambiente de aprendizaje</td>
                                        <td>
                                            <select id="id_laboratorio" name="laboratorio" class="validate[required]">
                                                <option value="">----</option>
                                                {% for lab in laboratorios %}
                                                    <option {% if practicasemana.laboratorio.pk == lab.pk %}selected{% endif %} value="{{ lab.pk }}">{{ lab }}</option>
                                                {% endfor %}
                                            </select>
                                            <p class="help-text" style="color: #dc1414;font-size: xx-small; margin-bottom: 0; height: 13px; line-height: 13px"></p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td width="25%">Nombre del ambiente de aprendizaje</td>
                                        <td style="text-align:left;">
                                            <textarea style="font-size:13px" placeholder="Escriba aquí..." cols="40" id="id_nombreambiente" name="nombreambiente" rows="2" class="validate[required] border-2 shadow-none card-dashed-hover">{{ practicasemana.nombreambiente|default:"" }}</textarea>
                                            <p class="help-text" style="color: #dc1414;font-size: xx-small; margin-bottom: 0; height: 13px; line-height: 13px"></p>
                                        </td>
                                    </tr>
                                    </tbody>
                                    <tfoot>
                                    </tfoot>
                                </table>
                                <table style="width: 100%" class="table table-bordered table-condensed">
                                    <thead class="table-light">
                                    <tr>
                                        <th colspan="8" style="">Equipos o instrumentos</th>
                                    </tr>
                                    <tr>
                                        <th style="width: 5%;text-align:center;">
                                            <a href="javascript:;" class="btn btn-success tu add-requerimiento-practica" data-tipo="1" title="Adicionar nuevo Equipo/Instrumento"><span class="fa fa-plus"></span></a>
                                        </th>
                                        <th colspan="6" style="width: 90%">
                                            <form class="form-search">
                                                <select id="id_equipo">
                                                    <option value="0" selected hidden>Seleccione Equipo/Instrumento</option>
                                                    {% for e in insumosequipo %}
                                                        <option value="{{ e.pk }}">{{ e }}</option>
                                                    {% endfor %}
                                                </select>
                                            </form>
                                        </th>
                                        <th style="width: 95%;text-align: center">
                                            <i class="fa fa-cogs"></i>
                                        </th>
                                    </tr>
                                    <tr>
                                        <th colspan="7">Equipo/Instrumento</th>
                                        <th style="width: 10px"></th>
                                    </tr>
                                    </thead>
                                    <tbody id="contenidoactivo" style="margin: 0px;overflow-y:auto;height:100px;">
                                        {% for equipo in listadoequipos %}
                                            <tr id="elementosact-{{ equipo.requerimiento.pk }}" class="listadoequipos" data-id="{{ equipo.requerimiento.pk }}" data-ubicacion="{{ equipo.requerimiento.ubicacion }}">
                                                <td style="text-align: center;">{{ forloop.counter }}</td>
                                                <td colspan="6">{{ equipo.requerimiento }}</td>
                                                <td style="text-align:center;"><a class="btn btn-danger" href="javascript:;" onclick="deleteequipo('{{ equipo.requerimiento.pk }}', 1)"><i class="fa fa-times"></i></a></td>
                                            </tr>
                                        {% endfor %}
                                    </tbody>
                                </table>
                                <table style="width: 100%; margin: 0px;overflow-y:auto;height:100px;"
                                       class="table table-bordered table-condensed">
                                    <thead class="table-light">
                                    <tr>
                                        <th colspan="8" style="">Materiales o insumos</th>
                                    </tr>
                                    <tr>
                                        <th style="width: 5%;text-align:center;">
                                            <a href="javascript:;" class="btn btn-success tu add-requerimiento-practica" data-tipo="2" title="Adicionar nuevo Material/Insumo"><span class="fa fa-plus"></span></a>
                                        </th>
                                        <th style="width: 85%;" colspan="6">
                                            <form class="form-search">
                                                <select id="id_producto">
                                                    <option value="0" selected hidden>Seleccione Material/Insumo</option>
                                                    {% for e in insumosmaterial %}
                                                        <option value="{{ e.pk }}">{{ e }}</option>
                                                    {% endfor %}
                                                </select>
                                            </form>
                                        </th>
                                        <th style="width: 10%;text-align:center;">
                                            <form class="form-search">
                                                <select id="id_cantidadpro">
                                                    <option value="0" selected hidden>Cantidad</option>
                                                    {% for c in cantidad %}
                                                        <option value="{{ c }}">{{ c }}</option>
                                                    {% endfor %}
                                                </select>
                                            </form>
                                        </th>
                                    </tr>
                                    <tr>
                                        <th style="width: 15px;">Cantidad</th>
                                        <th style="width: 15px;">Unidad</th>
                                        <th colspan="5">Material/Insumo</th>
                                        <th style="width: 10px"></th>
                                    </tr>
                                    </thead>
                                    <tbody id="contenidoproducto">
                                        {% for insumo in listadoinsumos %}
                                            <tr id="elementosact-{{ insumo.requerimiento.pk }}" class="listadoinsumos" data-id="{{ insumo.requerimiento.pk }}" data-ubicacion="{{ insumo.requerimiento.ubicacion }}">
                                                <td class="cantidad" style="text-align:center;">{{ insumo.cantidad }}</td>
                                                <td>Unidad/es</td>
                                                <td colspan="5">{{ insumo.requerimiento }}</td>
                                                <td style="text-align:center;"><a class="btn btn-danger" href="javascript:;" onclick="deleteequipo('{{ insumo.requerimiento.pk }}', 2)"><i class="fa fa-times"></i></a></td>
                                            </tr>
                                        {% endfor %}
                                    </tbody>
                                </table>
                            {% endif %}
                            {% if seccion.0 == 3 %}
                                <div style="text-align: center">
                                    <div class="control">
                                        <div class="django-ckeditor-widget" data-field-id="id_instruccionobservacion1" style="display: inline-block;">
                                            <textarea cols="80" id="id_instruccionobservacion" name="instruccionobservacion" rows="10">{{ instruccion|default:"" }}</textarea>
                                        </div>
                                        <script>
                                            CKEDITOR.replace('id_instruccionobservacion', {
                                                {#height: '300px',#}
                                                enterMode: CKEDITOR.ENTER_BR,
                                                toolbar_Basic: [
                                                    ['Source', '-', 'Bold', 'Italic']
                                                ],
                                                toolbar:
                                                    [
                                                        {
                                                            'name': 'document',
                                                            'items': ['Source', '-', 'NewPage', 'Templates']
                                                        },
                                                        {
                                                            'name': 'clipboard',
                                                            'items': ['Cut', 'Copy', 'Paste', 'PasteText', 'PasteFromWord', '-', 'Undo', 'Redo']
                                                        },
                                                        {'name': 'editing', 'items': ['Find', 'SelectAll']},
                                                        {
                                                            'name': 'insert',
                                                            'items': ['Image', 'Table', 'HorizontalRule', 'Smiley', 'SpecialChar', 'Youtube', 'Video']
                                                        },
                                                        '/',
                                                        {
                                                            'name': 'basicstyles',
                                                            'items': ['Bold', 'Italic', 'Underline', 'Strike', 'Subscript', 'Superscript', '-', 'RemoveFormat']
                                                        },
                                                        {
                                                            'name': 'paragraph',
                                                            'items': ['NumberedList', 'BulletedList', '-', 'Outdent', 'Indent', '-', 'Blockquote', '-',
                                                                'JustifyLeft', 'JustifyCenter', 'JustifyRight', 'JustifyBlock']
                                                        },
                                                        {'name': 'links', 'items': ['Link', 'Unlink']},
                                                        '/',
                                                        {
                                                            'name': 'styles',
                                                            'items': ['Styles', 'Format', 'Font', 'FontSize']
                                                        },
                                                        {'name': 'colors', 'items': ['TextColor', 'BGColor']},
                                                        {'name': 'tools', 'items': ['ShowBlocks']},
                                                        {
                                                            'name': 'yourcustomtools', 'items': [
                                                                'Maximize',
                                                            ]
                                                        },
                                                    ]
                                            });
                                        </script>
                                        <p class="help-text" style="font-size: xx-small; margin-bottom: 0; height: 13px; line-height: 13px"></p>
                                    </div>
                                </div>
                            {% endif %}
                            {% if seccion.0 == 4 %}
                                <fieldset class="control-group nomargins">
                                    <table class='table table-bordered' cellpadding="0" cellspacing="0">
                                        <thead class="table-light">
                                        <tr>
                                            <th style="width: 5%;"></th>
                                            <th style="text-align: center;border-right-style: hidden!important;">{{ 'Bibliografía básica'|upper }}</th>
                                            <th style="width: 15%"></th>
                                        </tr>
                                        </thead>
                                        <tbody id="itemsbodymet" class="datatable">
                                        {% for lisbib in listadobibiografiabasica %}
                                            <tr id="filamet_{{ lismet.id }}">
                                                <!-- border-right-style: hidden!important; -->
                                                <td style="text-align:center;vertical-align:middle;"><input {% if lisbib.seleccionadoguiapractica %}checked{% endif %} idb="tipobib" type="checkbox" codbasico="{{ lisbib.id }}" class="listabasico form-check-input" name="chkbib_{{ lisbib.id }}" id="chkbib_{{ lisbib.id }}"></td>
                                                <td colspan="2" style='text-align: justify'>{{ lisbib.librokohaprogramaanaliticoasignatura }}</td>
                                            </tr>
                                        {% empty %}
                                            <tr>
                                                <td colspan="2">No existen registros en esta tabla</td>
                                            </tr>
                                        {% endfor %}
                                        </tbody>
                                        <tfoot>
                                        </tfoot>
                                    </table>
                                    <table class='table table-bordered' cellpadding="0" cellspacing="0">
                                        <thead class="table-light">
                                        <tr>
                                            <th style="width: 5%;"></th>
                                            <th colspan="1" style="text-align: center">{{ 'Bibliografía complementaria'|upper }}</th>
                                            <th colspan="1" style="width:15%;text-align: left;text-align:center">CATEGORÍA</th>
                                        </tr>
                                        </thead>
                                        <tbody id="itemsbodymet" class="datatable">
                                            {% for liscom in librosuteca %}
                                                <tr>
                                                    <td style="text-align:center;vertical-align:middle;"><input {% if liscom.seleccionadoguiapractica %}checked{% endif %} type="checkbox" codarticulo="{{ liscom.id }}" class="listauteca form-check-input"></td>
                                                    <td style='text-align: justify'>{{ liscom }}</td>
                                                    <td style="text-align:center;vertical-align:middle">UTECA</td>
                                                </tr>
                                            {% endfor %}
                                            {% for arti in listadoguiaarticulos %}
                                                <tr id="filamet_{{ arti.id }}">
                                                    <td style="text-align:center;vertical-align:middle;"><input {% if arti.seleccionadoguiapractica %}checked{% endif %} type="checkbox" codarticulo="{{ arti.id }}" class="listaarticulo form-check-input"></td>
                                                    <td style='text-align: justify'>{{ arti.flexbox_repr|upper }}</td>
                                                    <td style="text-align:center;vertical-align:middle">ARTÍCULOS</td>
                                                </tr>
                                            {% endfor %}
                                            {% for liscom in bbliogriapa %}
                                                <tr>
                                                    <td style="text-align:center;vertical-align:middle;"><input {% if liscom.seleccionadoguiapractica %}checked{% endif %} type="checkbox" codarticulo="{{ liscom.id }}" class="listavirtual form-check-input"></td>
                                                    <td style='text-align: justify'>{{ liscom }}</td>
                                                    <td style="text-align:center;vertical-align:middle">BIBLIOGRAFÍA VIRTUAL</td>
                                                </tr>
                                            {% endfor %}
                                            {% for liscom in bibliografiacomplementaria %}
                                                <tr id="filamet_{{ liscom.id }}">
                                                    <td style="text-align:center;vertical-align:middle;"><input {% if liscom.seleccionadoguiapractica %}checked{% endif %} type="checkbox" codcomplementario="{{ liscom.id }}" class="listacomplementaria form-check-input"></td>
                                                    <td style='text-align: justify'>{{ liscom }}</td>
                                                    <td style="text-align:center;vertical-align:middle">REPOSITORIO INSTITUCIONAL</td>
                                                </tr>
                                            {% endfor %}
                                        </tbody>
                                    </table>
                                </fieldset>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
            <hr class="py-0 my-0" style="border-color: #f0f0f0">
        {% endfor %}
    </div>
{% endblock %}
{% block formextra %}
    <input type='hidden' name='action' value='{{ action }}'/>
    <input type='hidden' name='id' value='{{ silabo.id|encrypt }}'/>
    <input type='hidden' name='idpractica' value='{{ practicasemana.id|encrypt }}'/>
    <input type='hidden' name='npractica' value='{{ npractica|encrypt }}'/>
    <input type='hidden' name='nombrepractica' value='{{ nombrepractica }}'/>
    <input type="hidden" name="tiempoactividad" value="{{ tiempoactividad|time:"H:i"|default:"0:0" }}">
{% endblock %}
{% block formback %}/pro_planificacion?action=practicasrecursos&ids={{ silabo.id|encrypt }}{% endblock %}
{% block buttonname %}Guardar{% endblock %}
{% block extraalerts %}
    <div class="modal fade static" id="itemspanelobj" style="display: none;">
        <div class="modal-dialog modal-dialog-centered modal-lg" role="document" id="wmodal">
            <div class="modal-content">
                <div class="modal-header border-0">
                    <h4 class="paneltitle">Adicionar objetivos</h4>
                </div>
                <div class="modal-body">
                    <div class="panelbody">
                        <div class="alert alert-info incompletoobj" style="display: none;">
                            <i class="fa fa-info-sign"></i> Complete todos los campos para continuar
                        </div>
                        <div class="alert alert-danger" id="incompletovaloresobj" style="display: none;">
                            <i class="fa fa-info-sign"></i> Revise los valores, la fecha/hora DESDE no debe ser mayor a
                            la fecha/hora HASTA
                        </div>
                        <div class="alert alert-danger" id="alertaingresoobj" style="display: none;"> FECHAS YA FUERON
                            INGRESADAS
                        </div>
                        <div class="row-fluid">
                            <form id="formulario2" class='form-vertical' action=""
                                  method="POST">{{ formobjetivo }}</form>
                        </div>
                    </div>
                </div>
                <div class="modal-footer border-0">
                    <a href="javascript:;" class="btn btn-success" id="adicionarycerrarobj"><i
                            class="fa fa-plus fs-6"></i> Adicionar</a>
                    <a href="javascript:;" class="btn btn-cerrar btn-danger" id="cerrarobj"><i
                            class="fa fa-times fs-6"></i> Cerrar</a>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade static" id="formmodal" style="display: none;">
        <div class="modal-dialog modal-dialog-centered modal-md" role="document" id="wmodal">
            <div class="modal-content">
                <div class="modal-header border-0">
                    <h4 class="paneltitle"></h4>
                </div>
                <div class="modal-body">
                    <div class="panelbody">
                        <div class="container">
                        <div class="row show-equipo-helpers" style="display:none;">
                            <div class="col-sm-12">
                                <div class="alert alert-primary" role="alert">
                                    <h4 class="alert-heading">
                                        Tipos de equipos o instrumentos
                                    </h4>
                                    <p>
                                        Se refieren a las herramientas y máquinas utilizadas para realizar experimentos
                                        y prácticas. Estos son generalmente dispositivos de mayor tamaño, complejidad y
                                        costo. Se utilizan para realizar mediciones, análisis, y operaciones
                                        específicas.
                                    </p>
                                    <hr>
                                    <p class="mb-0">Ej. Espectrofotómetro, microscopio, centrífuga</p>
                                </div>
                            </div>
                        </div>
                        <div class="row show-materiales-helpers" style="display:none;">
                            <div class="col-sm-12">
                                <div class="alert alert-primary" role="alert">
                                    <h4 class="alert-heading">
                                        Materiales o insumos</h4>
                                    <p>
                                        Se refieren a los productos consumibles que se utilizan en el proceso
                                        experimental. Estos son artículos de uso único o de menor durabilidad que se
                                        consumen o transforman durante los experimentos.
                                    </p>
                                    <hr>
                                    <p class="mb-0">
                                        Ej. Reactivos químicos, vidrio de reloj, papel de filtro
                                    </p>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-sm-12">
                                <b>Detalle(<span class="text-danger">*</span>): </b>
                                <textarea class="border-2 shadow-none card-dashed-hover" name="detalle" id="id_detalle" cols="30" rows="2" placeholder="Escriba aquí..."></textarea>
                                <p class="help-text-detalle" style="color: #dc1414;font-size: xx-small; margin-bottom: 0; height: 13px; line-height: 13px;font-weight: normal!important;"></p>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-sm-12">
                                <b>Ubicación(<span class="text-danger">*</span>): </b>
                                <select name="ubicacion" id="id_ubicacion">
                                    <option value="0">--Seleccione--</option>
                                    {% for u in ubicacion %}
                                        <option value="{{ u.0 }}">{{ u.1 }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                        </div>
                            <br>
                        </div>
                    </div>
                </div>
                <div class="modal-footer border-0 me-3 mb-3">
                    <a href="javascript:;" class="btn btn-success" id="adicionarycerrarobj"><i
                            class="fa fa-plus fs-6"></i> Adicionar</a>
                    <a href="javascript:;" class="btn btn-danger" data-bs-dismiss="modal"><i
                            class="fa fa-times fs-6"></i> Cerrar</a>
                </div>
            </div>
        </div>
    </div>
{% endblock %}